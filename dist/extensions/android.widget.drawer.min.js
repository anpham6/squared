this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.drawer=function(){"use strict";var e=android.base.Resource;const t=squared.lib.constant,i=squared.lib.session,n=squared.lib.util,a=android.lib.constant,s=android.lib.enumeration,o=android.lib.util,r=squared.base.lib.constant,d=squared.base.lib.enumeration;class l extends squared.base.Extension{constructor(e,t,i,n){super(e,t,i,n),this.documentBase=!0,this.require(r.EXT_NAME.EXTERNAL,!0),this.require("android.widget.menu"),this.require("android.widget.coordinator")}init(e){if(this.included(e)&&e.children.length){for(let t=0;t<e.children.length;t++){const i=e.children[t];"NAV"!==i.tagName||n.includes(i.dataset.use,r.EXT_NAME.EXTERNAL)||(i.dataset.use=(i.dataset.use?`${i.dataset.use}, `:"")+r.EXT_NAME.EXTERNAL)}return this.application.rootElements.add(e),!0}return!1}processNode(i,r){const u=o.createViewAttribute(this.options.self);if(l.findNestedElement(i.element,"android.widget.menu"))n.assignEmptyValue(u,a.STRING_ANDROID.ANDROID,"fitsSystemWindows","true"),this.setStyleTheme(i.localSettings.targetAPI);else{const e=o.createViewAttribute(this.options.navigationView);n.assignEmptyValue(e,a.STRING_ANDROID.ANDROID,a.STRING_ANDROID.LAYOUT_GRAVITY,i.localizeString(t.CSS.LEFT));const s=i.item();s.mergeGravity(a.STRING_ANDROID.LAYOUT_GRAVITY,e.android.layout_gravity),s.setLayoutHeight(a.STRING_ANDROID.MATCH_PARENT),s.positioned=!0}return i.documentRoot=!0,i.setControlType(a.SUPPORT_ANDROID.DRAWER,s.CONTAINER_NODE.BLOCK),i.exclude(d.NODE_RESOURCE.FONT_STYLE),i.apply(e.formatOptions(u,this.application.extensionManager.optionValueAsBoolean(a.EXT_ANDROID.RESOURCE_STRINGS,"numberResourceValue"))),i.render(r),i.setLayoutWidth(a.STRING_ANDROID.MATCH_PARENT),i.setLayoutHeight(a.STRING_ANDROID.MATCH_PARENT),{output:{type:1,node:i,controlName:a.SUPPORT_ANDROID.DRAWER},complete:!0}}postParseDocument(i){const s=o.createViewAttribute(this.options.navigationView),d=n.optionalAsString(l.findNestedElement(i.element,"android.widget.menu"),"dataset.layoutName"),u=n.optionalAsString(l.findNestedElement(i.element,r.EXT_NAME.EXTERNAL),"dataset.layoutName");""!==d&&n.assignEmptyValue(s,a.STRING_ANDROID.APP,"menu",`@menu/${d}`),""!==u&&n.assignEmptyValue(s,a.STRING_ANDROID.APP,"headerLayout",`@layout/${u}`),""===d&&""===u||(n.assignEmptyValue(s,a.STRING_ANDROID.ANDROID,"id",`${i.documentId}_navigation`),n.assignEmptyValue(s,a.STRING_ANDROID.ANDROID,"fitsSystemWindows","true"),n.assignEmptyValue(s,a.STRING_ANDROID.ANDROID,a.STRING_ANDROID.LAYOUT_GRAVITY,i.localizeString(t.CSS.LEFT)),this.application.controllerHandler.addAfterInsideTemplate(i.id,this.application.controllerHandler.renderNodeStatic(a.SUPPORT_ANDROID.NAVIGATION_VIEW,e.formatOptions(s,this.application.extensionManager.optionValueAsBoolean(a.EXT_ANDROID.RESOURCE_STRINGS,"numberResourceValue")),a.STRING_ANDROID.WRAP_CONTENT,a.STRING_ANDROID.MATCH_PARENT)))}postOptimize(e){const t=l.findNestedElement(e.element,"android.widget.coordinator");if(t){const n=i.getElementAsNode(t,e.sessionId);n&&n.inlineHeight&&n.some(e=>e.positioned)&&n.setLayoutHeight(a.STRING_ANDROID.MATCH_PARENT)}}setStyleTheme(t){const i=this.application.userSettings,s=o.createStyleAttribute(this.options.resource);if(n.assignEmptyValue(s,"name",i.manifestThemeName),n.assignEmptyValue(s,a.STRING_ANDROID.PARENT,i.manifestParentThemeName),n.assignEmptyValue(s.items,"android:windowTranslucentStatus","true"),e.addTheme(s),t>=21){const t=o.createStyleAttribute(n.cloneObject(s));t.items={},n.assignEmptyValue(t.output,"path","res/values-v21"),n.assignEmptyValue(t.items,"android:windowDrawsSystemBarBackgrounds","true"),n.assignEmptyValue(t.items,"android:statusBarColor","@android:color/transparent"),e.addTheme(t)}}}const u=new l("android.widget.drawer",2);return squared&&squared.includeAsync(u),u}();
