this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.drawer=function(){"use strict";const{constant:e,session:t,util:i}=squared.lib,{constant:s,enumeration:n,util:a}=android.lib,{constant:o,enumeration:r}=squared.base.lib,d=android.base.Resource;class u extends squared.base.ExtensionUI{constructor(e,t,i,s){super(e,t,i,s),this.documentBase=!0,this.require(o.EXT_NAME.EXTERNAL,!0),this.require("android.widget.menu"),this.require("android.widget.coordinator")}init(e){if(this.included(e)){const t=e.children,s=t.length;if(s){for(let e=0;e<s;e++){const s=t[e];"NAV"!==s.tagName||i.includes(s.dataset.use,o.EXT_NAME.EXTERNAL)||(s.dataset.use=(s.dataset.use?`${s.dataset.use}, `:"")+o.EXT_NAME.EXTERNAL)}return this.application.rootElements.add(e),!0}}return!1}processNode(t,o){const N=a.createViewAttribute(this.options.self);if(u.findNestedElement(t.element,"android.widget.menu"))i.assignEmptyValue(N,s.STRING_ANDROID.ANDROID,"fitsSystemWindows","true"),this.setStyleTheme(t.localSettings.targetAPI);else{const n=a.createViewAttribute(this.options.navigationView);i.assignEmptyValue(n,s.STRING_ANDROID.ANDROID,s.STRING_ANDROID.LAYOUT_GRAVITY,t.localizeString(e.CSS.LEFT));const o=t.item();o.mergeGravity(s.STRING_ANDROID.LAYOUT_GRAVITY,n.android.layout_gravity),o.setLayoutHeight(s.STRING_ANDROID.MATCH_PARENT),o.positioned=!0}return t.documentRoot=!0,t.renderExclude=!1,t.setControlType(s.SUPPORT_ANDROID.DRAWER,n.CONTAINER_NODE.BLOCK),t.exclude(r.NODE_RESOURCE.FONT_STYLE),t.apply(d.formatOptions(N,this.application.extensionManager.optionValueAsBoolean(s.EXT_ANDROID.RESOURCE_STRINGS,"numberResourceValue"))),t.render(o),t.setLayoutWidth(s.STRING_ANDROID.MATCH_PARENT),t.setLayoutHeight(s.STRING_ANDROID.MATCH_PARENT),{output:{type:1,node:t,controlName:s.SUPPORT_ANDROID.DRAWER},complete:!0}}afterParseDocument(){for(const t of this.subscribers){const n=a.createViewAttribute(this.options.navigationView),r=i.optionalAsString(u.findNestedElement(t.element,"android.widget.menu"),"dataset.layoutName"),N=i.optionalAsString(u.findNestedElement(t.element,o.EXT_NAME.EXTERNAL),"dataset.layoutName");if(""!==r&&i.assignEmptyValue(n,s.STRING_ANDROID.APP,"menu",`@menu/${r}`),""!==N&&i.assignEmptyValue(n,s.STRING_ANDROID.APP,"headerLayout",`@layout/${N}`),""!==r||""!==N){const a=this.application.controllerHandler;i.assignEmptyValue(n,s.STRING_ANDROID.ANDROID,"id",`${t.documentId}_navigation`),i.assignEmptyValue(n,s.STRING_ANDROID.ANDROID,"fitsSystemWindows","true"),i.assignEmptyValue(n,s.STRING_ANDROID.ANDROID,s.STRING_ANDROID.LAYOUT_GRAVITY,t.localizeString(e.CSS.LEFT)),a.addAfterInsideTemplate(t.id,a.renderNodeStatic(s.SUPPORT_ANDROID.NAVIGATION_VIEW,d.formatOptions(n,this.application.extensionManager.optionValueAsBoolean(s.EXT_ANDROID.RESOURCE_STRINGS,"numberResourceValue")),s.STRING_ANDROID.WRAP_CONTENT,s.STRING_ANDROID.MATCH_PARENT))}}}postOptimize(e){const i=u.findNestedElement(e.element,"android.widget.coordinator");if(i){const n=t.getElementAsNode(i,e.sessionId);n&&n.inlineHeight&&n.some(e=>e.positioned)&&n.setLayoutHeight(s.STRING_ANDROID.MATCH_PARENT)}}setStyleTheme(e){const t=this.application.userSettings,n=a.createStyleAttribute(this.options.resource);if(i.assignEmptyValue(n,"name",t.manifestThemeName),i.assignEmptyValue(n,s.STRING_ANDROID.PARENT,t.manifestParentThemeName),i.assignEmptyValue(n.items,"android:windowTranslucentStatus","true"),d.addTheme(n),e>=21){const e=a.createStyleAttribute(i.cloneObject(n));e.items={},i.assignEmptyValue(e.output,"path","res/values-v21"),i.assignEmptyValue(e.items,"android:windowDrawsSystemBarBackgrounds","true"),i.assignEmptyValue(e.items,"android:statusBarColor","@android:color/transparent"),d.addTheme(e)}}}const N=new u("android.widget.drawer",2);return squared&&squared.includeAsync(N),N}();
