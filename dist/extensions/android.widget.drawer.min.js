this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.drawer=function(){"use strict";const{NODE_RESOURCE:e}=squared.base.lib.constant,{CONTAINER_NODE:t,SUPPORT_TAGNAME:a,SUPPORT_TAGNAME_X:i}=android.lib.constant,{assignEmptyValue:r,cloneObject:n,iterateArray:o}=squared.lib.util,{createThemeAttribute:s,createViewAttribute:d}=android.lib.util,u=android.base.Resource;class Drawer extends squared.base.ExtensionUI{constructor(e,t,a){super(e,t,a),this.documentBase=!0,this.require({name:"android.external",leading:!0}),this.require({name:"android.widget.menu"}),this.require({name:"android.widget.coordinator"})}beforeInsertNode(e,t){if(this.included(e)){const a=this.application;return o(e.children,(e=>{if("NAV"===e.tagName){const t=a.getDatasetName("use",e);Drawer.includes(t,"android.external")||a.setDatasetName("use",e,(t?t+", ":"")+"android.external")}})),a.getProcessing(t).rootElements.add(e),!0}return!1}processNode(n,o){const s=d(this.options.self);if(Drawer.findNestedElement(n,"android.widget.menu"))r(s,"android","fitsSystemWindows","true"),this.setStyleTheme(n.api);else{const e=d(this.options.navigationView);r(e,"android","layout_gravity",n.localizeString("left"));const t=n.item(-1);t.mergeGravity("layout_gravity",e.android.layout_gravity),t.setLayoutHeight("match_parent"),t.positioned=!0}n.documentRoot=!0,n.renderExclude=!1;const c=n.api<29?a.DRAWER:i.DRAWER;return n.setControlType(c,t.BLOCK),n.exclude({resource:e.FONT_STYLE}),n.apply(u.formatOptions(s,this.application.extensionManager.valueAsBoolean("android.resource.strings","numberAsResource"))),n.render(o),n.setLayoutWidth("match_parent"),n.setLayoutHeight("match_parent"),{output:{type:1,node:n,controlName:c},complete:!0,include:!0,remove:!0}}afterParseDocument(e){var t,n;for(const o of this.subscribers)if(o.sessionId===e){const e=o.localSettings.systemName,s=d(this.options.navigationView),c=null===(t=Drawer.findNestedElement(o,"android.widget.menu"))||void 0===t?void 0:t.dataset["layoutName"+e],l=null===(n=Drawer.findNestedElement(o,"android.external"))||void 0===n?void 0:n.dataset["layoutName"+e],m=s.app||(s.app={});if(c&&r(m,"menu","@menu/"+c),l&&r(m,"headerLayout","@layout/"+l),c||l){const e=this.controller;r(s,"android","id",`@+id/${o.controlId}_navigation`),r(s,"android","fitsSystemWindows","true"),r(s,"android","layout_gravity",o.localizeString("left")),e.addAfterInsideTemplate(o,e.renderNodeStatic({controlName:o.api<29?a.NAVIGATION_VIEW:i.NAVIGATION_VIEW,width:"wrap_content",height:"match_parent"},u.formatOptions(s,this.application.extensionManager.valueAsBoolean("android.resource.strings","numberAsResource"))))}}}postOptimize(e){for(const t of e.ascend())t.hasHeight||t.setLayoutHeight("match_parent")}setStyleTheme(e){const t=this.application.userSettings,a=s(this.options.resource);if(r(a,"name",t.manifestThemeName),r(a,"parent",t.manifestParentThemeName),r(a.items,"android:windowTranslucentStatus","true"),u.addTheme(a),e>=21){const e=s(n(a)),t={};r(e.output,"path","res/values-v21"),r(t,"android:windowDrawsSystemBarBackgrounds","true"),r(t,"android:statusBarColor","@android:color/transparent"),e.items=t,u.addTheme(e)}}}const c=new Drawer("android.widget.drawer",2);return squared&&squared.add(c),c}();
