this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=android.base.Resource;const t=squared.lib.constant,a=squared.lib.css,n=squared.lib.session,i=squared.lib.util,r=squared.lib.dom,o=android.lib.constant,s=android.lib.enumeration,l=android.lib.util,d=squared.base.lib.constant,c=squared.base.lib.enumeration,u={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^\d+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},m={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},E=["showAsAction","actionViewClass","actionProviderClass"],N={MENU:"menu",ITEM:"item",GROUP:"group"},h="ic_menu_";function p(e,t,a){for(const n in t.dataset){const i=t.dataset[n];if(i&&e[n]){const t=e[n].exec(i);t&&(a[E.includes(n)?o.STRING_ANDROID.APP:o.STRING_ANDROID.ANDROID][n]=Array.from(new Set(t)).join("|"))}}}function b(e,t){if(""!==t.title)return t.title;for(const t of e.actualChildren)if(t&&t.textElement)return t.textContent.trim();return""}const A=(e,t)=>e.some(e=>e.element.type===t);const g=new class extends squared.base.Extension{constructor(e,t,a,n){super(e,t,a,n),this.require(d.EXT_NAME.EXTERNAL,!0)}init(e){if(this.included(e)){let i=!1;if(e.children.length){i=!0;const t=e.children[0].tagName;for(let a=1;a<e.children.length;a++)if(e.children[a].tagName!==t){i=!1;break}if(i){let t=e.parentElement;for(;t;){if("NAV"===t.tagName&&this.application.rootElements.has(t)){i=!1;break}t=t.parentElement}}}i&&(e.querySelectorAll("NAV").forEach(e=>{a.getStyle(e).display===t.CSS.NONE&&(n.setElementCache(e,"squaredExternalDisplay",this.application.processing.sessionId,t.CSS.NONE),e.style.setProperty("display","block"))}),this.application.rootElements.add(e))}return!1}condition(e){return this.included(e.element)}processNode(e){const t=this.application.createNode(r.createElement(),!1);e.documentRoot=!0,e.addAlign(4),e.setControlType(N.MENU,s.CONTAINER_NODE.INLINE),e.exclude(c.NODE_RESOURCE.ALL,c.NODE_PROCEDURE.ALL);for(const t of e.cascade())this.addDescendant(t);return e.render(t),e.dataset.pathname="res/menu",{output:{type:1,node:e,controlName:N.MENU},parentAs:t,complete:!0}}processChild(t,a){if(t.plainText)return t.hide(),{next:!0};const n=l.createViewAttribute(),r=t.element;let d,E="";switch("NAV"===t.tagName?(d=N.MENU,E=b(t,r)):t.some(e=>e.length>0)?(t.some(e=>"NAV"===e.tagName)?d=N.ITEM:(d=N.GROUP,t.every(e=>A(e,"radio"))?n.android.checkableBehavior="single":t.every(e=>A(e,"checkbox"))&&(n.android.checkableBehavior="all")),E=b(t,r)):(d=N.ITEM,E=(r.title||r.innerText).trim(),A(t,"checkbox")&&!a.android("checkableBehavior")&&(n.android.checkable="true")),d){case N.MENU:t.addAlign(4);break;case N.GROUP:t.addAlign(4),p(m,r,n);break;case N.ITEM:if(p(u,r,n),!n.android.icon){const e=this.application.resourceHandler;let a=e.addImageSrc(t.backgroundImage,h);if(""!==a)n.android.icon=`@drawable/${a}`;else{const i=t.find(e=>e.imageElement);i&&""!==(a=e.addImageSrc(i.element,h))&&(n.android.icon=`@drawable/${a}`)}}t.each(e=>"NAV"!==e.tagName&&e.hide())}if(""!==E){const t=this.application.extensionManager.optionValueAsBoolean(o.EXT_ANDROID.RESOURCE_STRINGS,"numberResourceValue"),a=e.addString(E,"",t);n.android.title=t||!i.isNumber(a)?`@string/${a}`:E}return t.setControlType(d,s.CONTAINER_NODE.INLINE),t.exclude(c.NODE_RESOURCE.ALL,c.NODE_PROCEDURE.ALL),t.render(a),t.apply(n),{output:{type:1,node:t,controlName:d},complete:!0,next:d===N.MENU}}postBaseLayout(e){e.element.querySelectorAll("NAV").forEach(t=>{const a=n.getElementCache(t,"squaredExternalDisplay",e.sessionId);a&&(t.style.setProperty("display",a),n.deleteElementCache(t,"squaredExternalDisplay",e.sessionId))})}}("android.widget.menu",2,["NAV"]);return squared&&squared.includeAsync(g),g}();
