this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";const{NODE_PROCEDURE:e,NODE_RESOURCE:t}=squared.base.lib.constant,{CONTAINER_NODE:n}=android.lib.constant,{capitalize:a,sameArray:i}=squared.lib.util,{createViewAttribute:r}=android.lib.util,{appendSeparator:o}=squared.base.lib.util,s=android.base.Resource,d={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^\d+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},c={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},l="menu",u="item",m="group",h=["showAsAction","actionViewClass","actionProviderClass"],p="ic_menu_";function g(e,t,n){const a=t.dataset;for(const t in a){const i=e[t];if(i){const e=a[t];if(e){const a=i.exec(e);if(a){const e=h.includes(t)?"app":"android";(n[e]||(n[e]={}))[t]=Array.from(new Set(a)).join("|")}}}}}function b(e,t){const n=t.title.trim();if(""!==n)return n;for(const t of e.naturalChildren)if(t.textElement&&!t.textEmpty)return t.textContent.trim();return""}const f=(e,t)=>!!e.find(e=>e.toElementString("type")===t);class Menu extends squared.base.ExtensionUI{constructor(e,t,n){super(e,t,n),this.cascadeAll=!0,this.require({name:"android.external",leading:!0})}beforeInsertNode(e,t){if(this.included(e)&&e.childElementCount){if(!i(e.children,e=>e.tagName))return!1;const n=this.application.getProcessing(t).rootElements;let a=e.parentElement;for(;a;){if("NAV"===a.tagName&&n.has(a))return!1;a=a.parentElement}return n.add(e),!0}return!1}condition(e){return this.included(e.element)}processNode(i,r){const s=this.application.createNode(i.sessionId,{parent:r,append:!1});return s.childIndex=i.childIndex,s.actualParent=r.actualParent,i.documentRoot=!0,i.setControlType(l,n.INLINE),i.addAlign(2),i.exclude({resource:t.ALL,procedure:e.ALL}),i.render(s),i.cascade(e=>this.addDescendant(e)),i.dataset["pathname"+a(this.application.systemName)]=o(this.controller.userSettings.outputDirectory,"res/menu"),{outerParent:s,output:{type:1,node:i,controlName:l},complete:!0}}processChild(a,i){if(a.plainText)return a.hide(),{next:!0};const o=r(),h=o.android,N=a.element;let A,y;switch("NAV"===a.tagName?(A=l,y=b(a,N)):a.find(e=>!e.isEmpty())?(a.find(e=>"NAV"===e.tagName)?A=u:(A=m,a.every(e=>f(e,"radio"))?h.checkableBehavior="single":a.every(e=>f(e,"checkbox"))&&(h.checkableBehavior="all")),y=b(a,N)):(A=u,y=(N.title||N.innerText).trim(),f(a,"checkbox")&&!i.android("checkableBehavior")&&(h.checkable="true")),A){case l:a.addAlign(2);break;case m:a.addAlign(2),g(c,N,o);break;case u:if(g(d,N,o),!h.icon){const e=this.resource;let t=e.addImageSrc(a.backgroundImage,p);if(""!==t)h.icon="@drawable/"+t;else{const n=a.find(e=>e.imageElement);n&&(t=e.addImageSrc(n.element,p),""!==t&&(h.icon="@drawable/"+t))}}a.each(e=>"NAV"!==e.tagName&&e.hide())}return""!==y&&(h.title=s.addString(y,"",this.application.extensionManager.valueAsBoolean("android.resource.strings","numberAsResource"))),a.setControlType(A,n.INLINE),a.exclude({resource:t.ALL,procedure:e.ALL}),a.render(i),a.apply(o),{output:{type:1,node:a,controlName:A},complete:!0,next:A===l}}}const N=new Menu("android.widget.menu",2,{tagNames:["NAV"]});return squared&&squared.add(N),N}();
