this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=android.base.Resource;const{isNumber:t}=squared.lib.util,n=android.lib,{NODE_PROCEDURE:a,NODE_RESOURCE:i}=squared.base.lib.enumeration,{EXT_ANDROID:r}=n.constant,{CONTAINER_NODE:o}=n.enumeration,{createViewAttribute:s}=n.util,c={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^\d+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},d={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^\d+$/},l=["showAsAction","actionViewClass","actionProviderClass"],u="menu",m="item",h="group";function p(e,t,n){const a=t.dataset;for(const t in a){const i=e[t];if(i){const e=a[t];if(e){const a=i.exec(e);if(a){const e=l.includes(t)?"app":"android";let i=n[e];void 0===i&&(i={},n[e]=i),i[t]=Array.from(new Set(a)).join("|")}}}}}function f(e,t){var n;const a=t.title;if(a)return a;for(const t of e.naturalChildren)if(null===(n=t)||void 0===n?void 0:n.textElement)return t.textContent.trim();return""}const g=(e,t)=>e.some(e=>e.toElementString("type")===t);class N extends squared.base.ExtensionUI{constructor(e,t,n,a){super(e,t,n,a),this.cascadeAll=!0,this.require(r.EXTERNAL,!0)}init(e){if(this.included(e)){const t=e.children,n=t.length;if(n){const a=t[0].tagName;for(let e=1;e<n;e++)if(t[e].tagName!==a)return!1;const i=this.application;let r=e.parentElement;for(;r;){if("NAV"===r.tagName&&i.rootElements.has(r))return!1;r=r.parentElement}i.rootElements.add(e)}}return!1}condition(e){return this.included(e.element)}processNode(e,t){const n=this.application.createNode({parent:t,append:!1});n.childIndex=e.childIndex,n.actualParent=t.actualParent,e.documentRoot=!0,e.setControlType(u,o.INLINE),e.addAlign(4),e.exclude({resource:i.ALL,procedure:a.ALL}),e.render(n);for(const t of e.cascade())this.addDescendant(t);return e.dataset.pathname="res/menu",{output:{type:1,node:e,controlName:u},outerParent:n,complete:!0}}processChild(n,l){if(n.plainText)return n.hide(),{next:!0};const N=s(),A=N.android,b=n.element;let E,C;switch("NAV"===n.tagName?(E=u,C=f(n,b)):n.some(e=>e.length>0)?(n.some(e=>"NAV"===e.tagName)?E=m:(E=h,n.every(e=>g(e,"radio"))?A.checkableBehavior="single":n.every(e=>g(e,"checkbox"))&&(A.checkableBehavior="all")),C=f(n,b)):(E=m,C=(b.title||b.innerText).trim(),g(n,"checkbox")&&!l.android("checkableBehavior")&&(A.checkable="true")),E){case u:n.addAlign(4);break;case h:n.addAlign(4),p(d,b,N);break;case m:if(p(c,b,N),!A.icon){const e=this.resource;let t=e.addImageSrc(n.backgroundImage,"ic_menu_");if(""!==t)A.icon="@drawable/"+t;else{const a=n.find(e=>e.imageElement);a&&(t=e.addImageSrc(a.element,"ic_menu_"),""!==t&&(A.icon="@drawable/"+t))}}n.each(e=>"NAV"!==e.tagName&&e.hide())}if(""!==C){const n=this.application.extensionManager.optionValueAsBoolean(r.RESOURCE_STRINGS,"numberResourceValue"),a=e.addString(C,"",n);A.title=n||!t(a)?"@string/"+a:C}return n.setControlType(E,o.INLINE),n.exclude({resource:i.ALL,procedure:a.ALL}),n.render(l),n.apply(N),{output:{type:1,node:n,controlName:E},complete:!0,next:E===u}}}const A=new N("android.widget.menu",2,["NAV"]);return squared&&squared.includeAsync(A),A}();
