!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).squared={})}(this,(function(e){"use strict";class Iterator{constructor(e){this.children=e,this.index=-1,this._iterating=0,this.length=e.length}next(){if(this.hasNext())return this._iterating=1,this.children[++this.index]}hasNext(){return this.index<this.length-1}remove(){const e=this._iterating;if(0!==e)this.children.splice(this.index,1),this.index-=e,--this.length,this._iterating=0}forEachRemaining(e){while(this.hasNext())e(this.children[++this.index])}}class ListIterator extends Iterator{constructor(e){super(e)}add(e){const t=this._iterating;if(0!==t)this.children.splice(1===t?Math.min(++this.index,this.length):Math.max(--this.index,0),0,e),++this.length,this._iterating=0}set(e){if(0!==this._iterating)this.children[this.index]=e,this._iterating=0}nextIndex(){return Math.min(this.index+1,this.length)}hasPrevious(){return this.previousIndex()>0}previous(){if(this.hasPrevious())return this._iterating=-1,this.children[--this.index]}previousIndex(){return Math.max(this.index-1,-1)}}const t="-?(?:\\d+(?:\\.\\d+)?|\\d*\\.\\d+)",r="px|em|pt|rem|ch|pc|vw|vh|vmin|vmax|mm|cm|in",n={DECIMAL:t,PERCENT:"-?\\d+(?:\\.\\d+)?%",LENGTH:`(${t})(${r})?`,LENGTH_PERCENTAGE:`(${t}(?:${r}|%)?)`,UNIT_LENGTH:r,DATAURI:"(?:data:([^,]+),)?(.+?)",CSS_SELECTOR_LABEL:"[\\.#]?[\\w\\-]+",CSS_SELECTOR_PSEUDO_ELEMENT:"::[\\w\\-]+",CSS_SELECTOR_PSEUDO_CLASS:":[\\w\\-]+(?:\\(\\s*([^()]+)\\s*\\)|\\(\\s*([\\w\\-]+\\(.+?\\))\\s*\\))?",CSS_SELECTOR_ATTR:"\\[((?:\\*\\|)?(?:\\w+\\\\:)?[\\w\\-]+)(?:([~^$*|])?=(?:\"((?:[^\"]|\\\\\")+)\"|'((?:[^']|\\')+)'|([^\\s\\]]+))\\s*(i)?)?\\]",CSS_ANGLE:`(${t})(deg|rad|turn|grad)`,CSS_TIME:`(${t})(s|ms)`,CSS_CALC:"calc\\((.+)\\)"},i={DECIMAL:new RegExp(`^\\s*(${n.DECIMAL})\\s*$`),LENGTH:new RegExp(`^\\s*${n.LENGTH}\\s*$`),PERCENT:new RegExp(`^\\s*(${n.PERCENT})\\s*$`),LENGTH_PERCENTAGE:new RegExp(`^\\s*${n.LENGTH_PERCENTAGE}\\s*$`)},s={PX:/\dpx$/,ANGLE:new RegExp(`^\\s*${n.CSS_ANGLE}\\s*$`),TIME:new RegExp(`^\\s*${n.CSS_TIME}\\s*$`),CALC:new RegExp(`^\\s*${n.CSS_CALC}\\s*$`),VAR:/var\((--[A-Za-z\d-]+)\s*(?!,\s*var\()(?:,\s*([a-z-]+\([^)]+\)|[^)]+))?\)/,URL:/^\s*url\((?:"?((?:[^")]|\\")+)"?)\)\s*$/,CUSTOM_PROPERTY:/^\s*var\(.+\)\s*$/,HEX:/[A-Za-z\d]{3,8}/,RGBA:/rgba?\((\d+),\s+(\d+),\s+(\d+)(?:,\s+([\d.]+))?\)/,HSLA:/hsla?\((\d+),\s+(\d+)%,\s+(\d+)%(?:,\s+([\d.]+))?\)/,SELECTOR_G:new RegExp(`\\s*((?:${n.CSS_SELECTOR_ATTR}|${n.CSS_SELECTOR_PSEUDO_CLASS}|${n.CSS_SELECTOR_PSEUDO_ELEMENT}|${n.CSS_SELECTOR_LABEL})+|[>~+*])\\s*`,"g"),SELECTOR_LABEL:new RegExp(n.CSS_SELECTOR_LABEL),SELECTOR_PSEUDO_ELEMENT:new RegExp(n.CSS_SELECTOR_PSEUDO_ELEMENT),SELECTOR_PSEUDO_CLASS:new RegExp(n.CSS_SELECTOR_PSEUDO_CLASS),SELECTOR_ATTR:new RegExp(n.CSS_SELECTOR_ATTR)},a={ATTRIBUTE:/([^\s]+)="((?:[^"]|\\")+)"/,ENTITY:/&#?[A-Za-z\d]+;/,SEPARATOR:/\s*,\s*/,DELIMITER:/\s*;\s*/,BREAKWORD_G:/([A-Za-z\d]+|&#?[A-Za-z\d]+;)/g,NONWORD_G:/[^A-Za-z\d]+/g,TAGNAME_G:/(<([^>]+)>)/g},l={SPACE:/\s+/,LEADINGSPACE:/^\s+/,TRAILINGSPACE:/\s+$/,TRAILINGZERO:/\.(\d*?)(0+)$/,LEADINGNEWLINE:/^\s*\n+/,LEADINGNUMBER:/^\d/,LOWERCASE:/^[a-z]+$/,WORD:/\w/,UNITZERO:/^\s*0[a-z]*\s*$/,WORDDASH:/[a-zA-Z\d]/},o={PROTOCOL:/^([A-Za-z]{3,}:\/\/)([A-Za-z\d\-.]+)(:\d+)?(\/[^?]*)?(.*)?$/},c={ENTITY:/&#(\d+);/g,NONENTITY:/&(?!#?[A-Za-z\d]{2,};)/g};var u=Object.freeze({__proto__:null,STRING:n,FILE:{NAME:/[/\\]?(([^/\\]+?)\.([^/\\]+?))$/,SVG:/\.svg$/i},UNIT:i,CSS:s,XML:a,CHAR:l,COMPONENT:o,ESCAPE:c});const h=[8,4,4,4,12],f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",g=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],d={},p={};function b(e){switch(_(e.trim(),".").toLowerCase()){case"aac":return"audio/aac";case"abw":return"application/x-abiword";case"apng":return"image/apng";case"arc":return"application/x-freearc";case"avi":return"video/x-msvideo";case"azw":return"application/vnd.amazon.ebook";case"bin":return"application/octet-stream";case"bmp":return"image/bmp";case"bz":return"application/x-bzip";case"bz2":return"application/x-bzip2";case"csh":return"application/x-csh";case"css":return"text/css";case"csv":return"text/csv";case"doc":return"application/msword";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"eot":case"embedded-opentype":return"application/vnd.ms-fontobject";case"epub":return"application/epub+zip";case"flac":return"audio/flac";case"gif":return"image/gif";case"gsm":return"audio/gsm";case"heic":return"image/heic";case"heif":return"image/heif";case"htm":case"html":return"text/html";case"cur":case"ico":return"image/x-icon";case"ics":return"text/calendar";case"jar":return"application/java-archive";case"jpeg":case"jpg":case"jfif":case"pjpeg":case"pjp":return"image/jpeg";case"js":case"mjs":return"text/javascript";case"json":return"application/json";case"jsonp":return"application/javascript";case"jsonld":return"application/ld+json";case"mid":case"midi":return"audio/midi";case"mkv":return"video/x-matroska";case"mp3":case"mpeg":return"audio/mpeg";case"mp4":return"video/mp4";case"mpkg":return"application/vnd.apple.installer+xml";case"odp":return"application/vnd.oasis.opendocument.presentation";case"ods":return"application/vnd.oasis.opendocument.spreadsheet";case"odt":return"application/vnd.oasis.opendocument.text";case"oga":case"spx":case"ogg":return"audio/ogg";case"ogv":case"ogm":return"video/ogg";case"ogx":return"application/ogg";case"otf":case"opentype":return"font/otf";case"png":return"image/png";case"pdf":return"application/pdf";case"ppt":return"application/vnd.ms-powerpoint";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"rar":return"application/x-rar-compressed";case"rtf":return"application/rtf";case"sh":return"application/x-sh";case"svg":return"image/svg+xml";case"swf":return"application/x-shockwave-flash";case"tar":return"application/x-tar";case"tif":case"tiff":return"image/tiff";case"ts":return"video/mp2t";case"ttf":case"truetype":return"font/ttf";case"txt":return"text/plain";case"vsd":return"application/vnd.visio";case"wav":return"audio/wav";case"weba":case"webm":return"audio/webm";case"webp":return"image/webp";case"woff":return"font/woff";case"woff2":return"font/woff2";case"xhtml":return"application/xhtml+xml";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xml":return"application/xml";case"xul":return"application/vnd.mozilla.xul+xml";case"zip":return"application/zip";case"3gp":return"video/3gpp";case"3g2":return"video/3gpp2";case"7z":return"application/x-7z-compressed";default:return""}}function m(e){for(const t in e)return void 0!==e[t];return false}function v(e,t,r){return 0===t?e.substring(r):e.substring(0,t)+e.substring(t+r)}function E(e,t="-"){let r=e.indexOf(t);if(-1===r)return e;const n=d[e];if(n)return n;let i=e.substring(0,r),s="";const a=e.length;while(r<a){const n=e.charAt(r++);if(n!==t)if(s===t)i+=n.toUpperCase();else i+=n;s=n}return d[e]=i,i}function w(e){return parseFloat(e)||0}function y(e){if(e>=0){let t="";const r=f.length;while(e>=r){const n=Math.floor(e/r);if(n>1&&n<=r)t+=f.charAt(n-1),e-=n*r;else if(n>0)return t+="Z",t+=y(e-=Math.pow(r,2)),t;const i=e%r;t+=f.charAt(i),e-=i+r}return f.charAt(e)+t}return e.toString()}function k(e){const t=e.toString().split("");let r="",n=3;while(n--)r=(g[parseInt(t.pop())+10*n]||"")+r;return"M".repeat(parseInt(t.join("")))+r}function x(e,t,r="",n="(",i=")"){if(r.length>1)return[];if(!R(t))t=n;const s=t!==n,a=s?t+n:n,l=[],o=e=>{e.split(r).forEach(e=>{if(""!==(e=e.trim()))l.push(e)})};let c=0,u=-1;const h=e.length;while(-1!==(u=e.indexOf(a,c))){let a="";if(u!==c){let n=e.substring(c,u);if(r){if(n=n.trim(),""!==n)if(o(n),!s){const r=l[l.length-1];if(e.substring(u-r.length,u+1)===r+t)a=r,--l.length}}else l.push(n)}let f=false;for(let o=u+(s?t.length:0)+1,g=1,d=0;o<h;++o){switch(e.charAt(o)){case n:++g;break;case i:++d;break}if(g===d){if(r){for(;o<h;++o)if(e.charAt(o)===r)break;c=o+1,l.push(a+e.substring(u,o).trim())}else c=o+1,l.push(e.substring(u,c));if(c===h)return l;f=true;break}}if(!f)return[]}if(c<h){const t=e.substring(c);if(r){const e=t.trim();if(""!==e)o(e)}else l.push(t)}return l}function A(e,t){return(e&t)===t}function S(e){return i.DECIMAL.test(e)}function R(e){return"string"==typeof e&&""!==e.trim()}function C(e){return"object"==typeof e&&null!==e}function F(e){return C(e)&&(e.constructor===Object||null===Object.getPrototypeOf(Object(e)))}function T(e,t=[],r=false){return e.forEach(e=>{if(Array.isArray(e))t.push(T(e,[],r));else if(r&&F(e))t.push(N(e,{},true));else t.push(e)}),t}function N(e,t={},r=false){for(const n in e){const i=e[n];if(Array.isArray(i))t[n]=r?T(i,[],true):i;else if(F(i))t[n]=N(i,{},r);else t[n]=i}return t}function P(e,t){if(e=e.trim(),!o.PROTOCOL.test(e)){const r=location.origin,n=((null==t?void 0:t.replace(r,""))||location.pathname).replace(/\\/g,"/").split("/");if(n.pop(),"/"===(e=e.replace(/\\/g,"/")).charAt(0))return r+e;else if(e.startsWith("../")){const t=[];e.split("/").forEach(e=>{if(".."===e)if(0===t.length)n.pop();else t.pop();else t.push(e)}),e=t.join("/")}return r+n.join("/")+"/"+e}return e}function I(e,t){return e.replace(new RegExp(`^${t}+`),"")}function L(e,t){return e.replace(new RegExp(t+"+$"),"")}function _(e,...t){for(const r of t){const t=e.lastIndexOf(r);if(-1!==t)return e.substring(t+1)}return e}function B(e){return null!=e&&""!==e}function O(e,t,r=1){return t>=e-r&&t<=e+r}function M(e,t){let r=0;for(const n of e)if(t(n,r++,e))return n}function D(e,t){const r=e.length,n=new Array(r),i=new Array(r);let s=0,a=0,l=0;while(s<r){const r=e[s];if(t(r,s++,e))n[a++]=r;else i[l++]=r}return n.length=a,i.length=l,[n,i]}function z(e,t){const r=e.length;if(r){let n,i=0;while(i<r){const r=t(e[i],i,e);if(0==i++)n=r;else if(r!==n)return false}return true}return false}function j(e,t,r="\n",n=true){let i="";const s=e.length;let a=0;while(a<s){const n=t(e[a],a++,e);if(""!==n)i+=n+r}return n?i:i.substring(0,i.length-r.length)}function $(e,t,r=0,n=1/0){r=Math.max(r,0);const i=Math.min(e.length,n);let s=r;while(s<i){if(true===t(e[s],s++,e))return 1/0}return i}function W(e,t){const r=e.length;let n=0;while(n<r)e[n]=t(e[n],n++,e);return e}function G(e,t){const r=e.length,n=new Array(r);let i=0;while(i<r)n[i]=t(e[i],i++,e);return n}var H=Object.freeze({__proto__:null,promisify:function(e){return(...t)=>new Promise((r,n)=>{try{r(e.call(null,...t))}catch(e){n(e)}})},hasMimeType:function(e,t){return"*"===e||e.includes(b(t))},parseMimeType:b,fromMimeType:function(e){switch(e){case"audio/aac":return"aac";case"application/x-abiword":return"abw";case"image/apng":return"apng";case"application/x-freearc":return"arc";case"video/x-msvideo":return"avi";case"application/vnd.amazon.ebook":return"azw";case"application/octet-stream":return"bin";case"image/bmp":return"bmp";case"application/x-bzip":return"bz";case"application/x-bzip2":return"bz2";case"application/x-csh":return"csh";case"text/css":return"css";case"text/csv":return"csv";case"application/msword":return"doc";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return"docx";case"application/vnd.ms-fontobject":return"eot";case"application/epub+zip":return"epub";case"audio/flac":return"flac";case"image/gif":return"gif";case"audio/gsm":return"gsm";case"image/heic":return"heic";case"image/heif":return"heif";case"text/html":return"html";case"image/x-icon":return"ico";case"text/calendar":return"ics";case"application/java-archive":return"jar";case"image/jpeg":return"jpg";case"text/javascript":return"js";case"application/json":return"json";case"application/ld+json":return"jsonld";case"audio/midi":return"mid";case"video/x-matroska":return"mkv";case"audio/mpeg":return"mp3";case"video/mp4":return"mp4";case"application/vnd.apple.installer+xml":return"mpkg";case"application/vnd.oasis.opendocument.presentation":return"odp";case"application/vnd.oasis.opendocument.spreadsheet":return"ods";case"application/vnd.oasis.opendocument.text":return"odt";case"audio/ogg":return"ogg";case"video/ogg":return"ogv";case"application/ogg":return"ogx";case"font/otf":return"otf";case"image/png":return"png";case"application/pdf":return"pdf";case"application/vnd.ms-powerpoint":return"ppt";case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return"pptx";case"application/x-rar-compressed":return"rar";case"application/rtf":return"rtf";case"application/x-sh":return"sh";case"image/svg+xml":return"svg";case"application/x-shockwave-flash":return"swf";case"application/x-tar":return"tar";case"image/tiff":return"tif";case"video/mp2t":return"ts";case"font/ttf":return"ttf";case"text/plain":return"txt";case"application/vnd.visio":return"vsd";case"audio/wav":return"wav";case"audio/webm":return"video/webm";case"image/webp":return"webp";case"font/woff":return"woff";case"font/woff2":return"woff2";case"application/xhtml+xml":return"xhtml";case"application/vnd.ms-excel":return"xls";case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return"xlsx";case"text/xml":return"xml";case"application/vnd.mozilla.xul+xml":return"xul";case"application/zip":return"zip";case"video/3gpp":return"3gp";case"video/3gpp2":return"3g2";case"application/x-7z-compressed":return"7z";default:return""}},hasKeys:m,capitalize:function(e,t){return false===t?e.charAt(0).toLowerCase()+e.substring(1):e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},capitalizeString:function(e){a.BREAKWORD_G.lastIndex=0;const t=e.split("");let r;while(null!==(r=a.BREAKWORD_G.exec(e))){const e=r.index;if(void 0!==e)t[e]=r[1].charAt(0).toUpperCase()}return t.join("")},lowerCaseString:function(e){a.BREAKWORD_G.lastIndex=0;let t,r=e;while(null!==(t=a.BREAKWORD_G.exec(e))){const n=t.index;if(void 0!==n){const i=t[1];if(!a.ENTITY.test(i)){const s=n+i.length;r=(n>0?r.substring(0,t.index):"")+e.substring(n,s).toLowerCase()+r.substring(s)}}}return r},spliceString:v,convertUnderscore:function(e){const t=p[e];if(t)return t;let r=e[0].toLowerCase(),n=true;const i=e.length;let s=1;while(s<i){const t=e.charAt(s++),i=t===t.toUpperCase();if(n&&i&&"_"!==t)r+="_"+t.toLowerCase();else r+=t;n=!i}return p[e]=r,r},convertCamelCase:E,convertWord:function(e,t){let r="";const n=t?l.WORDDASH:l.WORD,i=e.length;let s=0;while(s<i){const t=e.charAt(s++);r+=n.test(t)?t:"_"}return r},convertInt:function(e){return parseInt(e)||0},convertFloat:w,convertAlpha:y,convertRoman:k,convertEnum:function(e,t,r){for(const n of Object.keys(t))if(e===t[n])return r[n];return""},randomUUID:function(e="-"){let t="";for(let r=0;r<5;++r){if(r>0)t+=e;const n=h[r];for(let e=0;e<n;++e)t+="0123456789abcdef".charAt(Math.floor(16*Math.random()))}return t},formatString:function(e,...t){const r=t.length;let n=0;while(n<r)e=e.replace(`{${n}}`,t[n++]);return e},delimitString:function(e,...t){const r=e.value;if(!r&&1===t.length)return t[0];const n=e.delimiter||"|",i=e.not||[],s=e.remove||false,a=""!==r?r.split(n):[];for(let e=0;e<t.length;++e){const r=t[e];if(""!==r){if(a.includes(i[e]))continue;const t=a.findIndex(e=>e===r);if(-1===t)a.push(r);else if(s)a.splice(t,1)}}if(e.sort)a.sort();return a.join(n)},splitEnclosing:x,hasBit:A,isNumber:S,isString:R,isArray:function(e){return Array.isArray(e)&&e.length>0},isObject:C,isPlainObject:F,isEqual:function e(t,r){if(t===r)return true;else if(Array.isArray(t)&&Array.isArray(r)){const e=t.length;if(e===r.length){let n=0;while(n<e)if(t[n]!==r[n++])return false;return true}}else if(F(t)&&F(r))if(Object.keys(t).length===Object.keys(r).length){for(const n in t){const i=t[n],s=r[n];if(i!==s){if(F(i)&&F(s)&&e(i,s))continue;return false}}return true}return false},includes:function(e,t,r=a.SEPARATOR){if(e)for(const n of e.split(r))if(n===t)return true;return false},cloneInstance:function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)},cloneArray:T,cloneObject:N,resolvePath:P,trimBoth:function(e,t='"'){const r=new RegExp(`^(${t})(.*?)\\1$`).exec(e);return r?r[2]:e},trimString:function(e,t){return I(L(e,t),t)},trimStart:I,trimEnd:L,appendSeparator:function(e,t,r="/"){switch(e=e.trim(),t=t.trim(),r){case"\\":e=e.replace(/\//g,"\\"),t=t.replace(/\//g,"\\");break;case"/":e=e.replace(/\\/g,"/"),t=t.replace(/\\/g,"/");break}return e+(""!==e&&""!==t&&!e.endsWith(r)&&!t.startsWith(r)?r:"")+t},fromLastIndexOf:_,partitionLastIndexOf:function(e,...t){for(const r of t){const t=e.lastIndexOf(r);if(-1!==t)return[e.substring(0,t),e.substring(t+1)]}return["",e]},searchObject:function(e,t){const r=[];if("object"==typeof t)for(const n in t){const i=t[n];if(B(e[i]))r.push([i,e[i]])}else{const n=/^\*.+\*$/.test(t)?e=>e.includes(t.replace(/^\*/,"").replace(/\*$/,"")):t.startsWith("*")?e=>e.endsWith(t.replace(/^\*/,"")):t.endsWith("*")?e=>e.startsWith(t.replace(/\*$/,"")):e=>e===t;for(const t in e)if(n(t))r.push([t,e[t]])}return r},hasValue:B,withinRange:O,aboveRange:function(e,t,r=1){return e+r>t},belowRange:function(e,t,r=1){return e-r<t},assignEmptyProperty:function(e,t){for(const r in t)if(!Object.prototype.hasOwnProperty.call(e,r))e[r]=t[r];return e},assignEmptyValue:function(e,...t){const r=t.length;if(r>1){let n=e,i=0;do{const e=t[i],s=n[e];if(i===r-2){if(!B(s))n[e]=t[i+1];break}else if(R(e))if(null==s)n={},n[e]=n;else if(C(s))n=s;else break;else break}while(++i)}},findSet:M,sortNumber:function(e,t=true){return t?e.sort((e,t)=>e<t?-1:1):e.sort((e,t)=>e>t?-1:1)},safeNestedArray:function(e,t){let r=e[t];if(null==r)r=[],e[t]=r;return r},safeNestedMap:function(e,t){let r=e[t];if(null==r)r={},e[t]=r;return r},sortArray:function(e,t,...r){return e.sort((e,n)=>{for(const i of r){let r=e,s=n;for(const e of i.split(".")){const t=r[e],n=s[e];if(void 0!==t&&void 0!==n)r=t,s=n;else if(void 0===t&&void 0===n)return 0;else if(void 0!==t)return-1;else return 1}if(r!==s)if(t)return r>s?1:-1;else return r<s?-1:1}return 0})},flatArray:function e(t,r=0,n=0){let i=[];const s=t.length;let a=0;while(a<s){const s=t[a++];if(n<r&&Array.isArray(s)){if(s.length)i=i.concat(e(s,r,n+1))}else if(null!=s)i.push(s)}return i},spliceArray:function(e,t,r,n){let i=0;for(let s=0;s<e.length;++s){const a=e[s];if(t(a,s,e)){if(r)r(a,s,e);if(e.splice(s--,1),++i===n)break}}return e},partitionArray:D,sameArray:z,joinArray:j,iterateArray:$,iterateReverseArray:function(e,t,r=0,n=1/0){r=Math.max(r,0);const i=Math.min(e.length,n);let s=i-1;while(s>=r){if(true===t(e[s],s--,e))return 1/0}return i},conditionArray:function(e,t,r){const n=e.length;for(let i=0;i<n;++i){const n=e[i];if(t(n,i,e)){if(false===r(n,i,e))break}}},replaceMap:W,objectMap:G});class Container{constructor(e){this._children=e||[]}[Symbol.iterator](){return function*(e){const t=e.length;let r=0;while(r<t)yield e[r++]}(this._children)}item(e,t){const r=this._children;if(void 0!==e){if(t)if(e>=0&&e<r.length)return r[e]=t,t;else return;return r[e]}return r[r.length-1]}append(e){return this._children.push(e),this}remove(...e){const t=[],r=this._children;return e.forEach(e=>{const n=r.length;for(let i=0;i<n;++i)if(r[i]===e){r.splice(i,1),t.push(e);break}}),t}removeAt(e){return this._children.splice(e,1)[0]}contains(e){return this._children.includes(e)}retain(e){return this._children=e,this}duplicate(){return this._children.slice(0)}clear(){return this._children.length=0,this}each(e){const t=this._children,r=t.length;let n=0;while(n<r)e(t[n],n++,t);return this}iterate(e,t,r){return $(this._children,e,t,r)}join(...e){let t=this._children;return e.forEach(e=>t=t.concat(e.children)),this._children=t,this}every(e){const t=this._children,r=t.length;if(r){let n=0;while(n<r)if(!e(t[n],n++,t))return false;return true}return false}same(e){return z(this._children,e)}partition(e){return D(this._children,e)}extract(e,t){let r,n;if(t)({also:r,error:n}=t);const i=[],s=this._children;for(let t=0;t<s.length;++t){const a=s[t];if(n&&n(a,t,s))break;if(e(a,t,s))null==r||r.call(a,a),i.push(a),s.splice(t--,1)}return i}findIndex(e,t){let r,n;if(t)({also:r,error:n}=t);const i=this._children,s=i.length;for(let t=0;t<s;++t){const s=i[t];if(n&&n(s,t,i))return-1;if(e(s,t,i))return null==r||r.call(s,s),t}return-1}find(e,t){let r,n,i;if(t)({also:n,error:r,cascade:i}=t);let s=false;const a=t=>{const l=t.children,o=l.length;for(let t=0;t<o;++t){const o=l[t];if(r&&r(o,t,l)){s=true;break}if(e(o,t,l))return null==n||n.call(o,o),o;if(i&&o instanceof Container&&!o.isEmpty){const e=a(o);if(e)return null==n||n.call(o,o),e;else if(s)break}}};return a(this)}some(e,t){return void 0!==this.find(e,t)}cascade(e,t){let r,n;if(t)({also:n,error:r}=t);let i=false;const s=t=>{let a=[];const l=t.children,o=l.length;for(let t=0;t<o;++t){const o=l[t];if(r&&r(o,t,l)){i=true;break}if(!e||e(o))null==n||n.call(o,o),a.push(o);if(o instanceof Container&&!o.isEmpty)if(a=a.concat(s(o)),i)break}return a};return s(this)}map(e){return G(this._children,e)}sort(e){return this._children.sort(e),this}concat(e){return this._children=this._children.concat(e),this}iter(){return new ListIterator(this._children)}get children(){return this._children}get isEmpty(){return 0===this._children.length}get length(){return this._children.length}}function U(e){const t=navigator.platform.toLowerCase();if("string"==typeof e)return t.includes(e.toLowerCase());else return A(e,2)&&t.includes("win")||A(e,4)&&/(mac|iphone|ipad|ipod)/.test(t)}function V(e){const t=navigator.userAgent;let r;if(t.includes("Safari")&&!t.includes("Chrome"))r=4;else if(t.includes("Firefox"))r=8;else if(t.includes("Edge"))r=16;else r=2;if("string"==typeof e){const t=e.toUpperCase();if(e=0,t.includes("CHROME"))e|=2;if(t.includes("SAFARI"))e|=4;if(t.includes("FIREFOX"))e|=8;if(t.includes("EDGE"))e|=16}return A(e,r)}function X(){return 96*window.devicePixelRatio}var q=Object.freeze({__proto__:null,isWinEdge:function(){return V(16)&&U(2)},isPlatform:U,isUserAgent:V,getDeviceDPI:X});const Z=/^(-?\d+\.\d+)e(-?\d+)$/,Y=/^(-?\d+)\.(\d*?)(0{5,}|9{5,})\d*$/,K={};function Q(e){return Math.min.apply(null,e)}function J(e,t,r=5){return r+=Math.floor(e).toString().length,e.toPrecision(r)===t.toPrecision(r)}function ee(e,t=3){if("string"==typeof e)e=parseFloat(e);const r=Math.floor(e);if(e===r)return e.toString();else if(e>=0&&e<=1/Math.pow(10,t)||e<0&&e>=-1/Math.pow(10,t))return"0";else{if(0!==r)t+=r.toString().length;return re(e.toPrecision(t))}}function te(e){if(e!==Math.floor(e)){const t=Y.exec(function(e){const t=Z.exec(e.toString());return t?parseInt(t[2])>0?Number.MAX_SAFE_INTEGER.toString():"0":e.toString()}(e));if(t){const r=t[2];if(""===r)return Math.round(e);const n=t[1];return parseFloat(e.toPrecision(("0"!==n?n.length:0)+r.length))}}return e}function re(e){const t=l.TRAILINGZERO.exec(e);return t?e.substring(0,e.length-t[t[1]?2:0].length):e}function ne(e){return e*Math.PI/180}function ie(e,t){const r=t.x-e.x,n=t.y-e.y;return 180*Math.atan2(n,r)/Math.PI}function se(e,t=0,r=1){if(e<t)e=t;else if(e>r)e=r;return e}function ae(e,t=11){let r=e=ne(e);for(let n=3,i=0;n<=t;n+=2)r+=Math.pow(e,n)/oe(n)*(i++%2==0?-1:1);return r}function le(e,t=10){e=ne(e);let r=1;for(let n=2,i=0;n<=t;n+=2)r+=Math.pow(e,n)/oe(n)*(i++%2==0?-1:1);return r}function oe(e){let t=2,r=3;while(r<=e)t*=r++;return t}var ce=Object.freeze({__proto__:null,minArray:Q,maxArray:function(e){return Math.max.apply(null,e)},equal:J,moreEqual:function(e,t,r=5){return e>t||J(e,t,r)},lessEqual:function(e,t,r=5){return e<t||J(e,t,r)},truncate:ee,truncateFraction:te,truncateTrailingZero:re,truncateString:function(e,t=3){let r=K[t];if(!r)r=new RegExp(`(-?\\d+\\.\\d{${t}})(\\d)\\d*`,"g"),K[t]=r;else r.lastIndex=0;let n,i=e;while(null!==(n=r.exec(e))){let e=n[1];if(parseInt(n[2])>=5)e=te(parseFloat(e)+1/Math.pow(10,t)).toString();i=i.replace(n[0],re(e))}return i},convertRadian:ne,triangulate:function(e,t,r){const n=180-e-t;return[r/Math.sin(ne(n))*Math.sin(ne(e)),r/Math.sin(ne(n))*Math.sin(ne(t))]},absoluteAngle:ie,relativeAngle:function(e,t,r=90){let n=ie(e,t)+r;if(n<0)n+=360;return n},offsetAngleX:function(e,t){return t*Math.sin(ne(e))},offsetAngleY:function(e,t){return t*Math.cos(ne(e))*-1},clamp:se,multipleOf:function(e,t=0,r){const n=e.length;if(n>1){const i=Q(e);if((null==r?void 0:r.length)===n){let i=0;while(i<n)t=Math.max(t,r[i]+e[i++])}else r=void 0,t=Math.max(t,i);let s=0;while(s<t)s+=i;const a=(null==r?void 0:r[0])||0;let l=false;while(!l){const t=a+s;let o=1;while(o<n){if(t%((r?r[o]:0)+e[o++])==0)l=true;else{l=false,s+=i;break}}}return a+s}return e[0]},sin:ae,cos:le,tan:function(e,t=11){return ae(e,t)/le(e,t)},factorial:oe,hypotenuse:function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}});const ue=[{value:"#000000",key:"black",rgb:{r:0,g:0,b:0},hsl:{h:0,s:0,l:0}},{value:"#696969",key:"dimgray",rgb:{r:105,g:105,b:105},hsl:{h:0,s:0,l:41}},{value:"#696969",key:"dimgrey",rgb:{r:105,g:105,b:105},hsl:{h:0,s:0,l:41}},{value:"#808080",key:"gray",rgb:{r:128,g:128,b:128},hsl:{h:0,s:0,l:50}},{value:"#808080",key:"grey",rgb:{r:128,g:128,b:128},hsl:{h:0,s:0,l:50}},{value:"#A9A9A9",key:"darkgray",rgb:{r:169,g:169,b:169},hsl:{h:0,s:0,l:66}},{value:"#A9A9A9",key:"darkgrey",rgb:{r:169,g:169,b:169},hsl:{h:0,s:0,l:66}},{value:"#C0C0C0",key:"silver",rgb:{r:192,g:192,b:192},hsl:{h:0,s:0,l:75}},{value:"#D3D3D3",key:"lightgray",rgb:{r:211,g:211,b:211},hsl:{h:0,s:0,l:83}},{value:"#D3D3D3",key:"lightgrey",rgb:{r:211,g:211,b:211},hsl:{h:0,s:0,l:83}},{value:"#DCDCDC",key:"gainsboro",rgb:{r:220,g:220,b:220},hsl:{h:0,s:0,l:86}},{value:"#F5F5F5",key:"whitesmoke",rgb:{r:245,g:245,b:245},hsl:{h:0,s:0,l:96}},{value:"#FFFFFF",key:"white",rgb:{r:255,g:255,b:255},hsl:{h:0,s:0,l:100}},{value:"#BC8F8F",key:"rosybrown",rgb:{r:188,g:143,b:143},hsl:{h:0,s:25,l:65}},{value:"#CD5C5C",key:"indianred",rgb:{r:205,g:92,b:92},hsl:{h:0,s:53,l:58}},{value:"#A52A2A",key:"brown",rgb:{r:165,g:42,b:42},hsl:{h:0,s:59,l:41}},{value:"#B22222",key:"firebrick",rgb:{r:178,g:34,b:34},hsl:{h:0,s:68,l:42}},{value:"#F08080",key:"lightcoral",rgb:{r:240,g:128,b:128},hsl:{h:0,s:79,l:72}},{value:"#800000",key:"maroon",rgb:{r:128,g:0,b:0},hsl:{h:0,s:100,l:25}},{value:"#8B0000",key:"darkred",rgb:{r:139,g:0,b:0},hsl:{h:0,s:100,l:27}},{value:"#FF0000",key:"red",rgb:{r:255,g:0,b:0},hsl:{h:0,s:100,l:50}},{value:"#FFFAFA",key:"snow",rgb:{r:255,g:250,b:250},hsl:{h:0,s:100,l:99}},{value:"#FFE4E1",key:"mistyrose",rgb:{r:255,g:228,b:225},hsl:{h:6,s:100,l:94}},{value:"#FA8072",key:"salmon",rgb:{r:250,g:128,b:114},hsl:{h:6,s:93,l:71}},{value:"#FF6347",key:"tomato",rgb:{r:255,g:99,b:71},hsl:{h:9,s:100,l:64}},{value:"#E9967A",key:"darksalmon",rgb:{r:233,g:150,b:122},hsl:{h:15,s:72,l:70}},{value:"#FF7F50",key:"coral",rgb:{r:255,g:127,b:80},hsl:{h:16,s:100,l:66}},{value:"#FF4500",key:"orangered",rgb:{r:255,g:69,b:0},hsl:{h:16,s:100,l:50}},{value:"#FFA07A",key:"lightsalmon",rgb:{r:255,g:160,b:122},hsl:{h:17,s:100,l:74}},{value:"#A0522D",key:"sienna",rgb:{r:160,g:82,b:45},hsl:{h:19,s:56,l:40}},{value:"#FFF5EE",key:"seashell",rgb:{r:255,g:245,b:238},hsl:{h:25,s:100,l:97}},{value:"#D2691E",key:"chocolate",rgb:{r:210,g:105,b:30},hsl:{h:25,s:75,l:47}},{value:"#8B4513",key:"saddlebrown",rgb:{r:139,g:69,b:19},hsl:{h:25,s:76,l:31}},{value:"#F4A460",key:"sandybrown",rgb:{r:244,g:164,b:96},hsl:{h:28,s:87,l:67}},{value:"#FFDAB9",key:"peachpuff",rgb:{r:255,g:218,b:185},hsl:{h:28,s:100,l:86}},{value:"#CD853F",key:"peru",rgb:{r:205,g:133,b:63},hsl:{h:30,s:59,l:53}},{value:"#FAF0E6",key:"linen",rgb:{r:250,g:240,b:230},hsl:{h:30,s:67,l:94}},{value:"#FFE4C4",key:"bisque",rgb:{r:255,g:228,b:196},hsl:{h:33,s:100,l:88}},{value:"#FF8C00",key:"darkorange",rgb:{r:255,g:140,b:0},hsl:{h:33,s:100,l:50}},{value:"#DEB887",key:"burlywood",rgb:{r:222,g:184,b:135},hsl:{h:34,s:57,l:70}},{value:"#FAEBD7",key:"antiquewhite",rgb:{r:250,g:235,b:215},hsl:{h:34,s:78,l:91}},{value:"#D2B48C",key:"tan",rgb:{r:210,g:180,b:140},hsl:{h:34,s:44,l:69}},{value:"#FFDEAD",key:"navajowhite",rgb:{r:255,g:222,b:173},hsl:{h:36,s:100,l:84}},{value:"#FFEBCD",key:"blanchedalmond",rgb:{r:255,g:235,b:205},hsl:{h:36,s:100,l:90}},{value:"#FFEFD5",key:"papayawhip",rgb:{r:255,g:239,b:213},hsl:{h:37,s:100,l:92}},{value:"#FFE4B5",key:"moccasin",rgb:{r:255,g:228,b:181},hsl:{h:38,s:100,l:85}},{value:"#FFA500",key:"orange",rgb:{r:255,g:165,b:0},hsl:{h:39,s:100,l:50}},{value:"#F5DEB3",key:"wheat",rgb:{r:245,g:222,b:179},hsl:{h:39,s:77,l:83}},{value:"#FDF5E6",key:"oldlace",rgb:{r:253,g:245,b:230},hsl:{h:39,s:85,l:95}},{value:"#FFFAF0",key:"floralwhite",rgb:{r:255,g:250,b:240},hsl:{h:40,s:100,l:97}},{value:"#B8860B",key:"darkgoldenrod",rgb:{r:184,g:134,b:11},hsl:{h:43,s:89,l:38}},{value:"#DAA520",key:"goldenrod",rgb:{r:218,g:165,b:32},hsl:{h:43,s:74,l:49}},{value:"#FFF8DC",key:"cornsilk",rgb:{r:255,g:248,b:220},hsl:{h:48,s:100,l:93}},{value:"#FFD700",key:"gold",rgb:{r:255,g:215,b:0},hsl:{h:51,s:100,l:50}},{value:"#FFFACD",key:"lemonchiffon",rgb:{r:255,g:250,b:205},hsl:{h:54,s:100,l:90}},{value:"#F0E68C",key:"khaki",rgb:{r:240,g:230,b:140},hsl:{h:54,s:77,l:75}},{value:"#EEE8AA",key:"palegoldenrod",rgb:{r:238,g:232,b:170},hsl:{h:55,s:67,l:80}},{value:"#BDB76B",key:"darkkhaki",rgb:{r:189,g:183,b:107},hsl:{h:56,s:38,l:58}},{value:"#F5F5DC",key:"beige",rgb:{r:245,g:245,b:220},hsl:{h:60,s:56,l:91}},{value:"#FAFAD2",key:"lightgoldenrodyellow",rgb:{r:250,g:250,b:210},hsl:{h:60,s:80,l:90}},{value:"#808000",key:"olive",rgb:{r:128,g:128,b:0},hsl:{h:60,s:100,l:25}},{value:"#FFFF00",key:"yellow",rgb:{r:255,g:255,b:0},hsl:{h:60,s:100,l:50}},{value:"#FFFFE0",key:"lightyellow",rgb:{r:255,g:255,b:224},hsl:{h:60,s:100,l:94}},{value:"#FFFFF0",key:"ivory",rgb:{r:255,g:255,b:240},hsl:{h:60,s:100,l:97}},{value:"#6B8E23",key:"olivedrab",rgb:{r:107,g:142,b:35},hsl:{h:80,s:60,l:35}},{value:"#9ACD32",key:"yellowgreen",rgb:{r:154,g:205,b:50},hsl:{h:80,s:61,l:50}},{value:"#556B2F",key:"darkolivegreen",rgb:{r:85,g:107,b:47},hsl:{h:82,s:39,l:30}},{value:"#ADFF2F",key:"greenyellow",rgb:{r:173,g:255,b:47},hsl:{h:84,s:100,l:59}},{value:"#7FFF00",key:"chartreuse",rgb:{r:127,g:255,b:0},hsl:{h:90,s:100,l:50}},{value:"#7CFC00",key:"lawngreen",rgb:{r:124,g:252,b:0},hsl:{h:90,s:100,l:49}},{value:"#8FBC8F",key:"darkseagreen",rgb:{r:143,g:188,b:143},hsl:{h:120,s:25,l:65}},{value:"#228B22",key:"forestgreen",rgb:{r:34,g:139,b:34},hsl:{h:120,s:61,l:34}},{value:"#32CD32",key:"limegreen",rgb:{r:50,g:205,b:50},hsl:{h:120,s:61,l:50}},{value:"#90EE90",key:"lightgreen",rgb:{r:144,g:238,b:144},hsl:{h:120,s:73,l:75}},{value:"#98FB98",key:"palegreen",rgb:{r:152,g:251,b:152},hsl:{h:120,s:93,l:79}},{value:"#006400",key:"darkgreen",rgb:{r:0,g:100,b:0},hsl:{h:120,s:100,l:20}},{value:"#008000",key:"green",rgb:{r:0,g:128,b:0},hsl:{h:120,s:100,l:25}},{value:"#00FF00",key:"lime",rgb:{r:0,g:255,b:0},hsl:{h:120,s:100,l:50}},{value:"#F0FFF0",key:"honeydew",rgb:{r:240,g:255,b:240},hsl:{h:120,s:100,l:97}},{value:"#2E8B57",key:"seagreen",rgb:{r:46,g:139,b:87},hsl:{h:146,s:50,l:36}},{value:"#3CB371",key:"mediumseagreen",rgb:{r:60,g:179,b:113},hsl:{h:147,s:50,l:47}},{value:"#00FF7F",key:"springgreen",rgb:{r:0,g:255,b:127},hsl:{h:150,s:100,l:50}},{value:"#F5FFFA",key:"mintcream",rgb:{r:245,g:255,b:250},hsl:{h:150,s:100,l:98}},{value:"#00FA9A",key:"mediumspringgreen",rgb:{r:0,g:250,b:154},hsl:{h:157,s:100,l:49}},{value:"#66CDAA",key:"mediumaquamarine",rgb:{r:102,g:205,b:170},hsl:{h:160,s:51,l:60}},{value:"#7FFFD4",key:"aquamarine",rgb:{r:127,g:255,b:212},hsl:{h:160,s:100,l:75}},{value:"#40E0D0",key:"turquoise",rgb:{r:64,g:224,b:208},hsl:{h:174,s:72,l:56}},{value:"#20B2AA",key:"lightseagreen",rgb:{r:32,g:178,b:170},hsl:{h:177,s:70,l:41}},{value:"#48D1CC",key:"mediumturquoise",rgb:{r:72,g:209,b:204},hsl:{h:178,s:60,l:55}},{value:"#2F4F4F",key:"darkslategray",rgb:{r:47,g:79,b:79},hsl:{h:180,s:25,l:25}},{value:"#2F4F4F",key:"darkslategrey",rgb:{r:47,g:79,b:79},hsl:{h:180,s:25,l:25}},{value:"#AFEEEE",key:"paleturquoise",rgb:{r:175,g:238,b:238},hsl:{h:180,s:65,l:81}},{value:"#008080",key:"teal",rgb:{r:0,g:128,b:128},hsl:{h:180,s:100,l:25}},{value:"#008B8B",key:"darkcyan",rgb:{r:0,g:139,b:139},hsl:{h:180,s:100,l:27}},{value:"#00FFFF",key:"aqua",rgb:{r:0,g:255,b:255},hsl:{h:180,s:100,l:50}},{value:"#00FFFF",key:"cyan",rgb:{r:0,g:255,b:255},hsl:{h:180,s:100,l:50}},{value:"#E0FFFF",key:"lightcyan",rgb:{r:224,g:255,b:255},hsl:{h:180,s:100,l:94}},{value:"#F0FFFF",key:"azure",rgb:{r:240,g:255,b:255},hsl:{h:180,s:100,l:97}},{value:"#00CED1",key:"darkturquoise",rgb:{r:0,g:206,b:209},hsl:{h:181,s:100,l:41}},{value:"#5F9EA0",key:"cadetblue",rgb:{r:95,g:158,b:160},hsl:{h:182,s:25,l:50}},{value:"#B0E0E6",key:"powderblue",rgb:{r:176,g:224,b:230},hsl:{h:187,s:52,l:80}},{value:"#ADD8E6",key:"lightblue",rgb:{r:173,g:216,b:230},hsl:{h:195,s:53,l:79}},{value:"#00BFFF",key:"deepskyblue",rgb:{r:0,g:191,b:255},hsl:{h:195,s:100,l:50}},{value:"#87CEEB",key:"skyblue",rgb:{r:135,g:206,b:235},hsl:{h:197,s:71,l:73}},{value:"#87CEFA",key:"lightskyblue",rgb:{r:135,g:206,b:250},hsl:{h:203,s:92,l:75}},{value:"#4682B4",key:"steelblue",rgb:{r:70,g:130,b:180},hsl:{h:207,s:44,l:49}},{value:"#F0F8FF",key:"aliceblue",rgb:{r:240,g:248,b:255},hsl:{h:208,s:100,l:97}},{value:"#1E90FF",key:"dodgerblue",rgb:{r:30,g:144,b:255},hsl:{h:210,s:100,l:56}},{value:"#708090",key:"slategray",rgb:{r:112,g:128,b:144},hsl:{h:210,s:13,l:50}},{value:"#708090",key:"slategrey",rgb:{r:112,g:128,b:144},hsl:{h:210,s:13,l:50}},{value:"#778899",key:"lightslategray",rgb:{r:119,g:136,b:153},hsl:{h:210,s:14,l:53}},{value:"#778899",key:"lightslategrey",rgb:{r:119,g:136,b:153},hsl:{h:210,s:14,l:53}},{value:"#B0C4DE",key:"lightsteelblue",rgb:{r:176,g:196,b:222},hsl:{h:214,s:41,l:78}},{value:"#6495ED",key:"cornflower",rgb:{r:100,g:149,b:237},hsl:{h:219,s:79,l:66}},{value:"#4169E1",key:"royalblue",rgb:{r:65,g:105,b:225},hsl:{h:225,s:73,l:57}},{value:"#191970",key:"midnightblue",rgb:{r:25,g:25,b:112},hsl:{h:240,s:64,l:27}},{value:"#E6E6FA",key:"lavender",rgb:{r:230,g:230,b:250},hsl:{h:240,s:67,l:94}},{value:"#000080",key:"navy",rgb:{r:0,g:0,b:128},hsl:{h:240,s:100,l:25}},{value:"#00008B",key:"darkblue",rgb:{r:0,g:0,b:139},hsl:{h:240,s:100,l:27}},{value:"#0000CD",key:"mediumblue",rgb:{r:0,g:0,b:205},hsl:{h:240,s:100,l:40}},{value:"#0000FF",key:"blue",rgb:{r:0,g:0,b:255},hsl:{h:240,s:100,l:50}},{value:"#F8F8FF",key:"ghostwhite",rgb:{r:248,g:248,b:255},hsl:{h:240,s:100,l:99}},{value:"#6A5ACD",key:"slateblue",rgb:{r:106,g:90,b:205},hsl:{h:248,s:53,l:58}},{value:"#483D8B",key:"darkslateblue",rgb:{r:72,g:61,b:139},hsl:{h:248,s:39,l:39}},{value:"#7B68EE",key:"mediumslateblue",rgb:{r:123,g:104,b:238},hsl:{h:249,s:80,l:67}},{value:"#9370DB",key:"mediumpurple",rgb:{r:147,g:112,b:219},hsl:{h:260,s:60,l:65}},{value:"#8A2BE2",key:"blueviolet",rgb:{r:138,g:43,b:226},hsl:{h:271,s:76,l:53}},{value:"#4B0082",key:"indigo",rgb:{r:75,g:0,b:130},hsl:{h:275,s:100,l:25}},{value:"#9932CC",key:"darkorchid",rgb:{r:153,g:50,b:204},hsl:{h:280,s:61,l:50}},{value:"#9400D3",key:"darkviolet",rgb:{r:148,g:0,b:211},hsl:{h:282,s:100,l:41}},{value:"#BA55D3",key:"mediumorchid",rgb:{r:186,g:85,b:211},hsl:{h:288,s:59,l:58}},{value:"#D8BFD8",key:"thistle",rgb:{r:216,g:191,b:216},hsl:{h:300,s:24,l:80}},{value:"#DDA0DD",key:"plum",rgb:{r:221,g:160,b:221},hsl:{h:300,s:47,l:75}},{value:"#EE82EE",key:"violet",rgb:{r:238,g:130,b:238},hsl:{h:300,s:76,l:72}},{value:"#800080",key:"purple",rgb:{r:128,g:0,b:128},hsl:{h:300,s:100,l:25}},{value:"#8B008B",key:"darkmagenta",rgb:{r:139,g:0,b:139},hsl:{h:300,s:100,l:27}},{value:"#FF00FF",key:"fuchsia",rgb:{r:255,g:0,b:255},hsl:{h:300,s:100,l:50}},{value:"#FF00FF",key:"magenta",rgb:{r:255,g:0,b:255},hsl:{h:300,s:100,l:50}},{value:"#DA70D6",key:"orchid",rgb:{r:218,g:112,b:214},hsl:{h:302,s:59,l:65}},{value:"#C71585",key:"mediumvioletred",rgb:{r:199,g:21,b:133},hsl:{h:322,s:81,l:43}},{value:"#FF1493",key:"deeppink",rgb:{r:255,g:20,b:147},hsl:{h:328,s:100,l:54}},{value:"#FF69B4",key:"hotpink",rgb:{r:255,g:105,b:180},hsl:{h:330,s:100,l:71}},{value:"#FFF0F5",key:"lavenderblush",rgb:{r:255,g:240,b:245},hsl:{h:340,s:100,l:97}},{value:"#DB7093",key:"palevioletred",rgb:{r:219,g:112,b:147},hsl:{h:340,s:60,l:65}},{value:"#DC143C",key:"crimson",rgb:{r:220,g:20,b:60},hsl:{h:348,s:83,l:47}},{value:"#FFC0CB",key:"pink",rgb:{r:255,g:192,b:203},hsl:{h:350,s:100,l:88}},{value:"#FFB6C1",key:"lightpink",rgb:{r:255,g:182,b:193},hsl:{h:351,s:100,l:86}}],he={};function fe(e,t,r){if(e<0)e+=1;else if(e>1)e-=1;if(e<1/6)return t+6*(r-t)*e;else if(e<.5)return r;else if(e<2/3)return t+(r-t)*(2/3-e)*6;return t}const ge=e=>255*se(e);function de(e){e=e.toLowerCase();const t=ue.length;let r=0;while(r<t){const t=ue[r++];if(t.key===e)return t}}function pe(e,t=1,r=false){if(e&&("transparent"!==e||r)){let n=he[e];if(n)return n;let i,a="";if(e.startsWith("#"))i=me(e);else{let r=s.RGBA.exec(e);if(r)i={r:parseInt(r[1]),g:parseInt(r[2]),b:parseInt(r[3]),a:r[4]?255*parseFloat(r[4]):ge(t)};else if(r=s.HSLA.exec(e),r)i=Ee({h:parseInt(r[1]),s:parseInt(r[2]),l:parseInt(r[3]),a:se(r[4]?parseFloat(r[4]):t)});else switch(e){case"transparent":i={r:0,g:0,b:0,a:0},a="transparent";break;case"initial":i={r:0,g:0,b:0,a:255},a="black";break;default:{const r=de(e);if(r)i=Object.assign(Object.assign({},r.rgb),{a:ge(t)}),a=e;break}}}if(i){const{r:s,g:l,b:o,a:c}=i;if(c>0||r){const r=be(s,l,o),u=be(c),h="#"+(r+u);if(he[h])return he[h];if(t=c/255,n={key:a,value:e="#"+r,valueAsRGBA:h,valueAsARGB:"#"+(u+r),rgba:i,hsl:ve(i),opacity:t,transparent:0===t},1===t)he[e]=n;return he[h]=n,n}}}}function be(...e){let t="";return e.forEach(e=>{const r=Math.max(0,Math.min(e,255));t+=isNaN(r)?"00":"0123456789ABCDEF".charAt((r-r%16)/16)+"0123456789ABCDEF".charAt(r%16)}),t}function me(e){if(e=e.replace(/#/g,"").trim(),s.HEX.test(e)){let t=255;switch(e.length){case 4:t=parseInt(e.charAt(3).repeat(2),16);case 3:e=e.charAt(0).repeat(2)+e.charAt(1).repeat(2)+e.charAt(2).repeat(2);break;case 5:e+=e.charAt(4);break;default:if(e.length>=8)t=parseInt(e.substring(6,8),16);e=e.substring(0,6);break}if(6===e.length)return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4),16),a:t}}}function ve(e){const t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n);let a=(s+i)/2;const l=a;let o;if(s===i)a=0,o=0;else{const e=s-i;switch(o=l>.5?e/(2-s-i):e/(s+i),s){case t:a=(r-n)/e+(r<n?6:0);break;case r:a=(n-t)/e+2;break;case n:a=(t-r)/e+4;break}a/=6}return{h:Math.round(360*a),s:Math.round(100*o),l:Math.round(100*l),a:e.a/255}}function Ee(e){let t,r,n,{h:i,s:s,l:a,a:l}=e;if(i/=360,s/=100,a/=100,0===s)t=a,r=a,n=a;else{const e=a<.5?a*(1+s):a+s-a*s,l=2*a-e;t=fe(i+1/3,l,e),r=fe(i,l,e),n=fe(i-1/3,l,e)}return t=Math.round(255*Math.min(t,1)),r=Math.round(255*Math.min(r,1)),n=Math.round(255*Math.min(n,1)),l=Math.round(255*Math.min(l,1)),{r:t,g:r,b:n,a:l}}function we(e){return`rgb${e.a<255?"a":""}(${e.r}, ${e.g}, ${e.b}`+(e.a<255?", "+(e.a/255).toPrecision(2):"")+")"}var ye=Object.freeze({__proto__:null,findColorName:de,findColorShade:function(e){const t=me(e);if(t){const r=ve(t),n=[];let i=-1;const s=ue.length;let a=0;while(a<s){const t=ue[a++];if(t.value===e)return t;else if(-1!==i){if(i===t.hsl.h)n.push(t)}else if(r.h<=t.hsl.h)n.push(t),i=t.hsl.h}const l=n.length;if(1===l)return n[0];else if(l>1){const e=r.l+r.s;let t=1/0,i=-1;for(a=0;a<l;++a){const{l:r,s:s}=n[a].hsl,l=Math.abs(e-(r+s));if(l<t)t=l,i=a}return n[i]}else return ue[ue.length-1]}},parseColor:pe,reduceRGBA:function(e,t,r){if(r){const e=he[r+="_"+t];if(e)return e}let{r:n,g:i,b:s}=e;if(0===n&&0===i&&0===s)if(n=255,i=255,s=255,t>0)t*=-1;const a=t<0?0:255;t=Math.abs(t);const l=pe(we({r:(n+Math.round((a-n)*t))%255,g:(i+Math.round((a-i)*t))%255,b:(s+Math.round((a-s)*t))%255,a:e.a}));if(r)he[r]=l;return l},getHexCode:be,convertHex:function(e){return"#"+be(e.r,e.g,e.b)+(e.a<255?be(e.a):"")},parseRGBA:me,convertHSLA:ve,convertRGBA:Ee,formatRGBA:we,formatHSLA:function(e){return`hsl${e.a<255?"a":""}(${e.h}, ${e.s}%, ${e.l}%`+(e.a<255?", "+(e.a/255).toPrecision(2):"")+")"}});const ke=`(\\(\\s*(?:orientation:\\s*(?:portrait|landscape)|(?:max|min)-width:\\s*${n.LENGTH_PERCENTAGE})\\s*\\))`,xe=/((?:\d+%\s*,?\s*)+|from|to)\s*{\s*(.+?)\s*}/,Ae=/(?:(not|only)?\s*(?:all|screen)\s+and\s+)?((?:\([^)]+\)(?:\s+and\s+)?)+),?\s*/g,Se=/\(([a-z-]+)\s*(:|<?=?|=?>?)?\s*([\w.%]+)?\)(?:\s+and\s+)?/g,Re=/^(.*?)(?:\s+([\d.]+)([xw]))?$/,Ce=/\s+([+-]\s+|\s*[*/])\s*/,Fe=/^\s*-?\d+\s*$/,Te=/\s*\/\s*/,Ne=/^\*(\s+\*){0,2}$/,Pe=/^(\*\s+){1,2}/,Ie=new RegExp(n.CSS_CALC),Le=new RegExp(`(${n.UNIT_LENGTH}|%)`),_e=new RegExp(`\\s*(?:(\\(\\s*)?${ke}|(\\(\\s*))?\\s*(and|or|not)?\\s*(?:${ke}(\\s*\\))?)?\\s*(.+)`);function Be(e,t,r){switch(e){case"<=":return t<=r;case"<":return t<r;case">=":return t>=r;case">":return t>r;default:return t===r}}function Oe(e,t,r){const n=[];W(x(t.trim(),"calc"),e=>e.trim()).forEach(e=>{if(e.includes(" ")&&!kt(e))n.push(...e.split(l.SPACE));else n.push(e)});const i=n.length;switch(i){case 1:case 2:return ht(e,n.join(" "),{dimension:["width","height"],boundingBox:r,parent:false});case 3:case 4:{let t=0,s=0;for(let a=0;a<i;++a){const l=n[a];switch(l){case"top":case"bottom":if(2==++s)return"";break;case"center":if(4===i)return"";break;case"left":case"right":if(2==++t)return"";break;default:{let t;switch(n[a-1]){case"top":case"bottom":t="height";break;case"left":case"right":t="width";break;default:return""}if(kt(l)){const i=Qe(ft(e,l,{dimension:t,boundingBox:r}));if(""!==i)n[a]=i;else return""}break}}}return n.join(" ")}}return""}function Me(e,t){const r=x(t),n=r.length;if(n>1){for(let t=1;t<n;++t){const n=r[t].trim();if(Ct(n)){const i=r[t-1].trim();if(Ke(i)){const s=et(n).split(a.SEPARATOR),l=s.length;if(l>=3){const n=i.startsWith("hsl");for(let t=0;t<l;++t){const r=s[t];if(kt(r))if(n&&(1===t||2===t)){const n=ft(e,r,{unitType:4,supportPercent:true});if(!isNaN(n))s[t]=se(n,0,100)+"%";else return""}else if(3===t){const n=r.includes("%");let i=ft(e,r,n?{unitType:4}:{unitType:64});if(!isNaN(i)){if(n)i/=100;s[t]=se(i).toString()}else return""}else{const n=ft(e,r,{unitType:64,supportPercent:false});if(!isNaN(n))s[t]=se(n,0,255).toString();else return""}}r[t]=`(${s.join(", ")})`;continue}}return""}}return r.join("")}return t}function De(e,t,r,n,i,s="width"){const a=x(t,"calc"),l=a.length;for(let t=0;t<l;++t){const l=a[t];if(kt(l)){const o=Le.test(l),c=ft(e,l,o?{dimension:s,boundingBox:i,min:0,parent:false}:{unitType:r,min:n,supportPercent:false});if(!isNaN(c))a[t]=c+(o?"px":"");else return""}}return a.join("").trim()}function ze(e){switch(e){case"vertical-lr":return 1;case"vertical-rl":return 2}return 0}function je(e){switch(e){case"none":case"initial":case"hidden":return false}return true}function $e(e){return(je(e.getPropertyValue("border-left-style"))?parseFloat(e.getPropertyValue("border-left-width")):0)+parseFloat(e.getPropertyValue("padding-left"))+parseFloat(e.getPropertyValue("padding-right"))+(je(e.getPropertyValue("border-right-style"))?parseFloat(e.getPropertyValue("border-right-width")):0)}function We(e){return(je(e.getPropertyValue("border-top-style"))?parseFloat(e.getPropertyValue("border-top-width")):0)+parseFloat(e.getPropertyValue("padding-top"))+parseFloat(e.getPropertyValue("padding-bottom"))+(je(e.getPropertyValue("border-bottom-style"))?parseFloat(e.getPropertyValue("border-bottom-width")):0)}function Ge(e){switch(e){case"absolute":case"fixed":return true}return false}function He(e=["left","top"]){return{static:true,top:0,left:0,right:0,bottom:0,topAsPercent:0,leftAsPercent:0,rightAsPercent:0,bottomAsPercent:0,horizontal:"left",vertical:"top",orientation:e}}function Ue(e,t){if(e)switch(t){case"+":case"-":if(S(e))return false;break;case"*":case"/":if(!S(e))return false;break}return true}function Ve(e,t){if(e)switch(t){case"+":case"-":return false}return true}const Xe=e=>(null==e?void 0:e.width)||window.innerWidth,qe=e=>(null==e?void 0:e.height)||window.innerHeight,Ze=(e,t,r,n)=>Rt(e)?Math.round(w(e)/100*t):mt(e,r,n),Ye=(e,t,r,n)=>Rt(e)?parseFloat(e)/100:mt(e,r,n)/t,Ke=e=>/(rgb|hsl)a?/.test(e),Qe=e=>!isNaN(e)?e+"px":"",Je=e=>!isNaN(e)?e.toString():"",et=e=>e.substring(1,e.length-1),tt=e=>Ne.test(e)?"*":e.replace(Pe,"");function rt(e,t=""){if(e){const r=e["__style"+t];if(r)return r;if(it(e)){const r=getComputedStyle(e,t);return e["__style"+t]=r,r}return{position:"static",display:"inline"}}return{position:"static",display:"none"}}function nt(e){if("#"===e.nodeName.charAt(0))e=e.parentElement||document.body;return parseFloat(rt(e).getPropertyValue("font-size"))}function it(e){return"#"!==e.nodeName.charAt(0)&&(e instanceof HTMLElement||e instanceof SVGElement)}function st(e,t){switch(e){case"inlineSize":return 0===ze(t)?"width":"height";case"blockSize":return 0===ze(t)?"height":"width";case"maxInlineSize":return 0===ze(t)?"maxWidth":"maxHeight";case"maxBlockSize":return 0===ze(t)?"maxHeight":"maxWidth";case"minInlineSize":return 0===ze(t)?"minWidth":"minHeight";case"minBlockSize":return 0===ze(t)?"minHeight":"minWidth";case"borderInlineStart":return 0===ze(t)?"borderLeft":"borderTop";case"borderInlineEnd":return 0===ze(t)?"borderRight":"borderBottom";case"borderInlineStartWidth":return 0===ze(t)?"borderLeftWidth":"borderTopWidth";case"borderInlineEndWidth":return 0===ze(t)?"borderRightWidth":"borderBottomWidth";case"insetInlineStart":return 0===ze(t)?"left":"top";case"insetInlineEnd":return 0===ze(t)?"right":"bottom";case"marginInlineStart":return 0===ze(t)?"marginLeft":"marginTop";case"marginInlineEnd":return 0===ze(t)?"marginRight":"marginBottom";case"paddingInlineStart":return 0===ze(t)?"paddingLeft":"paddingTop";case"paddingInlineEnd":return 0===ze(t)?"paddingRight":"paddingBottom";case"scrollMarginInlineStart":return 0===ze(t)?"scrollMarginLeft":"scrollMarginTop";case"scrollMarginInlineEnd":return 0===ze(t)?"scrollMarginRight":"scrollMarginBottom";case"scrollPaddingInlineStart":return 0===ze(t)?"scrollPaddingLeft":"scrollPaddingTop";case"scrollPaddingInlineEnd":return 0===ze(t)?"scrollPaddingRight":"scrollPaddingBottom";case"borderBlockStart":switch(ze(t)){case 0:return"borderTop";case 1:return"borderLeft";case 2:return"borderRight"}case"borderBlockEnd":switch(ze(t)){case 0:return"borderBottom";case 1:return"borderRight";case 2:return"borderLeft"}case"borderBlockStartWidth":switch(ze(t)){case 0:return"borderTopWidth";case 1:return"borderLeftWidth";case 2:return"borderRightWidth"}case"borderBlockEndWidth":switch(ze(t)){case 0:return"borderBottomWidth";case 1:return"borderRightWidth";case 2:return"borderLeftWidth"}case"insetBlockStart":switch(ze(t)){case 0:return"top";case 1:return"left";case 2:return"right"}case"insetBlockEnd":switch(ze(t)){case 0:return"bottom";case 1:return"right";case 2:return"left"}case"marginBlockStart":switch(ze(t)){case 0:return"marginTop";case 1:return"marginLeft";case 2:return"marginRight"}case"marginBlockEnd":switch(ze(t)){case 0:return"marginBottom";case 1:return"marginRight";case 2:return"marginLeft"}case"paddingBlockStart":switch(ze(t)){case 0:return"paddingTop";case 1:return"paddingLeft";case 2:return"paddingRight"}case"paddingBlockEnd":switch(ze(t)){case 0:return"paddingBottom";case 1:return"paddingRight";case 2:return"paddingLeft"}case"scrollMarginBlockStart":switch(ze(t)){case 0:return"scrollMarginTop";case 1:return"scrollMarginLeft";case 2:return"scrollMarginRight"}case"scrollMarginBlockEnd":switch(ze(t)){case 0:return"scrollMarginBottom";case 1:return"scrollMarginRight";case 2:return"scrollMarginLeft"}case"scrollPaddingBlockStart":switch(ze(t)){case 0:return"scrollPaddingTop";case 1:return"scrollPaddingLeft";case 2:return"scrollPaddingRight"}case"scrollPaddingBlockEnd":switch(ze(t)){case 0:return"scrollPaddingBottom";case 1:return"scrollPaddingRight";case 2:return"scrollPaddingLeft"}}return""}function at(e,t,r,n){switch(t){case"left":case"right":case"textIndent":return Qe(ft(e,r,{dimension:"width",boundingBox:n}));case"columnWidth":case"marginBottom":case"marginLeft":case"marginRight":case"marginTop":case"maxWidth":case"minWidth":case"paddingBottom":case"paddingLeft":case"paddingRight":case"paddingTop":case"scrollMarginBottom":case"scrollMarginLeft":case"scrollMarginRight":case"scrollMarginTop":case"scrollPaddingBottom":case"scrollPaddingLeft":case"scrollPaddingRight":case"scrollPaddingTop":case"width":return Qe(ft(e,r,{dimension:"width",boundingBox:n,min:0}));case"columnGap":case"gridColumnGap":case"shapeMargin":return Qe(ft(e,r,{dimension:"width",boundingBox:n,min:0,parent:false}));case"bottom":case"top":case"verticalAlign":return Qe(ft(e,r,{dimension:"height",boundingBox:n}));case"height":case"maxHeight":case"minHeight":return Qe(ft(e,r,{dimension:"height",boundingBox:n,min:0}));case"gridRowGap":case"rowGap":return Qe(ft(e,r,{dimension:"height",boundingBox:n,min:0,parent:false}));case"flexBasis":{const t=e.parentElement;return Qe(ft(e,r,{dimension:!!t&&rt(t).flexDirection.includes("column")?"height":"width",boundingBox:n,min:0}))}case"borderBottomWidth":case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"letterSpacing":case"outlineOffset":case"outlineWidth":case"perspective":case"wordSpacing":return Qe(ft(e,r,{min:0,supportPercent:false}));case"offsetDistance":{let t=0;if(r.includes("%")){const r=rt(e).getPropertyValue("offset-path");if("none"!==r){const e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",r),t=e.getTotalLength()}}return Qe(ft(e,r,{boundingSize:t}))}case"lineHeight":return Qe(ft(e,r,{boundingSize:nt(e),min:0}));case"fontSize":return Qe(ft(e,r,{boundingSize:nt(e.parentElement||document.body),min:0}));case"margin":return ht(e,r,{dimension:"width",boundingBox:n});case"borderBottomLeftRadius":case"borderBottomRightRadius":case"borderTopLeftRadius":case"borderTopRightRadius":case"borderRadius":case"padding":case"scrollMargin":case"scrollMarginBlock":case"scrollMarginInline":case"scrollPadding":case"scrollPaddingBlock":case"scrollPaddingInline":return ht(e,r,{dimension:"width",boundingBox:n,min:0});case"objectPosition":return ht(e,r,{dimension:["width","height"],boundingBox:n});case"gridGap":case"perspectiveOrigin":return ht(e,r,{dimension:["width","height"],boundingBox:n,min:"gridGap"===t?0:void 0,parent:false});case"borderImageOutset":case"borderImageWidth":return ht(e,r,{dimension:["height","width","height","width"],boundingBox:n,min:0,parent:false});case"borderWidth":case"borderSpacing":case"columnRule":return ht(e,r,{min:0,supportPercent:false});case"gridAutoColumns":case"gridTemplateColumns":return De(e,r,32,1,n);case"gridAutoRows":case"gridTemplateRows":return De(e,r,32,1,n,"height");case"zIndex":return Je(ft(e,r,{unitType:32}));case"tabSize":return Je(ft(e,r,{unitType:32,min:0}));case"columnCount":case"fontWeight":case"widows":return Je(ft(e,r,{unitType:32,min:1}));case"gridRow":case"gridRowEnd":case"gridRowStart":case"gridColumn":case"gridColumnEnd":case"gridColumnStart":case"counterIncrement":case"counterReset":return ht(e,r,{unitType:32});case"fontVariationSettings":return ht(e,r,{unitType:32,min:0});case"gridArea":return ht(e,r,{unitType:32,min:1});case"flexGrow":case"flexShrink":return Je(ft(e,r,{unitType:64,min:0}));case"animationIterationCount":case"fontSizeAdjust":return Je(ft(e,r,{unitType:64,min:0,supportPercent:false}));case"opacity":case"shapeImageThreshold":{const t=r.includes("%"),n=ft(e,r,{unitType:t?4:64});return!isNaN(n)?se(n*(t?.01:1)).toString():""}case"fontStretch":return ht(e,r,{unitType:4,min:0,supportPercent:true});case"fontStyle":case"offsetRotate":return ht(e,r,{unitType:16,supportPercent:false});case"offsetAnchor":case"transformOrigin":return Oe(e,r,n);case"transform":{const t=x(r=r.trim()),i=t.length;if(i>1){for(let r=1;r<i;++r){let i=t[r];if(Ct(i)){let s;switch(i=et(i),t[r-1].trim()){case"matrix":case"matrix3d":s=ht(e,i,{unitType:64,supportPercent:false});break;case"scaleX":case"scaleY":case"scaleZ":{const t=ft(e,i,{unitType:64,min:0,supportPercent:false});if(!isNaN(t))s=t.toString();break}case"scale":case"scale3d":s=ht(e,i,{unitType:64,min:0,supportPercent:false});break;case"translateX":s=Qe(ft(e,i,{dimension:"width",boundingBox:n,parent:true}));break;case"translateY":s=Qe(ft(e,i,{dimension:"height",boundingBox:n,parent:true}));break;case"translateZ":case"perspective":s=Qe(ft(e,i,{supportPercent:false}));break;case"translate":case"translate3d":s=ht(e,i,{dimension:["width","height"],boundingBox:n,parent:true});break;case"skew":case"rotate":s=ht(e,i,{unitType:16,supportPercent:false});break;case"skewX":case"skewY":case"rotateX":case"rotateY":case"rotateZ":{const t=ft(e,i,{unitType:16,supportPercent:false});if(!isNaN(t))s=t+"deg";break}case"rotate3d":{const t=i.split(a.SEPARATOR),r=t.length;if(3===r||4===r){s="";for(let n=0;n<r;++n){let r=t[n];if(kt(r)){const t=ft(e,r,{unitType:3===n?16:64,supportPercent:false});if(!isNaN(t))r=t+(3===n?"deg":"");else return""}s+=(""!==s?", ":"")+r}}break}}if(s)t[r]=`(${s})`;else return""}}return t.join("")}return r}case"backgroundImage":case"borderImageSource":case"maskImage":{const t=x(r=r.trim()),n=t.length;if(n>1){for(let r=1;r<n;++r){const n=t[r];if(Ke(n)&&Ct(n)){const i=x(et(n)),s=i.length;for(let t=1;t<s;++t)if(Ct(i[t])){const r=i[t-1];if(Ke(r)){const n=r.split(l.SPACE).pop(),s=Me(e,n+i[t]);if(""!==s){i[t]=s.replace(n,"");continue}}return""}t[r]=`(${i.join("")})`}}return t.join("")}return r}case"borderColor":case"scrollbarColor":{const t=x(r=r.trim()),n=t.length;if(n>1){for(let r=1;r<n;++r){const n=t[r-1];if(Ke(n)&&Ct(t[r])){const i=n.split(l.SPACE).pop(),s=Me(e,i+t[r]);if(""!==s)t[r]=s,t[r-1]=n.substring(0,n.length-i.length);else return""}}return t.join("")}return r}case"boxShadow":case"textShadow":return ht(e,at(e,"borderColor",r),{supportPercent:false,errorString:/-?[\d.]+[a-z]*\s+-?[\d.]+[a-z]*(\s+-[\d.]+[a-z]*)/});case"backgroundSize":case"maskPosition":case"maskSize":return ht(e,r,{dimension:["width","height"],boundingBox:n,min:"maskPosition"!==t?0:void 0,parent:false,separator:","});case"animation":case"animationDelay":case"animationDuration":case"transition":case"transitionDelay":case"transitionDuration":return ht(e,r,{unitType:8,min:0,precision:0,separator:","});case"columns":return De(e,r,32,1,n);case"borderImageSlice":case"flex":case"font":return De(e,r,64,0,n);case"backgroundPosition":{const t=[];for(const i of r.split(a.SEPARATOR)){const r=Oe(e,i,n);if(""!==r)t.push(r);else return""}return t.join(", ")}case"border":case"borderBottom":case"borderLeft":case"borderRight":case"borderTop":case"outline":{const t=x(r=r.trim()),n=t.length;if(n>1){for(let r=1;r<n;++r){const n=t[r-1],i=n.split(l.SPACE).pop();let s;if("calc"===i)s=Qe(ft(e,i+t[r],{min:0,supportPercent:false}));else if(Ke(i))s=Me(e,i+t[r]);else continue;if(""!==s)t[r]=s,t[r-1]=n.substring(0,n.length-i.length);else return""}return t.join("")}return r}case"animationTimingFunction":case"transitionTimingFunction":{const t=x(r=r.trim()),n=t.length;if(n>1){for(let r=1;r<n;++r){let n=t[r];if(Ct(n)){const i=t[r-1].trim();let s;if(n=et(n),i.endsWith("cubic-bezier")){const t=n.split(a.SEPARATOR),r=t.length;if(4===r){s="";const n={unitType:64,supportPercent:false};for(let i=0;i<r;++i){let r=t[i];if(kt(r)){if(i%2==0)n.min=0,n.max=1;else n.min=void 0,n.max=void 0;const t=ft(e,r,n);if(!isNaN(t))r=t.toString();else return""}s+=(""!==s?", ":"")+r}}}else if(i.endsWith("steps"))s=ht(e,n,{unitType:32,min:1});if(s)t[r]=`(${s})`;else return""}}return t.join("")}return r}case"clip":return Ge(rt(e).position)?ht(e,r,{supportPercent:false}):"";case"clipPath":case"offsetPath":case"shapeOutside":{const t=x(r=r.trim());if(2===t.length){const i=t[0].trim();switch(i){case"url":case"path":return!Ct(t[1])?r:"";case"linear-gradient":case"repeating-linear-gradient":case"radial-gradient":case"repeating-radial-gradient":case"conic-gradient":return at(e,"backgroundImage",r,n)}let s=t[1].trim();switch(s=et(s),i){case"circle":case"ellipse":{const t=[];let[r,a]=s.split(/\s+at\s+/);if(Ct(r)){const s={boundingBox:n,min:0,parent:true};if("circle"===i){if(r.includes("%")){const{width:t,height:r}=n||gt(e);if(t>0&&r>0)s.boundingSize=Math.min(t,r);else return""}}else s.dimension=["width","height"];if(r=ht(e,r,s),""!==r)t.push(r);else return""}else if(r)t.push(r);if(Ct(a))if(a=ht(e,a,{dimension:["width","height"],boundingBox:n,parent:true}),""!==a)t.push(a);else return"";else if(a)t.push(a);s=t.join(" at ");break}case"inset":s=ht(e,s,{dimension:["height","width","height","width","width"],boundingBox:n,checkUnit:true});break;case"polygon":{const t=[];for(let r of s.split(a.SEPARATOR))if(Ct(r))if(r=ht(e,r,{dimension:["width","height"],boundingBox:n,parent:true}),""!==r)t.push(r);else return"";else t.push(r);s=t.join(", ");break}}if(""!==s)return`${i}(${s})`}return r}case"grid":{let[t,i]=r.trim().split(Te);if(Ct(t)){const r=at(e,"gridTemplateRows",t,n);if(""!==r)t=r;else return""}if(Ct(i)){const t=at(e,"gridTemplateColumns",i,n);if(""!==t)i=t;else return""}return t+(i?" / "+i:"")}case"offset":{let[t,i]=r.trim().split(Te);if(Ct(t)){const r=x(t.trim()),i=r.length;if(i>=2){if(t=r[0]+r[1],Ct(t))if(t=at(e,"offsetPath",t,n),""===t)return"";if(i>2){let i=r.slice(2).join("");if(Ct(t))if(i=at(e,Le.test(i)?"offsetDistance":"offsetRotate",i,n),""===i)return"";t+=" "+i}}else return""}if(Ct(i)){const t=at(e,"offsetAnchor",i,n);if(""!==t)i=t;else return""}return t+(i?" / "+i:"")}case"borderImage":{const t=/([a-z-]+\(.+?\))\s*([^/]+)(?:\s*\/\s*)?(.+)?/.exec(r.trim());if(t){let r=t[2].trim();if(Ct(r))r=at(e,"borderImageSlice",r,n);if(""!==r){let i,s;if(t[3]){if([i,s]=t[3].trim().split(Te),Ct(i)){const t=at(e,"borderImageWidth",i,n);if(""!==t)i=t;else return""}if(Ct(s)){const t=at(e,"borderImageOutset",s,n);if(""!==t)s=t;else return""}}return t[1]+" "+r+(i?" / "+i:"")+(s?" / "+s:"")}}return""}case"background":case"gridTemplate":return rt(e)[t];default:if(t.endsWith("Color"))return Me(e,r.trim());else{const i=st(t,rt(e).writingMode);if(""!==i)return at(e,i,r,n)}}return""}function lt(e){const t={},r=e.length;let n=0;while(n<r){const r=e[n++],i=xe.exec(r.cssText);if(i)(r.keyText||i[1]).trim().split(a.SEPARATOR).forEach(e=>{switch(e){case"from":e="0%";break;case"to":e="100%";break}const r={};i[2].split(a.DELIMITER).forEach(e=>{const t=e.indexOf(":");if(-1!==t){const n=e.substring(t+1).trim();if(""!==n){const i=e.substring(0,t).trim();r[i]=n}}}),t[e]=r})}return t}function ot(e,t){switch(e){case"only all":case"only screen":return true;default:{let r;Ae.lastIndex=0;while(null!==(r=Ae.exec(e))){Se.lastIndex=0;const e="not"===r[1];let n,i=false;while(null!==(n=Se.exec(r[2]))){const e=n[1];let r=n[2];const s=n[3];if(e.startsWith("min"))r=">=";else if(e.startsWith("max"))r="<=";switch(e){case"aspect-ratio":case"min-aspect-ratio":case"max-aspect-ratio":if(s){const[e,t]=W(s.split("/"),e=>parseInt(e));i=Be(r,window.innerWidth/window.innerHeight,e/t)}else i=false;break;case"width":case"min-width":case"max-width":case"height":case"min-height":case"max-height":i=Be(r,e.endsWith("width")?window.innerWidth:window.innerHeight,mt(s,t));break;case"orientation":i="portrait"===s&&window.innerWidth<=window.innerHeight||"landscape"===s&&window.innerWidth>window.innerHeight;break;case"resolution":case"min-resolution":case"max-resolution":if(s){let e=parseFloat(s);if(s.endsWith("dpcm"))e*=2.54;else if(s.endsWith("dppx"))e*=96;i=Be(r,X(),e)}else i=false;break;case"grid":i="0"===s;break;case"color":i=void 0===s||parseInt(s)>0;break;case"min-color":i=parseInt(s)<=screen.colorDepth/3;break;case"max-color":i=parseInt(s)>=screen.colorDepth/3;break;case"color-index":case"min-color-index":case"monochrome":case"min-monochrome":i="0"===s;break;case"max-color-index":case"max-monochrome":i=parseInt(s)>=0;break;default:i=false;break}if(!i)break}if(!e&&i||e&&!i)return true}}}return false}function ct(e,t,r,...n){let i="",s=e.parentElement;while(s&&!n.includes(s.tagName)){if(i=rt(s)[t],"inherit"===i||(null==r?void 0:r.test(i)))i="";else if(i)break;s=s.parentElement}return i}function ut(e,t){const r=rt(e);let n;while(null!==(n=s.VAR.exec(t))){let e=r.getPropertyValue(n[1]).trim();const i=n[2];if(i&&(""===e||yt(i,true)&&!yt(e,true)||S(i)&&!S(e)||pe(i)&&!pe(e)))e=i;if(e)t=t.replace(n[0],e).trim();else return""}return t}function ht(e,t,r){let n,i,s,a,l,o;const c={};if(r){if(Object.assign(c,r),Array.isArray(r.orderedSize))n=r.orderedSize;if(Array.isArray(r.dimension))i=r.dimension;({separator:s,unitType:a,checkUnit:l,errorString:o}=r)}let u;switch(t=t.trim(),a){case 32:case 64:u="";break;case 4:u="%";break;case 8:u="ms";break;case 16:u="deg";break;default:u="px",a=2;break}const h=[];for(let r of s?t.split(s):[t])if(r=r.trim(),""!==r){const t=x(r,"calc"),s=t.length;if(s){let r="",o=0,f=0;while(o<s){let s=t[o++];if(kt(s)){if(void 0!==(null==n?void 0:n[f]))c.boundingSize=n[f++];else if(i)c.dimension=i[f++],c.boundingSize=void 0;else if(n)c.boundingSize=void 0;const t=ft(e,s,c);if(!isNaN(t))r+=t+u;else return""}else if(r+=s,i)if(s=s.trim(),""!==s&&(!l||2===a&&(yt(s,true)||"auto"===s)))++f}h.push(r)}else return""}if(t=1===h.length?h[0]:h.join(" "===s?" ":s?s+" ":""),o){let e;while(null!==(e=o.exec(t))){if(void 0===e[1])return"";const r=e[0];let n=r;let i=e.length-1;while(i>=1)n=n.replace(new RegExp(e[i--]+"$"),"");if(n===r)return"";else t=t.replace(r,n)}}return t}function ft(e,t,r={}){const n=ut(e,t);if(n){const{precision:i,unitType:s}=r;if(t.includes("%")){if(false===r.supportPercent||32===s)return NaN;else if(void 0===r.boundingSize){const{dimension:t,boundingBox:n}=r;if(t)if(n)r.boundingSize=n[t];else{let n,i=0;if(false===r.parent)n=e;else if(n=e.parentElement,n instanceof HTMLElement){let r;if(Ge(rt(e).position))do{if(r=rt(n),n===document.body)break;switch(r.position){case"static":case"initial":case"unset":n=n.parentElement;continue}break}while(n);else r=rt(n);if(r)i="width"===t?$e(r):We(r)}else if(e instanceof SVGElement){if(true!==r.parent)n=e}else n=null;if(n)r.boundingSize=Math.max(0,n.getBoundingClientRect()[t]-i)}}}else if(r.supportPercent)return NaN;if((!s||2===s)&&/\d(em|ch)/.test(t)&&void 0===r.fontSize)r.fontSize=nt(e);let a=bt(n,r);if(void 0!==i)a=0===i?Math.floor(a):parseFloat(ee(a,i));else if(r.roundValue)a=Math.round(a);return a}return NaN}function gt(e){const t=e.parentElement;let r=0,n=0;if(t){const e=rt(t);({width:r,height:n}=t.getBoundingClientRect()),r=Math.max(0,r-$e(e)),n=Math.max(0,n-We(e))}return{width:r,height:n}}function dt(e){const t=s.URL.exec(e);return t?t[1]||t[2]:""}function pt(e,t="deg"){let r=w(e);switch(t){case"rad":r*=180/Math.PI;break;case"grad":r/=400;case"turn":r*=360;break}return r}function bt(e,t){if(""===(e=e.trim()))return NaN;let r=e.length;if("("!==e.charAt(0)||")"!==e.charAt(r-1))e=`(${e})`,r+=2;let n=0;const i=[],s=[];for(let t=0;t<r;++t)switch(e.charAt(t)){case"(":++n,i[t]=true;break;case")":s.push(t);break}if(n===s.length){const r=[];let n=0;while(true)for(let a=0;a<s.length;++a){let l=s[a]-1,o=false;for(;l>=0;l--)if(i[l]){o=true,i[l]=false;break}else if(s.includes(l))break;if(o){let i,o,c,u,h,f,g;if(t)({boundingSize:i,min:o,max:c,unitType:u,fontSize:h}=t);let d=false;const p=[],b=[],m=e.substring(l+1,s[a]).split(Ce),v=m.length;let E=0;while(E<v){const e=m[E++].trim();switch(e){case"+":case"-":case"*":case"/":b.push(e),g=e;break;default:{const t=/\s*{(\d+)}\s*/.exec(e);if(t){switch(u){case 32:case 64:break;default:if(!Ue(f,g))return NaN;break}const e=r[parseInt(t[1])];p.push(e),f=e.toString(),d=true}else{switch(u){case 4:if(S(e)){if(!Ve(f,g))return NaN;p.push(parseFloat(e))}else if(Rt(e)){if(!Ue(f,g))return NaN;p.push(parseFloat(e)),d=true}else return NaN;break;case 8:if(S(e)){if(!Ve(f,g))return NaN;p.push(parseFloat(e))}else if(St(e)){if(!Ue(f,g))return NaN;p.push(Et(e)),d=true}else return NaN;break;case 16:if(S(e)){if(!Ve(f,g))return NaN;p.push(parseFloat(e))}else if(At(e)){if(!Ue(f,g))return NaN;p.push(vt(e)),d=true}else return NaN;break;case 32:if(Fe.test(e))p.push(parseInt(e)),d=true;else return NaN;break;case 64:if(S(e))p.push(parseFloat(e)),d=true;else if(Rt(e)&&void 0!==i&&!isNaN(i))p.push(parseFloat(e)/100*i);else return NaN;break;default:if(S(e)){if(!Ve(f,g))return NaN;p.push(parseFloat(e))}else if(yt(e)){if(!Ue(f,g))return NaN;p.push(mt(e,h)),d=true}else if(Rt(e)&&void 0!==i&&!isNaN(i)){if(!Ue(f,g))return NaN;p.push(parseFloat(e)/100*i),d=true}else return NaN;break}f=e}break}}}if(!d||p.length!==b.length+1)return NaN;for(E=0;E<b.length;++E)if("/"===b[E])if(0!==Math.abs(p[E+1]))p.splice(E,2,p[E]/p[E+1]),b.splice(E--,1);else return NaN;for(E=0;E<b.length;++E)if("*"===b[E])p.splice(E,2,p[E]*p[E+1]),b.splice(E--,1);for(E=0;E<b.length;++E)p.splice(E,2,p[E]+p[E+1]*("-"===b[E]?-1:1)),b.splice(E--,1);if(1===p.length)if(1===s.length){const e=p[0];if(void 0!==o&&e<o||void 0!==c&&e>c)return NaN;else return te(e)}else{r[n]=p[0];const t=`{${n++}}`,i=s[a]+1;e=e.substring(0,l)+t+" ".repeat(i-(l+t.length))+e.substring(i),s.splice(a--,1)}else return NaN}}}return NaN}function mt(e,t,r){const n=i.LENGTH.exec(e);if(n){let e=parseFloat(n[1]);switch(n[2]){case"px":return e;case"em":case"ch":return e*(null!=t?t:nt(document.body)||16);case"rem":return e*(nt(document.body)||16);case"pc":e*=12;case"pt":return 4*e/3;case"mm":e/=10;case"cm":e/=2.54;case"in":return e*X();case"vw":return e*Xe(r)/100;case"vh":return e*qe(r)/100;case"vmin":return e*Math.min(Xe(r),qe(r))/100;case"vmax":return e*Math.max(Xe(r),qe(r))/100}}return 0}function vt(e){const t=s.ANGLE.exec(e);return t?pt(t[1],t[2]):0}function Et(e){const t=s.TIME.exec(e);if(t)switch(t[2]){case"ms":return parseInt(t[1]);case"s":return 1e3*parseFloat(t[1])}return 0}function wt(e,t=true){if("string"==typeof e)if(e=parseFloat(e),isNaN(e))return"0%";return e*=100,(t?Math.round(e):e)+"%"}function yt(e,t){return!t?i.LENGTH.test(e):i.LENGTH_PERCENTAGE.test(e)}function kt(e){return s.CALC.test(e)}function xt(e){return s.CUSTOM_PROPERTY.test(e)}function At(e){return s.ANGLE.test(e)}function St(e){return s.TIME.test(e)}function Rt(e){return i.PERCENT.test(e)}function Ct(e){return Ie.test(e)}var Ft=Object.freeze({__proto__:null,BOX_POSITION:["top","right","bottom","left"],BOX_MARGIN:["marginTop","marginRight","marginBottom","marginLeft"],BOX_BORDER:[["borderTopStyle","borderTopWidth","borderTopColor"],["borderRightStyle","borderRightWidth","borderRightColor"],["borderBottomStyle","borderBottomWidth","borderBottomColor"],["borderLeftStyle","borderLeftWidth","borderLeftColor"],["outlineStyle","outlineWidth","outlineColor"]],BOX_PADDING:["paddingTop","paddingRight","paddingBottom","paddingLeft"],TEXT_STYLE:["fontFamily","fontSize","fontWeight","fontStyle","color","whiteSpace","textDecoration","textTransform","letterSpacing","wordSpacing"],getStyle:rt,getFontSize:nt,hasComputedStyle:it,parseSelectorText:function(e,t){if((e=t?e.trim():tt(e.trim())).includes(",")){let t,r=e,n=false;while(null!==(t=s.SELECTOR_ATTR.exec(r))){const e=t.index,i=t[0].length;r=(e>0?r.substring(0,e):"")+"_".repeat(i)+r.substring(e+i),n=true}if(n){const t=[];let n=0;while(true){const i=r.indexOf(",",n);if(-1!==i){const r=e.substring(n,i).trim();t.push(0===n?r:tt(r)),n=i+1}else{if(n>0)t.push(tt(e.substring(n).trim()));break}}return t}return W(e.split(a.SEPARATOR),e=>tt(e))}return[e]},getSpecificity:function e(t){s.SELECTOR_G.lastIndex=0;let r,n=0;while(null!==(r=s.SELECTOR_G.exec(t))){let t,i=r[1];if(1===i.length)switch(i.charAt(0)){case"+":case"~":case">":case"*":continue}else if(i.startsWith("*|*")){if(i.length>3)return 0}else if(i.startsWith("*|"))i=i.substring(2);else if(i.startsWith("::"))return 0;while(null!==(t=s.SELECTOR_ATTR.exec(i))){if(t[1])n+=1;if(t[3]||t[4]||t[5])n+=10;i=v(i,t.index,t[0].length)}while(null!==(t=s.SELECTOR_PSEUDO_CLASS.exec(i))){if(t[0].startsWith(":not(")){const r=t[1];if(r){const t=s.SELECTOR_G.lastIndex;n+=e(r),s.SELECTOR_G.lastIndex=t}}else switch(r[2]){case":scope":case":root":break;default:n+=10;break}i=v(i,t.index,t[0].length)}while(null!==(t=s.SELECTOR_PSEUDO_ELEMENT.exec(i)))n+=1,i=v(i,t.index,t[0].length);while(null!==(t=s.SELECTOR_LABEL.exec(i))){const e=t[0];switch(e.charAt(0)){case"#":n+=100;break;case".":n+=10;break;default:n+=1;break}i=v(i,t.index,e.length)}}return n},checkWritingMode:st,calculateStyle:at,checkStyleValue:function(e,t,r,n){if("inherit"===r)switch(t){case"fontSize":case"lineHeight":if(n)return n[t];default:return ct(e,t)}else if(Ct(r)){if(""===(r=at(e,t,r))&&n)r=n[t]}else if(xt(r))if(""===(r=ut(e,r))&&n)r=n[t];return r||""},getKeyframesRules:function(){const e={};e:{const t=document.styleSheets,r=t.length;let n=0;while(n<r){const r=t[n++].cssRules;if(r){const t=r.length;for(let n=0;n<t;++n)try{const t=r[n];if(t.type===CSSRule.KEYFRAMES_RULE){const r=lt(t.cssRules);if(m(r)){const n=t.name;if(e[n])Object.assign(e[n],r);else e[n]=r}}}catch(e){break e}}}}return e},parseKeyframes:lt,checkMediaRule:ot,isParentStyle:function(e,t,...r){if("#"!==e.nodeName.charAt(0)&&r.includes(rt(e)[t]))return true;else{const n=e.parentElement;if(n)return r.includes(rt(n)[t])}return false},getInheritedStyle:ct,parseVar:ut,calculateVarAsString:ht,calculateVar:ft,getParentBoxDimension:gt,getBackgroundPosition:function(e,t,r){if(""!==(e=e.trim())){const n=e.split(l.SPACE);if(1===n.length)n.push("center");const i=n.length;if(i<=4){let e,s,a,o;if(r)({fontSize:e,imageDimension:s,imageSize:a,screenDimension:o}=r);const{width:c,height:u}=t,h=He(n),f=(t,r,n,i)=>{if(s&&!yt(t)){let t=h[i];if(a&&"auto"!==a&&"initial"!==a){const[n,i]=a.split(l.SPACE);if(r){let r=c;if(yt(n,true))if(Rt(n))r*=parseFloat(n)/100;else{const t=mt(n,e,o);if(t)r=t}else if(i){let t=1;if(Rt(i))t=parseFloat(i)/100*u/s.height;else if(yt(i)){const r=mt(i,e,o);if(r)t=r/s.height}r=t*s.width}t*=r}else{let r=u;if(yt(i,true))if(Rt(i))r*=parseFloat(i)/100;else{const t=mt(i,e,o);if(t)r=t}else if(n){let t=1;if(Rt(n))t=parseFloat(n)/100*c/s.width;else if(yt(n)){const r=mt(n,e,o);if(r)t=r/s.width}r=t*s.height}t*=r}}else t*=r?s.width:s.height;h[n]-=t}};if(2===i){n.sort((e,t)=>{switch(e){case"left":case"right":return-1;case"top":case"bottom":return 1}switch(t){case"left":case"right":return 1;case"top":case"bottom":return-1}return 0});for(let t=0;t<2;++t){let r=n[t];const i=0===t,[s,a]=i?["left",c]:["top",u],l=s+"AsPercent";switch(r){case"0%":if(i)r="left";case"left":case"top":break;case"100%":if(i)r="right";case"right":case"bottom":h[s]=a,h[l]=1;break;case"50%":case"center":r="center",h[s]=a/2,h[l]=.5;break;default:{const c=Ye(r,a,e,o);if(c>1)n[t]="100%",r=i?"right":"bottom",h[r]=-1*Ze(wt(c-1),a,e,o);else h[s]=Ze(r,a,e,o);h[l]=c;break}}if(i)h.horizontal=r;else h.vertical=r;f(r,i,s,l)}}else{let t=0,r=0;const s=(e,n)=>{switch(e){case"left":case"right":h.horizontal=e,++t;break;case"center":if(4===i)return false;else{let r=true;if(void 0===n)if(t>0)h.vertical=e,r=false;else h.horizontal=e;else switch(n){case"left":case"right":h.vertical=e,r=false;break;case"top":case"bottom":h.horizontal=e;break;default:return false}if(r)h.left=c/2,h.leftAsPercent=.5,f(e,true,"left","leftAsPercent");else h.top=u/2,h.topAsPercent=.5,f(e,false,"top","topAsPercent")}break;case"top":case"bottom":h.vertical=e,++r;break;default:return false}return t<2&&r<2};for(let t=0;t<i;++t){const r=n[t];if(yt(r,true)){const i=n[t-1];switch(i){case"left":case"right":{const t=Ze(r,c,e,o),n=Ye(r,c,e,o);if("right"===i)h.right=t,h.rightAsPercent=n,f(r,true,"right","rightAsPercent"),h.left=c-t,h.leftAsPercent=1-n;else{if(n>1){const t=1-n;h.horizontal="right",h.right=Ze(wt(t),c,e,o),h.rightAsPercent=t,f(r,true,"right","rightAsPercent")}h.left=t,h.leftAsPercent=n}f(r,true,"left","leftAsPercent");break}case"top":case"bottom":{const t=Ze(r,u,e,o),n=Ye(r,u,e,o);if("bottom"===i)h.bottom=t,h.bottomAsPercent=n,f(r,false,"bottom","bottomAsPercent"),h.top=u-t,h.topAsPercent=1-n;else{if(n>1){const t=1-n;h.horizontal="bottom",h.bottom=Ze(wt(t),u,e,o),h.bottomAsPercent=t,f(r,false,"bottom","bottomAsPercent")}h.top=t,h.topAsPercent=n}f(r,false,"top","topAsPercent");break}default:return He()}}else if(!s(r,n[t+1]))return He()}}return h.static=0===h.top&&0===h.right&&0===h.bottom&&0===h.left,h}}return He()},getSrcSet:function(e,t){const r=e.parentElement,n=[];let{srcset:i,sizes:o}=e;if("PICTURE"===(null==r?void 0:r.tagName))$(r.children,e=>{if("SOURCE"===e.tagName){const{media:r,type:n,srcset:s}=e;if(R(s)&&!(R(r)&&!ot(r))&&(!R(n)||!t||t.includes(n.trim().toLowerCase())))return i=s,o=e.sizes,true}});if(""!==i)i.trim().split(a.SEPARATOR).forEach(e=>{const t=Re.exec(e);if(t){let e=0,r=0;switch(t[3]){case"w":e=w(t[2]);break;case"x":r=w(t[2]);break;default:r=1;break}n.push({src:P(t[1].split(l.SPACE)[0]),pixelRatio:r,width:e})}});const c=n.length;if(0===c)n.push({src:e.src,pixelRatio:1,width:0});else if(c>1)if(n.sort((e,t)=>{const r=e.pixelRatio,n=t.pixelRatio;if(r>0&&n>0){if(r!==n)return r<n?-1:1}else{const r=e.width,n=t.width;if(r!==n&&r>0&&n>0)return r<n?-1:1}return 0}),R(o)){let t=NaN;for(const r of o.trim().split(a.SEPARATOR)){let n=_e.exec(r);if(n){const r=n[2]?ot(n[2]):void 0,i=n[6]?ot(n[6]):void 0;switch(n[5]){case"and":if(!r||!i)continue;break;case"or":if(!r&&!i)continue;break;case"not":if(void 0!==r||i)continue;break;default:if(false===r||void 0!==i)continue;break}const a=n[9];if(a)if(n=s.CALC.exec(a),n)t=bt(n[1],n[1].includes("%")?{boundingSize:gt(e).width}:void 0);else if(Rt(a))t=parseFloat(a)/100*gt(e).width;else if(yt(a))t=mt(a);if(!isNaN(t))break}}if(!isNaN(t)){const e=t*window.devicePixelRatio;let r=-1;for(let t=0;t<c;++t){const i=n[t].width;if(i>0&&i<=e&&(-1===r||n[r].width<i))r=t}if(0===r){const e=n[0];e.pixelRatio=1,e.actualWidth=t}else if(r>0){const e=n.splice(r,1)[0];e.pixelRatio=1,e.actualWidth=t,n.unshift(e)}let i=1;while(i<c){const e=n[i++];if(0===e.pixelRatio)e.pixelRatio=e.width/t}}}return n},convertListStyle:function(e,t,r){switch(e){case"decimal":return t.toString();case"decimal-leading-zero":return(t<9?"0":"")+t.toString();case"upper-alpha":case"upper-latin":if(t>=1)return y(t-1);break;case"lower-alpha":case"lower-latin":if(t>=1)return y(t-1).toLowerCase();break;case"upper-roman":return k(t);case"lower-roman":return k(t).toLowerCase()}return r?t.toString():""},extractURL:dt,resolveURL:function(e){return""!==(e=dt(e))?P(e):""},insertStyleSheetRule:function(e,t=0){const r=document.createElement("style");if(V(4))r.appendChild(document.createTextNode(""));document.head.appendChild(r);const n=r.sheet;if("function"==typeof(null==n?void 0:n.insertRule))try{n.insertRule(e,t)}catch(e){return null}return r},convertAngle:pt,convertPX:function(e,t){return e?mt(e,t)+"px":"0px"},calculate:bt,parseUnit:mt,parseAngle:vt,parseTime:Et,formatPX:function(e){return Math.round(e)+"px"},formatPercent:wt,isLength:yt,isCalc:kt,isCustomProperty:xt,isAngle:At,isTime:St,isPercent:Rt,hasCalc:Ct});function Tt(){return{top:0,left:0,right:0,bottom:0,width:0,height:0}}function Nt(e,t=true){const r={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height};if(t){const{scrollX:e,scrollY:t}=window;if(0!==t)r.top+=t,r.bottom+=t;if(0!==e)r.left+=e,r.right+=e}return r}function Pt(e){const t=[],r=document.createRange();r.selectNodeContents(e);const n=r.getClientRects();let i,s=n.length,a=0;while(a<s){const e=n.item(a++);if(Math.round(e.width)>0&&!O(e.left,e.right,.5))t.push(e)}if(s=t.length,s){i=Nt(t[0]);let e=1,r=false;a=0;while(++a<s){const{left:n,right:s,top:l,bottom:o,width:c}=t[a];if(n<i.left)i.left=n;else if(n>i.right)r=true;if(s>i.right)i.right=s;if(l<i.top)i.top=l;else if(l>=t[a-1].bottom)++e;if(o>i.bottom)i.bottom=o;i.width+=c}if(i.height=i.bottom-i.top,e>1)i.numberOfLines=e,i.overflow=r}else i={top:0,left:0,right:0,bottom:0,width:0,height:0};return i}var It=Object.freeze({__proto__:null,ELEMENT_BLOCK:["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DD","DETAILS","DIALOG","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL"],newBoxRect:function(){return{top:0,left:0,right:0,bottom:0}},newBoxRectDimension:Tt,newBoxModel:function(){return{marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},withinViewport:function(e){return!(e.top+window.scrollY+e.height<0||e.left+window.scrollX+e.width<0)},assignRect:Nt,getRangeClientRect:Pt,removeElementsByClassName:function(e){Array.from(document.getElementsByClassName(e)).forEach(e=>{var t;return null===(t=e.parentElement)||void 0===t?void 0:t.removeChild(e)})},getElementsBetweenSiblings:function(e,t){const r=[];if(!e||e.parentElement===t.parentElement){const n=t.parentElement;if(n){let i=e?-1:0,s=-1;if($(n.childNodes,(r,n)=>{if(r===t){if(s=n,-1!==i)return true}else if(r===e)if(i=n,-1!==s)return true}),-1!==i&&-1!==s)$(n.childNodes,e=>{const t=e.nodeName;if("#"!==t[0]||"#text"===t)r.push(e)},Math.min(i,s),Math.max(i,s)+1)}}return r},createElement:function(e,t,r){const n=document.createElement(t),i=n.style;for(const e in r)if(e.includes("-"))i.setProperty(e,r[e]);else i[e]=r[e];return e.appendChild(n),n},measureTextWidth:function(e,t,r){if(t&&r){const n=document.createElement("canvas").getContext("2d");if(n)return n.font=`${r}px ${t}`,n.measureText(e).width}return 0},getNamedItem:function(e,t){var r;return(null===(r=e.attributes.getNamedItem(t))||void 0===r?void 0:r.value.trim())||""},isTextNode:function(e){return"#text"===e.nodeName}});function Lt(){return Promise.reject(new Error("Framework not installed."))}function _t(e,t,r,n){e[`__${t}::${r}`]=n}function Bt(e,t,r){if(!r)r=e["__sessionId::0"]||"0";return e[`__${t}::${r}`]}var Ot=Object.freeze({__proto__:null,frameworkNotInstalled:Lt,actualClientRect:function(e,t){if(t){const r=Bt(e,"clientRect",t);if(r)return r}const r=e.getBoundingClientRect();if(t)_t(e,"clientRect",t,r);return r},actualTextRangeRect:function(e,t){if(t){const r=Bt(e,"textRangeRect",t);if(r)return r}let r;if(e.childElementCount)$(e.children,e=>{const t=rt(e);if("visible"!==t.getPropertyValue("visibility")){const n=t.getPropertyValue("position");if("absolute"===n||"fixed"===n){const n=t.getPropertyValue("display");if("none"!==n){if(e.style.display="none",!r)r=[];r.push([e,n])}}}});const n=Pt(e);if(null==r||r.forEach(e=>e[0].style.display=e[1]),t)_t(e,"textRangeRect",t,n);return n},getStyleValue:function(e,t,r){var n;return(null===(n=Bt(e,"styleMap",r))||void 0===n?void 0:n[E(t)])||""},getPseudoElt:function(e,t){return Bt(e,"pseudoElement",t)||""},getElementAsNode:function(e,t){return Bt(e,"node",t)||null},setElementCache:_t,getElementCache:Bt,deleteElementCache:function(e,t,r){delete e[`__${t}::${r}`]}});const Mt=/^(\t+)(.*)$/,Dt={ITEM:/\s*(<(\/)?([?\w]+)[^>]*>)\n?([^<]*)/g,OPENTAG:/\s*>$/,CLOSETAG:/\/>\n*$/,NBSP:/&nbsp;/g,AMP:/&/g},zt="&#160;".repeat(8);function jt(e,t,r="\t",n){if(t>0){if(void 0===n)n=r.repeat(t);return j(e.split("\n"),e=>""!==e?n+e:"")}return e}var $t=Object.freeze({__proto__:null,STRING_XMLENCODING:'<?xml version="1.0" encoding="utf-8"?>\n',STRING_SPACE:"&#160;",STRING_TABSPACE:zt,isPlainText:function(e){const t=e.length;let r=0;while(r<t)switch(e.charCodeAt(r++)){case 9:case 10:case 13:case 32:continue;default:return true}return false},pushIndent:jt,pushIndentArray:function(e,t,r="\t",n=""){if(t>0){const n=r.repeat(t),i=e.length;let s=0;while(s<i)e[s]=jt(e[s++],t,r,n)}return e.join(n)},replaceIndent:function(e,t,r){if(t>=0){let n=-1;return j(e.split("\n"),e=>{const i=r.exec(e);if(i){if(-1===n)n=i[2].length;return(i[1]||"")+"\t".repeat(t+(i[2].length-n))+i[3]}return e})}return e},replaceTab:function(e,t=4,r=false){if(t>0)if(r)return j(e.split("\n"),e=>{const r=Mt.exec(e);if(r)return" ".repeat(t*r[1].length)+r[2];else return e});else return e.replace(/\t/g," ".repeat(t));return e},applyTemplate:function e(t,r,n,i){const s=r[t],a=true===s[">>"];let l="",o="";if(void 0===i)l+='<?xml version="1.0" encoding="utf-8"?>\n',i=0;else o+="\t".repeat(i);let c=n.length;for(let r=0;r<c;++r){const c=n[r],u=s["#"]&&c[s["#"]],h=!a&&!u,f=s["@"],g=s[">"];let d=false;if(l+=o+"<"+t,null==f||f.forEach(e=>{const t=c[e];if(t)l+=` ${(s["^"]?s["^"]+":":"")+e}="${t}"`}),g){let n="";const s=i+(a?r:0)+1;for(const t in g){const r=c[t];if(Array.isArray(r))n+=e(t,g,r,s);else if(F(r))n+=e(t,g,[r],s)}if(""!==n){if(l+=">\n"+n,h)l+=o+`</${t}>\n`}else l+=h?" />\n":">\n";d=true}else if(s["~"]){if(l+=">"+c.innerText,h)l+=`</${t}>\n`;d=true}else if(h)l+=" />\n";if(u){if(!d)l+=">\n";if(l+=u,!a)l+=o+`</${t}>\n`}if(a)o+="\t"}if(a)while(--c>=0)o=o.substring(1),l+=o+`</${t}>\n`;return l},formatTemplate:function(e,t=false,r=-1,n="\t"){const i=[];let s;while(null!==(s=Dt.ITEM.exec(e)))i.push({tag:s[1],closing:!!s[2],tagName:s[3],value:s[4]});let a="",l=r,o=false;const c=i.length;for(let e=0;e<c;++e){const s=i[e];let c=l;if(e>0){let r=false;if(s.closing)--l;else{const n=i[e+1];if(r=n.closing&&s.tagName===n.tagName,!Dt.CLOSETAG.exec(s.tag))if(t&&""===s.value.trim())if((null==n?void 0:n.closing)&&n.tagName===s.tagName)s.tag=s.tag.replace(Dt.OPENTAG," />"),++e;else++l;else++l;++c}s.tag.trim().split("\n").forEach((e,t,i)=>{if(o)a+=e,o=false;else{const r=c+Math.min(t,1);a+=(r>0?n.repeat(r):"")+e.trim()}if(r&&1===i.length)o=true;else a+="\n"})}else a+=(r>0?n.repeat(r):"")+s.tag+"\n";a+=s.value}return a},replaceCharacterData:function(e,t=false){const r=[],n=(e=e.replace(Dt.NBSP,"&#160;").replace(c.NONENTITY,"&amp;")).length;for(let i=0;i<n;++i)switch(e.charAt(i)){case"'":r.push({i:i,text:"\\'"});break;case'"':r.push({i:i,text:"&quot;"});break;case"<":r.push({i:i,text:"&lt;"});break;case">":r.push({i:i,text:"&gt;"});break;case"\t":if(t)r.push({i:i,text:zt});break;case"":r.push({i:i,text:" "});break;case"":r.push({i:i,text:"&#160;"});break}if(r.length){const t=e.split("");let n=0;while(n<r.length){const{i:e,text:i}=r[n++];t[e]=i}return t.join("")}return e}});const Wt=new Set,Gt=new Map,Ht={},Ut=new Set,Vt={};let Xt,qt;function Zt(e,t){if(Xt&&!e.includes(t))t.application=Xt,e.push(t)}function Yt(e){for(const t in e)delete e[t]}const Kt=e=>false===(null==e?void 0:e.initializing)&&e.length>0;function Qt(e,t){if(F(t))if("string"==typeof e){e=e.trim();const r=(null==Xt?void 0:Xt.extensionManager.retrieve(e))||M(Wt,t=>t.name===e);if(r)Object.assign(r.options,t);else Gt.set(e,t);return true}else if(e instanceof squared.base.Extension)return Object.assign(e.options,t),true;return false}function Jt(e){let t=null;if(Xt)if(t=Xt.extensionManager.retrieve(e),null===t)for(const t of Ut)if(t.name===e)return t;return t}function er(){null==Xt||Xt.reset()}const tr={base:{Container:Container,ArrayIterator:Iterator,ListIterator:ListIterator},client:q,color:ye,css:Ft,dom:It,math:ce,regex:u,session:Ot,util:H,xml:$t};e.appendFromArchive=function(e,t){var r;if(Kt(Xt)&&R(e)&&F(t)&&(null===(r=t.assets)||void 0===r?void 0:r.length))return Xt.appendFromArchive(e,t);else return Lt()},e.appendToArchive=function(e,t){if(Kt(Xt)&&R(e))return Xt.finalize(),Xt.appendToArchive(e,t);else return Lt()},e.close=function(){if(Kt(Xt))Xt.finalize()},e.configure=Qt,e.copyToDisk=function(e,t){if(Kt(Xt)&&R(e))return Xt.finalize(),Xt.copyToDisk(e,t);else return Lt()},e.createFrom=function(e,t){var r;if(Kt(Xt)&&R(e)&&F(t)&&(null===(r=t.assets)||void 0===r?void 0:r.length))return Xt.createFrom(e,t);else return Lt()},e.exclude=function(e){if(Xt){const t=Xt.extensionManager;if("string"==typeof e)e=t.retrieve(e.trim());if(e instanceof squared.base.Extension)return Wt.delete(e),Ut.delete(e),t.exclude(e)}return false},e.include=function(e,t){if("string"==typeof e)e=e.trim(),e=(null==Xt?void 0:Xt.builtInExtensions[e])||Jt(e);if(e instanceof squared.base.Extension){if(Ut.add(e),!(true===(null==Xt?void 0:Xt.extensionManager.include(e))))Wt.add(e);if(t)Qt(e,t);return true}return false},e.lib=tr,e.parseDocument=function(...e){if(Xt){const t=Xt.extensionManager;for(const e of Wt)t.include(e);for(const[e,t]of Gt.entries())Qt(e,t);if(Wt.clear(),Gt.clear(),!Xt.closed)return Xt.parseDocument(...e);else if(!Ht.showErrorMessages||confirm("ERROR: Document is closed. Reset and rerun?"))return Xt.reset(),Xt.parseDocument(...e)}return Lt()},e.ready=function(){return false===(null==Xt?void 0:Xt.initializing)&&!Xt.closed},e.reset=er,e.retrieve=Jt,e.saveToArchive=function(e,t){if(Kt(Xt))return Xt.finalize(),Xt.saveToArchive(e,t);else return Lt()},e.setFramework=function(e,t,r=false){const n=void 0!==qt;if(qt!==e){const i=r?e.cached():e.create();if(F(t))Object.assign(i.userSettings,t);Yt(Ht),Object.assign(Ht,i.userSettings),Xt=i.application,Xt.userSettings=Ht;const{builtInExtensions:s,extensions:a}=Xt;if(a.length=0,Ht.builtInExtensions.forEach(e=>{const t=s[e];if(t)Zt(a,t);else{e+=".";for(const t in s)if(t.startsWith(e))Zt(a,s[t])}}),n)Yt(Vt);Object.assign(Vt,e.system),qt=e}if(n)er()},e.setHostname=function(e){if(null==Xt?void 0:Xt.fileHandler){const t=o.PROTOCOL.exec(e);if(t&&t[1].startsWith("http"))Xt.fileHandler.hostname=t[1]+t[2]+(t[3]||"")}},e.setViewModel=function(e){if(Xt)Xt.viewModel=e},e.settings=Ht,e.system=Vt,e.toString=function(){return(null==Xt?void 0:Xt.toString())||""},Object.defineProperty(e,"__esModule",{value:true})}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.base={}))}(this,(function(e){"use strict";const{hasBit:t,isObject:i}=squared.lib.util;class ExtensionManager{constructor(e){this.application=e}include(e){const i=this.application,s=i.extensions;if("string"==typeof e){const t=this.retrieve(e);if(null===t)return false;e=t}let n=e.name;const a=s.findIndex(e=>e.name===n);if(-1!==a)return s[a]=e,true;else{const a=e.framework;if(a>0)e.dependencies.forEach(e=>{if(e.preload)if(n=e.name,null===this.retrieve(n)){const e=i.builtInExtensions[n];if(e)this.include(e)}});if((0===a||t(a,i.framework))&&e.dependencies.every(e=>!!this.retrieve(e.name)))return e.application=i,s.push(e),true}return false}exclude(e){const t=this.extensions,i=t.length;for(let s=0;s<i;++s)if(t[s]===e||"string"==typeof e&&this.retrieve(e))return t.splice(s,1),true;return false}retrieve(e,t=false){const i=this.extensions,s=i.length;let n=0;while(n<s){const t=i[n++];if(t.name===e)return t}return t&&this.application.builtInExtensions[e]||null}optionValue(e,t){var s;const n=null===(s=this.retrieve(e))||void 0===s?void 0:s.options;return i(n)?n[t]:void 0}optionValueAsObject(e,t){const s=this.optionValue(e,t);return i(s)?s:null}optionValueAsString(e,t){const i=this.optionValue(e,t);return"string"==typeof i?i:""}optionValueAsNumber(e,t){const i=this.optionValue(e,t);return"number"==typeof i?i:NaN}optionValueAsBoolean(e,t){const i=this.optionValue(e,t);return"boolean"==typeof i?i:false}get extensions(){return this.application.extensions}}class NodeList extends squared.lib.base.Container{constructor(e){super(e),this._currentId=0}append(e,t=false,i=false){var s;if(super.append(e),t)null===(s=this.afterAppend)||void 0===s||s.call(this,e,i);return this}reset(){return this._currentId=0,this.clear(),this}get nextId(){return++this._currentId}}const s=squared.lib,{STRING:n,XML:a}=s.regex,{extractURL:r}=s.css,{fromLastIndexOf:l,fromMimeType:o,hasMimeType:c,randomUUID:h}=s.util,d=new RegExp(`^${n.DATAURI}$`);class Resource{reset(){const e=Resource.ASSETS;for(const t in e)e[t].clear()}addImage(e){var t;if(null==e?void 0:e.complete){const i=e.src;if(i.startsWith("data:image/")){const s=d.exec(i);if(s){const n=s[1].split(a.DELIMITER);this.addRawData(i,n[0].trim(),(null===(t=n[1])||void 0===t?void 0:t.trim())||"base64",s[2],e.naturalWidth,e.naturalHeight)}}if(""!==i)Resource.ASSETS.image.set(i,{width:e.naturalWidth,height:e.naturalHeight,uri:i})}}addVideo(e,t){Resource.ASSETS.video.set(e,{uri:e,mimeType:t})}addAudio(e,t){Resource.ASSETS.audio.set(e,{uri:e,mimeType:t})}addFont(e){const t=Resource.ASSETS.fonts,i=e.fontFamily.trim().toLowerCase();e.fontFamily=i;const s=t.get(i);if(s)s.push(e);else t.set(i,[e])}addRawData(e,t,i,s,n=0,a=0){let r;if(t=t.toLowerCase(),"base64"===(i=i.toLowerCase())){if(r=s,"image/svg+xml"===t)s=window.atob(s)}else s=s.replace(/\\(["'])/g,(e,...t)=>t[0]);const c=this.mimeTypeMap.image;if("*"===c||c.includes(t)){const i="."+o(t),c=e.endsWith(i)?l(e,"/","\\"):this.randomUUID+i;return Resource.ASSETS.rawData.set(e,{pathname:e.startsWith(location.origin)?e.substring(location.origin.length+1,e.lastIndexOf("/")):"",filename:c,content:s,base64:r,mimeType:t,width:n,height:a}),c}return""}getImage(e){return Resource.ASSETS.image.get(e)}getVideo(e){return Resource.ASSETS.video.get(e)}getAudio(e){return Resource.ASSETS.audio.get(e)}getFont(e,t="normal",i){const s=Resource.ASSETS.fonts.get(e.trim().toLowerCase());if(s){const e=this.mimeTypeMap.font;return s.find(s=>s.fontStyle===t&&(!i||s.fontWeight===parseInt(i))&&(c(e,s.srcFormat)||s.srcUrl&&c(e,s.srcUrl)))}}getRawData(e){if(e.startsWith("url("))if(""===(e=r(e)))return;return Resource.ASSETS.rawData.get(e)}setFileHandler(e){e.resource=this,this.fileHandler=e}get controllerSettings(){return this.application.controllerHandler.localSettings}get mimeTypeMap(){return this.controllerSettings.mimeType}get randomUUID(){return h()}}Resource.KEY_NAME="squared.resource",Resource.ASSETS={ids:new Map,fonts:new Map,image:new Map,video:new Map,audio:new Map,rawData:new Map},Resource.canCompressImage=e=>/\.(png|jpg|jpeg)$/i.test(e);const u=squared.lib,{checkMediaRule:f,getSpecificity:g,getStyle:p,hasComputedStyle:m,insertStyleSheetRule:b,parseSelectorText:x}=u.css,{isTextNode:y}=u.dom,{capitalize:v,convertCamelCase:E,isString:S,objectMap:w,promisify:k,resolvePath:_}=u.util,{CHAR:C,FILE:T,STRING:A,XML:I}=u.regex,{frameworkNotInstalled:R,getElementCache:P,setElementCache:M}=u.session,{image:N,rawData:B}=Resource.ASSETS,L=/all|screen/,W=/^background/,F=/\s*([a-z-]+):[^!;]+!important;/g,O=/\s*@font-face\s*{([^}]+)}\s*/,D=/\s*font-family:[^\w]*([^'";]+)/,U=/\s*src:\s*([^;]+);/,H=/\s*font-style:\s*(\w+)\s*;/,X=/\s*font-weight:\s*(\d+)\s*;/,V=/\s*(url|local)\((?:"((?:[^"]|\\")+)"|([^)]+))\)(?:\s*format\("?([\w-]+)"?\))?\s*/,z=new RegExp(`url\\("?(${A.DATAURI})"?\\),?\\s*`,"g");function G(e,t=0,i=0){if(""!==e){const s=N.get(e);if(t>0&&i>0||!s||0===s.width||0===s.height)N.set(e,{width:t,height:i,uri:e})}}function j(e){if(""!==e)e.split(I.SEPARATOR).forEach(e=>{if(""!==e)G(_(e.split(C.SPACE)[0]))})}function q(e,t,i,s){var n;const a=t[i];if(a&&"initial"!==a){z.lastIndex=0;let r,l=a;while(null!==(r=z.exec(a)))if(r[2]){const t=r[2].split(I.DELIMITER);e.addRawData(r[1],t[0].trim(),(null===(n=t[1])||void 0===n?void 0:n.trim())||"utf8",r[3])}else{const t=_(r[3],s);if(""!==t){if(!e.getImage(t))G(t);l=l.replace(r[0],`url("${t}")`)}}t[i]=l}}const Y=e=>T.SVG.test(e),$=(e,t)=>{var i;return(null===(i=new RegExp(`\\s*@${e}([^{]+)`).exec(t))||void 0===i?void 0:i[1].trim())||t};class Application{constructor(e,t,i,s,n){this.framework=e,this.initializing=false,this.closed=false,this.systemName="",this.rootElements=new Set,this.session={active:[]},this.processing={cache:new NodeList,excluded:new NodeList,unusedStyles:new Set,sessionId:""},this._cascadeAll=false;const a=this.processing.cache;this._cache=a,this._controllerHandler=new i(this,a),this._resourceHandler=new s(this,a),this._extensionManager=new(n||ExtensionManager)(this,a),this._afterInsertNode=this._controllerHandler.afterInsertNode,this.Node=t}copyToDisk(e,t){var i;return(null===(i=this.fileHandler)||void 0===i?void 0:i.copyToDisk(e,t))||R()}appendToArchive(e,t){var i;return(null===(i=this.fileHandler)||void 0===i?void 0:i.appendToArchive(e,t))||R()}saveToArchive(e,t){var i;return(null===(i=this.fileHandler)||void 0===i?void 0:i.saveToArchive(e||this.userSettings.outputArchiveName,t))||R()}createFrom(e,t){var i;return(null===(i=this.fileHandler)||void 0===i?void 0:i.createFrom(e,t))||R()}appendFromArchive(e,t){var i;return(null===(i=this.fileHandler)||void 0===i?void 0:i.appendFromArchive(e,t))||R()}reset(){var e;const t=this.processing;t.cache.reset(),t.excluded.clear(),t.sessionId="",t.unusedStyles.clear(),this.session.active.length=0,this.controllerHandler.reset(),this.resourceHandler.reset(),null===(e=this.fileHandler)||void 0===e||e.reset(),this.extensions.forEach(e=>e.subscribers.clear()),this.closed=false}parseDocument(...e){const{controllerHandler:t,resourceHandler:i}=this;this.initializing=false,this.rootElements.clear();const s=t.generateSessionId;this.processing.sessionId=s,this.session.active.push(s),t.sessionId=s,t.init(),this.setStyleMap();const n=[],a=this.userSettings.preloadImages,r=[],l=b("html > body { overflow: hidden !important; }"),o=()=>{this.initializing=false,n.forEach(e=>{if(e.parentElement)c.removeChild(e)}),n.length=0,this.extensions.forEach(e=>e.beforeParseDocument());const e=[];for(const t of this.rootElements){const i=this.createCache(t);if(i)this.afterCreateCache(i),e.push(i)}this.extensions.forEach(e=>e.afterParseDocument());try{document.head.removeChild(l)}catch(e){}return e};if(0===e.length)e.push(document.body);e.forEach(e=>{let t;if("string"==typeof e)t=document.getElementById(e);else if(m(e))t=e;else return;if(t)this.rootElements.add(t)});const c=this.rootElements.values().next().value;for(const e of this.rootElements)e.querySelectorAll("picture > source").forEach(e=>j(e.srcset)),e.querySelectorAll("video").forEach(e=>G(e.poster)),e.querySelectorAll("input[type=image]").forEach(e=>G(e.src,e.width,e.height));if(a){for(const e of N.values()){const t=e.uri;if(Y(t))r.push(t);else if(0===e.width||0===e.height){const i=document.createElement("img");if(i.src=t,i.naturalWidth>0&&i.naturalHeight>0)e.width=i.naturalWidth,e.height=i.naturalHeight;else c.appendChild(i),n.push(i)}}for(const[e,t]of B.entries()){const i=t.mimeType;if((null==i?void 0:i.startsWith("image/"))&&!i.endsWith("svg+xml")){const s=document.createElement("img");s.src=`data:${i};${t.base64?"base64,"+t.base64:t.content}`;const{naturalWidth:a,naturalHeight:r}=s;if(a>0&&r>0)t.width=a,t.height=r,N.set(e,{width:a,height:r,uri:t.filename});else document.body.appendChild(s),n.push(s)}}}for(const e of this.rootElements)e.querySelectorAll("img").forEach(e=>{if(j(e.srcset),!a)i.addImage(e);else if(Y(e.src))r.push(e.src);else if(e.complete)i.addImage(e);else r.push(e)});if(r.length)return this.initializing=true,Promise.all(w(r,e=>new Promise((t,i)=>{if("string"==typeof e)(async()=>{const i=await fetch(e,{method:"GET",headers:new Headers({Accept:"application/xhtml+xml, image/svg+xml","Content-Type":"image/svg+xml"})});t(await i.text())})();else e.addEventListener("load",()=>t(e)),e.addEventListener("error",()=>i(e))}))).then(e=>{const t=e.length;for(let s=0;s<t;++s){const t=e[s];if("string"==typeof t){const e=r[s];if("string"==typeof e)i.addRawData(e,"image/svg+xml","utf8",t)}else i.addImage(t)}return o()}).catch(e=>{let t=e;if(e instanceof Event)t=e.target;const i=t instanceof HTMLImageElement?t.src:"";return!this.userSettings.showErrorMessages||!S(i)||confirm("FAIL: "+i)?o():[]});else return k(o)()}createCache(e){const t=this.createRootNode(e);if(t)this.controllerHandler.sortInitialCache();return t}setStyleMap(){const e=document.styleSheets,t=e.length;let i=0;while(i<t){const t=e[i++];let s;try{s=t.media.mediaText}catch(e){}if(!S(s)||L.test(s))this.applyStyleSheet(t)}}getDatasetName(e,t){return t.dataset[e+v(this.systemName)]||t.dataset[e]}setDatasetName(e,t,i){t.dataset[e+v(this.systemName)]=i}toString(){return""}createRootNode(e){const t=this.processing,i=t.cache;i.clear(),t.excluded.clear(),this._cascadeAll=false;const s=this.extensionsCascade,n=this.cascadeParentNode(e,0,s.length?s:void 0);if(n){const i=new this.Node(0,t.sessionId,e.parentElement||document.body);this._afterInsertNode(i),n.parent=i,n.actualParent=i,n.childIndex=0,n.documentRoot=true}return t.node=n,i.afterAppend=void 0,n}cascadeParentNode(e,t,i){const s=this.insertNode(e);if(s){const{controllerHandler:n,processing:a}=this,r=a.cache;if(s.depth=t,0===t)r.append(s);if(n.preventNodeCascade(e))return s;const{childElementCount:l,childNodes:o}=e,c=o.length,h=new Array(c),d=new Array(l);let u=true,f=0,g=0,p=0;while(f<c){const e=o[f++];let l;if("#"===e.nodeName.charAt(0)){if(y(e))l=this.insertNode(e,s)}else if(n.includeElement(e)){if(l=this.cascadeParentNode(e,t+1,i),l)d[p++]=l,r.append(l),u=false}else if(l=this.insertNode(e),l)a.excluded.append(l),u=false;if(l)l.parent=s,l.actualParent=s,l.childIndex=g,h[g++]=l}if(h.length=g,d.length=p,s.naturalChildren=h,s.naturalElements=d,s.inlineText=u,p>0&&this.userSettings.createQuerySelectorMap)s.queryMap=this.createQueryMap(d,p)}return s}createQueryMap(e,t){var i;const s=[e];let n=0;while(n<t){const t=e[n++].queryMap;if(t){const e=t.length;for(let n=0;n<e;++n){const e=n+1;s[e]=(null===(i=s[e])||void 0===i?void 0:i.concat(t[n]))||t[n]}}}return s}applyStyleRule(e){var t,i,s,n,a,r;const l=this.resourceHandler,o=this.processing.sessionId,c=(null===(t=e.parentStyleSheet)||void 0===t?void 0:t.href)||location.href,h=e.cssText;switch(e.type){case CSSRule.SUPPORTS_RULE:this.applyCSSRuleList(e.cssRules);break;case CSSRule.STYLE_RULE:{const t=e.style,i={},s={};let n;Array.from(t).forEach(e=>s[E(e)]=t[e]),q(l,s,"backgroundImage",c),q(l,s,"listStyleImage",c),q(l,s,"content",c),F.lastIndex=0;while(null!==(n=F.exec(h))){const e=E(n[1]);switch(e){case"margin":i.marginTop=true,i.marginRight=true,i.marginBottom=true,i.marginLeft=true;break;case"padding":i.paddingTop=true,i.paddingRight=true,i.paddingBottom=true,i.paddingLeft=true;break;case"background":i.backgroundColor=true,i.backgroundImage=true,i.backgroundSize=true,i.backgroundRepeat=true,i.backgroundPositionX=true,i.backgroundPositionY=true;break;case"backgroundPosition":i.backgroundPositionX=true,i.backgroundPositionY=true;break;case"border":i.borderTopStyle=true,i.borderRightStyle=true,i.borderBottomStyle=true,i.borderLeftStyle=true,i.borderTopWidth=true,i.borderRightWidth=true,i.borderBottomWidth=true,i.borderLeftWidth=true,i.borderTopColor=true,i.borderRightColor=true,i.borderBottomColor=true,i.borderLeftColor=true;break;case"borderStyle":i.borderTopStyle=true,i.borderRightStyle=true,i.borderBottomStyle=true,i.borderLeftStyle=true;break;case"borderWidth":i.borderTopWidth=true,i.borderRightWidth=true,i.borderBottomWidth=true,i.borderLeftWidth=true;break;case"borderColor":i.borderTopColor=true,i.borderRightColor=true,i.borderBottomColor=true,i.borderLeftColor=true;break;case"font":i.fontFamily=true,i.fontStyle=true,i.fontSize=true,i.fontWeight=true,i.lineHeight=true;break}i[e]=true}x(e.selectorText,true).forEach(e=>{const n=g(e),[a,r]=e.split("::"),l=r?"::"+r:"",c=document.querySelectorAll(a||"*"),h=c.length;if(0===h)return void this.processing.unusedStyles.add(e);let d=0;while(d<h){const e=c[d++],a="styleMap"+l,r="styleSpecificity"+l,h=P(e,a,o);if(h){const a=P(e,r,o)||{};for(const e in s){const r=a[e],l=n+(i[e]?1e3:0);if(void 0===r||l>=r){const i=s[e];if("initial"===i&&W.test(e)){if("none"===t.background)delete h[e]}else h[e]=i;a[e]=l}}}else{const t=Object.assign({},s),c={};for(const e in t)c[e]=n+(i[e]?1e3:0);M(e,"style"+l,"0",p(e,l)),M(e,"sessionId","0",o),M(e,a,o,t),M(e,r,o,c)}}});break}case CSSRule.FONT_FACE_RULE:{const e=null===(i=O.exec(h))||void 0===i?void 0:i[1];if(e){const t=((null===(s=D.exec(e))||void 0===s?void 0:s[1])||"").trim(),i=((null===(n=U.exec(e))||void 0===n?void 0:n[1])||"").split(I.SEPARATOR);if(""!==t&&i.length){const s=(null===(a=H.exec(e))||void 0===a?void 0:a[1].toLowerCase())||"normal",n=parseInt((null===(r=X.exec(e))||void 0===r?void 0:r[1])||"400");i.forEach(e=>{var i;const a=V.exec(e);if(a){let e,r;const o=(a[2]||a[3]).trim();if("url"===a[1])e=_(o,c);else r=o;l.addFont({fontFamily:t,fontWeight:n,fontStyle:s,srcUrl:e,srcLocal:r,srcFormat:(null===(i=a[4])||void 0===i?void 0:i.toLowerCase().trim())||"truetype"})}})}}break}}}applyCSSRuleList(e){const t=e.length;let i=0;while(i<t)this.applyStyleRule(e[i++])}applyStyleSheet(e){var t;try{const i=e.cssRules;if(i){const e=i.length;let s=0;while(s<e){const e=i[s++];switch(e.type){case CSSRule.STYLE_RULE:case CSSRule.FONT_FACE_RULE:this.applyStyleRule(e);break;case CSSRule.IMPORT_RULE:{const i=_(e.href,(null===(t=e.parentStyleSheet)||void 0===t?void 0:t.href)||location.href);if(""!==i)this.resourceHandler.addRawData(i,"text/css","utf8","");this.applyStyleSheet(e.styleSheet);break}case CSSRule.MEDIA_RULE:if(f(e.conditionText||$("media",e.cssText)))this.applyCSSRuleList(e.cssRules);break;case CSSRule.SUPPORTS_RULE:if(CSS.supports&&CSS.supports(e.conditionText||$("supports",e.cssText)))this.applyCSSRuleList(e.cssRules);break}}}}catch(t){if(this.userSettings.showErrorMessages)alert("CSS cannot be parsed inside <link> tags when loading files directly from your hard drive or from external websites. Either use a local web server, embed your CSS into a <style> tag, or you can also try using a different browser. See the README for more detailed instructions.\n\n"+e.href+"\n\n"+t)}}get controllerHandler(){return this._controllerHandler}get resourceHandler(){return this._resourceHandler}get extensionManager(){return this._extensionManager}get fileHandler(){return this._resourceHandler.fileHandler}get extensionsCascade(){return[]}get nextId(){return this._cache.nextId}get length(){return 0}}Application.KEY_NAME="squared.application";class Controller{preventNodeCascade(e){return false}get generateSessionId(){return(new Date).getTime().toString()}get afterInsertNode(){return e=>{}}}class Extension{constructor(e,t,i){if(this.name=e,this.framework=t,this.options={},this.dependencies=[],this.subscribers=new Set,i)Object.assign(this.options,i)}require(e,t=false){this.dependencies.push({name:e,preload:t})}beforeParseDocument(){}afterParseDocument(){}set application(e){this._application=e,this._controller=e.controllerHandler}get application(){return this._application}get controller(){return this._controller}}const K=squared.lib,{frameworkNotInstalled:Q}=K.session,{fromLastIndexOf:J,isString:Z,trimEnd:ee}=K.util;class File{constructor(){this.assets=[]}static downloadFile(e,t,i){const s=new Blob([e],{type:i||"application/octet-stream"}),n=window.URL.createObjectURL(s),a=document.createElement("a");if(a.style.setProperty("display","none"),a.setAttribute("href",n),a.setAttribute("download",t),!a.download)a.setAttribute("target","_blank");const r=document.body;r.appendChild(a),a.click(),r.removeChild(a),setTimeout(()=>window.URL.revokeObjectURL(n),1)}createFrom(e,t){return this.archiving(Object.assign(Object.assign({filename:this.userSettings.outputArchiveName},t),{format:e}))}appendFromArchive(e,t){return this.archiving(Object.assign(Object.assign({filename:this.userSettings.outputArchiveName},t),{appendTo:e,format:e.substring(e.lastIndexOf(".")+1)}))}addAsset(e){if(e.content||e.uri||e.base64){const{pathname:t,filename:i}=e,s=this.assets.find(e=>e.pathname===t&&e.filename===i);if(s)Object.assign(s,e);else this.assets.push(e)}}reset(){this.assets.length=0}copying(e){if(this.hasHttpProtocol()){const{assets:t,directory:i}=e;if(Z(i)){const s=t?t.concat(this.assets):this.assets,n=s[0];if(n)return n.exclusions=e.exclusions,n.dataMap=this.getDataMap(e),fetch(this.hostname+"/api/assets/copy?to="+encodeURIComponent(i.trim())+"&empty="+(this.userSettings.outputEmptyCopyDirectory?"1":"0")+this.getCopyQueryParameters(e),{method:"POST",headers:new Headers({Accept:"application/json, text/plain","Content-Type":"application/json"}),body:JSON.stringify(s)}).then(e=>e.json()).then(t=>{if(t){if("function"==typeof e.callback)e.callback(t);if(this.userSettings.showErrorMessages){const{application:e,system:i}=t;if(i)alert(e+"\n\n"+i)}}return t})}}else if(this.userSettings.showErrorMessages)alert("SERVER (required): See README for instructions");return Q()}archiving(e){if(this.hasHttpProtocol()){const{assets:t,filename:i}=e;if(Z(i)){const s=t?t.concat(this.assets):this.assets,n=s[0];if(n)return n.exclusions=e.exclusions,n.dataMap=this.getDataMap(e),fetch(this.hostname+"/api/assets/archive?filename="+encodeURIComponent(i.trim())+"&format="+(e.format||this.userSettings.outputArchiveFormat).trim().toLowerCase()+"&to="+encodeURIComponent((e.copyTo||"").trim())+"&append_to="+encodeURIComponent((e.appendTo||"").trim())+this.getArchiveQueryParameters(e),{method:"POST",headers:new Headers({Accept:"application/json, text/plain","Content-Type":"application/json"}),body:JSON.stringify(s)}).then(e=>e.json()).then(t=>{if(t){if("function"==typeof e.callback)e.callback(t);const i=t.zipname;if(Z(i))fetch("/api/browser/download?filepath="+encodeURIComponent(i)).then(async e=>File.downloadFile(await e.blob(),J(i,"/","\\")));else if(this.userSettings.showErrorMessages){const{application:e,system:i}=t;if(i)alert(e+"\n\n"+i)}}return t})}}else if(this.userSettings.showErrorMessages)alert("SERVER (required): See README for instructions");return Q()}hasHttpProtocol(){return(this._hostname||location.protocol).startsWith("http")}set hostname(e){if(null==e?void 0:e.startsWith("http"))this._hostname=ee(e,"/")}get hostname(){return this._hostname||location.origin}}const te=squared.lib,{USER_AGENT:ie,isUserAgent:se}=te.client,{BOX_BORDER:ne,CSS_UNIT:ae,TEXT_STYLE:re,checkStyleValue:le,checkWritingMode:oe,formatPX:ce,getInheritedStyle:he,getStyle:de,hasComputedStyle:ue,isLength:fe,isPercent:ge,parseSelectorText:pe,parseUnit:me}=te.css,{ELEMENT_BLOCK:be,assignRect:xe,getNamedItem:ye,getRangeClientRect:ve,newBoxRectDimension:Ee}=te.dom,{CHAR:Se,CSS:we,FILE:ke,XML:_e}=te.regex,{actualClientRect:Ce,actualTextRangeRect:Te,deleteElementCache:Ae,getElementAsNode:Ie,getElementCache:Re,getPseudoElt:Pe,setElementCache:Me}=te.session,{aboveRange:Ne,belowRange:Be,convertCamelCase:Le,convertFloat:We,convertInt:Fe,hasBit:Oe,hasValue:De,isNumber:Ue,isObject:He,isString:Xe,iterateArray:Ve,spliceString:ze,splitEnclosing:Ge}=te.util,{PX:je,SELECTOR_ATTR:qe,SELECTOR_G:Ye,SELECTOR_LABEL:$e,SELECTOR_PSEUDO_CLASS:Ke}=we,Qe=/\s*(url|[a-z-]+gradient)/,Je=/^:lang\(\s*(.+)\s*\)$/,Ze=/^:nth(-last)?-(child|of-type)\((.+)\)$/,et=/^(-)?(\d+)?n\s*([+-]\d+)?$/,tt=/\dem$/;function it(e,t,i,s,n){if(n!==s)if(e.style.setProperty(t,s),nt(s,e.style.getPropertyValue(t)))return Me(e,t,i,"auto"!==s?n:""),true;else return false;return true}function st(e,t,i){const s=Re(e,t,i);if(void 0!==s)e.style.setProperty(t,s),Ae(e,t,i)}const nt=(e,t)=>e===t||fe(e,true)&&je.test(t),at=(e,t)=>e.id<t.id?-1:1,rt=e=>parseFloat(e.getPropertyValue("font-size"));function lt(){var e;let t;if(this.naturalElement){const e=this.sessionId;t=[];let i=0;this.element.childNodes.forEach(s=>{const n=Ie(s,e);if(n)n.childIndex=i++,t.push(n)})}else t=((null===(e=this.initial)||void 0===e?void 0:e.children)||this.children).slice(0);return this.naturalChildren=t,t}function ot(){const e=this.naturalChildren.filter(e=>e.naturalElement);return this.naturalElements=e,e}function ct(e,t,i){const s=(i||this).css(e);if(Ue(s))return parseFloat(s);else if("inherit"===s&&!i)return ct.call(this,e,t,this.actualParent);return t}function ht(e,t){const i=this.cssAscend("textAlign",this.textElement&&this.blockStatic&&!this.hasPX("width"));return(i===e||i===t)&&(this.blockStatic?this.textElement&&!this.hasPX("width",true,true)&&!this.hasPX("maxWidth",true,true):this.display.startsWith("inline"))}function dt(e,t,i,s){const n=e[t],a=this.parseUnit(n,t);let r=Math.max(a,this.parseUnit(e[i],t));if(0===r&&this.styleElement){const e=this.element;switch(e.tagName){case"IMG":case"INPUT":if("image"!==e.type)break;case"TD":case"TH":case"SVG":case"IFRAME":case"VIDEO":case"AUDIO":case"CANVAS":case"OBJECT":case"EMBED":{const i=ye(e,t);if(""!==i)if(r=Ue(i)?parseFloat(i):this.parseUnit(i,t),r>0)this.css(t,ge(i)?i:i+"px");break}}}let l=0;if(a>0&&!this.imageElement){const i=e[s];if(n===i)delete e[s];else if(l=this.parseUnit(i,t),l>0&&l<=a&&fe(n))l=0,e[t]=i,delete e[s]}return l>0?Math.min(r,l):r}function ut(){let e=0;if(this.htmlElement&&!this.inputElement&&!this.imageElement&&"HR"!==this.tagName&&!this.documentBody){const t=this.element,{overflowX:i,overflowY:s}=this.cssAsObject("overflowX","overflowY");if(this.hasHeight&&(this.hasPX("height")||this.hasPX("maxHeight"))&&("scroll"===s||"auto"===s&&t.clientHeight!==t.scrollHeight))e|=16;if((this.hasPX("width")||this.hasPX("maxWidth"))&&("scroll"===i||"auto"===i&&t.clientWidth!==t.scrollWidth))e|=8}return e}function ft(e,t){if(!this.plainText){switch(this.css(t[0])){case"none":case"initial":case"hidden":return 0}const i=this.css(t[1]),s=fe(i,true)?this.parseUnit(i,e):We(this.style[t[1]]);if(s>0)return Math.max(Math.round(s),1)}return 0}function gt(e,t){var i;switch(this.display){case"table":if(!t&&"collapse"===this.css("borderCollapse"))return 0;break;case"table-row":return 0;case"table-cell":if(t){switch(this.tagName){case"TD":case"TH":return 0;default:{const t=this.ascend({condition:e=>"TABLE"===e.tagName})[0];if(t){const[i,s]=t.css("borderSpacing").split(" ");switch(e){case"marginTop":case"marginBottom":return s?this.parseUnit(s,"height",false):this.parseUnit(i,"width",false);case"marginRight":if(this.actualParent.lastChild!==this)return this.parseUnit(i,"width",false);case"marginLeft":return 0}}break}}return 0}break}return this.parseUnit(this.css(e),"width",!(true===(null===(i=this.actualParent)||void 0===i?void 0:i.gridElement)))}function pt(){return this.naturalChild&&(this.inlineVertical||0===this.length)&&!this.floating&&true!==this.autoMargin.horizontal}function mt(e,t,i){return!this._preferInitial&&this._styleMap[e]||this.cssInitial(e,t,i)}function bt(e,t,i,s,n){var a,r;if(t.all)return true;let l=t.tagName;if(l&&l!==e.tagName.toUpperCase())return false;const o=t.id;if(o&&o!==e.elementId)return false;const{attrList:c,classList:h,notList:d,pseudoList:u}=t;if(u){const t=e.actualParent;l=e.tagName;for(const i of u)switch(i){case":first-child":case":nth-child(1)":if(e!==t.firstChild)return false;break;case":last-child":case":nth-last-child(1)":if(e!==t.lastChild)return false;break;case":only-child":if(t.naturalElements.length>1)return false;break;case":only-of-type":{let e=0;for(const i of t.naturalElements)if(i.tagName===l&&++e>1)return false;break}case":first-of-type":for(const i of t.naturalElements)if(i.tagName===l){if(i!==e)return false;break}break;case":nth-child(n)":case":nth-last-child(n)":break;case":empty":if(e.element.childNodes.length)return false;break;case":checked":switch(l){case"INPUT":if(!e.toElementBoolean("checked"))return false;break;case"OPTION":if(!e.toElementBoolean("selected"))return false;break;default:return false}break;case":enabled":if(!e.inputElement||e.toElementBoolean("disabled"))return false;break;case":disabled":if(!e.inputElement||!e.toElementBoolean("disabled"))return false;break;case":read-only":{const t=e.element;if(t.isContentEditable||("INPUT"===l||"TEXTAREA"===l)&&!t.readOnly)return false;break}case":read-write":{const t=e.element;if(!t.isContentEditable||("INPUT"===l||"TEXTAREA"===l)&&t.readOnly)return false;break}case":required":if(!e.inputElement||"BUTTON"===l||!e.toElementBoolean("required"))return false;break;case":optional":if(!e.inputElement||"BUTTON"===l||e.toElementBoolean("required"))return false;break;case":placeholder-shown":if(!(("INPUT"===l||"TEXTAREA"===l)&&""!==e.toElementString("placeholder")))return false;break;case":default":switch(l){case"INPUT":{const t=e.element;switch(t.type){case"radio":case"checkbox":if(!t.checked)return false;break;default:return false}break}case"OPTION":if(void 0===e.element.attributes.selected)return false;break;case"BUTTON":{const t=e.ascend({condition:e=>"FORM"===e.tagName})[0];if(t){let i=false;const s=e.element;if(Ve(t.element.querySelectorAll("*"),e=>{switch(e.tagName){case"BUTTON":return i=s===e,true;case"INPUT":switch(e.type){case"submit":case"image":return i=s===e,true}break}}),!i)return false}break}default:return false}break;case":in-range":case":out-of-range":if("INPUT"===l){const t=e.element,s=parseFloat(t.value);if(!isNaN(s)){const e=parseFloat(t.min),n=parseFloat(t.max);if(s>=e&&s<=n){if(":out-of-range"===i)return false}else if(":in-range"===i)return false}else if(":in-range"===i)return false}else return false;break;case":indeterminate":if("INPUT"===l){const t=e.element;switch(t.type){case"checkbox":if(!t.indeterminate)return false;break;case"radio":if(t.checked)return false;else if(t.name)if(Ve(((null===(a=e.ascend({condition:e=>"FORM"===e.tagName})[0])||void 0===a?void 0:a.element)||document).querySelectorAll(`input[type=radio][name="${t.name}"`),e=>e.checked)===1/0)return false;break;default:return false}}else if("PROGRESS"===l){if(-1!==e.toElementInt("value",-1))return false}else return false;break;case":target":if(""===location.hash)return false;else{const t=e.element;if(!(location.hash==="#"+t.id||"A"===l&&location.hash==="#"+t.name))return false}break;case":scope":if(!s||">"===n&&e!==this)return false;break;case":root":if(!s||n)return false;break;case":link":case":visited":case":any-link":case":hover":case":focus":case":focus-within":case":valid":case":invalid":{const s=e.element;if(Ve(t.element.querySelectorAll(":scope > "+i),e=>e===s)!==1/0)return false;break}default:{let s=Ze.exec(i);if(s){const i=s[3].trim();let n=t.naturalElements;if(s[1])n=n.slice(0).reverse();const a=("child"===s[2]?n.indexOf(e):n.filter(e=>e.tagName===l).indexOf(e))+1;if(a>0){if(Ue(i)){if(parseInt(i)!==a)return false}else switch(i){case"even":if(a%2!=0)return false;break;case"odd":if(a%2==0)return false;break;default:{const e=et.exec(i);if(e){const t=Fe(e[3]);if(e[2]){if(e[1])return false;const i=parseInt(e[2]);if(0!==i){if(a!==t)for(let e=i;;e+=i){const e=i+t;if(e===a)break;else if(e>a)return false}}else if(a!==t)return false}else if(e[3])if(t>0){if(e[1]){if(a>t)return false}else if(a<t)return false}else return false}break}}continue}}else if(s=Je.exec(i),s)if((null===(r=e.attributes.lang)||void 0===r?void 0:r.trim().toLowerCase())===s[1].toLowerCase())continue;return false}}}if(d)for(const t of d){const n={};switch(t.charAt(0)){case".":n.classList=[t];break;case"#":n.id=t.substring(1);break;case":":n.pseudoList=[t];break;case"[":{qe.lastIndex=0;const e=qe.exec(t);if(e){const t="i"===e[6];let i=e[3]||e[4]||e[5]||"";if(t)i=i.toLowerCase();n.attrList=[{key:e[1],symbol:e[2],value:i,caseInsensitive:t}]}else continue;break}default:if(Se.WORDDASH.test(t))n.tagName=t;else return false;break}if(bt.call(this,e,n,i,s))return false}if(h){const t=e.element.classList;for(const e of h)if(!t.contains(e))return false}if(c){const t=e.attributes;for(const e of c){let i;if(e.endsWith){const s=new RegExp(`^(.+:)?${e.key}$`);for(const e in t)if(s.test(e)){i=t[e];break}}else i=t[e.key];if(void 0===i)return false;else{const t=e.value;if(t){if(e.caseInsensitive)i=i.toLowerCase();if(e.symbol)switch(e.symbol){case"~":if(!i.split(Se.SPACE).includes(t))return false;break;case"^":if(!i.startsWith(t))return false;break;case"$":if(!i.endsWith(t))return false;break;case"*":if(!i.includes(t))return false;break;case"|":if(i!==t&&!i.startsWith(t+"-"))return false;break}else if(i!==t)return false}}}}return true}function xt(e){if(!this.positionStatic){const t=mt.call(this,e,true);if(fe(t))return this.parseUnit(t,"left"===e||"right"===e?"width":"height");else if(ge(t)&&this.styleElement)return We(this.style[e])}return 0}class Node extends squared.lib.base.Container{constructor(e,t="0",i){if(super(),this.id=e,this.sessionId=t,this.documentRoot=false,this.depth=-1,this.childIndex=1/0,this._element=null,this._data={},this._documentBody=false,this._inlineText=false,this._parent=null,i)this._element=i,this._documentBody=i===document.body;else this.style={},this._styleMap={},this._cssStyle={}}init(){const e=this._element;if(e){const t=this.styleElement,i=this.sessionId,s=Re(e,"styleMap",i)||{};let n;if(!this.pseudoElement){if(n=de(e),t){const t=Array.from(e.style),i=t.length;if(i){const n=e.style;let a=0;while(a<i){const e=t[a++];s[Le(e)]=n.getPropertyValue(e)}}}}else n=de(e.parentElement,Pe(e,i));if(t){const t={},i=n.writingMode;for(let a in s){const r=s[a],l=oe(a,i);if(""!==l)if(!s[l])a=l;else continue;const o=le(e,a,r,n);if(""!==o)t[a]=o}this._styleMap=t}else this._styleMap=s;if(this.style=n,this._cssStyle=s,"0"!==i)Me(e,"node",i,this)}}saveAsInitial(e=false){if(void 0===this._initial||e)this._initial={children:this.duplicate(),styleMap:Object.assign({},this._styleMap)}}data(e,t,i,s=true){const n=this._data;if(De(i)){let a=n[e];if(!He(a))a={},n[e]=a;if(s||void 0===a[t])a[t]=i}else if(null===i)return void delete n[e];const a=n[e];return He(a)?a[t]:void 0}unsetCache(...e){let t=e.length;if(t){const i=this._cached;e.forEach(e=>{switch(e){case"position":if(!this._preferInitial)this.cascade(e=>{if(!e.pageFlow)e.unsetCache("absoluteParent");return false});return void(this._cached={});case"display":case"float":case"tagName":return void(this._cached={});case"width":i.actualWidth=void 0,i.percentWidth=void 0;case"minWidth":i.width=void 0;case"maxWidth":i.overflow=void 0;break;case"height":i.actualHeight=void 0,i.percentHeight=void 0;case"minHeight":if(i.height=void 0,!this._preferInitial)i.blockVertical=void 0,this.each(e=>e.unsetCache("height","actualHeight","blockVertical","overflow","bottomAligned"));case"maxHeight":i.overflow=void 0;break;case"verticalAlign":i.baseline=void 0;break;case"left":case"right":case"textAlign":i.rightAligned=void 0,i.centerAligned=void 0;break;case"top":case"bottom":i.bottomAligned=void 0;break;case"overflowX":case"overflowY":i.overflow=void 0;break;default:if(e.startsWith("margin"))i.autoMargin=void 0,i.rightAligned=void 0,i.centerAligned=void 0;else if(e.startsWith("padding"))i.contentBoxWidth=void 0,i.contentBoxHeight=void 0;else if(e.startsWith("border"))i.visibleStyle=void 0,i.contentBoxWidth=void 0,i.contentBoxHeight=void 0;else if(e.startsWith("background"))i.visibleStyle=void 0,--t;else if(re.includes(e))i.lineHeight=void 0,this._textStyle=void 0;else if(!/^(grid|flex|row|column|offset|scroll)/.test(e))--t;break}if(e in i)i[e]=void 0})}else this._cached={},this._textStyle=void 0,t=1;if(0!==t&&!this._preferInitial)this.resetBounds(),this.cascade(e=>(e.resetBounds(),false))}ascend(e){let t=e.attr;if(!Xe(t))t="actualParent";else if(!/[pP]arent$/.test(t))return[];const{condition:i,including:s,error:n,every:a,excluding:r}=e,l=[];let o=e.startSelf?this:this[t];while(o&&o!==r){if(n&&n(o))break;if(i){if(i(o))if(l.push(o),!a)break}else l.push(o);if(o===s)break;o=o[t]}return l}intersectX(e,t="linear"){if(e.width>0){const{left:i,right:s}=this[t],{left:n,right:a}=e;return Math.ceil(i)>=n&&Math.floor(i)<=a||s>=Math.floor(n)&&s<=Math.ceil(a)||Math.ceil(n)>=i&&Math.floor(n)<=s||a>=Math.floor(i)&&a<=Math.ceil(s)}return false}intersectY(e,t="linear"){if(e.height>0){const{top:i,bottom:s}=this[t],{top:n,bottom:a}=e;return Math.ceil(i)>=n&&Math.floor(i)<=a||s>=Math.floor(n)&&s<=Math.ceil(a)||Math.ceil(n)>=i&&Math.floor(n)<=s||a>=Math.floor(i)&&a<=Math.ceil(s)}return false}withinX(e,t="linear"){if(this.pageFlow||e.width>0){const i=this[t];return Ne(i.left,e.left)&&Be(i.right,e.right)}return true}withinY(e,t="linear"){if(this.pageFlow||e.height>0){const i=this[t];return Math.ceil(i.top)>=e.top&&Math.floor(i.bottom)<=e.bottom}return true}outsideX(e,t="linear"){if(this.pageFlow||e.width>0){const i=this[t];return i.left<Math.floor(e.left)||i.right>Math.ceil(e.right)}return false}outsideY(e,t="linear"){if(this.pageFlow||e.height>0){const i=this[t];return i.top<Math.floor(e.top)||i.bottom>Math.ceil(e.bottom)}return false}css(e,t,i=true){if(t&&this.styleElement)if(this.style[e]=t,nt(t,this.style[e])){if(this._styleMap[e]=t,i)this.unsetCache(e);return t}return this._styleMap[e]||this.styleElement&&this.style[e]||""}cssApply(e,t=true){for(const i in e){const s=e[i];if(this.css(i,s,t)===s&&t)this.unsetCache(i)}return this}cssInitial(e,t=false,i=false){var s;let n=((null===(s=this._initial)||void 0===s?void 0:s.styleMap)||this._styleMap)[e]||t&&this._styleMap[e];if(!n&&i)n=this.style[e];return n||""}cssAny(e,...t){const i=this.css(e);for(const e of t)if(i===e)return true;return false}cssInitialAny(e,...t){for(const i of t)if(this.cssInitial(e)===i)return true;return false}cssAscend(e,t=false){let i,s=t?this:this.actualParent;while(s){if(i=s.cssInitial(e),""!==i)return i;if(s.documentBody)break;s=s.actualParent}return""}cssSort(e,t=true,i=false){return(i?this.duplicate():this.children).sort((i,s)=>{const n=i.toFloat(e,i.childIndex),a=s.toFloat(e,s.childIndex);if(n===a)return 0;else if(t)return n<a?-1:1;return n>a?-1:1})}cssPX(e,t,i=false,s=false){const n=this._styleMap[e];if(n&&fe(n)){if(t+=me(n,this.fontSize),!i&&t<0)t=0;const a=ce(t);if(this.css(e,a),s)this.unsetCache(e);return a}return""}cssSpecificity(e){var t,i;let s;if(this.styleElement)if(this.pseudoElement){const i=this._element,n=this.sessionId;s=null===(t=Re(i.parentElement,"styleSpecificity"+Pe(i,n),n))||void 0===t?void 0:t[e]}else s=null===(i=Re(this._element,"styleSpecificity",this.sessionId))||void 0===i?void 0:i[e];return s||0}cssTry(e,t){if(this.styleElement){const i=this._element;return it(i,e,this.sessionId,t,de(i).getPropertyValue(e))}return false}cssFinally(e){if(this.styleElement)if("string"==typeof e)st(this._element,e,this.sessionId);else{const t=this.sessionId,i=this._element;for(const s in e)st(i,s,t)}}cssTryAll(e){if(this.styleElement){const t=this.sessionId,i=this._element,s=de(i),n=[];for(const a in e)if(it(i,a,t,e[a],s.getPropertyValue(a)))n.push(a);else return void n.forEach(e=>this.cssFinally(e));return e}}cssParent(e,t,i=false){return this.naturalChild?this.actualParent.css(e,t,i):""}cssCopy(e,...t){const i=this._styleMap;t.forEach(t=>i[t]=e.css(t))}cssCopyIfEmpty(e,...t){const i=this._styleMap;t.forEach(t=>{if(!De(i[t]))i[t]=e.css(t)})}cssAsTuple(...e){const t=e.length,i=new Array(t);let s=0;while(s<t)i[s]=this.css(e[s++]);return i}cssAsObject(...e){const t={};return e.forEach(e=>t[e]=this.css(e)),t}toInt(e,t=NaN,i=false){var s;const n=parseInt((i&&(null===(s=this._initial)||void 0===s?void 0:s.styleMap)||this._styleMap)[e]);return isNaN(n)?t:n}toFloat(e,t=NaN,i=false){var s;const n=parseFloat((i&&(null===(s=this._initial)||void 0===s?void 0:s.styleMap)||this._styleMap)[e]);return isNaN(n)?t:n}toElementInt(e,t=NaN){var i;const s=parseInt(null===(i=this._element)||void 0===i?void 0:i[e]);return!isNaN(s)?s:t}toElementFloat(e,t=NaN){var i;const s=parseFloat(null===(i=this._element)||void 0===i?void 0:i[e]);return!isNaN(s)?s:t}toElementBoolean(e,t=false){var i;const s=null===(i=this._element)||void 0===i?void 0:i[e];return"boolean"==typeof s?s:t}toElementString(e,t=""){var i;return((null===(i=this._element)||void 0===i?void 0:i[e])||t).toString()}parseUnit(e,t="width",i=true,s){var n;if(e){if(ge(e)){const s=i&&(null===(n=this.absoluteParent)||void 0===n?void 0:n.box)||this.bounds;let a=parseFloat(e)/100;switch(t){case"width":a*=s.width;break;case"height":a*=s.height;break}return a}return me(e,this.fontSize,s)}return 0}has(e,t){var i;let s,n,a;if(t)({map:s,not:n,type:a}=t);const r=("initial"===s&&(null===(i=this._initial)||void 0===i?void 0:i.styleMap)||this._styleMap)[e];if(r)switch(r){case"auto":case"none":case"initial":case"normal":case"rgba(0, 0, 0, 0)":return false;case"baseline":return"verticalAlign"!==e;case"left":case"start":return"textAlign"!==e;default:if(n)if(Array.isArray(n)){for(const e of n)if(r===e)return false}else if(r===n)return false;if(a)return Oe(a,2)&&fe(r)||Oe(a,4)&&ge(r);else return true}return false}hasPX(e,t=true,i=false){var s;return fe((i&&(null===(s=this._initial)||void 0===s?void 0:s.styleMap)||this._styleMap)[e],t)}setBounds(e=true){let t;if(this.styleElement){if(!e)Ae(this._element,"clientRect",this.sessionId);t=xe(Ce(this._element,this.sessionId)),this._bounds=t}else if(this.plainText){const e=ve(this._element);t=xe(e);const i=e.numberOfLines;t.numberOfLines=i,this._bounds=t,this._textBounds=t,this._cached.multiline=i>1}if(!e&&t)this._box=void 0,this._linear=void 0;return t}resetBounds(){this._bounds=void 0,this._box=void 0,this._linear=void 0,this._textBounds=void 0,this._cached.multiline=void 0}querySelector(e){return this.querySelectorAll(e,1)[0]||null}querySelectorAll(e,t=-1){let i=[];const s=this.queryMap;if(s&&0!==t){const n=pe(e);let a=n.length,r=0;while(r<a){const e=n[r++],l=[];let o=-1;e:if("*"===e)l.push({all:true}),++o;else{let t,i;Ye.lastIndex=0;while(null!==(i=Ye.exec(e))){let e=i[1],s=false;if(1===e.length){const i=e.charAt(0);switch(i){case"+":case"~":--o;case">":if(t||0===l.length){l.length=0;break e}t=i;continue;case"*":s=true;break}}else if(e.startsWith("*|*")){if(e.length>3){l.length=0;break e}s=true}else if(e.startsWith("*|"))e=e.substring(2);else if(e.startsWith("::")){l.length=0;break e}if(s)l.push({all:true});else{let i,s,n,a,r,o,c;while(null!==(c=qe.exec(e))){if(void 0===a)a=[];let t=c[1].replace("\\:",":"),i=false;switch(t.indexOf("|")){case-1:break;case 1:if("*"===t.charAt(0)){i=true,t=t.substring(2);break}default:l.length=0;break e}const s="i"===c[6];let n=c[3]||c[4]||c[5]||"";if(s)n=n.toLowerCase();a.push({key:t,symbol:c[2],value:n,endsWith:i,caseInsensitive:s}),e=ze(e,c.index,c[0].length)}if(e.includes("::")){l.length=0;break e}while(null!==(c=Ke.exec(e))){const t=c[0];if(t.startsWith(":not(")){if(c[1]){if(void 0===o)o=[];o.push(c[1])}}else{if(void 0===r)r=[];r.push(t)}e=ze(e,c.index,t.length)}while(null!==(c=$e.exec(e))){const t=c[0];switch(t.charAt(0)){case"#":s=t.substring(1);break;case".":if(void 0===n)n=[];n.push(t.substring(1));break;default:i=t.toUpperCase();break}e=ze(e,c.index,t.length)}l.push({tagName:i,id:s,adjacent:t,classList:n,pseudoList:r,notList:o,attrList:a})}++o,t=void 0}}if(a=s.length,l.length&&-1!==o&&o<a){const e=l.pop(),c=0===l.length,h=i.length;let d;if(e.all&&a-o==1)d=s[o];else{d=[];let t=o;while(t<a){const n=s[t++];if(e.all)d=d.concat(n);else{const t=n.length;let s=0;while(s<t){const t=n[s++];if((0===h||!i.includes(t))&&bt.call(this,t,e,r,c))d.push(t)}}}}if(l.length){const s=this.depth;l.reverse(),a=l.length;const n=(e,t,i)=>{const o=l[e],c=e===a-1,h=[],d=i.length;let u=0;while(u<d){const n=i[u++];if(t){const e=n.actualParent;if(">"===t){if(bt.call(this,e,o,r,c,t))h.push(e)}else{const i=e.naturalElements;switch(t){case"+":{const e=i.indexOf(n);if(e>0){const s=i[e-1];if(s&&bt.call(this,s,o,r,c,t))h.push(s)}break}case"~":{const e=i.length;let s=0;while(s<e){const e=i[s++];if(e===n)break;else if(bt.call(this,e,o,r,c,t))h.push(e)}break}}}}else if(n.depth-s>=a-e){let e=n.actualParent;do{if(bt.call(this,e,o,r,c))h.push(e);e=e.actualParent}while(e)}}if(h.length)if(++e===a)return true;else return n(e,o.adjacent,h);return false};let o=h;const c=d.length;let u=0;while(u<c){const s=d[u++];if((0===h||!i.includes(s))&&n(0,e.adjacent,[s]))if(i.push(s),++o===t)return i.sort(at)}}else if(0===h)if(r===n.length-1||t>0&&t<=d.length){if(t>0&&d.length>t)d.length=t;return d.sort(at)}else i=d;else{const e=d.length;if(t>0){let s=h,n=0;while(n<e){const e=d[n++];if(!i.includes(e))if(i.push(e),++s===t)return i.sort(at)}}else{let t=0;while(t<e){const e=d[t++];if(!i.includes(e))i.push(e)}}}}}}return i.sort(at)}set parent(e){if(e){const t=this._parent;if(e!==t)null==t||t.remove(this),this._parent=e;if(!e.contains(this))e.append(this);if(-1===this.depth)this.depth=e.depth+1}}get parent(){return this._parent}get tagName(){let e=this._cached.tagName;if(void 0===e){const t=this._element;if(t){const i=t.nodeName;e="#"===i.charAt(0)?i:t.tagName}else e="";this._cached.tagName=e}return e}get element(){return this._element}get elementId(){var e;return(null===(e=this._element)||void 0===e?void 0:e.id)||""}get htmlElement(){let e=this._cached.htmlElement;if(void 0===e)e=!this.plainText&&this._element instanceof HTMLElement,this._cached.htmlElement=e;return e}get svgElement(){let e=this._cached.svgElement;if(void 0===e)e=!this.htmlElement&&!this.plainText&&this._element instanceof SVGElement||this.imageElement&&ke.SVG.test(this.toElementString("src")),this._cached.svgElement=e;return e}get styleElement(){return this.htmlElement||this.svgElement}get naturalChild(){return true}get naturalElement(){let e=this._cached.naturalElement;if(void 0===e)e=this.naturalChild&&this.styleElement&&!this.pseudoElement,this._cached.naturalElement=e;return e}get pseudoElement(){return false}get imageElement(){return"IMG"===this.tagName}get flexElement(){let e=this._cached.flexElement;if(void 0===e)e=this.display.endsWith("flex"),this._cached.flexElement=e;return e}get gridElement(){let e=this._cached.gridElement;if(void 0===e)e=this.display.endsWith("grid"),this._cached.gridElement=e;return e}get textElement(){let e=this._cached.textElement;if(void 0===e)e=this.plainText||this.inlineText&&!this.inputElement,this._cached.textElement=e;return e}get tableElement(){let e=this._cached.tableElement;if(void 0===e)e="TABLE"===this.tagName||"table"===this.display,this._cached.tableElement=e;return e}get inputElement(){let e=this._cached.inputElement;if(void 0===e){switch(this.tagName){case"INPUT":case"BUTTON":case"SELECT":case"TEXTAREA":e=true;break;default:e=false;break}this._cached.inputElement=e}return e}get plainText(){return"#text"===this.tagName}get styleText(){return this.naturalElement&&this.inlineText}get lineBreak(){return"BR"===this.tagName}get documentBody(){return this._documentBody}get initial(){return this._initial}get bounds(){return this._bounds||this.setBounds(false)||xe(this.boundingClientRect)}get linear(){let e=this._linear;if(void 0===e){const t=this.bounds;if(t)if(this.styleElement){const{marginBottom:i,marginRight:s}=this,n=Math.max(this.marginTop,0),a=Math.max(this.marginLeft,0);e={top:t.top-n,right:t.right+s,bottom:t.bottom+i,left:t.left-a,width:t.width+a+s,height:t.height+n+i}}else e=t;else e=Ee();this._linear=e}return e}get box(){let e=this._box;if(void 0===e){const t=this.bounds;if(t)if(this.styleElement)e={top:t.top+(this.paddingTop+this.borderTopWidth),right:t.right-(this.paddingRight+this.borderRightWidth),bottom:t.bottom-(this.paddingBottom+this.borderBottomWidth),left:t.left+(this.paddingLeft+this.borderLeftWidth),width:t.width-this.contentBoxWidth,height:t.height-this.contentBoxHeight};else e=t;else e=Ee();this._box=e}return e}get dataset(){if(this.styleElement)return this._element.dataset;else{let e=this._dataset;if(void 0===e)e={},this._dataset=e;return e}}get flexdata(){let e=this._cached.flexdata;if(void 0===e){if(this.flexElement){const{flexWrap:t,flexDirection:i,alignContent:s,justifyContent:n}=this.cssAsObject("flexWrap","flexDirection","alignContent","justifyContent"),a=i.startsWith("row");e={row:a,column:!a,reverse:i.endsWith("reverse"),wrap:t.startsWith("wrap"),wrapReverse:"wrap-reverse"===t,alignContent:s,justifyContent:n}}else e={};this._cached.flexdata=e}return e}get flexbox(){var e;let t=this._cached.flexbox;if(void 0===t){if((null===(e=this.actualParent)||void 0===e?void 0:e.flexElement)&&this.styleElement){const e=this.css("alignSelf"),i=this.css("justifySelf");t={alignSelf:"auto"===e?this.cssParent("alignItems"):e,justifySelf:"auto"===i?this.cssParent("justifyItems"):i,basis:this.css("flexBasis"),grow:ct.call(this,"flexGrow",0),shrink:ct.call(this,"flexShrink",1),order:this.toInt("order",0)}}else t={};this._cached.flexbox=t}return t}get width(){let e=this._cached.width;if(void 0===e)e=dt.call(this,this._styleMap,"width","minWidth","maxWidth"),this._cached.width=e;return e}get height(){let e=this._cached.height;if(void 0===e)e=dt.call(this,this._styleMap,"height","minHeight","maxHeight"),this._cached.height=e;return e}get hasWidth(){let e=this._cached.hasWidth;if(void 0===e)e=this.width>0,this._cached.hasWidth=e;return e}get hasHeight(){var e;let t=this._cached.hasHeight;if(void 0===t){const i=this.css("height");if(ge(i))if(this.pageFlow)t=(null===(e=this.actualParent)||void 0===e?void 0:e.hasHeight)||this.documentBody;else t="fixed"===this.css("position")||this.hasPX("top")||this.hasPX("bottom");else t=this.height>0||this.hasPX("height",false);this._cached.hasHeight=t}return t}get lineHeight(){let e=this._cached.lineHeight;if(void 0===e){if(e=0,!this.imageElement&&!this.svgElement){let t=this.has("lineHeight"),i=0;if(t){const e=this.css("lineHeight");if(ge(e))i=We(this.style.lineHeight);else if(Ue(e))i=parseFloat(e)*this.fontSize;else if(i=me(e,this.fontSize),je.test(e)&&"inherit"!==this._cssStyle.lineHeight){const e=mt.call(this,"fontSize");if(tt.test(e))i*=parseFloat(e)}}else{const e=this.ascend({condition:e=>e.lineHeight>0})[0];if(e)i=e.lineHeight;if(this.styleElement){const e=mt.call(this,"fontSize");if(tt.test(e)){const s=parseFloat(e);if(1!==s)i*=s,this.css("lineHeight",ce(i)),t=true}}}if(t||i>this.height||this.multiline||this.block&&this.naturalChildren.some(e=>e.textElement))e=i}this._cached.lineHeight=e}return e}get display(){return this.css("display")}get positionStatic(){let e=this._cached.positionStatic;if(void 0===e){switch(this.css("position")){case"fixed":case"absolute":e=false;break;case"relative":if(!this.documentBody){if(e=!(this.hasPX("top")||this.hasPX("right")||this.hasPX("bottom")||this.hasPX("left")),e)this._cached.positionRelative=false}else e=false;break;case"inherit":{const t=this._element,i=(null==t?void 0:t.parentElement)?he(t.parentElement,"position"):"";e=""!==i&&!("absolute"===i||"fixed"===i);break}default:e=true;break}this._cached.positionStatic=e}return e}get positionRelative(){let e=this._cached.positionRelative;if(void 0===e)e="relative"===this.css("position"),this._cached.positionRelative=e;return e}get top(){let e=this._cached.top;if(void 0===e)e=xt.call(this,"top"),this._cached.top=e;return e}get right(){let e=this._cached.right;if(void 0===e)e=xt.call(this,"right"),this._cached.right=e;return e}get bottom(){let e=this._cached.bottom;if(void 0===e)e=xt.call(this,"bottom"),this._cached.bottom=e;return e}get left(){let e=this._cached.left;if(void 0===e)e=xt.call(this,"left"),this._cached.left=e;return e}get marginTop(){let e=this._cached.marginTop;if(void 0===e)e=this.inlineStatic?0:gt.call(this,"marginTop",true),this._cached.marginTop=e;return e}get marginRight(){let e=this._cached.marginRight;if(void 0===e)e=gt.call(this,"marginRight",true),this._cached.marginRight=e;return e}get marginBottom(){let e=this._cached.marginBottom;if(void 0===e)e=this.inlineStatic?0:gt.call(this,"marginBottom",true),this._cached.marginBottom=e;return e}get marginLeft(){let e=this._cached.marginLeft;if(void 0===e)e=gt.call(this,"marginLeft",true),this._cached.marginLeft=e;return e}get borderTopWidth(){let e=this._cached.borderTopWidth;if(void 0===e)e=ft.call(this,"height",ne[0]),this._cached.borderTopWidth=e;return e}get borderRightWidth(){let e=this._cached.borderRightWidth;if(void 0===e)e=ft.call(this,"height",ne[1]),this._cached.borderRightWidth=e;return e}get borderBottomWidth(){let e=this._cached.borderBottomWidth;if(void 0===e)e=ft.call(this,"width",ne[2]),this._cached.borderBottomWidth=e;return e}get borderLeftWidth(){let e=this._cached.borderLeftWidth;if(void 0===e)e=ft.call(this,"width",ne[3]),this._cached.borderLeftWidth=e;return e}get paddingTop(){let e=this._cached.paddingTop;if(void 0===e)e=gt.call(this,"paddingTop",false),this._cached.paddingTop=e;return e}get paddingRight(){let e=this._cached.paddingRight;if(void 0===e)e=gt.call(this,"paddingRight",false),this._cached.paddingRight=e;return e}get paddingBottom(){let e=this._cached.paddingBottom;if(void 0===e)e=gt.call(this,"paddingBottom",false),this._cached.paddingBottom=e;return e}get paddingLeft(){let e=this._cached.paddingLeft;if(void 0===e)e=gt.call(this,"paddingLeft",false),this._cached.paddingLeft=e;return e}get contentBox(){return"border-box"!==this.css("boxSizing")||this.tableElement&&se(8)}get contentBoxWidth(){let e=this._cached.contentBoxWidth;if(void 0===e)e=this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth,this._cached.contentBoxWidth=e;return e}get contentBoxHeight(){let e=this._cached.contentBoxHeight;if(void 0===e)e=this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth,this._cached.contentBoxHeight=e;return e}get inline(){let e=this._cached.inline;if(void 0===e){const t=this.display;e="inline"===t||"initial"===t&&!be.includes(this.tagName),this._cached.inline=e}return e}get inlineStatic(){let e=this._cached.inlineStatic;if(void 0===e)e=this.inline&&this.pageFlow&&!this.floating&&!this.imageElement,this._cached.inlineStatic=e;return e}get inlineVertical(){let e=this._cached.inlineVertical;if(void 0===e){if(this.naturalElement&&!this.floating){const t=this.display;e=t.startsWith("inline")||"table-cell"===t}else e=false;this._cached.inlineVertical=e}return e}get inlineDimension(){let e=this._cached.inlineDimension;if(void 0===e)e=this.naturalElement&&(this.display.startsWith("inline-")||this.floating),this._cached.inlineDimension=e;return e}set inlineText(e){switch(this.tagName){case"INPUT":case"IMG":case"SELECT":case"SVG":case"BR":case"HR":case"TEXTAREA":case"PROGRESS":case"METER":case"CANVAS":this._inlineText=false;break;case"BUTTON":this._inlineText=""!==this.textContent.trim();break;default:this._inlineText=e,this._cached.textElement=void 0;break}}get inlineText(){return this._inlineText}get block(){let e=this._cached.block;if(void 0===e){switch(this.display){case"block":case"flex":case"grid":case"list-item":e=true;break;case"initial":e=be.includes(this.tagName);break;case"inline":if("svg"===this.tagName&&this.actualParent.htmlElement){e=!this.hasPX("width")&&0===We(ye(this._element,"width"));break}default:e=false;break}this._cached.block=e}return e}get blockStatic(){let e=this._cached.blockStatic;if(void 0===e)e=this.pageFlow&&(this.block&&!this.floating||this.lineBreak||this.blockDimension&&("100%"===mt.call(this,"width")||"100%"===mt.call(this,"minWidth"))&&!this.hasPX("maxWidth")),this._cached.blockStatic=e;return e}get blockDimension(){let e=this._cached.blockDimension;if(void 0===e){if(this.block||this.floating||this.imageElement||this.svgElement)e=true;else{const t=this.display;e=t.startsWith("inline-")||"table"===t}this._cached.blockDimension=e}return e}get blockVertical(){let e=this._cached.blockVertical;if(void 0===e)e=this.blockDimension&&this.hasHeight,this._cached.blockVertical=e;return e}get pageFlow(){let e=this._cached.pageFlow;if(void 0===e)e=this.positionStatic||this.positionRelative,this._cached.pageFlow=e;return e}get inlineFlow(){let e=this._cached.inlineFlow;if(void 0===e)e=this.inline||this.inlineDimension||this.inlineVertical||this.imageElement,this._cached.inlineFlow=e;return e}get centerAligned(){let e=this._cached.centerAligned;if(void 0===e){if(!this.pageFlow)e=this.hasPX("left")&&this.hasPX("right");else e=this.autoMargin.leftRight||pt.call(this)&&ht.call(this,"center");this._cached.centerAligned=e}return e}get rightAligned(){let e=this._cached.rightAligned;if(void 0===e){if(!this.pageFlow)e=this.hasPX("right")&&!this.hasPX("left");else e="right"===this.float||this.autoMargin.left||pt.call(this)&&ht.call(this,"right","end");this._cached.rightAligned=e}return e}get bottomAligned(){var e;let t=this._cached.bottomAligned;if(void 0===t){if(!this.pageFlow)t=this.hasPX("bottom")&&!this.hasPX("top");else t=true===(null===(e=this.actualParent)||void 0===e?void 0:e.hasHeight)&&true===this.autoMargin.top;this._cached.bottomAligned=t}return t}get autoMargin(){let e=this._cached.autoMargin;if(void 0===e){if(!this.pageFlow||this.blockStatic||"table"===this.display){const t=this._styleMap,i="auto"===t.marginLeft&&(this.pageFlow||this.hasPX("right")),s="auto"===t.marginRight&&(this.pageFlow||this.hasPX("left")),n="auto"===t.marginTop&&(this.pageFlow||this.hasPX("bottom")),a="auto"===t.marginBottom&&(this.pageFlow||this.hasPX("top"));e={horizontal:i||s,left:i&&!s,right:!i&&s,leftRight:i&&s,vertical:n||a,top:n&&!a,bottom:!n&&a,topBottom:n&&a}}else e={};this._cached.autoMargin=e}return e}get floating(){let e=this._cached.floating;if(void 0===e)e="none"!==this.float,this._cached.floating=e;return e}get float(){let e=this._cached.float;if(void 0===e)e=this.pageFlow&&this.css("float")||"none",this._cached.float=e;return e}get zIndex(){return this.toInt("zIndex",0)}get textContent(){let e=this._cached.textContent;if(void 0===e)e=this.naturalChild&&!this.svgElement?this._element.textContent:"",this._cached.textContent=e;return e}get overflowX(){let e=this._cached.overflow;if(void 0===e)e=ut.call(this),this._cached.overflow=e;return Oe(e,8)}get overflowY(){let e=this._cached.overflow;if(void 0===e)e=ut.call(this),this._cached.overflow=e;return Oe(e,16)}get baseline(){let e=this._cached.baseline;if(void 0===e){if(this.pageFlow&&!this.floating){const t=this.css("verticalAlign");e="baseline"===t||"initial"===t||0===this.naturalElements.length&&fe(t,true)}else e=false;this._cached.baseline=e}return e}get verticalAlign(){let e=this._cached.verticalAlign;if(void 0===e){if(this.pageFlow){if(e=this.css("verticalAlign"),fe(e,true))e=this.parseUnit(e,"height")+"px"}else e="0px";this._cached.verticalAlign=e}return e}set textBounds(e){this._textBounds=e}get textBounds(){let e=this._textBounds;if(void 0===e){if(e=null,this.naturalChild)if(this.textElement)e=Te(this._element,this.sessionId);else{const t=this.naturalChildren,i=t.length;if(i){let s=1/0,n=-1/0,a=-1/0,r=1/0,l=0,o=0;while(o<i){const e=t[o++];if(e.textElement){const t=Te(e.element,e.sessionId);s=Math.min(t.top,s),n=Math.max(t.right,n),r=Math.min(t.left,r),a=Math.max(t.bottom,a),l+=t.numberOfLines||0}}if(l>0)e={top:s,right:n,left:r,bottom:a,width:n-r,height:a-s,numberOfLines:l}}}this._textBounds=e}return e}get multiline(){var e;let t=this._cached.multiline;if(void 0===t){if(this.plainText)t=Math.floor(ve(this._element).width)>this.actualParent.box.width;else if(this.styleText&&(this.inlineFlow||0===this.naturalElements.length))t=(null===(e=this.textBounds)||void 0===e?void 0:e.numberOfLines)>1;else t=false;this._cached.multiline=t}return t}get backgroundColor(){let e=this._cached.backgroundColor;if(void 0===e){switch(e=this.css("backgroundColor"),e){case"initial":case"transparent":case"rgba(0, 0, 0, 0)":e="";break;default:if(""!==e&&this.pageFlow&&this.styleElement&&!this.inputElement&&(!this._initial||mt.call(this,"backgroundColor")===e)){let t=this.actualParent;while(t){const i=mt.call(t,"backgroundColor",true);if(""!==i){if(i===e&&""===t.backgroundColor)e="";break}t=t.actualParent}}break}this._cached.backgroundColor=e}return e}get backgroundImage(){let e=this._cached.backgroundImage;if(void 0===e){let t=this.css("backgroundImage");if(""!==t&&"none"!==t&&"initial"!==t)e=t;else if(t=this.css("background"),Qe.test(t)){const i=[],s=Ge(t),n=s.length;for(let e=1;e<n;++e){const t=s[e-1].trim();if(Qe.test(t))i.push(t+s[e])}e=i.join(", ")}else e="";this._cached.backgroundImage=e}return e}get percentWidth(){let e=this._cached.percentWidth;if(void 0===e){const t=mt.call(this,"width");e=ge(t)?parseFloat(t)/100:0,this._cached.percentWidth=e}return e}get percentHeight(){var e;let t=this._cached.percentHeight;if(void 0===t){const i=mt.call(this,"height");t=ge(i)&&((null===(e=this.actualParent)||void 0===e?void 0:e.hasHeight)||"fixed"===this.css("position"))?parseFloat(i)/100:0,this._cached.percentHeight=t}return t}get visibleStyle(){let e=this._cached.visibleStyle;if(void 0===e){if(this.plainText)e={background:false,borderWidth:false,backgroundImage:false,backgroundColor:false,backgroundRepeat:false,backgroundRepeatX:false,backgroundRepeatY:false};else{const t=this.borderTopWidth>0||this.borderRightWidth>0||this.borderBottomWidth>0||this.borderLeftWidth>0,i=""!==this.backgroundColor,s=""!==this.backgroundImage;let n=false,a=false;if(s)this.css("backgroundRepeat").split(_e.SEPARATOR).forEach(e=>{const[t,i]=e.split(Se.SPACE);if(!n)n="repeat"===t||"repeat-x"===t;if(!a)a="repeat"===t||"repeat-y"===t||"repeat"===i});e={background:t||s||i,borderWidth:t,backgroundImage:s,backgroundColor:i,backgroundRepeat:n||a,backgroundRepeatX:n,backgroundRepeatY:a}}this._cached.visibleStyle=e}return e}get absoluteParent(){let e=this._cached.absoluteParent;if(void 0===e){if(e=this.actualParent,!this.pageFlow&&!this.documentBody)while(e&&!e.documentBody){switch(mt.call(e,"position",false,true)){case"static":case"initial":case"unset":e=e.actualParent;continue}break}this._cached.absoluteParent=e}return e}set actualParent(e){this._cached.actualParent=e}get actualParent(){var e;let t=this._cached.actualParent;if(void 0===t){const i=null===(e=this._element)||void 0===e?void 0:e.parentElement;t=i&&Ie(i,this.sessionId)||null,this._cached.actualParent=t}return t}get actualWidth(){var e;let t=this._cached.actualWidth;if(void 0===t){if(this.plainText){const e=this.bounds;switch(e.numberOfLines||1){case 1:t=e.width;break;case 2:t=Math.min(e.width,this.actualParent.box.width);break;default:t=Math.min(e.right-e.left,this.actualParent.box.width);break}}else if(this.inlineStatic||"table-cell"===this.display||true===(null===(e=this.actualParent)||void 0===e?void 0:e.flexdata.row))t=this.bounds.width;else if(t=this.width,t>0){if(this.contentBox&&!this.tableElement)t+=this.contentBoxWidth}else t=this.bounds.width;this._cached.actualWidth=t}return t}get actualHeight(){var e;let t=this._cached.actualHeight;if(void 0===t){if(!(this.inlineStatic||"table-cell"===this.display||true===(null===(e=this.actualParent)||void 0===e?void 0:e.flexdata.column)))if(t=this.height,t>0){if(this.contentBox&&!this.tableElement)t+=this.contentBoxHeight}else t=this.bounds.height;else t=this.bounds.height;this._cached.actualHeight=t}return t}get actualDimension(){return{width:this.actualWidth,height:this.actualHeight}}set naturalChildren(e){this._naturalChildren=e}get naturalChildren(){return this._naturalChildren||lt.call(this)}set naturalElements(e){this._naturalElements=e}get naturalElements(){return this._naturalElements||ot.call(this)}get firstChild(){return this.naturalElements[0]||null}get lastChild(){const e=this.naturalElements,t=e.length;return t?e[t-1]:null}get firstStaticChild(){for(const e of this.naturalChildren)if(e.pageFlow)return e;return null}get lastStaticChild(){const e=this.naturalChildren;let t=e.length-1;while(t>=0){const i=e[t--];if(i.pageFlow)return i}return null}get previousSibling(){var e;return(null===(e=this.actualParent)||void 0===e?void 0:e.naturalChildren[this.childIndex-1])||null}get nextSibling(){var e;return(null===(e=this.actualParent)||void 0===e?void 0:e.naturalChildren[this.childIndex+1])||null}get previousElementSibling(){var e;const t=null===(e=this.actualParent)||void 0===e?void 0:e.naturalElements;if(t){const e=t.indexOf(this);if(e>0)return t[e-1]}return null}get nextElementSibling(){var e;const t=null===(e=this.actualParent)||void 0===e?void 0:e.naturalElements;if(t){const e=t.indexOf(this);if(-1!==e)return t[e+1]||null}return null}get attributes(){let e=this._cached.attributes;if(void 0===e){if(e={},this.styleElement){const t=this._element.attributes,i=t.length;let s=0;while(s<i){const{name:i,value:n}=t.item(s++);e[i]=n}}this._cached.attributes=e}return e}get boundingClientRect(){var e;return this.naturalElement&&(null===(e=this._element)||void 0===e?void 0:e.getBoundingClientRect())||this._bounds||Ee()}get fontSize(){var e,t,i;let s=this._fontSize;if(void 0===s){if(this.naturalChild&&this.styleElement){const t=this.css("fontSize");if(je.test(t))s=parseFloat(t);else if(ge(t)&&!this.documentBody)s=((null===(e=this.actualParent)||void 0===e?void 0:e.fontSize)||rt(de(document.body)))*parseFloat(t)/100;else s=rt(this.style)}else s=me(this.css("fontSize"));if(0===s&&!this.naturalChild){const e=this.element;if(e&&ue(e))s=(null===(t=Ie(e,this.sessionId))||void 0===t?void 0:t.fontSize)||rt(de(e));else s=(null===(i=this.ascend({condition:e=>e.fontSize>0})[0])||void 0===i?void 0:i.fontSize)||rt(de(document.body))}this._fontSize=s}return s}get cssStyle(){return this._cssStyle}get textStyle(){let e=this._textStyle;if(void 0===e)e=this.cssAsObject(...re),e.fontSize=this.fontSize+"px",this._textStyle=e;return e}set dir(e){this._cached.dir=e}get dir(){let e=this._cached.dir;if(void 0===e){if(e=this.naturalElement?this._element.dir:"",""===e){let t=this.actualParent;while(t){if(e=t.dir,""!==e)break;t=t.actualParent}}this._cached.dir=e}return e}get center(){const e=this.bounds;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}}const yt=new Map([[2,"marginTop"],[4,"marginRight"],[8,"marginBottom"],[16,"marginLeft"],[32,"paddingTop"],[64,"paddingRight"],[128,"paddingBottom"],[256,"paddingLeft"]]),vt={ACCESSIBILITY:"squared.accessibility",COLUMN:"squared.column",CSS_GRID:"squared.css-grid",FLEXBOX:"squared.flexbox",GRID:"squared.grid",LIST:"squared.list",RELATIVE:"squared.relative",SPRITE:"squared.sprite",TABLE:"squared.table",VERTICAL_ALIGN:"squared.verticalalign",WHITESPACE:"squared.whitespace"};var Et,St,wt,kt=Object.freeze({__proto__:null,CSS_SPACING:yt,EXT_NAME:vt});!function(e){e[e.DOM_TRAVERSE=2]="DOM_TRAVERSE",e[e.EXTENSION=4]="EXTENSION",e[e.RENDER=8]="RENDER",e[e.ALL=14]="ALL"}(Et||(Et={})),function(e){e[e.BOX_STYLE=2]="BOX_STYLE",e[e.BOX_SPACING=4]="BOX_SPACING",e[e.FONT_STYLE=8]="FONT_STYLE",e[e.VALUE_STRING=16]="VALUE_STRING",e[e.IMAGE_SOURCE=32]="IMAGE_SOURCE",e[e.ASSET=56]="ASSET",e[e.ALL=126]="ALL"}(St||(St={})),function(e){e[e.CONSTRAINT=2]="CONSTRAINT",e[e.LAYOUT=4]="LAYOUT",e[e.ALIGNMENT=8]="ALIGNMENT",e[e.ACCESSIBILITY=16]="ACCESSIBILITY",e[e.LOCALIZATION=32]="LOCALIZATION",e[e.CUSTOMIZATION=64]="CUSTOMIZATION",e[e.ALL=126]="ALL"}(wt||(wt={}));var _t=Object.freeze({__proto__:null,get APP_SECTION(){return Et},get NODE_RESOURCE(){return St},get NODE_PROCEDURE(){return wt}});const Ct=squared.lib,{BOX_MARGIN:Tt,BOX_PADDING:At,BOX_POSITION:It}=Ct.css,{isTextNode:Rt}=Ct.dom,{equal:Pt}=Ct.math,{getElementAsNode:Mt}=Ct.session,{capitalize:Nt,cloneObject:Bt,convertWord:Lt,hasBit:Wt,hasKeys:Ft,isArray:Ot,iterateArray:Dt,safeNestedMap:Ut,searchObject:Ht,withinRange:Xt}=Ct.util,{XML:Vt}=Ct.regex,zt=Array.from(yt.keys()),Gt=["position","display","verticalAlign","float","clear","zIndex"];function jt(e,t,i,s,n){let a=i[e+n]||i[e]||"",r=0;const l=s[e+"Child"+n]||s[e+"Child"];if(l)a+=(""!==a?"|":"")+l;if(""!==a)a.split("|").forEach(e=>{const i=t[e.trim().toUpperCase()]||0;if(i>0&&!Wt(r,i))r|=i});return r}function qt(e,t,i,s){let n,a,r,l;if(s)({floating:n,pageFlow:a,lineBreak:r,excluded:l}=s);const o=[];while(e){const s=Mt(e,i);if(s)if(false!==r&&s.lineBreak||false!==l&&s.excluded&&!s.lineBreak)o.push(s);else if(s.pageFlow&&!s.excluded){if(false===a)break;if(o.push(s),false!==n||!s.floating&&(s.visible||s.rendered)&&"none"!==s.display)break}e=e[t]}return o}function Yt(){return this.naturalElements.length>0&&!this.layoutElement&&!this.tableElement}function $t(){return this.blockVertical||this.percentWidth>0}function Kt(e){return this.blockDimension&&Math.ceil(this.bounds.top)>=e.bounds.bottom&&($t.call(this)||$t.call(e))}function Qt(){return this.inlineDimension&&!this.hasPX("maxWidth")?this.percentWidth:-1/0}function Jt(){return this.actualWidth+Math.max(this.marginLeft,0)+this.marginRight}function Zt(e){const t=this.dataset;return t[e+Nt(this.localSettings.systemName)]||t[e]}function ei(e,t,i,s,n){for(let a=0;a<4;++a){const r=zt[a+s];if(Wt(i,r)){const i=t[a];if(e[i]=1,n){const e=this.registerBox(r);if(e)e.resetBox(r,n);else{if(this.naturalChild){const e=this[i];if(e>=0)n.modifyBox(r,e)}this.transferBox(r,n)}}}}}function ti(e,t,i,s,n){for(let a=0;a<4;++a){const r=zt[a+s];if(Wt(i,r)){const i=this.registerBox(r);if(i)i.transferBox(r,n);else{const i=t[a],s=e[i];if(0!==s)n.modifyBox(r,s,false),e[i]=0;this.registerBox(r,n)}}}}class NodeUI extends Node{constructor(){super(...arguments),this.alignmentType=0,this.rendered=false,this.excluded=false,this.originalRoot=false,this.floatContainer=false,this.lineBreakLeading=false,this.lineBreakTrailing=false,this.baselineActive=false,this.baselineAltered=false,this._boxRegister={},this._preferInitial=true,this._excludeSection=0,this._excludeProcedure=0,this._excludeResource=0,this._childIndex=1/0,this._containerIndex=1/0,this._visible=true,this._renderAs=null,this._locked={}}static refitScreen(e,t){const{width:i,height:s}=e.localSettings.screenDimension;let{width:n,height:a}=t;if(n>i)a=Math.round(a*i/n),n=i;else if(a>s)n=Math.round(n*s/a),a=s;else return t;return{width:n,height:a}}static outerRegion(e){let t,i,s,n,a=1/0,r=-1/0,l=-1/0,o=1/0,c=-1/0,h=-1/0;return e.each(e=>{if(e.companion)t=e.actualRect("top"),i=e.actualRect("right"),s=e.actualRect("bottom"),n=e.actualRect("left");else{if(({top:t,right:i,bottom:s,left:n}=e.linear),e.marginRight<0){const t=i+Math.abs(e.marginRight);if(t>c)c=t}if(e.marginBottom<0){const t=s+Math.abs(e.marginBottom);if(t>h)h=t}}if(t<a)a=t;if(i>r)r=i;if(s>l)l=s;if(n<o)o=n}),{top:a,right:r,bottom:l,left:o,width:Math.max(r,c)-o,height:Math.max(l,h)-a}}static baseline(e,t=false){const i=[],s=e.length;let n=0;while(n<s){const s=e[n++];if(s.baseline&&(!t||s.textElement)&&!s.baselineAltered)if(s.naturalElements.length){if(s.baselineElement)i.push(s)}else i.push(s)}if(i.length>1)i.sort((e,t)=>{if(e.length&&0===t.length)return 1;else if(t.length&&0===e.length)return-1;const i=e.baselineHeight+e.marginBottom,s=t.baselineHeight+t.marginBottom;if(!Pt(i,s))return i>s?-1:1;else if(e.textElement&&t.textElement){if(!e.pseudoElement&&t.pseudoElement)return-1;else if(e.pseudoElement&&!t.pseudoElement)return 1;else if(!e.plainText&&t.plainText)return-1;else if(e.plainText&&!t.plainText)return 1}else if(e.inputElement&&t.inputElement&&e.containerType!==t.containerType)return e.containerType>t.containerType?-1:1;else if(t.textElement&&e.inputElement&&t.childIndex<e.childIndex)return 1;else if(e.textElement&&t.inputElement&&e.childIndex<t.childIndex)return-1;const n=e.bounds.bottom,a=t.bounds.bottom;if(n>a)return-1;else if(n<a)return 1;return 0});return i[0]||null}static linearData(e,t){const i=new Set;let s=false,n=false;const a=e.length;if(a>1){const r=new Array(a);let l=0,o=0;while(l<a){const t=e[l++];if(t.pageFlow){if(t.floating)i.add(t.float);r[o++]=t}else if(t.autoPosition)r[o++]=t}if(o){r.length=o;const e=[r[0]];let a=1,c=1;l=1;while(l<o){const i=r[l++];if(i.alignedVertically(e,t)>0)++c;else++a;if(a>1&&c>1)break;e.push(i)}if(s=a===o,n=c===o,s&&i.size){let e=1/0,t=-1/0,i=-1/0,n=1/0;l=0;while(l<o){const s=r[l++],{left:a,right:o}=s.linear;switch(e=Math.min(e,a),t=Math.max(t,o),s.float){case"left":i=Math.max(i,o);break;case"right":n=Math.min(n,a);break}}let a=0,c=0,h=0,d=0;for(l=0;l<o;++l){const o=r[l],{left:u,right:f}=o.linear;if(Math.floor(u)<=e)++a;if(Math.ceil(f)>=t)++c;if(!o.floating){if(u===i)++h;if(f===n)++d}if(0===l)continue;if(2===a||2===c||2===h||2===d){s=false;break}const g=r[l-1];if(Xt(u,g.linear.left)||g.floating&&Math.ceil(o.bounds.top)>=g.bounds.bottom){s=false;break}}}}}else if(a)n=e[0].blockStatic,s=!n;return{linearX:s,linearY:n,floated:i,cleared:t}}static partitionRows(e,t){const i=[];let s=[],n=[];const a=e.length;let r=0;while(r<a){const a=e[r++];let l=a;if(!a.naturalChild){if(a.nodeGroup){if(s.length)i.push(s);i.push([a]),s=[],n.length=0;continue}const e=a.innerMostWrapped;if(e!==a)l=e}if(0===s.length)s.push(a),n.push(l);else if(l.alignedVertically(n,t)>0){if(s.length)i.push(s);s=[a],n=[l]}else s.push(a),n.push(l)}if(s.length)i.push(s);return i}is(e){return this.containerType===e}of(e,...t){return this.is(e)&&t.some(e=>this.hasAlign(e))}attr(e,t,i,s=true){let n=this["__"+e];if(i){if(!n){if(!this._namespaces.includes(e))this._namespaces.push(e);n={},this["__"+e]=n}if(s&&this.lockedAttr(e,t))s=false;if(!s&&n[t])i=n[t];else n[t]=i;return i}else return(null==n?void 0:n[t])||""}unsafe(e,t){if(void 0!==t)this["_"+e]=t;else return this["_"+e]}unset(e){delete this["_"+e]}namespace(e){return this["__"+e]||{}}delete(e,...t){const i=this["__"+e];if(i)t.forEach(e=>{if(e.includes("*"))for(const[t]of Ht(i,e))delete i[t];else delete i[e]})}lockAttr(e,t){Ut(this._locked,e)[t]=true}unlockAttr(e,t){const i=this._locked[e];if(i)i[t]=false}lockedAttr(e,t){var i;return true===(null===(i=this._locked[e])||void 0===i?void 0:i[t])}render(e){this.renderParent=e,this.rendered=true}parseUnit(e,t="width",i=true,s){return super.parseUnit(e,t,i,s||this.localSettings.screenDimension)}parseWidth(e,t=true){return super.parseUnit(e,"width",t,this.localSettings.screenDimension)}parseHeight(e,t=true){return super.parseUnit(e,"height",t,this.localSettings.screenDimension)}renderEach(e){const t=this.renderChildren,i=t.length;let s=0;while(s<i)e(t[s],s++,t);return this}hide(e){if(null==e?void 0:e.remove)this.removeTry(e);this.rendered=true,this.visible=false}inherit(e,...t){t.forEach(t=>{switch(t){case"base":{if(this._documentParent=e.documentParent,this._bounds=e.bounds,this._linear=e.linear,this._box=e.box,-1===this.depth)this.depth=e.depth;const t=e.actualParent;if(t)this.actualParent=t,this.dir=t.dir;break}case"initial":Bt(e.unsafe("initial"),this.initial);break;case"alignment":{const t=this._styleMap;if(Gt.forEach(i=>t[i]=e.css(i)),!this.positionStatic)It.forEach(i=>{if(e.hasPX(i))t[i]=e.css(i)});Object.assign(this.autoMargin,e.autoMargin),this.autoPosition=e.autoPosition;break}case"styleMap":this.cssCopyIfEmpty(e,...Object.keys(e.unsafe("styleMap")));break;case"textStyle":this.cssApply(e.textStyle),this.setCacheValue("fontSize",e.fontSize);break;case"boxStyle":{const{backgroundColor:t,backgroundImage:i}=e;this.cssApply(e.cssAsObject("backgroundRepeat","backgroundSize","backgroundPositionX","backgroundPositionY","backgroundClip","boxSizing","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius")),this.cssApply({backgroundColor:t,backgroundImage:i,border:"inherit",borderRadius:"inherit"}),this.unsetCache("borderTopWidth","borderBottomWidth","borderRightWidth","borderLeftWidth"),this.setCacheValue("backgroundColor",t),this.setCacheValue("backgroundImage",i),e.setCacheValue("backgroundColor",""),e.setCacheValue("backgroundImage",""),e.cssApply({backgroundColor:"rgba(0, 0, 0, 0)",backgroundImage:"none",border:"initial",borderRadius:"initial"});const s=e.visibleStyle;s.background=false,s.backgroundImage=false,s.backgroundRepeatX=false,s.backgroundRepeatY=false,s.backgroundColor=false,s.borderWidth=false;break}}})}addAlign(e){if(!this.hasAlign(e))this.alignmentType|=e}removeAlign(e){if(this.hasAlign(e))this.alignmentType^=e}hasAlign(e){return Wt(this.alignmentType,e)}hasResource(e){return!Wt(this._excludeResource,e)}hasProcedure(e){return!Wt(this._excludeProcedure,e)}hasSection(e){return!Wt(this._excludeSection,e)}exclude(e){const{resource:t,procedure:i,section:s}=e;if(t&&!Wt(this._excludeResource,t))this._excludeResource|=t;if(i&&!Wt(this._excludeProcedure,i))this._excludeProcedure|=i;if(s&&!Wt(this._excludeSection,s))this._excludeSection|=s}setExclusions(e){var t;if(this.naturalElement){const i=this._element,s=i.dataset,n=(null===(t=i.parentElement)||void 0===t?void 0:t.dataset)||{};if(Ft(s)||Ft(n))e=Nt(e||this.localSettings.systemName),this.exclude({resource:jt("excludeResource",St,s,n,e),procedure:jt("excludeProcedure",wt,s,n,e),section:jt("excludeSection",Et,s,n,e)})}}replaceTry(e){const{child:t,replaceWith:i}=e,s=this.children,n=s.length;for(let e=0;e<n;++e){const n=s[e];if(n===t||n===t.outerMostWrapper)return s[e]=i,i.parent=this,i.containerIndex=t.containerIndex,true}if(e.notFoundAppend)return i.parent=this,true;else return false}removeTry(e){var t,i;const s=this.renderParent;if(s){const{renderTemplates:n,renderChildren:a}=s;if(n){const r=a.findIndex(e=>e===this);if(-1!==r){const l=n[r];if(l.node===this){const o=null==e?void 0:e.replaceWith;if(o){const i=o.renderParent;if(i){const c=i.renderTemplates;if(c){const h=c.findIndex(e=>e.node===o);if(-1!==h){if(null===(t=e.beforeReplace)||void 0===t||t.call(this,o),a[r]=o,n[r]=c[h],c.splice(h,1),i.renderChildren.splice(h,1),o.renderParent=s,this.documentRoot)o.documentRoot=true,this.documentRoot=false;return o.depth=this.depth,this.renderParent=void 0,l}}}}else return null===(i=null==e?void 0:e.beforeReplace)||void 0===i||i.call(this,void 0),a.splice(r,1),this.renderParent=void 0,n.splice(r,1)[0]}}}}}sort(e){if(e)super.sort(e);else this.children.sort((e,t)=>e.containerIndex<t.containerIndex?-1:1);return this}alignedVertically(e,t,i){if(this.lineBreak)return 2;else if(this.autoPosition&&Ot(e))return e[e.length-1].blockStatic?1:0;else if(this.pageFlow){const s=this.floating;if(Ot(e)){const n=e[e.length-1];if(t)if(t.size&&(t.has(this)||this.siblingsLeading.some(e=>e.excluded&&t.has(e))))return 4;else if(s&&n.floating){if(i&&this.float===n.float||Math.floor(this.bounds.top)===Math.floor(n.bounds.top))return 0;else if(Math.ceil(this.bounds.top)>=n.bounds.bottom){if(e.every(e=>e.inlineDimension)){const t=this.actualParent;if(t&&t.ascend({condition:e=>!e.inline&&e.hasWidth,error:e=>e.layoutElement,startSelf:true})){if(t.naturalChildren.filter(e=>e.visible&&e.pageFlow).length===e.length+1){let i=t.box.width-Jt.call(this);if(e.forEach(e=>i-=Jt.call(e)),i>=0)return 0}}}return 6}}else if(this.blockStatic&&e.reduce((e,t)=>e+(t.floating?t.linear.width:-1/0),0)/this.actualParent.box.width>=.8)return 7;else if(e.every(e=>e.inlineDimension&&Math.ceil(this.bounds.top)>=e.bounds.bottom))return 5;else if(void 0!==i)if(s&&!i&&n.blockStatic)return 0;else if(!this.display.startsWith("inline-")){let{top:s,bottom:n}=this.bounds;if(this.textElement&&t.size&&e.some(e=>t.has(e))&&e.some(e=>Math.floor(s)<e.bounds.top&&Math.ceil(n)>e.bounds.bottom))return 7;else if(e[0].floating)if(e.length>1){const t=e[0].float;let a=-1/0,r=0;if(e.forEach(e=>{if(e.floating){if(e.float===t)a=Math.max(e.actualRect("bottom","bounds"),a);r+=e.linear.width}}),Math.ceil(r)>=this.actualParent.box.width)return 5;else if(this.multiline){if(this.styleText){const e=this.textBounds;if(e)n=e.bottom}const e=n-a;s=e<=0||e/(n-s)<.5?-1/0:1/0}else s=Math.ceil(s);if(s<Math.floor(a))return i?0:5;else return i?5:0}else if(!i)return 5}if(Kt.call(this,n))return 3;else{const t=Qt.call(this);if(t>0&&e.reduce((e,t)=>e+Qt.call(t),t)>1)return 8}}for(const n of this.siblingsLeading){if(n.lineBreak)return 2;else if(n.blockStatic||n.autoMargin.leftRight||(s&&0===n.childIndex||false===i)&&n.plainText&&n.multiline)return 1;else if((this.blockStatic||"table"===this.display)&&(!n.floating||(null==t?void 0:t.has(n))))return 1;else if(n.floating){if("left"===n.float){if(this.autoMargin.right)return 5}else if(this.autoMargin.left)return 5;if(this.floatContainer&&this.some(e=>e.floating&&Math.ceil(e.bounds.top)>=n.bounds.bottom))return 5}if((null==t?void 0:t.has(n))&&!((null==e?void 0:e[0])===n))return 4;else if(Kt.call(this,n))return 3}}else return 1;return 0}previousSiblings(e){var t,i,s;return qt(this.nodeGroup?null===(i=null===(t=this.firstChild)||void 0===t?void 0:t.element)||void 0===i?void 0:i.previousSibling:null===(s=this.innerMostWrapped.element)||void 0===s?void 0:s.previousSibling,"previousSibling",this.sessionId,e)}nextSiblings(e){var t,i,s;return qt(this.nodeGroup?null===(i=null===(t=this.firstChild)||void 0===t?void 0:t.element)||void 0===i?void 0:i.nextSibling:null===(s=this.innerMostWrapped.element)||void 0===s?void 0:s.nextSibling,"nextSibling",this.sessionId,e)}modifyBox(e,t,i=true){if(0!==t){const s=yt.get(e);if(s){const n=this._boxRegister[e];if(void 0===t)if(n){const t=this[s]||n.getBox(e)[1];if(t>0)n.modifyBox(e,-t,i)}else this._boxReset[s]=1;else if(n)n.modifyBox(e,t,i);else{const e=this._boxAdjustment;if(!i&&(0===this._boxReset[s]?this[s]:0)+e[s]+t<=0){if(e[s]=0,this[s]>=0&&t<0)this._boxReset[s]=1}else e[s]+=t}}}}getBox(e){const t=yt.get(e);return t?[this._boxReset[t],this._boxAdjustment[t]]:[NaN,0]}setBox(e,t){const i=yt.get(e);if(i){const s=this._boxRegister[e];if(s)s.setBox(e,t);else{const{reset:e,adjustment:s}=t,n=this._boxReset,a=this._boxAdjustment;if(void 0!==e)n[i]=e;if(void 0!==s){let e=a[i];if(t.accumulate)e+=s;else e=s;if(false===t.negative&&(0===n[i]?this[i]:0)+e<=0)if(e=0,this[i]>=0&&e<0)n[i]=1;a[i]=e}else if(1===e&&!this.naturalChild)a[i]=0}}}resetBox(e,t){if(Wt(30,e))ei.call(this,this._boxReset,Tt,e,0,t);if(Wt(480,e))ei.call(this,this._boxReset,At,e,4,t)}transferBox(e,t){if(Wt(30,e))ti.call(this,this._boxAdjustment,Tt,e,0,t);if(Wt(480,e))ti.call(this,this._boxAdjustment,At,e,4,t)}registerBox(e,t){const i=this._boxRegister;if(t)i[e]=t;else t=i[e];while(t){const i=t.unsafe("boxRegister")[e];if(i)t=i;else break}return t}actualPadding(e,t){if(t>0){if(!this.layoutElement){const i=this.innerMostWrapped;if(i!==this)if(i.naturalChild){if(0===i.getBox("paddingTop"===e?32:128)[0])return 0}else return t;if(i.naturalChild)return Yt.call(i)&&function e(t,i,s){let n=false;const a=t.length;let r=0;while(r<a){const a=t[r++];if(a.blockStatic)return false;else if(a.inlineStatic)if(a.has("lineHeight")&&a.lineHeight>a.bounds.height)return false;else if(a[i]>=s)n=true;else if(Yt.call(a))if(!e(a.naturalChildren,i,s))return false;else n=true}return n}(i.naturalChildren,e,t)?0:t}else if(this.gridElement)switch(this.css("alignContent")){case"space-around":case"space-evenly":return 0}return t}return 0}actualBoxWidth(e){if(!e)e=this.box.width;if(this.pageFlow&&!this.documentRoot){let t=0,i=0,s=this.actualParent;while(s){if(s.hasPX("width",false)||!s.pageFlow)return e;else t+=Math.max(s.marginLeft,0)+s.borderLeftWidth+s.paddingLeft,i+=s.paddingRight+s.borderRightWidth+s.marginRight;if(s.documentRoot)break;else s=s.actualParent}const n=this.localSettings.screenDimension.width-t-i;if(n>0)return Math.min(e,n)}return e}cloneBase(e){if(e.localSettings=this.localSettings,e.alignmentType=this.alignmentType,e.containerName=this.containerName,e.depth=this.depth,e.visible=this.visible,e.excluded=this.excluded,e.rendered=this.rendered,e.childIndex=this.childIndex,e.containerIndex=this.containerIndex,e.inlineText=this.inlineText,e.lineBreakLeading=this.lineBreakLeading,e.lineBreakTrailing=this.lineBreakTrailing,e.actualParent=this.actualParent,e.documentParent=this.documentParent,e.documentRoot=this.documentRoot,e.renderParent=this.renderParent,this.length)e.retain(this.duplicate());e.inherit(this,"initial","base","alignment","styleMap","textStyle"),Object.assign(e.unsafe("cached"),this._cached)}unsetCache(...e){if(e.length){const t=this._cached;e.forEach(e=>{switch(e){case"top":case"right":case"bottom":case"left":t.autoPosition=void 0,t.positiveAxis=void 0;break;case"fontSize":case"lineHeight":t.baselineHeight=void 0;break;case"whiteSpace":t.preserveWhiteSpace=void 0,t.textEmpty=void 0;break}})}super.unsetCache(...e)}css(e,t,i=false){if(arguments.length>=2){if(t)this._styleMap[e]=t;else delete this._styleMap[e];if(i)this.unsetCache(e)}return this._styleMap[e]||this.styleElement&&this.style[e]||""}cssApply(e,t=false){if(Object.assign(this._styleMap,e),t)this.unsetCache(...Object.keys(e));return this}cssSet(e,t,i=true){return super.css(e,t,i)}setCacheValue(e,t){this._cached[e]=t}get element(){return this._element||!!this.innerWrapped&&this.innerMostWrapped.unsafe("element")||null}set naturalChild(e){this._cached.naturalChild=e}get naturalChild(){var e;let t=this._cached.naturalChild;if(void 0===t)t=!!(null===(e=this._element)||void 0===e?void 0:e.parentElement),this._cached.naturalChild=t;return t}get pseudoElement(){var e;return"__squared.pseudo"===(null===(e=this._element)||void 0===e?void 0:e.className)}get layoutElement(){let e=this._cached.layoutElement;if(void 0===e)e=this.flexElement||this.gridElement,this._cached.layoutElement=e;return e}set documentParent(e){this._documentParent=e}get documentParent(){return this._documentParent||this.absoluteParent||this.actualParent||this.parent||this}set containerName(e){this._cached.containerName=e.toUpperCase()}get containerName(){let e=this._cached.containerName;if(void 0===e){const t=this.element;if(t)if(Rt(t))e="PLAINTEXT";else if("INPUT"===t.tagName)e="INPUT_"+Lt(t.type,true).toUpperCase();else e=t.tagName.toUpperCase();else e="";this._cached.containerName=e}return e}get layoutHorizontal(){return this.hasAlign(8)}get layoutVertical(){if(this.hasAlign(16))return true;else if(this.naturalChild){const e=this.naturalChildren;return 1===e.length&&e[0].blockStatic}return false}get nodeGroup(){return false}set renderAs(e){if(!this.rendered&&false===(null==e?void 0:e.rendered))this._renderAs=e}get renderAs(){return this._renderAs}get blockStatic(){return super.blockStatic||this.hasAlign(64)&&this.pageFlow&&!this.floating}get rightAligned(){return super.rightAligned||this.hasAlign(2048)}set autoPosition(e){this._cached.autoPosition=e}get autoPosition(){let e=this._cached.autoPosition;if(void 0===e){if(this.pageFlow)e=false;else{const{top:t,right:i,bottom:s,left:n}=this._styleMap;e=!(t&&"auto"!==t||n&&"auto"!==n||i&&"auto"!==i||s&&"auto"!==s)}this._cached.autoPosition=e}return e}set textContent(e){this._cached.textContent=e}get textContent(){return super.textContent}get positiveAxis(){let e=this._cached.positiveAxis;if(void 0===e)e=(!this.positionRelative||this.positionRelative&&this.top>=0&&this.left>=0&&(this.right<=0||this.hasPX("left"))&&(this.bottom<=0||this.hasPX("top")))&&this.marginTop>=0&&this.marginLeft>=0&&this.marginRight>=0,this._cached.positiveAxis=e;return e}get leftTopAxis(){let e=this._cached.leftTopAxis;if(void 0===e){switch(this.cssInitial("position")){case"absolute":e=this.absoluteParent===this.documentParent;break;case"fixed":e=true;break;default:e=false;break}this._cached.leftTopAxis=e}return e}get baselineElement(){let e=this._cached.baselineElement;if(void 0===e){if(this.baseline){const t=this.naturalChildren;if(t.length)e=t.every(e=>e.baselineElement&&0===e.length);else e=this.inlineText&&this.textElement||this.plainText&&!this.multiline||this.inputElement||this.imageElement||this.svgElement}else e=false;this._cached.baselineElement=e}return e}set multiline(e){this._cached.multiline=e,this._cached.baselineElement=void 0}get multiline(){return super.multiline}set visible(e){this._visible=e}get visible(){return this._visible}set controlName(e){if(!this.rendered||!this._controlName)this._controlName=e}get controlName(){return this._controlName||""}set actualParent(e){this._cached.actualParent=e}get actualParent(){let e=this._cached.actualParent;if(void 0===e){if(e=super.actualParent,null===e)e=this.innerMostWrapped.actualParent;this._cached.actualParent=e}return e}set siblingsLeading(e){this._siblingsLeading=e}get siblingsLeading(){return this._siblingsLeading||this.previousSiblings()}set siblingsTrailing(e){this._siblingsTrailing=e}get siblingsTrailing(){return this._siblingsTrailing||this.nextSiblings()}get previousSibling(){const e=this.actualParent;if(e){const t=e.naturalChildren,i=t.indexOf(this);if(-1!==i){let e=i-1;while(e>=0){const i=t[e--];if(i&&(!i.excluded||i.lineBreak))return i}}}return null}get nextSibling(){const e=this.actualParent;if(e){const t=e.naturalChildren,i=t.indexOf(this);if(-1!==i){const e=t.length;let s=i+1;while(s<e){const e=t[s++];if(e&&(!e.excluded||e.lineBreak))return e}}}return null}get firstChild(){return this.naturalChildren[0]||null}get lastChild(){const e=this.naturalChildren;return e[e.length-1]||null}get onlyChild(){var e,t,i;return 1===(null!==(t=null===(e=this.renderParent)||void 0===e?void 0:e.renderChildren.length)&&void 0!==t?t:null===(i=this.parent)||void 0===i?void 0:i.length)&&!this.documentRoot}set childIndex(e){this._childIndex=e}get childIndex(){let e=this._childIndex;if(e===1/0){let t=this.innerWrapped;if(t)do{const i=t.childIndex;if(i!==1/0){e=i,this._childIndex=e;break}t=t.innerWrapped}while(t);else{const t=this._element;if(t){const i=t.parentElement;if(i)Dt(i.childNodes,(i,s)=>{if(i===t)return e=s,this._childIndex=s,true})}}}return e}set containerIndex(e){this._containerIndex=e}get containerIndex(){let e=this._containerIndex;if(e===1/0){let t=this.innerWrapped;while(t){const i=t.containerIndex;if(i!==1/0){e=i,this._containerIndex=e;break}t=t.innerWrapped}}return e}get textEmpty(){let e=this._cached.textEmpty;if(void 0===e){if(this.styleElement&&!this.imageElement&&!this.svgElement){const t=this.textContent;e=""===t||!this.preserveWhiteSpace&&""===t.trim()}else e=false;this._cached.textEmpty=e}return e}get innerMostWrapped(){if(this.naturalChild)return this;let e=this.innerWrapped;while(e){const t=e.innerWrapped;if(t)e=t;else break}return e||this}get outerMostWrapper(){let e=this.outerWrapper;while(e){const t=e.outerWrapper;if(t)e=t;else break}return e||this}get preserveWhiteSpace(){let e=this._cached.preserveWhiteSpace;if(void 0===e){const t=this.css("whiteSpace");e="pre"===t||"pre-wrap"===t,this._cached.preserveWhiteSpace=e}return e}set use(e){const t=this.use;this.dataset["use"+Nt(this.localSettings.systemName)]=(t?t+", ":"")+e}get use(){return Zt.call(this,"use")}get extensions(){var e;let t=this._cached.extensions;if(void 0===t){const i=null===(e=this.use)||void 0===e?void 0:e.trim();t=i?i.split(Vt.SEPARATOR):[],this._cached.extensions=t}return t}}const{hasBit:ii}=squared.lib.util;class LayoutUI extends squared.lib.base.Container{constructor(e,t,i=0,s=0,n){super(n),this.parent=e,this.node=t,this.containerType=i,this.alignmentType=s,this.rowCount=0,this.columnCount=0,this.renderType=0,this.renderIndex=-1}static create(e){const{parent:t,node:i,containerType:s,alignmentType:n,children:a,itemCount:r,rowCount:l,columnCount:o}=e,c=new LayoutUI(t,i,s,n,a);if(r)c.itemCount=r;if(l)c.rowCount=l;if(o)c.columnCount=o;return c}init(){const e=this.length;if(e>1){const e=NodeUI.linearData(this.children);this._floated=e.floated,this._linearX=e.linearX,this._linearY=e.linearY}else if(e)this._linearY=this.item(0).blockStatic,this._linearX=!this._linearY;else return;this._initialized=true}setContainerType(e,t){if(this.containerType=e,t)this.add(t)}hasAlign(e){return ii(this.alignmentType,e)}add(e){if(!ii(this.alignmentType,e))this.alignmentType|=e;return this.alignmentType}addRender(e){if(!ii(this.renderType,e))this.renderType|=e;return this.renderType}delete(e){if(ii(this.alignmentType,e))this.alignmentType^=e;return this.alignmentType}retain(e){return super.retain(e),this.init(),this}set itemCount(e){this._itemCount=e}get itemCount(){var e;return null!==(e=this._itemCount)&&void 0!==e?e:this.length}set type(e){this.setContainerType(e.containerType,e.alignmentType);const t=e.renderType;if(t)this.addRender(t)}get linearX(){var e;if(!this._initialized)this.init();return null!==(e=this._linearX)&&void 0!==e?e:true}get linearY(){var e;if(!this._initialized)this.init();return null!==(e=this._linearY)&&void 0!==e?e:false}get floated(){if(!this._initialized)this.init();return this._floated||new Set}get singleRowAligned(){let e=this._singleRow;if(void 0===e){const t=this.children,i=t.length;if(i){if(e=true,i>1){let s=1/0,n=0;while(n<i){const i=t[n++];if(i.blockStatic||i.multiline||Math.ceil(i.bounds.top)>=s){e=false;break}s=i.bounds.bottom}}this._singleRow=e}else return false}return e}get unknownAligned(){return this.length>1&&!this.linearX&&!this.linearY}}const si=squared.lib,{BOX_POSITION:ni,TEXT_STYLE:ai,convertListStyle:ri,formatPX:li,getStyle:oi,insertStyleSheetRule:ci,resolveURL:hi}=si.css,{getNamedItem:di,isTextNode:ui,removeElementsByClassName:fi}=si.dom,{maxArray:gi}=si.math,{appendSeparator:pi,capitalize:mi,convertFloat:bi,convertWord:xi,flatArray:yi,hasBit:vi,hasMimeType:Ei,isString:Si,iterateArray:wi,partitionArray:ki,safeNestedArray:_i,safeNestedMap:Ci,trimBoth:Ti,trimString:Ai}=si.util,{XML:Ii}=si.regex,{getElementCache:Ri,getPseudoElt:Pi,setElementCache:Mi}=si.session,{isPlainText:Ni}=si.xml,Bi=/\s*(?:attr\(([^)]+)\)|(counter)\(([^,)]+)(?:,\s+([a-z-]+))?\)|(counters)\(([^,]+),\s+"([^"]*)"(?:,\s+([a-z-]+))?\)|"([^"]+)")\s*/g;function Li(e,t,i,s,n,a){Ci(e,i)[s]=a,t.style.setProperty(s,n)}function Wi(e,t,i=1){if("none"!==e){const s=/\s*([^\-\d][^\-\d]?[^\s]*)\s+(-?\d+)\s*/g;let n;while(null!==(n=s.exec(e)))if(n[1]===t)return parseInt(n[2]);return i}}function Fi(e,t,i,s,n){var a;const r=null===(a=Ri(e,"styleMap"+i,s))||void 0===a?void 0:a.counterIncrement;return r&&Wi(r,t,n)}function Oi(e,t,i){if(i.length)return false;else return t.push(e),true}function Di(e,t,i){if(t.length)return false;else return i.push(e),true}function Ui(e,t){if(e){const i=e.split(Ii.SEPARATOR),s=[],n=[];if(t.forEach(e=>{const t=i.indexOf(e.name);if(-1!==t)s[t]=e;else n.push(e)}),s.length)return yi(s).concat(n)}return t}function Hi(e,t,i){if((t||0===bi(e.width))&&0===bi(e.height)){for(const t in e)if(/(padding|Width|Height)/.test(t)&&bi(e[t])>0)return true;else if(!i&&t.startsWith("margin")&&0!==bi(e[t]))return true;return false}return true}const Xi=e=>!e.blockStatic&&true!==e.autoMargin.horizontal&&!(e.blockDimension&&"100%"===e.css("width"))&&(!(e.plainText&&e.multiline)||e.floating),Vi=e=>e.textElement&&(e.blockStatic||e.multiline),zi=(e,t)=>e.positionRelative?e.hasPX("left")?e.left*(t?1:-1):e.right*(t?-1:1):0,Gi=e=>e.ascend({condition:e=>!!e.use}).length>0,ji=(e,t,i,s)=>{var n;return(null===(n=e.get(t))||void 0===n?void 0:n.set(i,s))||e.set(t,new Map([[i,s]]))},qi=e=>-1*e-2;const Yi=squared.lib,{USER_AGENT:$i,isUserAgent:Ki,isWinEdge:Qi}=Yi.client,{BOX_BORDER:Ji,BOX_PADDING:Zi,formatPX:es,getStyle:ts,isLength:is,isPercent:ss}=Yi.css,{isTextNode:ns,withinViewport:as}=Yi.dom,{capitalize:rs,convertFloat:ls,flatArray:os,isString:cs,iterateArray:hs,safeNestedArray:ds}=Yi.util,{actualClientRect:us,getElementCache:fs,setElementCache:gs}=Yi.session,{pushIndent:ps,pushIndentArray:ms}=Yi.xml;function bs(e){switch(e.getPropertyValue("position")){case"absolute":case"fixed":return true}return false}function xs(e,t){if(!cs(e.border)&&!(Ji[0][0]in e||Ji[1][0]in e||Ji[2][0]in e||Ji[3][0]in e)){e.border="outset 1px "+t;for(let i=0;i<4;++i){const s=Ji[i];e[s[0]]="outset",e[s[1]]="1px",e[s[2]]=t}return true}return false}function ys(e,t,i){if(t){const t=e.backgroundColor;if(!cs(t)||"initial"===t)e.backgroundColor=i}if(!cs(e.textAlign))e.textAlign="center";if(!cs(e.padding)&&!Zi.some(t=>!!e[t]))e.paddingTop="2px",e.paddingRight="6px",e.paddingBottom="3px",e.paddingLeft="6px"}const vs=(e,t)=>parseInt(e.getPropertyValue(t));const{capitalize:Es,includes:Ss}=squared.lib.util;class ExtensionUI extends Extension{constructor(e,t,i,s=[]){super(e,t,i),this.eventOnly=false,this.documentBase=false,this.cascadeAll=false,this.removeIs=false,this.tagNames=s,this._isAll=0===s.length}static findNestedElement(e,t){if(e.styleElement){const i=Es(e.localSettings.systemName),s=e.element.children,n=s.length;let a=0;while(a<n){const e=s[a++];if(Ss(e.dataset["use"+i]||e.dataset.use,t))return e}}return null}is(e){return this._isAll||this.tagNames.includes(e.tagName)}condition(e,t){return e.use?this.included(e.element):!this._isAll}included(e){return Ss(this.application.getDatasetName("use",e),this.name)}processNode(e,t){}processChild(e,t){}addDescendant(e){const t=this.application.session.extensionMap,i=e.id,s=t.get(i);if(s){if(!s.includes(this))s.push(this)}else t.set(i,[this])}postBaseLayout(e){}postConstraints(e){}postOptimize(e){}afterBaseLayout(){}afterConstraints(){}afterResources(){}beforeBaseLayout(){}beforeCascade(e){}afterFinalize(){}set application(e){this._application=e,this._controller=e.controllerHandler,this._resource=e.resourceHandler,this._cache=e.session.cache,this._cacheProcessing=e.processing.cache}get application(){return this._application}get controller(){return this._controller}get resource(){return this._resource}get cache(){return this._cache}get cacheProcessing(){return this._cacheProcessing}}const{isLength:ws}=squared.lib.css;const ks=squared.lib,{USER_AGENT:_s,isUserAgent:Cs}=ks.client,{parseColor:Ts}=ks.color,{BOX_BORDER:As,calculate:Is,convertAngle:Rs,formatPX:Ps,getBackgroundPosition:Ms,getInheritedStyle:Ns,isCalc:Bs,isLength:Ls,isParentStyle:Ws,isPercent:Fs,parseAngle:Os}=ks.css,{getNamedItem:Ds}=ks.dom,{cos:Us,equal:Hs,hypotenuse:Xs,offsetAngleX:Vs,offsetAngleY:zs,relativeAngle:Gs,sin:js,triangulate:qs,truncateFraction:Ys}=ks.math,{CHAR:$s,ESCAPE:Ks,STRING:Qs,XML:Js}=ks.regex,{getElementAsNode:Zs}=ks.session,{appendSeparator:en,convertCamelCase:tn,convertFloat:sn,hasValue:nn,isEqual:an,isNumber:rn,isString:ln,iterateArray:on,trimEnd:cn,trimStart:hn}=ks.util,{STRING_SPACE:dn,STRING_TABSPACE:un}=ks.xml,fn=`((?:rgb|hsl)a?\\(\\d+,\\s+\\d+%?,\\s+\\d+%?(?:,\\s+[\\d.]+)?\\)|#[A-Za-z\\d]{3,8}|[a-z]+)\\s*(${Qs.LENGTH_PERCENTAGE}|${Qs.CSS_ANGLE}|(?:${Qs.CSS_CALC}(?=,)|${Qs.CSS_CALC}))?,?\\s*`,gn=/\u00A0/g,pn=new RegExp(`(?:initial|url\\([^)]+\\)|(repeating-)?(linear|radial|conic)-gradient\\(((?:to\\s+[a-z\\s]+|(?:from\\s+)?-?[\\d.]+(?:deg|rad|turn|grad)|(?:circle|ellipse)?\\s*(?:closest-side|closest-corner|farthest-side|farthest-corner)?)?(?:\\s*(?:(?:-?[\\d.]+(?:[a-z%]+)?\\s*)+)?(?:at\\s+[\\w %]+)?)?),?\\s*((?:${fn})+)\\))`,"g"),mn=new RegExp(fn,"g"),bn=/\n([^\S\n]*)?$/;function xn(e,t,i){const{width:s,height:n}=t.dimension,a=[];let r,l=false,o=true,c=1;switch(t.type){case"linear":{const{repeating:e,angle:i}=t;switch(l=e,i){case 0:case 180:case 360:r=n,o=false;break;case 90:case 270:r=s;break;default:r=Math.abs(s*js(i-180))+Math.abs(n*Us(i-180)),o=s>=n;break}break}case"radial":{const{repeating:i,radiusExtent:s,radius:n}=t;o=e.actualWidth>=e.actualHeight,l=i,c=s/n,r=n;break}case"conic":r=Math.min(s,n);break;default:return a}let h,d=0;while(null!==(h=mn.exec(i))){const i=Ts(h[1],1,true);if(i){let s=-1;if("conic"===t.type){const e=h[3],t=h[4];if(e&&t)s=Rs(e,t)/360}else{const t=h[2];if(Fs(t))s=parseFloat(t)/100;else if(Ls(t))s=(o?e.parseWidth(t,false):e.parseHeight(t,false))/r;else if(Bs(t))if(s=Is(h[6],{boundingSize:r,fontSize:e.fontSize})/r,isNaN(s))s=-1;if(l&&-1!==s)s*=c}if(0===a.length)if(-1===s)s=0;else if(s>0)a.push({color:i,offset:0});if(-1!==s)s=Math.max(d,s),d=s;a.push({color:i,offset:s})}}const u=a.length,f=a[u-1];if(-1===f.offset)f.offset=1;let g=0;for(let e=0;e<u;++e){const t=a[e];if(-1===t.offset)if(0===e)t.offset=0;else{for(let i=e+1,s=2;i<u-1;++s){const e=a[i++];if(-1!==e.offset){t.offset=(g+e.offset)/s;break}}if(-1===t.offset)t.offset=g+f.offset/(u-1)}g=t.offset}if(l){if(g<100)e:{let e=g;const t=a.slice(0);while(g<100){let i=0;while(i<u){const s=t[i++];if(g=Math.min(e+s.offset,1),a.push(Object.assign(Object.assign({},s),{offset:g})),1===g)break e}e=g}}}else if(g<1)a.push(Object.assign(Object.assign({},a[u-1]),{offset:1}));return mn.lastIndex=0,a}function yn(e,t){var i,s,n;let a=false;switch(t=t.replace(gn,dn),e.css("whiteSpace")){case"nowrap":t=t.replace(/\n/g," "),a=true;break;case"pre":case"pre-wrap":{if(false===(null===(i=e.renderParent)||void 0===i?void 0:i.layoutVertical))t=t.replace(/^\s*\n/,"");const s=ResourceUI.checkPreIndent(e);if(s){const[e,i]=s;if(""!==e)i.textContent=e+i.textContent;t=t.replace(bn,"")}return[t=t.replace(/\n/g,"\\n").replace(/\t/g,un).replace(/\s/g,dn),true,false]}case"pre-line":return[t=t.replace(/\n/g,"\\n").replace(/\s+/g," "),true,false]}if(e.onlyChild&&e.htmlElement)t=t.replace($s.LEADINGSPACE,"").replace($s.TRAILINGSPACE,"");else{if(null===(s=e.previousSibling)||void 0===s?void 0:s.blockStatic)t=t.replace($s.LEADINGSPACE,"");if(null===(n=e.nextSibling)||void 0===n?void 0:n.blockStatic)t=t.replace($s.TRAILINGSPACE,"")}return[t,a,true]}function vn(e,t,i,s){if(i){const n=i.split(Js.SEPARATOR);return ResourceUI.getBackgroundSize(e,n[t%n.length],s)}}function En(e,t,i,s){const n=e.css(s[0])||"none";if("none"!==n){let a=Ps("outline"!==i?e[s[1]]:sn(e.style[s[1]]));if("0px"!==a){let r=e.css(s[2])||"initial";switch(r){case"initial":r="rgb(0, 0, 0)";break;case"inherit":case"currentcolor":case"currentColor":r=Ns(e.element,s[2]);break}if("2px"===a&&("inset"===n||"outset"===n))a="1px";if(r=Ts(r,1,true),r)t[i]={width:a,style:n,color:r}}}}function Sn(e,t,i){let s=e.css(i);if("initial"===s)s="backgroundClip"===i?"border-box":"padding-box";switch(s){case"border-box":return true;case"padding-box":t[i]={top:e.borderTopWidth,right:e.borderRightWidth,bottom:e.borderBottomWidth,left:e.borderLeftWidth};break;case"content-box":t[i]={top:e.borderTopWidth+e.paddingTop,right:e.borderRightWidth+e.paddingRight,bottom:e.borderBottomWidth+e.paddingBottom,left:e.borderLeftWidth+e.paddingLeft};break}return false}function wn(e,t=0){if(""!==(e=e.trim())){let t=Os(e);if(t<0)t+=360;return t}return t}const kn=e=>e.replace(/&/g,"&amp;"),_n=e=>ln(e)?e.includes("at ")?/(.+?)?\s*at (.+?)\s*$/.exec(e):[e,e]:null;class ResourceUI extends Resource{static isBackgroundVisible(e){return!!e&&("backgroundImage"in e||"borderTop"in e||"borderRight"in e||"borderBottom"in e||"borderLeft"in e)}static generateId(e,t,i=1){const s=t;let n=i;if(1===i)t+="_"+n;const a=this.ASSETS.ids,r=a.get(e)||[];do{if(!r.includes(t)){r.push(t);break}else t=s+"_"+ ++n}while(true);return a.set(e,r),t}static insertStoredAsset(e,t,i){const s=ResourceUI.STORED[e];if(s&&nn(i)){let n=function(e,t){const i=ResourceUI.STORED[e];if(i)for(const[e,s]of i.entries())if(an(t,s))return e;return""}(e,i);if(""===n){if(rn(t))t="__"+t;let e=0;do{if(n=t+(e>0?"_"+e:""),!s.has(n)){s.set(n,i);break}}while(++e)}return n}return""}static getOptionArray(e,t=false){let i=[],s=true;return on(e.children,e=>{if(!e.disabled||t)switch(e.tagName){case"OPTION":{const t=e.text.trim()||e.value.trim();if(""!==t){if(s&&!rn(t))s=false;i.push(t)}break}case"OPTGROUP":{const[n,a]=this.getOptionArray(e,t);if(n)i=i.concat(n),s=false;else if(a)i=i.concat(a);break}}}),s?[void 0,i]:[i]}static parseBackgroundImage(e,t,i){var s,n;if(""!==t){pn.lastIndex=0;const a=[];let r,l=0;while(null!==(r=pn.exec(t))){const t=r[0];if(t.startsWith("url(")||"initial"===t)a.push(t);else{const t=!!r[1],o=r[2],c=r[3],h=vn(e,l,e.css("backgroundSize"),i),d=NodeUI.refitScreen(e,h||e.actualDimension);let u;switch(o){case"linear":{const{width:i,height:s}=d;let n=180;switch(c){case"to top":n=360;break;case"to right top":n=45;break;case"to right":n=90;break;case"to right bottom":n=135;break;case"to bottom":break;case"to left bottom":n=225;break;case"to left":n=270;break;case"to left top":n=315;break;default:if(c)n=wn(c,180)||360;break}let a=Ys(Vs(n,i)),l=Ys(zs(n,s));if(a!==i&&l!==s&&!Hs(Math.abs(a),Math.abs(l))){let e;if(n<=90)e=Gs({x:0,y:s},{x:i,y:0});else if(n<=180)e=Gs({x:0,y:0},{x:i,y:s});else if(n<=270)e=Gs({x:0,y:0},{x:-i,y:s});else e=Gs({x:0,y:s},{x:-i,y:0});const t=Math.abs(e-n);a=Ys(Vs(n,qs(t,90-t,Xs(i,s))[1])),l=Ys(zs(n,qs(90,90-n,a)[0]))}const h={type:o,repeating:t,dimension:d,angle:n,angleExtent:{x:a,y:l}};h.colorStops=xn(e,h,r[4]),u=h;break}case"radial":{const a=_n(c),l=Ms((null==a?void 0:a[2])||"center",d,{fontSize:e.fontSize,imageDimension:h,screenDimension:i}),{left:f,top:g}=l,{width:p,height:m}=d;let b="ellipse",x=g,y=g,v=1/0,E=-1/0,S=0,w=0;if(a){const t=null===(s=a[1])||void 0===s?void 0:s.trim();if(t)if(t.startsWith("circle"))b="circle";else{let i=1/0;const s=t.split(" "),n=s.length;for(let t=0;t<n;++t)i=Math.min(0===t?e.parseWidth(s[t],false):e.parseHeight(s[t],false),i);if(S=i,w=i,1===n||s[0]===s[1])b="circle"}}[[0,0],[p,0],[p,m],[0,m]].forEach(e=>{const t=Math.round(Xs(Math.abs(e[0]-f),Math.abs(e[1]-g)));v=Math.min(t,v),E=Math.max(t,E)}),[p-f,m-g,f].forEach(e=>{x=Math.min(e,x),y=Math.max(e,y)});const k={type:o,repeating:t,dimension:d,shape:b,center:l,closestSide:x,farthestSide:y,closestCorner:v,farthestCorner:E};if(0===S&&0===w){S=E;const e=(null===(n=null==a?void 0:a[1])||void 0===n?void 0:n.split(" ").pop())||"";switch(e){case"closest-corner":case"closest-side":case"farthest-side":{const i=k[tn(e)];if(t)w=i;else S=i;break}default:w=E;break}}k.radius=S,k.radiusExtent=w,k.colorStops=xn(e,k,r[4]),u=k;break}case"conic":{const t=_n(c),s={type:o,dimension:d,angle:wn(c),center:Ms((null==t?void 0:t[2])||"center",d,{fontSize:e.fontSize,imageDimension:h,screenDimension:i})};s.colorStops=xn(e,s,r[4]),u=s;break}}a.push(u||"initial")}++l}if(a.length)return a}}static getBackgroundSize(e,t,i){let s=0,n=0;switch(t){case"":case"cover":case"contain":case"100% 100%":case"auto":case"auto auto":case"initial":return;default:{const a=t.split($s.SPACE);if(1===a.length)a[1]=a[0];a.forEach((t,a)=>{if("auto"===t)t="100%";switch(a){case 0:s=e.parseUnit(t,"width",false,i);break;case 1:n=e.parseUnit(t,"height",false,i);break}});break}}return s>0&&n>0?{width:Math.round(s),height:Math.round(n)}:void 0}static hasLineBreak(e,t=false,i=false){if(e.naturalElements.length)return e.naturalElements.some(e=>e.lineBreak);else if(!t&&e.naturalChild){const t=e.element;let s=t.textContent;if(i)s=s.trim();return s.includes("\n")&&(e.plainText&&Ws(t,"whiteSpace","pre","pre-wrap")||e.css("whiteSpace").startsWith("pre"))}return false}static checkPreIndent(e){if(e.plainText){const t=e.actualParent;if((null==t?void 0:t.preserveWhiteSpace)&&t.ascend({condition:e=>"PRE"===e.tagName,startSelf:true}).length){let t=e.nextSibling;if(null==t?void 0:t.naturalElement){const i=e.textContent;if(""!==i.trim()){const e=bn.exec(i);if(e){if(!t.textElement)t=t.find(e=>e.naturalChild&&e.textElement,{cascade:true,error:e=>e.naturalChild&&!e.textElement&&0===e.length});if(t)return[e[1]?e[0]:"",t]}}}}}}finalize(e){}reset(){super.reset();const e=ResourceUI.STORED;for(const t in e)e[t].clear()}writeRawImage(e,t){const i=this.fileHandler;if(i){const s={pathname:en(this.userSettings.outputDirectory,this.controllerSettings.directory.image),filename:e,base64:t};return i.addAsset(s),s}}setBoxStyle(e){var t;if((e.styleElement||e.visibleStyle.background)&&e.hasResource(St.BOX_STYLE)){const i=e.cssAsObject("backgroundSize","backgroundRepeat","backgroundPositionX","backgroundPositionY");if(Sn(e,i,"backgroundClip"))Sn(e,i,"backgroundOrigin");if("0px"!==e.css("borderRadius")){const{borderTopLeftRadius:t,borderTopRightRadius:s,borderBottomRightRadius:n,borderBottomLeftRadius:a}=e.cssAsObject("borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"),[r,l]=t.split(" "),[o,c]=s.split(" "),[h,d]=n.split(" "),[u,f]=a.split(" "),g=!(l||c||d||f)?[r,o,h,u]:[r,l||r,o,c||o,h,d||h,u,f||u],p=e.actualWidth>=e.actualHeight,m=g[0];if(g.every(e=>e===m))g.length="0px"===m||""===m?0:1;const b=g.length;if(b){const t=p?"width":"height";let s=0;while(s<b)g[s]=Ps(e.parseUnit(g[s++],t,false));i.borderRadius=g}}if(e.visibleStyle.borderWidth){if(e.borderTopWidth>0)En(e,i,"borderTop",As[0]);if(e.borderRightWidth>0)En(e,i,"borderRight",As[1]);if(e.borderBottomWidth>0)En(e,i,"borderBottom",As[2]);if(e.borderLeftWidth>0)En(e,i,"borderLeft",As[3])}if(En(e,i,"outline",As[4]),e.hasResource(St.IMAGE_SOURCE))i.backgroundImage=ResourceUI.parseBackgroundImage(e,e.backgroundImage,e.localSettings.screenDimension);let s=e.backgroundColor;if(""===s&&e.has("backgroundColor")&&!e.documentParent.visible)s=e.css("backgroundColor");if(""!==s)i.backgroundColor=(null===(t=Ts(s))||void 0===t?void 0:t.valueAsRGBA)||"";e.data(ResourceUI.KEY_NAME,"boxStyle",i)}}setFontStyle(e){if((e.textElement||e.inlineText)&&(!e.textEmpty||e.visibleStyle.background||e.pseudoElement)||e.inputElement){const t=Ts(e.css("color"));let i=e.css("fontWeight");if(!rn(i))switch(i){case"lighter":i="200";break;case"bold":i="700";break;case"bolder":i="900";break;default:i="400";break}e.data(ResourceUI.KEY_NAME,"fontStyle",{fontFamily:e.css("fontFamily").trim(),fontStyle:e.css("fontStyle"),fontSize:e.fontSize,fontWeight:i,color:(null==t?void 0:t.valueAsRGBA)||""})}}setValueString(e){const t=e.element;if(t){let i="",s="",n="",a=true,r=false;switch(t.tagName){case"INPUT":switch(s=Ds(t,"value"),t.type){case"radio":case"checkbox":{const t=e.companion;if(false===(null==t?void 0:t.visible))s=t.textContent.trim();break}case"submit":if(""===s&&!e.visibleStyle.backgroundImage)s="Submit";break;case"reset":if(""===s&&!e.visibleStyle.backgroundImage)s="Reset";break;case"time":if(""===s)n="--:-- --";break;case"date":case"datetime-local":if(""===s){switch((new Intl.DateTimeFormat).resolvedOptions().locale){case"en-US":n="mm/dd/yyyy";break;default:n="dd/mm/yyyy";break}if("datetime-local"===t.type)n+=" --:-- --"}break;case"week":if(""===s)n="Week: --, ----";break;case"month":if(""===s)n="--------- ----";break;case"text":case"password":case"url":case"email":case"search":case"number":case"tel":if(""===s)n=t.placeholder;break;case"file":s=Cs(8)?"Browse...":"Choose File";break;case"color":{const t=this.controllerSettings.style.inputColorBorderColor,i=(Ts(s)||Ts("rgb(0, 0, 0)")).valueAsRGBA,{width:n,height:a}=e.actualDimension,r=`${n-10}px ${a-10}px, ${n-8}px ${a-8}px`,l="no-repeat, no-repeat",o="center, center",c="center, center",h=ResourceUI.parseBackgroundImage(e,`linear-gradient(${i}, ${i}), linear-gradient(${t}, ${t})`);s="";let d=e.data(ResourceUI.KEY_NAME,"boxStyle");if(d){const e=d.backgroundImage;if(e){d.backgroundSize=r+", "+d.backgroundSize,d.backgroundRepeat=l+", "+d.backgroundRepeat,d.backgroundPositionX=o+", "+d.backgroundPositionX,d.backgroundPositionY=c+", "+d.backgroundPositionY,e.unshift(...h);break}}else d={};e.data(ResourceUI.KEY_NAME,"boxStyle",Object.assign(d,{backgroundSize:r,backgroundRepeat:l,backgroundPositionX:o,backgroundPositionY:c,backgroundImage:h}));break}case"range":n=s,s="";break}break;case"TEXTAREA":s=t.value;break;case"IFRAME":s=t.src;break;default:{const n=e.textContent;if(e.plainText||e.pseudoElement)i=n.trim(),[s,r,a]=yn(e,kn(n)),r=true;else if(e.inlineText)i=n.trim(),[s,r,a]=yn(e,e.hasAlign(1024)?kn(n):this.removeExcludedFromText(e,t));else if(0===e.naturalChildren.length&&""===(null==n?void 0:n.trim())&&!e.hasPX("height")&&ResourceUI.isBackgroundVisible(e.data(ResourceUI.KEY_NAME,"boxStyle")))s=n;break}}if(""!==s){if(a&&e.pageFlow){const t=e.siblingsLeading[0];let i=false;if(s.length>1)if(!t||t.multiline||t.lineBreak||t.plainText&&$s.TRAILINGSPACE.test(t.textContent))s=s.replace($s.LEADINGSPACE,"");else if(t.naturalElement){const e=t.textContent,s=e.length;if(s)i=32===e.charCodeAt(s-1)}if(r){const n=!e.lineBreakTrailing&&$s.TRAILINGSPACE.test(s);if($s.LEADINGSPACE.test(s)&&false===(null==t?void 0:t.block)&&!t.lineBreak&&!i)s=dn+s.trim();else s=s.trim();if(n){const t=e.siblingsTrailing.find(e=>!e.excluded||e.lineBreak);if(false===(null==t?void 0:t.blockStatic))s+=dn}}else if(""!==s.trim())s=s.replace($s.LEADINGSPACE,t&&(t.block||t.lineBreak||i&&t.htmlElement&&t.textContent.length>1||e.multiline&&ResourceUI.hasLineBreak(e))?"":dn),s=s.replace($s.TRAILINGSPACE,"table-cell"===e.display||e.lineBreakTrailing||e.blockStatic?"":dn);else if(!e.inlineText)return}if(""!==s)e.data(ResourceUI.KEY_NAME,"valueString",{key:i,value:s})}if(""!==n)e.data(ResourceUI.KEY_NAME,"hintString",n)}else if(e.inlineText){const t=e.textContent;if(t)e.data(ResourceUI.KEY_NAME,"valueString",{key:t,value:t})}}removeExcludedFromText(e,t){const i=t.children.length>0||"CODE"===t.tagName,s=e.preserveWhiteSpace,n=i?"innerHTML":"textContent";let a=t[n]||"";if(""===a.trim())return s?a:dn;const r=e.sessionId;if(t.childNodes.forEach((e,t)=>{const l=Zs(e,r);if(null===l||!l.textElement||!l.pageFlow||l.positioned||l.pseudoElement||l.excluded){if(l)if(i&&l.htmlElement){const e=l.toElementString("outerHTML");if(l.lineBreak)a=a.replace(!s?new RegExp(`\\s*${e}\\s*`):e,"\\n");else if(l.positioned)a=a.replace(e,"");else if(!s)a=a.replace(e,l.pageFlow&&""!==l.textContent.trim()?dn:"");return}else{const e=l.plainText?l.textContent:l[n];if(ln(e)){if(!s)a=a.replace(e,"");return}}else if(e instanceof HTMLElement){const t=getComputedStyle(e).getPropertyValue("position");a=a.replace(e.outerHTML,"absolute"!==t&&"fixed"!==t&&""!==e.textContent.trim()?dn:"")}if(0===t)a=hn(a," ");else if(t===length-1)a=cn(a," ")}}),i)a=a.replace(/^\\n\\n/,"\\n").replace(/\\n\\n$/,"\\n").replace(Ks.ENTITY,(e,t)=>String.fromCharCode(parseInt(t)));return a}get controllerSettings(){return this.application.controllerHandler.localSettings}}ResourceUI.STORED={strings:new Map,arrays:new Map,fonts:new Map,colors:new Map,images:new Map};const Cn=squared.lib,{formatPercent:Tn,formatPX:An,isLength:In,isPercent:Rn}=Cn.css,{CHAR:Pn,CSS:Mn}=Cn.regex,{isNumber:Nn,safeNestedArray:Bn,trimString:Ln,withinRange:Wn}=Cn.util,Fn=vt.CSS_GRID,On="[\\d.]+[a-z%]+|auto|max-content|min-content",Dn="minmax\\(\\s*([^,]+),\\s+([^)]+)\\s*\\)",Un="fit-content\\(\\s*([\\d.]+[a-z%]+)\\s*\\)",Hn=new RegExp(`^${On}$`),Xn=new RegExp(`\\s*(repeat\\(\\s*(auto-fit|auto-fill|\\d+),\\s+(.+)\\)|\\[([\\w\\s\\-]+)\\]|${Dn}|${Un}|${On}\\s*)\\s*`,"g"),Vn=new RegExp(`\\s*(\\[([\\w\\s\\-]+)\\]|${Dn}|${Un}|${On})\\s*`,"g"),zn=new RegExp(On),Gn=new RegExp(Dn),jn=new RegExp(Un),qn=new RegExp("\\[([\\w\\s\\-]+)\\]"),Yn=/^([\w-]+)-(start|end)$/;function $n(e,t){const i=e.repeat,s=[],n=[],a=t.length;for(let e=0;e<a;++e)if(i[e])n.push(t[e]);else s.push(t[e]);const r=e.length,l=r-s.length,o=n.length,c=new Array(r);for(let e=0;e<r;++e)if(i[e]){for(let t=0,i=0;t<l;++e,++t,++i){if(i===o)i=0;c[e]=n[i]}--e}else c[e]=s.shift();return c}function Kn(e,t){const i=e.unit;if(1===i.length&&(e.autoFill||e.autoFit)){const s=e.unitMin;let n=0;if([i[0],s[0]].forEach(e=>{if(Rn(e))n=Math.max(parseFloat(e)/100*t,n);else if(In(e))n=Math.max(parseFloat(e),n)}),n>0)return e.length=Math.floor(t/(n+e.gap)),e.unit=$n(e,i),e.unitMin=$n(e,s),true}return false}function Qn(e,t,i,s,n){let a=0,r=0,l=1;const o=s.length;let c=0;while(c<o){const e=s[c++];if(Mn.PX.test(e))a+=parseFloat(e);else if(CssGrid.isFr(e))r+=parseFloat(e);else if(Rn(e))l-=parseFloat(e)/100}if(l<1&&r>0){const h=(e*l-(i-1)*t-n.reduce((e,t)=>e+Math.max(0,t),0)-a)/r;if(h>0)for(c=0;c<o;++c){const e=s[c];if(CssGrid.isFr(e))s[c]=An(parseFloat(e)*h)}}}function Jn(e,t){if(0===e.length){let i=0;while(i<t)e[i++]="1fr"}}function Zn(e,t,i){if(i){for(let s=0,n=-1,a=0;s<e;++s)if(0===i[s]){if(-1===n)n=s;if(++a===t)return n}else n=-1;return-1}return 0}function ea(e){const t=e.length;for(let i=0;i<t;++i)for(const t of e[i])if(0===t)return i;return Math.max(0,t-1)}const ta=(e,t,i)=>In(t)?An(e.parseUnit(t,0!==i?"width":"height")):t;class CssGrid extends ExtensionUI{static createDataAttribute(e){const t=e.gridAutoFlow;return Object.assign(e,{children:[],rowData:[],rowSpanMultiple:[],rowDirection:!t.includes("column"),dense:t.includes("dense"),templateAreas:{},row:CssGrid.createDataRowAttribute(),column:CssGrid.createDataRowAttribute(),emptyRows:[],minCellHeight:0})}static createDataRowAttribute(){return{length:0,gap:0,unit:[],unitMin:[],unitTotal:[],repeat:[],auto:[],autoFill:false,autoFit:false,name:{},fixedWidth:false,flexible:false,frTotal:0}}is(e){return e.gridElement}condition(e){return e.length>0}processNode(e){const t=CssGrid.createDataAttribute(e.cssAsObject("alignItems","alignContent","justifyItems","justifyContent","gridAutoFlow")),{column:i,dense:s,row:n,rowDirection:a}=t,[r,l,o,c]=a?[0,1,2,3]:[1,0,3,2],h=[],d=[],u=[];if(i.gap=e.parseWidth(e.css("columnGap"),false),n.gap=e.parseHeight(e.css("rowGap"),false),[e.cssInitial("gridTemplateRows",true),e.cssInitial("gridTemplateColumns",true),e.css("gridAutoRows"),e.css("gridAutoColumns")].forEach((t,s)=>{if(""!==t&&"none"!==t&&"auto"!==t){Xn.lastIndex=0;const a=0===s?n:i,{name:r,repeat:l,unit:o,unitMin:c}=a;let h,d=1;while(null!==(h=Xn.exec(t))){const t=h[1].trim();switch(s){case 0:case 1:if(t.startsWith("["))h[4].split(Pn.SPACE).forEach(e=>Bn(r,e).push(d));else if(t.startsWith("repeat")){let t=1;switch(h[2]){case"auto-fit":a.autoFit=true;break;case"auto-fill":a.autoFill=true;break;default:t=parseInt(h[2])||1;break}if(t>0){Vn.lastIndex=0;const i=[];let n;while(null!==(n=Vn.exec(h[3]))){const t=n[1];let a;if(null!==(a=qn.exec(t))){const e=a[1];if(!r[e])r[e]=[];i.push({name:e})}else if(null!==(a=Gn.exec(t)))i.push({unit:ta(e,a[2],s),unitMin:ta(e,a[1],s)});else if(null!==(a=jn.exec(t)))i.push({unit:ta(e,a[1],s),unitMin:"0px"});else if(null!==(a=zn.exec(t)))i.push({unit:ta(e,a[0],s)})}if(i.length)for(let e=0;e<t;++e)i.forEach(e=>{const{name:t,unit:i}=e;if(t)r[t].push(d);else if(i)o.push(i),c.push(e.unitMin||""),l.push(true),++d})}}else if(t.startsWith("minmax"))o.push(ta(e,h[6],s)),c.push(ta(e,h[5],s)),l.push(false),++d;else if(t.startsWith("fit-content"))o.push(ta(e,h[7],s)),c.push("0px"),l.push(false),++d;else if(Hn.test(t))o.push(ta(e,t,s)),c.push(""),l.push(false),++d;break;case 2:case 3:(2===s?n:i).auto.push(In(t)?An(e.parseUnit(t,2!==s?"width":"height")):t);break}}}}),a)e.sort((e,t)=>{const{left:i,top:s}=e.linear,{left:n,top:a}=t.linear;if(!Wn(s,a))return s<a?-1:1;else if(!Wn(i,n))return i<n?-1:1;return 0});else e.sort((e,t)=>{const{left:i,top:s}=e.linear,{left:n,top:a}=t.linear;if(!Wn(i,n))return i<n?-1:1;else if(!Wn(s,a))return s<a?-1:1;return 0});let f,g=false,p=false;if(!e.has("gridTemplateAreas")&&e.every(e=>"auto"===e.css("gridRowStart")&&"auto"===e.css("gridColumnStart"))){const[s,r,l,o,c]=a?["top","bottom",2,1,3]:["left","right",3,0,2];let h,d=0,f=0,m=0;if(a){if(i.autoFill)g=Kn(i,e.actualWidth)}else if(n.autoFill)p=Kn(n,e.actualHeight);e.each((e,i)=>{if(!h||e.linear[s]>=h.linear[r]||f>0&&f===m)m=Math.max(f,m),++d,f=1;const{gridRowEnd:n,gridColumnEnd:g}=e.cssAsObject("gridRowEnd","gridColumnEnd");let p=1,b=1;if(n.startsWith("span"))p=parseInt(n.split(" ")[1]);else if(Nn(n))p=parseInt(n)-d;if(g.startsWith("span"))b=parseInt(g.split(" ")[1]);else if(Nn(g))b=parseInt(g)-f;if(1===f&&m>0){let e=false;do{const i=new Array(m-1).fill(1);u.forEach(e=>{const t=e.placement;if(t[l]>d)for(let e=t[o];e<t[c];++e)i[e-1]=0});const s=i.length;for(let t=0,n=0,a=0;t<s;++t)if(i[t]){if(0===n)a=t;if(++n===b){f=a+1,e=true;break}}else n=0;if(!e)t.emptyRows[d-1]=i,++d}while(!e)}if(a)u[i]={outerCoord:e.linear.top,placement:[d,f,d+p,f+b],rowSpan:p,columnSpan:b};else u[i]={outerCoord:e.linear.left,placement:[f,d,f+b,d+p],rowSpan:p,columnSpan:b};f+=b,h=e})}else{const s=t.templateAreas;let r;g=Kn(i,e.actualWidth),p=Kn(n,e.actualHeight),e.css("gridTemplateAreas").split(/"[\s\n]+"/).forEach((e,t)=>{if("none"!==e)Ln(e.trim(),'"').split(Pn.SPACE).forEach((e,i)=>{if("."!==e.charAt(0)){const n=s[e];if(n)n.rowSpan=t-n.rowStart+1,n.columnSpan=i-n.columnStart+1;else s[e]={rowStart:t,rowSpan:1,columnStart:i,columnSpan:1}}})}),e.each((e,t)=>{const l=e.cssAsTuple("gridRowStart","gridColumnStart","gridRowEnd","gridColumnEnd"),o=[0,0,0,0];let c=-1,h=-1;if(Object.keys(s).length)for(let e=0;e<4;++e){const t=l[e];let i=s[t];if(i)switch(e){case 0:o[0]=i.rowStart+1;break;case 1:o[1]=i.columnStart+1;break;case 2:o[2]=i.rowStart+i.rowSpan+1;break;case 3:o[3]=i.columnStart+i.columnSpan+1;break}else{const n=Yn.exec(t);if(n)if(i=s[n[1]],i)if("start"===n[2])switch(e){case 0:case 2:o[e]=i.rowStart+1;break;case 1:case 3:o[e]=i.columnStart+1;break}else switch(e){case 0:case 2:o[e]=i.rowStart+i.rowSpan+1;break;case 1:case 3:o[e]=i.columnStart+i.columnSpan+1;break}}}if(0===o[0]||0===o[1]||0===o[2]||0===o[3]){const e=(e,t,i,s)=>{if(Nn(e)){const i=parseInt(e);if(i>0)return o[t]=i,true;else if(i<0&&t>=2){const e=t-2;return o[o[e]>0?t:e]=i+s+2,true}}else if(e.startsWith("span")){const n=parseInt(e.split(" ")[1]);if(n===s&&r)if(a){if(!i){const e=r[2];if(e>0&&0===o[0])o[0]=e}}else if(i){const e=r[3];if(e>0&&0===o[1])o[1]=e}const d=o[t-2];switch(t){case 0:{const e=l[2];if(Nn(e)){const t=parseInt(e);o[0]=t-n,o[2]=t}break}case 1:{const e=l[3];if(Nn(e)){const t=parseInt(e);o[1]=t-n,o[3]=t}break}case 2:case 3:if(d>0)o[t]=d+n;break}if(i){if(-1===c)c=n}else if(-1===h)h=n;return true}return false};let t,s;for(let a=0;a<4;++a){const r=l[a];if("auto"!==r&&0===o[a]){const d=a%2==0,u=d?n:i;if(!e(r,a,d,Math.max(1,u.unit.length))){const e=r.split(" ");if(1===e.length)e[1]=e[0],e[0]="1";else if(Nn(e[0]))if(d)if(t)c=parseInt(e[0])-parseInt(t[0]);else t=e;else if(s)h=parseInt(e[0])-parseInt(s[0]);else s=e;const i=u.name[e[1]];if(i){const t=parseInt(e[0]);if(t<=i.length)o[a]=i[t-1]+(e[1]===l[a-2]?1:0)}}}}}if(!r){if(0===o[0])o[0]=1;if(0===o[1])o[1]=1}const[d,f,g,p]=o;if(-1===c)c=d>0&&g>0?g-d:1;else if(d>0&&0===g)o[2]=d+c;if(-1===h)h=f>0&&p>0?p-f:1;else if(f>0&&0===p)o[3]=d+h;if(0===o[2]&&o[0]>0)o[2]=o[0]+c;if(0===o[3]&&o[1]>0)o[3]=o[1]+h;u[t]={outerCoord:a?e.bounds.top:e.bounds.left,placement:o,rowSpan:c,columnSpan:h},r=o})}{const[t,s]=a?[i,e.box.top]:[n,e.box.left];let r=t.unit,l=1,o=0;u.forEach(e=>{if(e){const[t,i,n]=a?[e.columnSpan,1,3]:[e.rowSpan,0,2],r=e.placement;if(r.some(e=>e>0))l=Math.max(l,t,r[i],r[n]-1);if(Wn(e.outerCoord,s))o+=t}});let c=r.length;if(f=Math.max(l,o,a&&!g||!a&&!p?c:0),t.length=f,c<f)if(t.autoFill||t.autoFit){if(0===c)r.push("auto"),t.unitMin.push(""),t.repeat.push(true);r=$n(t,r),t.unit=r,t.unitMin=$n(t,t.unitMin)}else{const e=t.auto,i=e.length;if(i){let t=0;while(r.length<f){if(t===i)t=0;r.push(e[t++])}}}else if(t.autoFit||t.autoFill&&e.blockStatic&&(a&&!e.hasWidth&&!e.hasPX("maxWidth",false)||!a&&!e.hasHeight))r.length=f;let h=1,d=0,m=0;if(r.forEach(e=>{if(Rn(e))h-=parseFloat(e)/100;else if(CssGrid.isFr(e))d+=parseFloat(e);else if("auto"===e)++m}),t.flexible=h<1||d>0,h<1)if(d>0){c=r.length;for(let e=0;e<c;++e){const t=r[e];if(CssGrid.isFr(t))r[e]=h*(parseFloat(t)/d)+"fr"}}else if(1===m){const e=r.findIndex(e=>"auto"===e);if(-1!==e)r[e]=Tn(h)}}if(e.each((e,i)=>{const{placement:n,rowSpan:g,columnSpan:p}=u[i],[m,b]=a?[g,p]:[p,g];while(0===n[0]||0===n[1]){const e=n.slice(0);if(0===e[r]){let t=h.length;for(let i=s?0:ea(d),n=0,a=-1;i<t;++i){if(-1!==Zn(f,b,d[i])){if(0===n)a=i,t=Math.max(t,i+m);if(++n===m){e[r]=a+1;break}}else n=0,a=-1,t=h.length}}if(0===e[r]){if(n[r]=h.length+1,0===n[l])n[l]=1}else if(0===e[l]){if(0===e[o])e[o]=e[r]+m;const t=[],i=e[r]-1,s=e[o]-1;let n=i;while(n<s){const e=h[n++];if(!e)t.push([[0,-1]]);else if(e.reduce((e,t)=>e+(t?1:0),0)+b<=f){const i=[];let s=0;for(let t=0,n=-1;t<f;++t){const a=e[t];if(!a){if(-1===n)n=t;++s}if(a||t===f-1){if(s>=b)i.push([n,n+s]);n=-1,s=0}}if(i.length)t.push(i);else break}else break}const a=t.length;if(a){const r=t[0];if(-1===r[0][1])e[l]=1;else if(a===s-i)if(a>1)e:for(const i of r)for(n=i[0];n<i[1];++n){let i=1;while(i<a){const s=t[i++],a=s.length;let r=0;while(r<a){const t=s[r++];if(n>=t[0]&&(-1===t[1]||n+b<=t[1])){e[l]=n+1;break e}}}}else e[l]=r[0][0]+1}}const t=e[r];if(t>0){const i=e[l];if(i>0)n[r]=t,n[l]=i}}if(0===n[o])n[o]=n[r]+m;if(0===n[c])n[c]=n[l]+b;if(((e,t,i)=>{if(t.every(e=>e>0)){for(let n=t[r]-1;n<t[o]-1;++n){const a=Bn(h,n);let r=d[n],o=t[l]-1;if(!r){if(r=new Array(i).fill(0),!s){let e=0;while(e<o)r[e++]=1}d[n]=r}while(o<t[c]-1)Bn(a,o).push(e),r[o++]=1}return true}return false})(e,n,f)){const[i,r,l,o]=n,c=i-1,h=l-i,u=r-1;if(!s){const e=a?c:u;if(e>0){const t=d[e-1];let i=0;while(i<f)t[i++]=1}}if(h>1){const e=t.rowSpanMultiple,i=c+h;let s=c;while(s<i)e[s++]=true}e.data(Fn,"cellData",{rowStart:c,rowSpan:h,columnStart:u,columnSpan:o-r})}}),h.length){let s;if(a)s=h,t.rowData=h;else{s=t.rowData;const e=h.length;for(let t=0;t<e;++t){const e=h[t],i=e.length;let n=0;while(n<i)Bn(s,n)[t]=e[n++]}}const r=a?n.unitTotal:i.unitTotal,l=t.children,o=i.unit.length;if(s.forEach(e=>{const t=e.length;let i=0;while(i<t){const t=e[i];let s=r[i]||0;if(t){let e=0;t.forEach(t=>{if(!l.includes(t))e=Math.max(e,a?t.bounds.height:t.bounds.width),l.push(t)}),s+=e}r[i++]=s}}),l.length===e.length){const{gap:r,unit:c}=n,{gap:h,unit:d}=i,u=Math.max(c.length,s.length),f=new Array(u).fill(0),g=new Array(o).fill(0),p=new Set;n.length=u,i.length=o;let m=0;for(let e=0;e<u;++e){const i=s[e],n=c[e];if(i)for(let s=0;s<o;++s){const n=i[s];if(n)n.forEach(t=>{if(!p.has(t)){const{columnSpan:i,rowSpan:n}=t.data(Fn,"cellData"),a=s+i-1,l=e+n-1;if(h>0&&a<o-1)t.modifyBox(4,h);if(r>0&&l<u-1)t.modifyBox(8,r);if(1===n){const i=t.bounds.height,s=f[e];if(t.hasHeight)if(s<0){if(i>Math.abs(s))f[e]=i}else f[e]=Math.max(i,s);else if(i>Math.abs(s))f[e]=-i;m=Math.max(i,m)}if(1===i){const e=t.bounds.width,i=g[s];if(t.hasWidth)if(i<0){if(e>Math.abs(i))g[s]=e}else g[s]=Math.max(e,i);else if(e>Math.abs(i))g[s]=-e}p.add(t)}});else if(!a)t.emptyRows[s]=[1/0]}else if(f[e]=parseFloat(n)||0,a)t.emptyRows[e]=[1/0]}if(t.minCellHeight=m,a){if(e.hasPX("width",false))i.fixedWidth=true,i.flexible=false,Qn(e.actualWidth,h,o,d,g);if(e.hasHeight&&!CssGrid.isAligned(e))Jn(n.unit,u)}else{if(e.hasPX("height",false))n.fixedWidth=true,n.flexible=false,Qn(e.actualHeight,r,u,c,f);if(e.hasWidth&&!CssGrid.isJustified(e))Jn(i.unit,o)}if(e.retain(l),e.cssSort("zIndex"),e.cssTry("display","block"))e.each(e=>{const{width:t,height:i}=e.boundingClientRect;e.data(Fn,"boundsData",Object.assign(Object.assign({},e.bounds),{width:t,height:i}))}),e.cssFinally("display");e.data(Fn,"mainData",t)}}}}CssGrid.isFr=e=>/\dfr$/.test(e),CssGrid.isPx=e=>Mn.PX.test(e),CssGrid.isAligned=e=>e.hasHeight&&/^space-|center|flex-end|end/.test(e.css("alignContent")),CssGrid.isJustified=e=>(e.blockStatic||e.hasWidth)&&/^space-|center|flex-end|end|right/.test(e.css("justifyContent"));const{withinRange:ia}=squared.lib.util,sa=vt.FLEXBOX;class Flexbox extends ExtensionUI{static createDataAttribute(e,t){return Object.assign(Object.assign({},e.flexdata),{rowCount:0,columnCount:0,children:t})}is(e){return e.flexElement}condition(e){return e.length>0}processNode(e){const t=this.controller,[i,s]=e.partition(e=>e.pageFlow),n=Flexbox.createDataAttribute(e,i);if(e.cssTry("align-items","start")){if(e.cssTry("justify-items","start"))i.forEach(e=>{if(e.cssTry("align-self","start")){if(e.cssTry("justify-self","start")){const{width:t,height:i}=e.boundingClientRect;e.data(sa,"boundsData",Object.assign(Object.assign({},e.bounds),{width:t,height:i})),e.cssFinally("justify-self")}e.cssFinally("align-self")}}),e.cssFinally("justify-items");e.cssFinally("align-items")}if(n.wrap){const[a,r,l,o]=n.row?["top","left","right","intersectY"]:["left","top","bottom","intersectX"];i.sort((e,t)=>{const i=e.linear,s=t.linear;if(!e[o](t.bounds,"bounds"))return i[a]<s[a]?-1:1;else{const e=i[r],t=s[r];if(!ia(e,t))return e<t?-1:1}return 0});let c=i[0],h=[c];const d=[h];let u=i.length,f=1;while(f<u){const e=i[f++];if(c[o](e.bounds,"bounds"))h.push(e);else c=e,h=[e],d.push(h)}e.clear();let g,p=0;if(u=d.length,f=0,u>1){const i=e.box[l];while(f<u){const s=d[f];p=Math.max(s.length,p);const n=t.createNodeGroup(s[0],s,{parent:e,delegate:true,cascade:true});n.addAlign(128),n.box[l]=i,n.containerIndex=f++}g=u}else{const t=d[0];e.retain(t),p=t.length;while(f<p)t[f].containerIndex=f++;g=p}const m=s.length;f=0;while(f<m)s[f].containerIndex=g+f++;if(e.concat(s),e.sort(),n.row)n.rowCount=u,n.columnCount=p;else n.rowCount=p,n.columnCount=u}else{if(i.some(e=>0!==e.flexbox.order)){const[e,t]=n.reverse?[-1,1]:[1,-1];i.sort((i,s)=>{const n=i.flexbox.order,a=s.flexbox.order;if(n===a)return 0;else return n>a?e:t})}if(n.row)n.rowCount=1,n.columnCount=e.length;else n.rowCount=e.length,n.columnCount=1}e.data(sa,"mainData",n)}}const{aboveRange:na,belowRange:aa,objectMap:ra,safeNestedArray:la,withinRange:oa}=squared.lib.util,ca=vt.GRID;function ha(e,t){const i=t.bounds.top,s=e.length;let n=0;while(n<s){const t=e[n++].findIndex(e=>{const t=e.bounds.top;return oa(i,t)||Math.ceil(i)>=t&&i<Math.floor(e.bounds.bottom)});if(-1!==t)return t}return-1}class Grid extends ExtensionUI{static createDataCellAttribute(){return{rowSpan:0,columnSpan:0,index:-1,cellStart:false,cellEnd:false,rowEnd:false,rowStart:false}}condition(e){if(e.length>1&&!e.layoutElement&&"TABLE"!==e.tagName&&!e.has("listStyle"))if("table"===e.display)return e.every(e=>"table-row"===e.display&&e.every(e=>"table-cell"===e.display))||e.every(e=>"table-cell"===e.display);else if(0===e.percentWidth||!e.find(e=>e.percentWidth>0,{cascade:true})){let t=false,i=0;for(const s of e)if(s.pageFlow&&s.blockStatic&&!s.visibleStyle.background&&0===s.percentWidth&&!s.autoMargin.leftRight&&!s.autoMargin.left){if(s.length>1)t=true;if("list-item"===s.display&&!s.has("listStyleType"))++i}else return false;return i===e.length||t&&e.every(e=>e.length>0&&NodeUI.linearData(e.children).linearX)}return false}processNode(e){var t;const i=[],s={};let n=[];e.each(e=>{e.each(e=>{if(e.visible)la(s,Math.floor(e.linear.left)).push(e)})});const a=Object.keys(s),r=a.length;if(r){let l=-1;for(let e=0;e<r;++e){const t=s[a[e]];if(0===e)l=r;else if(l!==t.length){l=-1;break}}if(-1!==l)n=ra(a,e=>s[e]);else{const l=[];for(let e=0;e<r;++e){const t=s[a[e]],i=t.length;if(0===e&&0===i)return;l[e]=0===e?0:l[e-1];for(let s=0;s<i;++s){const a=t[s],{left:r,right:o}=a.linear;if(0===e||na(r,l[e-1])){const t=la(n,e);if(0===e||n[0].length===i)t[s]=a;else{const e=ha(n,a);if(-1!==e)t[e]=a;else return}}else{const e=n[n.length-1];if(e){let t=1/0,i=-1/0;if(e.forEach(e=>{const s=e.linear;t=Math.min(s.left,t),i=Math.max(s.right,i)}),Math.floor(r)>Math.ceil(t)&&Math.floor(o)>Math.ceil(i)){const t=ha(n,a);if(-1!==t){let i=n.length-1;while(i>=0){const s=n[i--];if(s){if(!s[t])e.length=0;break}}}}}}l[e]=Math.max(o,l[e])}}const o=l.length;for(let e=0,t=-1;e<o;++e)if(!n[e]){if(-1===t)t=e-1;else if(e===o-1)l[t]=l[e]}else if(-1!==t)l[t]=l[e-1],t=-1;for(let e=0;e<n.length;++e)if(null===(t=n[e])||void 0===t?void 0:t.length)i.push(l[e]);else n.splice(e--,1);const c=n.reduce((e,t)=>Math.max(e,t.length),0);for(let e=0;e<c;++e){const t=n.length;let i=0;while(i<t){const t=n[i++];if(!t[e])t[e]={spacer:1}}}i.push(e.box.right)}}const l=n.length;if(l>1&&n[0].length===e.length){const t=[],s=new Set;for(let e=0,a=0;e<l;++e){const r=n[e],o=r.length;for(let c=0,h=0,d=0;c<o;++c){const u=r[c],f=la(t,c);if(!u.spacer){const t=Object.assign(Grid.createDataCellAttribute(),u.data(ca,"cellData"));let g=1,p=1+d,m=e+1;while(m<l){const e=n[m++][c];if(1===e.spacer)++p,e.spacer=2;else break}if(1===p){m=c+1;while(m<o){const e=r[m++];if(1===e.spacer)++g,e.spacer=2;else break}}if(i.length){const n=Math.min(e+(p-1),i.length-1);u.actualParent.naturalChildren.forEach(e=>{if(!s.has(e)&&e.visible&&!e.rendered){const{left:s,right:a}=e.linear;if(na(s,u.linear.right)&&aa(a,i[n]))la(t,"siblings").push(e)}})}t.rowSpan=g,t.columnSpan=p,t.rowStart=0==h++,t.rowEnd=p+e===l,t.cellStart=0==a++,t.cellEnd=t.rowEnd&&c===o-1,t.index=e,d=0,u.data(ca,"cellData",t),f.push(u),s.add(u)}else if(1===u.spacer)++d}}if(e.each(e=>e.hide()),e.clear(),t.forEach(t=>t.forEach(t=>t.parent=e)),e.tableElement&&"collapse"===e.css("borderCollapse"))e.resetBox(480);e.data(ca,"columnCount",l)}}}const da=squared.lib,{convertListStyle:ua}=da.css,{isNumber:fa}=da.util,ga=e=>e.backgroundImage&&!e.backgroundRepeat;class List extends ExtensionUI{condition(e){const t=e.length;if(t){const i=new Set;let s=true,n=true,a=true,r=true,l=false;const o=e.children;for(let e=0;e<t;++e){const c=o[e],h=c.css("listStyleType");if("list-item"===c.display&&("none"!==h||c.innerBefore)||c.marginLeft<0&&"none"===h&&ga(c.visibleStyle))l=true;if(a||r)if(c.floating)i.add(c.float),r=false;else if(0===e||e===t-1||c.blockStatic||o[e-1].blockStatic&&o[e+1].blockStatic)a=false;else a=false,r=false;if(!c.blockStatic)s=false;if(!c.inlineVertical)n=false;if(!(s||n||r||a))return false}return l&&(s||n||a&&1===i.size||r)}return false}processNode(e){const t="OL"===e.tagName;let i=t&&e.toElementInt("start")||1;e.each(e=>{const s=List.createDataAttribute(),n=e.css("listStyleType"),a="list-item"===e.display;if(a||""!==n&&"none"!==n||ga(e.visibleStyle)){if(e.has("listStyleImage"))s.imageSrc=e.css("listStyleImage");else{if(t&&a&&"LI"===e.tagName){const t=e.attributes.value;if(fa(t))i=Math.floor(parseFloat(t))}let r=ua(n,i);if(""===r)switch(n){case"disc":r="";break;case"square":r="";break;case"none":{let t="",i="";if(!e.visibleStyle.backgroundRepeat)t=e.backgroundImage,i=e.css("backgroundPosition");if(""!==t&&"none"!==t)s.imageSrc=t,s.imagePosition=i,e.exclude({resource:St.IMAGE_SOURCE});break}default:r="";break}else r+=".";s.ordinal=r}if(a)++i}e.data(vt.LIST,"mainData",s)})}}List.createDataAttribute=()=>({ordinal:"",imageSrc:"",imagePosition:""});const pa=squared.lib,{assignRect:ma}=pa.dom,{convertFloat:ba,withinRange:xa}=pa.util,ya={relative:true};const{getBackgroundPosition:va,resolveURL:Ea}=squared.lib.css,Sa=/^0[a-z%]+|left|start|top/;const wa=squared.lib,{formatPercent:ka,formatPX:_a,getInheritedStyle:Ca,getStyle:Ta,isLength:Aa,isPercent:Ia}=wa.css,{getNamedItem:Ra}=wa.dom,{maxArray:Pa}=wa.math,{isNumber:Ma,replaceMap:Na,safeNestedArray:Ba,withinRange:La}=wa.util,Wa=vt.TABLE,Fa=/rgba\(0, 0, 0, 0\)|transparent/;function Oa(e,t,i){i.percent=Math.round(t.bounds.width/e.box.width*100)+"%",i.expand=true}function Da(e,t,i){const s=t+"Style";e.ascend({including:i}).some(i=>{if(i.has(s)){const n=t+"Color",a=t+"Width";return e.css("border","inherit"),e.cssApply(i.cssAsObject(s,n,a)),e.unsetCache(a),true}return false})}function Ua(e){e.exclude({resource:St.ALL}),e.hide()}const Ha=e=>e.css("width",_a(e.bounds.width),true);class Table extends ExtensionUI{static createDataAttribute(e){return{layoutType:0,rowCount:0,columnCount:0,layoutFixed:"fixed"===e.css("tableLayout"),borderCollapse:"collapse"===e.css("borderCollapse"),expand:false}}processNode(e){const t=Table.createDataAttribute(e),i=[];let s,n,a=[];const r=e=>{if(e)e.cascade(t=>{switch(t.tagName){case"TH":case"TD":t.inherit(e,"styleMap"),t.unsetCache("visibleStyle");break}return false}),a=a.concat(e.children),Ua(e)};e.each(e=>{switch(e.tagName){case"THEAD":if(!n)n=e;else Ua(e);break;case"TBODY":i.push(e);break;case"TFOOT":if(!s)s=e;else Ua(e);break}}),r(n),i.forEach(e=>{a=a.concat(e.children),Ua(e)}),r(s);const l=e.hasWidth,o=t.borderCollapse,[c,h]=o?[0,0]:Na(e.css("borderSpacing").split(" "),(t,i)=>0===i?e.parseWidth(t):e.parseHeight(t)),d=c>1?Math.round(c/2):c,u=h>1?Math.round(h/2):h,f=e.element.querySelector("COLGROUP"),g=e.find(e=>"CAPTION"===e.tagName),p="bottom"===e.css("captionSide"),m=[],b=[],x=[],y=[],v=a.length;let E=0;for(let i=0;i<v;++i){const s=a[i];m[i]=c;const n=x[i]||[];x[i]=n,s.each((s,a)=>{const r=s.element,l=r.rowSpan;let o=r.colSpan,g=0;while(n[g])++g;const p=i+l;let E=i;while(E<p){const e=Ba(x,E++),t=g+o;for(let i=g,n=0;i<t;++i)if(!e[i])e[i]=s,++n;else{o=n;break}}if(!s.hasPX("width")){const e=Ra(r,"width");if(Ia(e))s.css("width",e,true);else if(Ma(e))s.css("width",_a(parseFloat(e)),true)}if(!s.hasPX("height")){const e=Ra(r,"height");if(Ia(e))s.css("height",e);else if(Ma(e))s.css("height",_a(parseFloat(e)))}if(""===s.cssInitial("verticalAlign"))s.css("verticalAlign","middle",true);if(!s.visibleStyle.backgroundImage&&!s.visibleStyle.backgroundColor)if(f){const{backgroundImage:e,backgroundColor:t}=Ta(f.children[a+1]);if(e&&"none"!==e)s.css("backgroundImage",e,true);if(t&&!Fa.test(t))s.css("backgroundColor",t),s.setCacheValue("backgroundColor",t)}else{let e=Ca(r,"backgroundImage",/none/,"TABLE");if(""!==e)s.css("backgroundImage",e,true);if(e=Ca(r,"backgroundColor",Fa,"TABLE"),""!==e)s.css("backgroundColor",e),s.setCacheValue("backgroundColor",e)}switch(s.tagName){case"TD":{const e=s.parent;if(0===s.borderTopWidth)Da(s,"borderTop",e);if(0===s.borderRightWidth)Da(s,"borderRight",e);if(0===s.borderBottomWidth)Da(s,"borderBottom",e);if(0===s.borderLeftWidth)Da(s,"borderLeft",e);break}case"TH":if(""===s.cssInitial("textAlign"))s.css("textAlign","center");if(0===s.borderTopWidth)Da(s,"borderTop",e);if(0===s.borderBottomWidth)Da(s,"borderBottom",e);break}const S=s.cssInitial("width"),w=void 0===y[g]||"auto"===y[g],k=s.bounds.width;if(0===i||w||!t.layoutFixed)if(""===S||"auto"===S){if(void 0===y[g])y[g]=S||"0px",b[g]=0;else if(i===v-1&&w&&0===b[g])b[g]=k}else{const e=Ia(S),t=Aa(y[g]);if(w||k<b[g]||k===b[g]&&(t&&e||e&&Ia(y[g])&&s.parseWidth(S)>=s.parseWidth(y[g])||t&&Aa(S)&&s.parseWidth(S)>s.parseWidth(y[g])))y[g]=S;if(w||1===r.colSpan)b[g]=k}if(s.length||s.inlineText)m[i]+=k+c;if(d>0)s.modifyBox(16,0===g?c:d),s.modifyBox(4,0===a?d:c);if(u>0)s.modifyBox(2,0===i?h:u),s.modifyBox(8,i+l<v?u:h);s.data(Wa,"cellData",{colSpan:o,rowSpan:l})}),Ua(s),E=Math.max(E,n.length)}if(e.hasPX("width",false)&&y.some(e=>Ia(e)))Na(y,(e,t)=>{if("auto"===e){const e=b[t];if(e>0)return _a(e)}return e});let S=false,w=0;if(y.every(e=>Ia(e))){if(y.reduce((e,t)=>e+parseFloat(t),0)>1){let e=100;Na(y,t=>{const i=parseFloat(t);if(e<=0)t="0px";else if(e-i<0)t=ka(e/100);return e-=i,t})}if(!e.hasWidth)t.expand=true;S=true}else if(y.every(e=>Aa(e))){const i=y.reduce((e,t)=>e+parseFloat(t),0);if(e.hasWidth)if(i<e.width)Na(y,e=>"0px"!==e?parseFloat(e)/i*100+"%":e);else if(i>e.width)if(e.css("width","auto"),!t.layoutFixed)e.cascade(e=>(e.css("width","auto"),false));if(t.layoutFixed&&!e.hasPX("width"))e.css("width",_a(e.bounds.width))}if(t.layoutType=(()=>{if(y.length>1){if(w=y.reduce((e,t)=>e+(Ia(t)?parseFloat(t):0),0),t.layoutFixed&&y.reduce((e,t)=>e+(Aa(t)?parseFloat(t):0),0)>=e.actualWidth)return 4;else if(y.length>1&&y.some(e=>Ia(e))||y.every(e=>Aa(e)&&"0px"!==e))return 3;else if(y.every(e=>e===y[0]))if(e.find(e=>e.hasHeight,{cascade:true}))return t.expand=true,3;else if("auto"===y[0])if(e.hasWidth)return 3;else{const t=e.cascade(e=>"TD"===e.tagName);return t.length&&t.every(e=>La(e.bounds.width,t[0].bounds.width))?0:3}else if(e.hasWidth)return 2;if(y.every(e=>"auto"===e||Aa(e)&&"0px"!==e)){if(!e.hasWidth)t.expand=true;return 1}}return 0})(),e.clear(),g){if(!g.hasWidth)if(g.textElement){if(!g.hasPX("maxWidth"))g.css("maxWidth",_a(g.bounds.width))}else if(g.bounds.width>Pa(m))Ha(g);if(!g.cssInitial("textAlign"))g.css("textAlign","center");if(g.data(Wa,"cellData",{colSpan:E}),!p)g.parent=e}let k=0;while(k<v){const i=x[k++],s=i.length;let n=0;while(n<s){const s=i[n],a=s.data(Wa,"cellData"),r=y[n];if(n+=a.colSpan,!a.placed){if(r)switch(t.layoutType){case 0:break;case 3:if("auto"===r)if(w>=1)Ha(s),a.exceed=!l,a.downsized=true;else Oa(e,s,a);else if(Ia(r))if(S)a.percent=r,a.expand=true;else Ha(s);else if(Aa(r)&&parseInt(r)>0)if(s.bounds.width>=parseInt(r))Ha(s),a.expand=false,a.downsized=false;else if(t.layoutFixed)Oa(e,s,a),a.downsized=true;else Ha(s),a.expand=false;else{if(!s.hasPX("width",false)||s.percentWidth)Ha(s);a.expand=false}break;case 2:Oa(e,s,a);break;case 1:if("auto"===r)a.flexible=true;else{if(t.layoutFixed)a.downsized=true;else Ha(s);a.expand=false}break;case 4:if(!Aa(r))s.hide();break}a.placed=true,s.parent=e}}if(s<E){const e=i[s-1].data(Wa,"cellData");if(e)e.spaceSpan=E-s}}if(g&&p)g.parent=e;if(t.borderCollapse){const t=e.cssAsObject("borderTopColor","borderTopStyle","borderTopWidth"),i=e.cssAsObject("borderRightColor","borderRightStyle","borderRightWidth"),s=e.cssAsObject("borderBottomColor","borderBottomStyle","borderBottomWidth"),n=e.cssAsObject("borderLeftColor","borderLeftStyle","borderLeftWidth"),a=parseInt(t.borderTopWidth),r=parseInt(i.borderRightWidth),l=parseInt(s.borderBottomWidth),o=parseInt(n.borderLeftWidth);let c=false,h=false,d=false,u=false;for(k=0;k<v;++k){const e=x[k];for(let f=0;f<E;++f){const g=e[f];if("visible"===(null==g?void 0:g.css("visibility"))){if(0===k)if(g.borderTopWidth<a)g.cssApply(t),g.unsetCache("borderTopWidth");else c=true;if(k>=0&&k<v-1){const e=x[k+1][f];if("visible"===(null==e?void 0:e.css("visibility"))&&e!==g)if(g.borderBottomWidth>e.borderTopWidth)e.css("borderTopWidth","0px",true);else g.css("borderBottomWidth","0px",true)}if(k===v-1)if(g.borderBottomWidth<l)g.cssApply(s),g.unsetCache("borderBottomWidth");else d=true;if(0===f)if(g.borderLeftWidth<o)g.cssApply(n),g.unsetCache("borderLeftWidth");else u=true;if(f>=0&&f<E-1){const t=e[f+1];if("visible"===(null==t?void 0:t.css("visibility"))&&t!==g)if(g.borderRightWidth>=t.borderLeftWidth)t.css("borderLeftWidth","0px",true);else g.css("borderRightWidth","0px",true)}if(f===E-1)if(g.borderRightWidth<r)g.cssApply(i),g.unsetCache("borderRightWidth");else h=true}}}if(c||h||d||u)e.cssApply({borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px",borderLeftWidth:"0px"},true)}t.rowCount=v+(g?1:0),t.columnCount=E,e.data(Wa,"mainData",t)}}const Xa=squared.lib,{isLength:Va}=Xa.css,{convertFloat:za}=Xa.util;var Ga;const ja=squared.lib,{formatPX:qa}=ja.css,{maxArray:Ya}=ja.math,{getElementCache:$a}=ja.session,{iterateReverseArray:Ka}=ja.util,Qa="html"===(null===(Ga=document.doctype)||void 0===Ga?void 0:Ga.name),Ja=["marginTop","borderTopWidth","paddingTop",2],Za=["marginBottom","borderBottomWidth","paddingBottom",8];function er(e,t,i,s=0){let n;switch(t){case 2:n=e.actualRect("top")-i;break;case 16:n=e.actualRect("left")-i;break;case 8:n=i-e.actualRect("bottom");break;default:n=0;break}if(n-=s,n>0)(e.renderAs||e).modifyBox(t,n)}function tr(e,t,i){if(1===e.getBox(t)[0]){const s=e.registerBox(t);if(s){const[e,n]=s.getBox(t);if(i=Math.max(n,i),1===e)s.setBox(t,{adjustment:i});else s.setCacheValue("marginTop",i);return}}e.setBox(t,{reset:1,adjustment:i})}function ir(e,t,i){if(!i||sr(t,true)){const[s,n,a,r]=i?Ja:Za;if(0===e[n])if(0===e[a]){let l=t;while(Qa&&0===l[s]&&0===l[n]&&0===l[a]&&cr(l))if(i){const e=l.firstStaticChild;if(sr(e,i))l=e;else break}else{const e=ar(l);if(e)l=e;else break}const o=e[s],c=l[s];if(o>=0&&c>=0){const n=l.bounds.height;let a=false;if(!Qa&&0===o&&c>0&&""===l.cssInitial(s))a=true;else{const s=o>=c;if(0===n&&s&&l.textEmpty&&0===l.extensions.length)l.hide({collapse:true});else{const n=l.registerBox(r);if(n){const t=n.getBox(r)[1];if(t>0){if(t>o)tr(e,r,t);n.setBox(r,{reset:1,adjustment:0})}}else if(0===l.getBox(r)[0])if(s)a=c>0;else if(e.documentBody){if(lr(e,r),i){if(e.bounds.top>0)e.bounds.top=0,e.unset("box"),e.unset("linear");if(e.layoutVertical){const i=e.renderChildren[0];if((l.positionStatic||l.top>=0&&!l.hasPX("bottom"))&&i!==t.outerMostWrapper)tr(i,r,c),tr(l,r,0),a=true}}}else tr(e,r,c),a=true}}if(a){if(lr(l,r),!i&&l.floating){const e=l.bounds;l.actualParent.naturalChildren.forEach(t=>{if(t.floating&&t!==l&&t.intersectY(e,"bounds"))lr(t,r)})}if(0===n&&!l.every(e=>e.floating||!e.pageFlow))lr(l,i?8:2)}}else if(o<0&&c<0)if(!i){if(c<o)tr(e,r,c);lr(l,r)}}else if(0===t[s]&&0===t[n]&&cr(t)){let r=true;do{const l=i?t.firstStaticChild:t.lastStaticChild;if(l&&0===l[s]&&0===l[n]&&!l.visibleStyle.background&&cr(l)){const s=l[a];if(s>0){if(s>=e[a])e.setBox(i?32:128,{reset:1});else if(r)e.modifyBox(i?32:128,-s,false);break}else{if(!sr(l,i))r=false;t=l}}else break}while(true)}}}function sr(e,t){if(null===e||!e.styleElement||e.lineBreak)return false;else if(e.blockStatic)return true;else if(!e.floating){switch(e.display){case"table":case"list-item":return true}if(void 0!==t)if(t){const t=e.firstStaticChild;return sr(t)&&hr(t,false)}else{const t=e.lastStaticChild;return sr(t)&&dr(t,false)}}return false}function nr(e,t,i,s){let n=1/0;if(e.nodeGroup&&e.some(e=>e.floating))e.renderEach(t=>{if(!t.floating){const i=t.linear.top;if(i<n)n=i,e=t}});if(n===1/0)n=e.linear.top;if(s){const a=Math.max(s.linear.top,t.linear.bottom);if(a<n)return[n-a-i,e]}return[Math.round(n-t.linear.bottom-i),e]}function ar(e){let t;if(!e.floatContainer){if(t=e.lastStaticChild,!sr(e,false)||e.hasHeight&&Math.floor(t.linear.bottom)<e.box.bottom)t=void 0}else{let i;const s=e.naturalChildren;let n=s.length-1;while(n>=0){const a=s[n--];if(a.floating){if(!t){const t=a.linear.bottom;if(i){if(t>i.linear.bottom)i=a}else if(Math.ceil(a.linear.bottom)>=e.box.bottom)i=a}else if(a.linear.bottom>=t.linear.bottom){t=a;break}}else if(!t){if(i&&i.linear.bottom>a.linear.bottom){t=i;break}t=a}}if(!t)t=i}return t}function rr(e){for(const t of[e.cssInitial("overflowX"),e.cssInitial("overflowY")])switch(t){case"auto":case"hidden":case"overlay":return true}return false}function lr(e,t,i){if(e.setBox(t,{reset:1}),i)e.registerBox(t,i)}const or=(e,t)=>e.css("minHeight",qa(Math.max(t,e.hasPX("minHeight",false)?e.parseHeight(e.css("minHeight")):0))),cr=(e,t=true)=>(!t&&e.blockStatic||t&&e.length>0&&!e.floating)&&!e.layoutElement&&!e.tableElement&&"FIELDSET"!==e.tagName,hr=(e,t)=>!e.hasHeight&&0===e.borderBottomWidth&&0===e.paddingBottom&&cr(e,t),dr=(e,t)=>!e.hasHeight&&0===e.borderTopWidth&&0===e.paddingTop&&cr(e,t),ur=e=>e.pageFlow&&e.blockDimension&&!e.floating&&!e.excluded;const fr={Accessibility:class Accessibility extends ExtensionUI{},Column:class Column extends ExtensionUI{is(e){return e.blockDimension&&"table"!==e.display&&!e.layoutElement&&e.length>1}condition(e){return e.has("columnCount")||e.hasPX("columnWidth")}processNode(e,t){let i=[];const s=[i];let n=1/0,a=false;if(e.each(e=>{var t;if("all"===e.css("columnSpan")){if(i.length)s.push([e]);else i.push(e);i=[],s.push(i)}else{if(e.textElement&&(null===(t=e.textBounds)||void 0===t?void 0:t.overflow))n=NaN;if(e.multiline)a=true;else if(!isNaN(n))n=Math.min(e.bounds.width,n);i.push(e)}}),0===i.length)s.pop();const[r,l,o]=e.cssAsTuple("columnRuleStyle","columnRuleWidth","columnRuleColor"),c=e.box.width,h=e.toInt("columnCount"),d=e.parseWidth(e.css("columnWidth"));let u,f=e.parseWidth(e.css("columnGap"));const g=()=>isNaN(h)&&d>0?c/(d+f):1/0;if(f>0)u=Math.floor(g());else f=(d>0&&!isNaN(n)&&n!==1/0?Math.max(n-d,0):0)+16,u=Math.ceil(g());e.data(vt.COLUMN,"mainData",{rows:s,columnCount:h,columnWidth:d,columnGap:f,columnSized:u,columnRule:{borderLeftStyle:r,borderLeftWidth:l,borderLeftColor:o},boxWidth:t.actualBoxWidth(c),multiline:a})}},CssGrid:CssGrid,Flexbox:Flexbox,Grid:Grid,List:List,Relative:class Relative extends ExtensionUI{is(e){return e.positionRelative&&!e.autoPosition||0!==ba(e.verticalAlign)}condition(){return true}processNode(e){return{subscribe:true}}postOptimize(e){const t=e.renderParent,i=!e.baselineAltered?ba(e.verticalAlign):0;let s=0,n=0,a=0,r=0;if(e.hasPX("top"))s=e.top;else a=e.bottom;if(e.hasPX("left"))r=e.left;else n=e.right;if(t.support.positionTranslation){let t=0,l=0;if(0!==r)t=r;else if(0!==n)t=-n;if(0!==s)l=s;else if(0!==a)l=-a;if(0!==i)l-=i;if(0!==t)e.translateX(t,ya);if(0!==l)e.translateY(l,ya)}else{let l=e;if((0!==s||0!==a||0!==i)&&t.layoutHorizontal&&t.support.positionRelative&&0===e.renderChildren.length){const i=this.application;l=e.clone(i.nextId,true,true),l.baselineAltered=true,e.hide({hidden:true}),this.cache.append(l,false);const s=new LayoutUI(t,l,l.containerType,l.alignmentType),n=t.renderChildren.findIndex(t=>t===e);if(-1!==n)s.renderIndex=n+1;if(i.addLayout(s),e.parseUnit(e.css("textIndent"))<0){const i=e.documentId;t.renderEach(e=>{if(e.alignSibling("topBottom")===i)e.alignSibling("topBottom",l.documentId);else if(e.alignSibling("bottomTop")===i)e.alignSibling("bottomTop",l.documentId)})}if(e.baselineActive&&!e.baselineAltered)for(const i of t.horizontalRows||[t.renderChildren])if(i.includes(e)){const t=i.filter(t=>t.positionRelative&&t.length>0&&0!==ba(e.verticalAlign)),s=t.length;if(s){t.sort((e,t)=>{const i=e.linear.top,s=t.linear.top;if(xa(i,s))return 0;else return i<s?-1:1});let i=true,n=0;while(n<s){const s=t[n++];if(i)e.modifyBox(2,ba(s.verticalAlign)),i=false;else s.modifyBox(2,s.linear.top-t[0].linear.top);s.setCacheValue("verticalAlign","0px")}}break}}else if(e.positionRelative&&e.naturalElement){const i=e.bounds,l=0!==s||0!==a,o=0!==r||0!==n;let c,h=false;const d=e.actualParent.naturalChildren,u=d.length;let f=0;while(f<u){const u=d[f++];if(u===e){if(h){if(l&&t.layoutVertical){const t=ma(e.boundingClientRect);if(0!==s)s-=t.top-i.top;else if((null==c?void 0:c.positionRelative)&&c.hasPX("top"))a+=i.bottom-t.bottom;else a+=t.bottom-i.bottom}if(o&&t.layoutHorizontal&&!e.alignSibling("leftRight")){const t=ma(e.boundingClientRect);if(0!==r)r-=t.left-i.left;else if((null==c?void 0:c.positionRelative)&&c.hasPX("right"))n+=i.right-t.right;else n+=t.right-i.right}}else if(t.layoutVertical)if(0!==s){if((null==c?void 0:c.blockStatic)&&c.positionRelative&&u.blockStatic)s-=c.top}else if(0!==a){if(1===u.getBox(2)[0])a-=u.marginTop}break}else if(u.positionRelative&&u.renderParent===t)h=true;if(u.pageFlow)c=u}}if(0!==i)l.modifyBox(2,-1*i);if(0!==s)l.modifyBox(2,s);else if(0!==a)l.modifyBox(2,-1*a);if(0!==r)if(l.autoMargin.left)l.modifyBox(4,-1*r);else l.modifyBox(16,r);else if(0!==n)l.modifyBox(16,-1*n);if(l!==e)l.setBoxSpacing()}}},Sprite:class Sprite extends ExtensionUI{is(e){return 0===e.length&&e.hasWidth&&e.hasHeight}condition(e){const t=e.backgroundImage;if(""!==t&&(!e.use||this.included(e.element))){const i=this.resource.getRawData(t)||this.resource.getImage(Ea(t));if(i){const t=e.actualDimension,{backgroundPositionX:s,backgroundPositionY:n}=e.cssAsObject("backgroundPositionX","backgroundPositionY"),a=va(s+" "+n,t,{fontSize:e.fontSize,screenDimension:e.localSettings.screenDimension}),r=(a.left<0||Sa.test(s))&&i.width>t.width,l=(a.top<0||Sa.test(n))&&i.height>t.height;if((r||l)&&(r||0===a.left)&&(l||0===a.top))return e.data(vt.SPRITE,"mainData",{image:i,position:a}),true}}return false}},Table:Table,VerticalAlign:class VerticalAlign extends ExtensionUI{is(e){return e.length>0}condition(e){let t=false,i=0,s=0;const n=e.children,a=n.length;let r=0;while(r<a){const e=n[r++];if(!(e.positionStatic||e.positionRelative&&e.length))return false;else if(e.inlineVertical){const n=za(e.verticalAlign);if(0!==n)t=true;if(!isNaN(s))if(0===s)s=n;else if(s!==n)s=NaN;++i}else s=NaN}return t&&isNaN(s)&&i>1&&NodeUI.linearData(n).linearX}processNode(e){return e.each(e=>{if(e.inlineVertical&&Va(e.verticalAlign)||e.imageElement||e.svgElement)e.baselineAltered=true}),{subscribe:true}}postConstraints(e){if(e.layoutHorizontal)for(const t of e.horizontalRows||[e.renderChildren]){const e=[];let i,s=1/0;if(t.forEach(t=>{const n=t.linear.top;if(t.inlineVertical&&n<=s){if(n<s)e.length=0;e.push(t),s=n}if(t.baselineActive)i=t}),e.length){const s=e[0],n=s.linear.top;if(t.forEach(t=>{if(t!==i){if(t.inlineVertical)if(!e.includes(t)){if(Va(t.verticalAlign)||!i)t.setBox(2,{reset:1,adjustment:t.linear.top-n}),t.baselineAltered=true}else if(i&&(t.imageElement||t.svgElement)&&i.documentId===t.alignSibling("baseline"))t.setBox(2,{reset:1,adjustment:i.linear.top-t.linear.top});if(t.baselineAltered)t.setCacheValue("verticalAlign","0px")}}),i)i.setBox(2,{reset:1,adjustment:i.linear.top-n+Math.min(0,s.parseHeight(s.cssInitial("verticalAlign")))}),i.baselineAltered=true}}else e.each(e=>e.baselineAltered=false)}},WhiteSpace:class WhiteSpace extends ExtensionUI{afterBaseLayout(){const e=this.application,t=new Set,i=e.session.clearMap;this.cacheProcessing.each(e=>{var s,n;if(e.naturalElement&&!e.hasAlign(4)){const a=e.naturalChildren,r=a.length;if(0===r)return;const l=e.pageFlow,o=l&&sr(e,true)&&!e.actualParent.layoutElement;let c,h;for(let l=0;l<r;++l){const d=a[l];if(d.pageFlow){if(o)if(!d.floating){if(!c)c=d;h=d}else if(h){if(d.linear.bottom>=h.linear.bottom)h=d}else h=d;if(sr(d,true))if(l>0){const a=d.previousSiblings({floating:false}),o=a.length;if(o){let h=false;const u=a[o-1];if(sr(u,false)){let e=u.marginBottom,n=d.marginTop;if(u.marginTop<0&&0===u.bounds.height){const i=Math.min(e,u.marginTop);if(i<0){if(Math.abs(i)<n)d.modifyBox(2,i);else lr(d,2);t.add(u.id),u.hide({collapse:true});continue}}else if(d.marginBottom<0&&0===d.bounds.height){const i=Math.min(n,d.marginBottom);if(i<0){if(Math.abs(i)<e)u.modifyBox(8,i);else lr(u,8);t.add(d.id),d.hide({collapse:true});continue}}let a=false,r=u;while(hr(r,true)){let t=ar(r);if(0===(null==t?void 0:t.getBox(8)[0])){let i=t.marginBottom,s=t;while(0===s.bounds.height&&!s.pseudoElement){const e=s.marginTop;if(i=Math.max(e,s.marginBottom,i),0!==e)lr(s,2);const n=s.previousSibling;if(n)if(n.marginBottom>=i){if(0!==s.marginBottom)lr(s,8);t=n,i=n.marginBottom,s=n}else if(n.bounds.height>0)break;else{if(0!==n.marginBottom)lr(n,8);s=n}else break}if(0!==i)lr(t,8,0===u.getBox(8)[0]?u:void 0);if(i>e)e=i,a=true;else if(0===i&&0===e){r=t;continue}}break}r=d;while(dr(r,true)){let e=r.firstStaticChild;if(sr(e,true)&&0===e.getBox(2)[0]){let t=e.marginTop,i=e;while(0===i.bounds.height&&!i.pseudoElement){const s=i.marginBottom;if(t=Math.max(i.marginTop,s,t),0!==s)lr(i,8);const n=i.nextSibling;if(n)if(n.marginTop>=t){if(0!==i.marginTop)lr(i,2);e=n,t=n.marginTop,i=n}else if(n.bounds.height>0)break;else{if(0!==n.marginTop)lr(n,2);i=n}else break}if(0!==t)lr(e,2,0===d.getBox(2)[0]?d:void 0);if(t>n)n=t,h=true;else if(0===t&&0===n){r=e;continue}}break}if(e>0)if(n>0){if(n<=e){if(!h||!rr(d)){if(lr(d,2),0===d.bounds.height&&e>=d.marginBottom)lr(d,8);h=false}}else if(!a||!rr(u)){if(lr(u,8),0===u.bounds.height&&n>=u.marginTop)lr(u,2);a=false}}else if(0===d.bounds.height)if(n=Math.min(n,d.marginBottom),n<0)u.modifyBox(8,n),d.hide({collapse:true});if(n>0&&u.floatContainer&&0===d.getBox(2)[1]&&!rr(u)){let e=false;if(0===u.bounds.height)e=true;else{let t;if(Ka(u.naturalElements,e=>{if(i.has(e))return true;else if(e.floating){if(e.linear.bottom>Math.ceil(u.bounds.bottom))t=e.float;return true}}),t){const i=null===(s=$a(u.element,"styleMap::after",u.sessionId))||void 0===s?void 0:s.clear;e=!("both"===i||i===t)}}if(e)d.modifyBox(2,u.box.top-Ya(u.naturalElements.map(e=>e.linear.bottom)),false)}if(h){let e=0;if(0===u.bounds.height){const t=u.previousSibling;e=t&&sr(t,false)?Math.max(t.getBox(8)[1],t.marginBottom):0}if(n>e)(d.registerBox(2)||d).setCacheValue("marginTop",n)}if(a){let t=0;if(0===d.bounds.height){const e=d.nextSibling;t=e&&sr(e,true)?Math.max(e.getBox(2)[1],e.marginTop):0}if(e>=t)(u.registerBox(8)||u).setCacheValue("marginBottom",e)}}else if(0===d.bounds.height){const{marginTop:e,marginBottom:t}=d;if(e>0&&t>0)if(e<t)lr(d,2);else if(l===r-1)d.setCacheValue("marginBottom",e),lr(d,2);else lr(d,8)}if(!h&&d!==c&&a.length>1&&(e.layoutVertical||(null===(n=d.renderParent)||void 0===n?void 0:n.layoutVertical))){const e=a.pop();if(e.floating&&Math.floor(e.bounds.top)===Math.floor(d.bounds.top))d.modifyBox(2,-e.bounds.height,false)}}}else if(0===d.bounds.height){const{marginTop:e,marginBottom:t}=d;if(e>0&&t>0){if(e<t)d.setCacheValue("marginTop",t);lr(d,8)}}}}if(l&&!rr(e)&&"FIELDSET"!==e.tagName){if(null==c?void 0:c.naturalElement)ir(e,c,true);if(null==h?void 0:h.naturalElement)if(ir(e,h,false),h.marginTop<0){const t=h.bounds.height+h.marginBottom+h.marginTop;if(t<0)e.modifyBox(128,t,false)}}}}),e.processing.excluded.each(e=>{if(e.lineBreak&&!e.lineBreakTrailing&&!i.has(e)&&!t.has(e.id)){let i=false;const s=e.previousSiblings({floating:false});if(s.length){const n=e.actualParent,a=e.nextSiblings();if(a.length){let r,l,o=s.pop(),c=a.pop(),h=0;if(o.rendered&&c.rendered){const a=o.inlineStatic&&c.inlineStatic;if(a&&0===s.length)return void t.add(e.id);if(!o.multiline&&o.has("lineHeight")){const e=Math.floor((o.lineHeight-o.bounds.height)/2);if(e>0)h+=e}if(!c.multiline&&c.has("lineHeight")){const e=Math.round((c.lineHeight-c.bounds.height)/2);if(e>0)h+=e}if(a){if(r=s[0],1===s.length)r=r.lineBreak?e:void 0;null==r||r.setBounds(false)}let d=o.renderParent,u=c.renderParent;if(d!==u){while(d&&d!==n)o=d,d=o.renderParent;while(u&&u!==n)c=u,u=c.renderParent}if([l,c]=nr(c,o,h,r),l>=1)if(c.visible)c.modifyBox(2,l),i=true;else if(o.visible)o.modifyBox(8,l),i=true}else if([l,c]=nr(c,o,h),l>=1)if((c.lineBreak||c.excluded)&&n.lastChild===c)n.modifyBox(128,l),i=true;else if((o.lineBreak||o.excluded)&&n.firstChild===o)n.modifyBox(32,l),i=true}else if(n.visible&&!n.preserveWhiteSpace&&"CODE"!==n.tagName){if(!n.documentRoot&&!n.documentBody){const e=s[s.length-1],t=0===e.bounds.height&&e.length?NodeUI.outerRegion(e):e.linear,i=n.box.bottom-(e.lineBreak||e.excluded?t.top:t.bottom);if(0!==i)if(e.rendered||n.visibleStyle.background)n.modifyBox(128,i);else if(!n.hasHeight)or(n,i)}else if(a.length){const e=a[a.length-1],t=(e.lineBreak||e.excluded?e.linear.bottom:e.linear.top)-n.box.top;if(0!==t)if(e.rendered||n.visibleStyle.background)n.modifyBox(32,t);else if(!n.hasHeight)or(n,t)}i=true}if(i)s.forEach(e=>t.add(e.id)),a.forEach(e=>t.add(e.id))}}})}afterConstraints(){this.cacheProcessing.each(e=>{if(e.naturalChild&&e.styleElement&&e.inlineVertical&&e.pageFlow&&!e.positioned&&!e.actualParent.layoutElement){const t=e.outerMostWrapper,i=t.renderParent;if(false===(null==i?void 0:i.hasAlign(4))){if(e.blockDimension&&!e.floating)if(i.layoutVertical){const s=i.renderChildren,n=s.findIndex(e=>e===t);if(-1!==n){if(!e.lineBreakLeading&&!e.baselineAltered){const e=s[n-1];if(null==e?void 0:e.pageFlow)er(t,2,e.actualRect("bottom"),e.getBox(8)[1])}if(!e.lineBreakTrailing){const e=s[n+1];if((null==e?void 0:e.pageFlow)&&e.styleElement&&!e.inlineVertical)er(t,8,e.actualRect("top"),e.getBox(2)[1])}}}else if(!e.baselineAltered){const s=i.horizontalRows;let n;if(s&&s.length>1)e:{let e=-1/0;const i=s.length;for(let a=0;a<i;++a){const i=s[a],r=i.length;let l=0;while(l<r)if(t===i[l++]){if(a>0)er(t,2,e);else n=i;break e}if(i.forEach(t=>{const i=t.innerMostWrapped;if(ur(i))e=Math.max(i.actualRect("bottom"),e)}),e===-1/0)break}}else if(i.layoutHorizontal||i.hasAlign(1024))n=i.renderChildren;if(n){let i=[];n.forEach(e=>{if(e.nodeGroup)i=i.concat(e.cascade(e=>e.naturalChild));else if(e.innerWrapped)i.push(e.innerMostWrapped);else i.push(e)});let s=-1/0;const a=e.actualParent,r=e.actualRect("top"),l=a.naturalChildren,o=l.length;let c=0;while(c<o){const e=l[c++];if(i.includes(e))break;else if(e.lineBreak||e.block)s=-1/0;else if(ur(e))s=Math.max(e.actualRect("bottom"),s)}if(s!==-1/0&&r>s)er(t,2,s)}}if(!i.layoutVertical&&!t.alignParent("left")){const s=t.alignSibling("leftRight");if(""!==s){const e=i.renderChildren.find(e=>e.documentId===s);if(null==e?void 0:e.inlineVertical)er(t,16,e.actualRect("right"))}else{let i=e;while(true){const e=i.siblingsLeading;if(e.length&&!e.some(e=>e.lineBreak||e.excluded&&e.blockStatic)){const s=e[0];if(s.inlineVertical)er(t,16,s.actualRect("right"));else if(s.floating){i=s;continue}}break}}}}}if(e.floatContainer&&e.layoutVertical){const t=[];e.naturalChildren.forEach(i=>{if(i.pageFlow)if(!i.floating){if(t.length){const s=i.outerMostWrapper;let n=s.renderParent;if(n){const[a,r]=i.getBox(2);if((0===a?i.marginTop:0)+r>0){const i=Math.floor(e.bounds.top),a=t.length;let r=0;while(r<a){const a=t[r++];if(i<=Math.floor(a.bounds.top)){let t=a.outerMostWrapper.renderParent;if(t){if(n=n.ascend({error:e=>e.naturalChild,attr:"renderParent"}).pop()||n,t=t.ascend({error:e=>e.naturalChild,attr:"renderParent"}).pop()||t,n!==t)s.modifyBox(2,-1*(t!==e?t:a).linear.height,false);break}}}}}t.length=0}}else t.push(i)})}})}}},gr={constant:kt,enumeration:_t};e.Application=Application,e.ApplicationUI=class ApplicationUI extends Application{constructor(e,t,i,s,n){super(e,t,i,s,n),this.session={cache:new NodeList,excluded:new NodeList,extensionMap:new Map,clearMap:new Map,active:[]},this.builtInExtensions={},this.extensions=[],this._layouts=[];const a=this.controllerHandler.localSettings;this._controllerSettings=a,this._excluded=a.unsupported.excluded}finalize(){if(this.closed)return;const{controllerHandler:e,session:t}=this,i=t.cache,s=this.extensions,n=this._layouts,a=i.children,r=a.length,l=new Array(r);let o=0,c=0;while(o<r){const e=a[o++];if(e.renderParent&&e.visible){if(e.hasProcedure(wt.LAYOUT))e.setLayout();if(e.hasProcedure(wt.ALIGNMENT))e.setAlignment();l[c++]=e}}l.length=c,e.optimize(l),s.forEach(e=>{for(const t of e.subscribers)e.postOptimize(t)});const h=[];o=0;while(o<c){const e=l[o++];if(e.hasResource(St.BOX_SPACING))e.setBoxSpacing();if(e.documentRoot){if(0===e.renderChildren.length&&!e.inlineText){const t=e.naturalElements;if(t.length&&t.every(e=>e.documentRoot))continue}const t=e.innerMostWrapped.data(Application.KEY_NAME,"layoutName");if(t)h.push({node:e,layoutName:t})}}s.forEach(e=>e.beforeCascade(h));const d=this._controllerSettings.layout.baseTemplate,u=mi(this.systemName);h.forEach(t=>{var i;const s=t.node,n=s.renderParent.renderTemplates;if(n)this.saveDocument(t.layoutName,d+e.cascadeDocument(n,Math.abs(s.depth)),s.dataset["pathname"+u],(null===(i=s.renderExtension)||void 0===i?void 0:i.some(e=>e.documentBase))?0:void 0)}),this.resourceHandler.finalize(n),e.finalize(n),s.forEach(e=>e.afterFinalize()),fi("__squared.pseudo"),this.closed=true}copyToDisk(e,t){return super.copyToDisk(e,this.createAssetOptions(t))}appendToArchive(e,t){return super.appendToArchive(e,this.createAssetOptions(t))}saveToArchive(e,t){return super.saveToArchive(e,this.createAssetOptions(t))}reset(){super.reset();const e="iteration"+mi(this.systemName);for(const t of this.rootElements)delete t.dataset[e];const t=this.session;t.cache.reset(),t.excluded.reset(),t.extensionMap.clear(),this._layouts.length=0}conditionElement(e,t){if(!this._excluded.has(e.tagName))if(this.controllerHandler.visibleElement(e,t)||this._cascadeAll)return true;else if(!t){switch(oi(e).position){case"absolute":case"fixed":return this.useElement(e)}let t=e.parentElement;while(t){if("none"===oi(t).display)return this.useElement(e);t=t.parentElement}const i=this.controllerHandler;if(wi(e.children,e=>i.visibleElement(e))===1/0)return true;else return this.useElement(e)}return false}insertNode(e,t,i){if(ui(e)){if(Ni(e.textContent)||(null==t?void 0:t.preserveWhiteSpace)&&("PRE"!==t.tagName||0===t.element.childElementCount)){this.controllerHandler.applyDefaultStyles(e);const i=this.createNode({parent:t,element:e,append:false});if(t)i.cssApply(t.textStyle),i.setCacheValue("fontSize",t.fontSize);return i}}else if(this.conditionElement(e,i))return this.controllerHandler.applyDefaultStyles(e),this.createNode({parent:t,element:e,append:false});else{const i=this.createNode({parent:t,element:e,append:false});return i.visible=false,i.excluded=true,i}}saveDocument(e,t,i,s){if(Si(t)){const n={pathname:i?Ai(i.replace(/\\/g,"/"),"/"):pi(this.userSettings.outputDirectory,this._controllerSettings.layout.pathName),filename:e,content:t,index:s};if(void 0===s||!(s>=0&&s<this._layouts.length))this._layouts.push(n);else this._layouts.splice(s,0,n)}}renderNode(e){return 0===e.itemCount?this.controllerHandler.renderNode(e):this.controllerHandler.renderNodeGroup(e)}addLayout(e){const t=e.renderType;if(vi(t,512))if(vi(t,8))e=this.processFloatHorizontal(e);else if(vi(t,16))e=this.processFloatVertical(e);if(0!==e.containerType){const t=this.renderNode(e);if(t)return this.addLayoutTemplate(t.parent||e.parent,e.node,t,e.renderIndex)}return false}addLayoutTemplate(e,t,i,s){if(i){if(!t.renderExclude){if(t.renderParent){const n=_i(e,"renderTemplates");if(void 0===s||!(s>=0&&s<e.renderChildren.length))e.renderChildren.push(t),n.push(i);else e.renderChildren.splice(s,0,t),n.splice(s,0,i)}}else t.hide({remove:true}),t.excluded=true;return true}return false}createNode(e){const{element:t,parent:i,children:s}=e,n=new this.Node(this.nextId,this.processing.sessionId,t);if(this.controllerHandler.afterInsertNode(n),i){if(n.depth=i.depth+1,i.naturalElement&&(!t||null===t.parentElement))n.actualParent=i;const s=e.innerWrap;if(s&&i.replaceTry({child:s,replaceWith:n}))s.parent=n,n.innerWrapped=s}if(null==s||s.forEach(e=>e.parent=n),false!==e.append)this.processing.cache.append(n,true===e.delegate,true===e.cascade);return n}createCache(e){const t=this.createRootNode(e);if(t){const e=this.controllerHandler,i=this._cache,s=this.processing.excluded,n=t.parent,a={},r=new Set,l=[];let o=false;if(t.documentBody)n.naturalChild=true,n.setCacheValue("naturalElement",true),n.visible=false,n.addAlign(4),n.exclude({resource:St.FONT_STYLE|St.VALUE_STRING,procedure:wt.ALL}),i.append(n);if(t.originalRoot=true,t.documentParent=n,i.each(e=>{if(e.styleElement){const t=e.element;if(e.length){const i=e.cssInitial("textAlign");switch(i){case"center":case"right":case"end":Li(a,t,e.id,"text-align","left",i);break}}if(e.positionRelative)ni.forEach(i=>{if(e.hasPX(i)&&0!==e[i])Li(a,t,e.id,i,"auto",e.css(i)),o=true});if("rtl"===e.dir)t.dir="ltr",r.add(t),o=true}}),s.each(e=>{if(!e.pageFlow)e.cssTry("display","none")}),i.each(e=>{if(!e.pseudoElement)e.setBounds(!o&&void 0===a[e.id]);else l.push(e)}),l.length){const e=[];l.forEach(t=>{const i=t.actualParent.element;let s,n=i.id;if(t.pageFlow){if(""===n)n="__squared_"+Math.round(Math.random()*(new Date).getTime()),i.id=n;s=ci(`#${n+Pi(t.element,t.sessionId)} { display: none !important; }`)}if(t.cssTry("display",t.display))e.push({item:t,id:n,parentElement:i,styleElement:s})}),e.forEach(e=>e.item.setBounds(false)),e.forEach(e=>{const t=e.styleElement;if(e.id.startsWith("__squared_"))e.parentElement.id="";if(t)try{document.head.removeChild(t)}catch(e){}e.item.cssFinally("display")})}s.each(e=>{if(!e.lineBreak)e.setBounds(!o),e.saveAsInitial();if(!e.pageFlow)e.cssFinally("display")}),i.each(e=>{if(e.styleElement){const t=e.element,i=a[e.id];if(i)for(const e in i)t.style.setProperty(e,i[e]);if(r.has(t))t.dir="rtl"}e.saveAsInitial()}),e.evaluateNonStatic(t,i),e.sortInitialCache()}return t}afterCreateCache(e){const t=mi(this.systemName),i=e.dataset,s=i["filename"+t]||i.filename,n=i["iteration"+t],a=Si(s)&&s.replace(new RegExp(`\\.${this._controllerSettings.layout.fileExtension}$`),"")||e.elementId||"document_"+this.length,r=(n?parseInt(n):-1)+1,l=xi(r>0?a+"_"+r:a,true);i["iteration"+t]=r.toString(),i["layoutName"+t]=l,e.data(Application.KEY_NAME,"layoutName",l),this.setBaseLayout(),this.setConstraints(),this.setResources()}useElement(e){const t=this.getDatasetName("use",e);return Si(t)&&t.split(Ii.SEPARATOR).some(e=>!!this.extensionManager.retrieve(e))}toString(){var e;return(null===(e=this.layouts[0])||void 0===e?void 0:e.content)||""}cascadeParentNode(e,t,i){var s;const n=this.insertNode(e);if(n&&("none"!==n.display||0===t||Gi(n))){if(n.depth=t,0===t){this._cache.append(n);for(const e of n.extensions)if(null===(s=this.extensionManager.retrieve(e))||void 0===s?void 0:s.cascadeAll){this._cascadeAll=true;break}}const a=this.controllerHandler;if(n.excluded&&!Gi(n)||a.preventNodeCascade(e))return n;const r=this.processing.sessionId,l=this.createPseduoElement(e,"::before",r),o=this.createPseduoElement(e,"::after",r),c=e.childNodes,h=c.length,d=new Array(h),u=new Array(e.childElementCount);let f=true,g=0,p=0,m=0;while(g<h){const e=c[g++];let s;if(e===l){if(s=this.insertNode(l,void 0,"::before"),s){if(n.innerBefore=s,!s.textEmpty)s.inlineText=true;f=false}}else if(e===o){if(s=this.insertNode(o,void 0,"::after"),s){if(n.innerAfter=s,!s.textEmpty)s.inlineText=true;f=false}}else if("#"===e.nodeName.charAt(0)){if(ui(e))s=this.insertNode(e,n)}else if(a.includeElement(e)){if(i)Ui(this.getDatasetName("use",e),i).some(t=>t.init(e));if(!this.rootElements.has(e)){if(s=this.cascadeParentNode(e,t+1,i),false===(null==s?void 0:s.excluded))f=false}else{if(s=this.insertNode(e),s)s.documentRoot=true,s.visible=false,s.excluded=true;f=false}if(s)u[m++]=s}if(s)s.childIndex=p,s.naturalChild=true,d[p++]=s}if(d.length=p,u.length=m,n.naturalChildren=d,n.naturalElements=u,this.cacheNodeChildren(n,d,f),m>0&&this.userSettings.createQuerySelectorMap)n.queryMap=this.createQueryMap(u,m)}return n}cacheNodeChildren(e,t,i){const s=t.length;if(s){const n=this._cache;let a=[],r=[];if(s>1){let l=t[0],o=false;for(let c=0,h=0;c<s;++c){const d=t[c];if(d.excluded)this.processing.excluded.append(d);else if(!d.plainText||!i)d.containerIndex=h++,d.parent=e,n.append(d);if(d.pageFlow){if(d.floating)o=true;if(c>0)if(r.push(d),d.lineBreak)t[c-1].lineBreakTrailing=true;if(!d.excluded)d.siblingsLeading=a,l.siblingsTrailing=r,a=[],r=[],l=d;if(c<s-1)if(a.push(d),d.lineBreak)t[c+1].lineBreakLeading=true}d.actualParent=e}l.siblingsTrailing=r,e.floatContainer=o}else{const i=t[0];if(i.excluded)this.processing.excluded.append(i);else if(!i.plainText)i.siblingsLeading=a,i.siblingsTrailing=r,i.parent=e,i.containerIndex=0,n.append(i),e.floatContainer=i.floating;i.actualParent=e}}else i=!e.textEmpty;e.inlineText=i}setBaseLayout(){const{controllerHandler:e,processing:t,session:i}=this,{extensionMap:s,clearMap:n}=i,a=t.cache,r=t.node,l=new Map;let o=this.extensionsTraverse;{let e=0;ji(l,-1,0,r.parent),a.each(t=>{if(t.length){const i=t.depth;if(ji(l,i,t.id,t),e=Math.max(i,e),t.floatContainer){const e=new Set,i={};t.naturalChildren.forEach(t=>{if(t.pageFlow){const s=t.floating;if(e.size){const a=t.css("clear");if("none"!==a){if(!s){let s;switch(a){case"left":s=[i.left];break;case"right":s=[i.right];break;default:s=[i.left,i.right];break}s.forEach(s=>{if(s){const n=s.float;if(e.has(n)&&Math.ceil(t.bounds.top)>=s.bounds.bottom)e.delete(n),i[n]=void 0}})}if(e.has(a)||"both"===a){if(n.set(t,2===e.size?"both":a),!s)t.setBox(2,{reset:1});e.clear(),i.left=void 0,i.right=void 0}}}if(s){const s=t.float;e.add(s),i[s]=t}}})}}});let t=0;while(t<e)l.set(qi(t++),new Map);a.afterAppend=(e,t=false)=>{if(ji(l,qi(e.depth),e.id,e),t&&e.length)e.cascade(e=>{var t;if(e.length){const i=e.depth;null===(t=l.get(i))||void 0===t||t.delete(e.id),ji(l,qi(i),e.id,e)}return false})}}this.extensions.forEach(e=>e.beforeBaseLayout());for(const t of l.values())for(const i of t.values()){if(0===i.length)continue;const t=i.floatContainer,a=i.renderExtension,r=i.duplicate(),l=r.length;for(let i=0;i<l;++i){let c=r[i];if(c.rendered||!c.visible)continue;let h=c.parent;if(l>1&&i<l-1&&c.pageFlow&&(0===h.alignmentType||h.hasAlign(2)||c.hasAlign(8192))&&!h.hasAlign(4)&&!c.nodeGroup&&c.hasSection(Et.DOM_TRAVERSE)){const s=[],a=[];let o,d,u=i,f=0;if(h.layoutVertical&&c.hasAlign(8192))s.push(c),++u,++f;e:{let e=false;for(;u<l;++u,++f){const i=r[u];if(i.pageFlow){if(i.labelFor&&!i.visible){--f;continue}if(t){if(e){if(n.get(i))e=false}if(i.floating)e=true}if(0===f){const e=i.siblingsTrailing[0];if(e){if(!Xi(i)||e.alignedVertically([i])>0)a.push(i);else s.push(i);continue}}const r=i.siblingsLeading[0];if(r){const l=s.length>0;if(t){const t=i.alignedVertically(l?s:a,n,l);if(t>0){if(l){if(t<4&&e&&!i.siblingsLeading.some(e=>e.lineBreak&&!n.has(e))){if(!i.floating||r.floating&&i.bounds.top<Math.floor(r.bounds.bottom)){let t=-1/0;if(!i.floating)s.forEach(e=>{if(e.floating)t=Math.max(t,e.bounds.bottom)});if(!i.floating&&i.bounds.top<Math.floor(t)||e)if(s.push(i),!i.floating&&Math.ceil(i.bounds.bottom)>t)break e;else continue}}else switch(t){case 6:case 7:if(!n.has(i))n.set(i,"both");break}break e}if(!Di(i,s,a))break e}else if(!Oi(i,s,a))break e}else if(i.alignedVertically(l?s:a,void 0,l)>0){if(!Di(i,s,a))break e}else if(!Oi(i,s,a))break e}else break e}else if(i.autoPosition){const e=a.length;if(e){if(a[e-1].blockStatic)a.push(i);break}else s.push(i)}}}let g=s.length;if(g>1)o=e.processTraverseHorizontal(new LayoutUI(h,c,0,0,s),r),d=s[g-1];else if(g=a.length,g>1)if(o=e.processTraverseVertical(new LayoutUI(h,c,0,0,a),r),d=a[g-1],Xi(d)&&d!==r[l-1])d.addAlign(8192);let p=true;if(o)if(this.addLayout(o))h=c.parent;else p=false;if(p&&d===r[l-1])h.removeAlign(2)}if(c.removeAlign(8192),i===l-1)h.removeAlign(2);if(c.renderAs&&h.replaceTry({child:c,replaceWith:c.renderAs}))if(c.hide(),c=c.renderAs,c.positioned)h=c.parent;if(!c.rendered&&c.hasSection(Et.EXTENSION)){const e=s.get(c.id);let t=e?a?a.concat(e):e:a,i=false;if(t){const e=t.length;let s=0;while(s<e){const e=t[s++],n=e.processChild(c,h);if(n){const{output:t,renderAs:s,outputAs:a}=n;if(t)this.addLayoutTemplate(n.outerParent||h,c,t);if(s&&a)this.addLayoutTemplate(n.parentAs||h,s,a);if(h=n.parent||h,n.subscribe)e.subscribers.add(c);if(i=true===n.next,n.complete||i)break}}if(i)continue}if(c.styleElement){t=Ui(c.use,o);const s=t.length;let n=0;while(n<s){const s=t[n++];if(s.is(c))if(s.condition(c,h)&&(!e||!e.includes(s))){const e=s.processNode(c,h);if(e){const{output:t,renderAs:n,outputAs:a}=e;if(t)this.addLayoutTemplate(e.outerParent||h,c,t);if(n&&a)this.addLayoutTemplate(e.parentAs||h,n,a);if(h=e.parent||h,e.include)_i(c,"renderExtension").push(s),s.subscribers.add(c);else if(e.subscribe)s.subscribers.add(c);if(e.remove){const e=o.indexOf(s);if(-1!==e)o=o.slice(0),o.splice(e,1)}if(i=true===e.next,e.complete||i)break}}}if(i)continue}}if(!c.rendered&&c.hasSection(Et.RENDER)){let t=this.createLayoutControl(h,c);if(0===t.containerType){const i=c.length?e.processUnknownParent(t):e.processUnknownChild(t);if(i.next)continue;t=i.layout}this.addLayout(t)}}}a.sort((e,t)=>{if(e.depth===t.depth){const i=e.innerWrapped,s=t.innerWrapped;if(i===t)return-1;else if(e===s)return 1;const n=e.outerWrapper,a=t.outerWrapper;if(e===a||!n&&a)return-1;else if(t===n||!a&&n)return 1;const r=e.nodeGroup,l=t.nodeGroup;if(r&&l)return e.id<t.id?-1:1;else if(r)return-1;else if(l)return 1;return 0}return e.depth<t.depth?-1:1}),this.extensions.forEach(e=>{for(const t of e.subscribers)if(a.contains(t))e.postBaseLayout(t);e.afterBaseLayout()}),i.cache.join(a),i.excluded.join(t.excluded)}setConstraints(){const e=this._cache;this.controllerHandler.setConstraints(),this.extensions.forEach(t=>{for(const i of t.subscribers)if(e.contains(i))t.postConstraints(i);t.afterConstraints()})}setResources(){const e=this.resourceHandler;this._cache.each(t=>{if(e.setBoxStyle(t),!t.imageElement&&!t.svgElement&&t.visible)e.setFontStyle(t),e.setValueString(t)}),this.extensions.forEach(e=>e.afterResources())}processFloatHorizontal(e){const t=this.controllerHandler,{containerType:i,alignmentType:s}=t.containerTypeVertical,n=this.session.clearMap,a=[],r=[],l=[],o=[],c=[];let h,d,u,f,g=false;if(e.each((e,t)=>{if(t>0){if(n.get(e))g=true}const i=e.float;if(!g)if("left"===i)o.push(e);else if("right"===i)c.push(e);else if(o.length||c.length){let t=e.linear.top;if(e.styleText){const i=e.textBounds;if(i)t=Math.max(i.top,t)}if(t=Math.ceil(t),o.some(e=>t>=e.bounds.bottom)||c.some(e=>t>=e.bounds.bottom))l.push(e);else r.push(e)}else r.push(e);else if("left"===i)if(h)h.push(e);else h=[e];else if("right"===i)if(d)d.push(e);else d=[e];else l.push(e)}),o.length)u=h?[o,h]:o;if(c.length)f=d?[c,d]:c;if(c.length+((null==d?void 0:d.length)||0)===e.length)e.add(2048);if(l.length){const{node:n,parent:a}=e;if(l.length>1)l[0].addAlign(8192);l.unshift(n);const r=t.createNodeGroup(n,l,{parent:a});r.childIndex=n.childIndex,r.containerName=n.containerName,r.inherit(n,"boxStyle"),r.innerWrapped=n,n.resetBox(30,r),n.resetBox(480,r),this.addLayout(new LayoutUI(a,r,i,s|(a.blockStatic?64:0),l)),e.parent=r}if(r.length)a.push(r);if(u)a.push(u);if(f)a.push(f);return e.type=t.containerTypeVerticalMargin,e.itemCount=a.length,e.add(64),a.forEach(n=>{let a,l;if(Array.isArray(n[0])){a=n;const r=a.length;let o=a[0],h=1;while(h<r)o=o.concat(a[h++]);o.sort((e,t)=>e.childIndex<t.childIndex?-1:1);const d=e.node;if(d.layoutVertical)l=d;else l=t.createNodeGroup(o[0],o,{parent:d}),this.addLayout(LayoutUI.create({parent:d,node:l,containerType:i,alignmentType:s|(a.some(e=>e===f||e===c)?2048:0),itemCount:r}))}else a=[n];a.forEach(n=>{const a=n[0],h=l||e.node,d=t.createNodeGroup(a,n,{parent:h,delegate:true}),u=new LayoutUI(h,d,0,128);if(n===r)u.add(256);else u.add(function(e){let t=0,i=true,s=true;const n=e.length;let a=0;while(a<n){const t=e[a++];if(!t.floating)s=false;if(!t.rightAligned)i=false;if(!s&&!i)break}if(s)t|=512;if(i)t|=2048;return t}(n));if(n.some(e=>e.percentWidth>0)){if(u.type=t.containerTypePercent,1===n.length)u.node.innerWrapped=a}else if(1===n.length)u.setContainerType(i,s);else if(u.linearY||u.unknownAligned)u.setContainerType(i,s|(u.unknownAligned?2:0));else t.processLayoutHorizontal(u);if(this.addLayout(u),n===r)this.setFloatPadding(h,d,r,o,c)})}),e}processFloatVertical(e){const t=this.controllerHandler,{containerType:i,alignmentType:s}=t.containerTypeVertical,n=this.session.clearMap;if(0!==e.containerType){const n=e.node,a=t.createNodeGroup(n,[n],{parent:e.parent});this.addLayout(new LayoutUI(a,n,i,s,a.children)),e.node=a}else e.setContainerType(i,s);const a=[],r=[],l=[],o=[];let c=false,h=false,d=true;if(e.each(e=>{if(e.blockStatic&&0===o.length)l.push(e),h=true;else{if(n.has(e))if(!e.floating)e.setBox(2,{reset:1}),a.push(l.slice(0)),r.push(o.slice(0)),l.length=0,o.length=0;else c=true;if(e.floating){if(h)a.push(l.slice(0)),r.push(null),l.length=0,o.length=0,h=false;o.push(e)}else{if(c&&!n.has(e))d=false;l.push(e)}}}),o.length)r.push(o);if(l.length)a.push(l);if(!d){const n=e.node,l=Math.max(r.length,a.length);for(let e=0;e<l;++e){const l=a[e]||[];if(null===r[e]&&l.length){const e=t.containerTypeVertical;this.addLayout(new LayoutUI(n,t.createNodeGroup(l[0],l,{parent:n}),e.containerType,192|e.alignmentType,l))}else{const a=r[e]||[];if(l.length||a.length){const e=t.createNodeGroup(a[0]||l[0],[],{parent:n}),r=new LayoutUI(n,e);r.type=t.containerTypeVerticalMargin;const o=[];let c;if(a.length){const i=t.createNodeGroup(a[0],a,{parent:e});if(r.add(512),0===l.length&&a.every(e=>"right"===e.float))r.add(2048);o.push(i)}if(l.length)c=t.createNodeGroup(l[0],l,{parent:e}),o.push(c);if(r.itemCount=o.length,this.addLayout(r),o.forEach(n=>{if(!n.nodeGroup)n=t.createNodeGroup(n,[n],{parent:e,delegate:true});this.addLayout(new LayoutUI(e,n,i,192|s,n.children))}),l.length&&a.length){const[e,t]=ki(a,e=>"right"!==e.float);this.setFloatPadding(n,c,l,e,t)}}}}}return e}createPseduoElement(e,t,i){let s=Ri(e,"styleMap"+t,i),n=0;if("Q"===e.tagName){if(!s)s={},Mi(e,"styleMap"+t,i,s);let a=s.content;if(!a)a=oi(e,t).getPropertyValue("content")||("::before"===t?"open-quote":"close-quote"),s.content=a;if(a.endsWith("-quote")){let t=e.parentElement;while("Q"===(null==t?void 0:t.tagName))++n,t=t.parentElement}}if(s){let a=s.content;if(a){const r=Ti(a);let l=false;switch(s.position){case"absolute":case"fixed":l=true;break}if(""===r.trim())if("::after"===t){if((l||""===r||!function(e){const t=e.childNodes[e.childNodes.length-1];if(ui(t))return!/\s+$/.test(t.textContent);else return false}(e))&&!Hi(s,true,l))return}else{const t=e.childNodes,i=t.length;let n=0;while(n<i){const e=t[n++];if(ui(e)){if(""!==e.textContent.trim())break}else if(e instanceof HTMLElement){const t=oi(e);switch(t.getPropertyValue("position")){case"fixed":case"absolute":continue}if("none"!==t.getPropertyValue("float"))return;break}}switch(s.display){case void 0:case"block":case"inline":case"inherit":case"initial":if(!Hi(s,false,l))return;break}}else if("inherit"===a){let t=e;do{if(a=oi(t).getPropertyValue("content"),"inherit"!==a)break;t=t.parentElement}while(t)}const o=oi(e);ai.forEach(e=>{if(!Si(s[e]))s[e]=o[e]});let c="",h="";switch(a){case"normal":case"none":case"initial":case"inherit":case"unset":case"no-open-quote":case"no-close-quote":case'""':break;case"open-quote":if("::before"===t)h=n%2==0?"":"";break;case"close-quote":if("::after"===t)h=n%2==0?"":"";break;default:{const s=hi(a);if(""!==s)if(h=s,Ei(this._controllerSettings.mimeType.image,s))c="img";else h="";else{Bi.lastIndex=0;let s,n=false;while(null!==(s=Bi.exec(a))){const a=s[1];if(a)h+=di(e,a.trim());else if(s[2]||s[5]){const n="counter"===s[2],[a,r]=n?[s[3],s[4]||"decimal"]:[s[6],s[8]||"decimal"],l=(Fi(e,a,t,i,0)||0)+(Wi(o.getPropertyValue("counter-reset"),a,0)||0),c=[];let d,u=e,f=l,g=false;const p=(e,t)=>{const i=c.length;if(0===i)f+=e;else if(g||t)c[i-1]+=e},m=e=>{if(void 0===Wi(oi(e).getPropertyValue("counter-reset"),a))wi(e.children,e=>{if("__squared.pseudo"!==e.className){let s=Fi(e,a,t,i);if(s)p(s,true);const n=oi(e);if(s=Wi(n.getPropertyValue("counter-increment"),a),s)p(s,false);if(s=Wi(n.getPropertyValue("counter-reset"),a),void 0!==s)return true;m(e)}})};while(u){if(g=false,u.previousElementSibling){if(u=u.previousElementSibling,u)m(u)}else if(u.parentElement)u=u.parentElement,g=true;else break;if(u&&"__squared.pseudo"!==u.className){const e=Fi(u,a,t,i);if(e)p(e,true);const s=oi(u),r=Wi(s.getPropertyValue("counter-increment"),a);if(r)p(r,false);const l=Wi(s.getPropertyValue("counter-reset"),a);if(void 0!==l){if(!d)f+=l;if(d=u,n)break;else if(g)c.push((e||0)+l)}}}if(d){if(!n&&c.length>1){c.reverse().splice(1,1);const e=s[7];c.forEach(t=>h+=ri(r,t,true)+e)}}else f=l;h+=ri(r,f,true)}else if(s[9])h+=s[9];n=true}if(!n)h=a}break}}if(!Si(s.display))s.display="inline";if(h||'""'===a){if(""===c)c=/^(inline|table)/.test(s.display)?"span":"div";const n=function(e,t="span",i=-1){const s=document.createElement(t);if(s.className="__squared.pseudo",s.style.setProperty("display","none"),i>=0&&i<e.childNodes.length)e.insertBefore(s,e.childNodes[i]);else e.appendChild(s);return s}(e,c,"::before"===t?0:-1);if("img"===c){n.src=h;const e=this.resourceHandler.getImage(h);if(e){if(!Si(s.width)&&e.width>0)s.width=li(e.width);if(!Si(s.height)&&e.height>0)s.height=li(e.height)}}else if('""'!==a)n.innerText=h;for(const e in s)if("display"!==e)n.style[e]=s[e];return Mi(n,"pseudoElement",i,t),Mi(n,"styleMap",i,s),n}}}}createAssetOptions(e){let t=null==e?void 0:e.assets;if(t)t=this.layouts.concat(t);else t=this.layouts;return Object.assign(Object.assign({},e),{assets:t})}createLayoutControl(e,t){return new LayoutUI(e,t,t.containerType,t.alignmentType,t.children)}setFloatPadding(e,t,i,s,n){let a=[];i.forEach(e=>{if(Vi(e)||e.centerAligned)a.push(e);if(e.blockStatic)a=a.concat(e.cascade(e=>Vi(e)))});const r=t.bounds.bottom,l=e.actualBoxWidth();if(s.length){let i=-1/0,n=false;if(s.forEach(e=>{if(e.bounds.top<r){const t=e.linear.right+zi(e,false);if(t>i)i=t,n=e.marginRight>0;else if(t===i&&e.marginRight<=0)n=false}}),i!==-1/0){let s=-1/0;if(a.forEach(e=>{if(Math.floor(e.linear.left)<=i||e.centerAligned)s=Math.max(s,e.marginLeft)}),s!==-1/0){const r=i-e.box.left-s-gi(t.map(e=>!a.includes(e)?e.marginLeft:0));if(r>0&&r<l)t.modifyBox(256,r+(!n&&t.find(e=>e.multiline,{cascade:true})?Math.max(s,this._controllerSettings.deviations.textMarginBoundarySize):0))}}}if(n.length){let i=1/0,s=false;if(n.forEach(e=>{if(e.bounds.top<r){const t=e.linear.left+zi(e,true);if(t<i)i=t,s=e.marginLeft>0;else if(t===i&&e.marginLeft<=0)s=false}}),i!==1/0){let n=-1/0;if(a.forEach(e=>{if(e.multiline||Math.ceil(e.linear.right)>=i)n=Math.max(n,e.marginRight)}),n!==-1/0){const r=e.box.right-i-n-gi(t.map(e=>!a.includes(e)?e.marginRight:0));if(r>0&&r<l)t.modifyBox(64,r+(!s&&t.find(e=>e.multiline,{cascade:true})?Math.max(n,this._controllerSettings.deviations.textMarginBoundarySize):0))}}}}get layouts(){return this._layouts.sort((e,t)=>{const i=e.index,s=t.index;if(i!==s)if(0===i||s===1/0||void 0===s&&!(i===1/0))return-1;else if(0===s||i===1/0||void 0===i&&!(s===1/0))return 1;else if(void 0!==i&&void 0!==s)return i<s?-1:1;return 0})}get extensionsCascade(){return this.extensions.filter(e=>!!e.init)}get extensionsTraverse(){return this.extensions.filter(e=>!e.eventOnly)}get clearMap(){return this.session.clearMap}get length(){return this.session.cache.length}},e.Controller=Controller,e.ControllerUI=class ControllerUI extends Controller{constructor(){super(...arguments),this._requireFormat=false,this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}init(){const e=this.localSettings.unsupported;this._unsupportedCascade=e.cascade,this._unsupportedTagName=e.tagName}reset(){this._requireFormat=false,this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}preventNodeCascade(e){return this._unsupportedCascade.has(e.tagName)}applyDefaultStyles(e){const t=this.sessionId;let i;if(ns(e))i={position:"static",display:"inline",verticalAlign:"baseline",float:"none",clear:"none"};else{i=fs(e,"styleMap",t)||{};const s=e.tagName;if(Ki(8))switch(s){case"BODY":if("rgba(0, 0, 0, 0)"===i.backgroundColor)i.backgroundColor="rgb(255, 255, 255)";break;case"INPUT":case"SELECT":case"BUTTON":case"TEXTAREA":if(!cs(i.display))i.display="inline-block";break;case"FIELDSET":if(!cs(i.display))i.display="block";break}else if(Qi())switch(s){case"BODY":if("transparent"===i.backgroundColor)i.backgroundColor="rgb(255, 255, 255)";break;case"INPUT":switch(e.type){case"text":case"password":case"time":case"date":case"datetime-local":case"week":case"month":case"url":case"email":case"search":case"number":case"tel":if(!cs(i.fontSize))i.fontSize="13.3333px";break}break;case"CODE":if(!cs(i.fontFamily))i.fontFamily="monospace";break;case"LEGEND":case"RT":if(!cs(i.display))i.display="block";break}switch(s){case"INPUT":{const t=e.type;switch(t){case"radio":case"checkbox":case"image":break;case"week":case"month":case"time":case"date":case"datetime-local":i.paddingTop=es(ls(i.paddingTop)+1),i.paddingRight=es(ls(i.paddingRight)+1),i.paddingBottom=es(ls(i.paddingBottom)+1),i.paddingLeft=es(ls(i.paddingLeft)+1);break;default:{const e=this.localSettings.style,s=xs(i,e.inputBorderColor);switch(t){case"file":case"reset":case"submit":case"button":ys(i,s,e.inputBackgroundColor);break}break}}break}case"BUTTON":{const e=this.localSettings.style;ys(i,xs(i,e.inputBorderColor),e.inputBackgroundColor);break}case"TEXTAREA":case"SELECT":xs(i,this.localSettings.style.inputBorderColor);break;case"BODY":{const e=i.backgroundColor;if(!cs(e)||"initial"===e)i.backgroundColor="rgb(255, 255, 255)";break}case"FORM":if(!cs(i.marginTop))i.marginTop="0px";break;case"LI":if(!cs(i.listStyleImage)){const t=ts(e);i.listStyleImage=t.getPropertyValue("list-style-image")}break;case"IFRAME":if(!cs(i.display))i.display="block";case"VIDEO":case"CANVAS":case"svg":case"IMG":this.setElementDimension(e,s,i,"width","height"),this.setElementDimension(e,s,i,"height","width");break}}gs(e,"styleMap",t,i)}addBeforeOutsideTemplate(e,t,i=true,s=-1){const n=ds(this._beforeOutside,e);if(-1!==s&&s<n.length)n.splice(s,0,t);else n.push(t);if(i)this._requireFormat=true}addBeforeInsideTemplate(e,t,i=true,s=-1){const n=ds(this._beforeInside,e);if(-1!==s&&s<n.length)n.splice(s,0,t);else n.push(t);if(i)this._requireFormat=true}addAfterInsideTemplate(e,t,i=true,s=-1){const n=ds(this._afterInside,e);if(-1!==s&&s<n.length)n.splice(s,0,t);else n.push(t);if(i)this._requireFormat=true}addAfterOutsideTemplate(e,t,i=true,s=-1){const n=ds(this._afterOutside,e);if(-1!==s&&s<n.length)n.splice(s,0,t);else n.push(t);if(i)this._requireFormat=true}getBeforeOutsideTemplate(e,t){const i=this._beforeOutside[e];return i?ms(i,t):""}getBeforeInsideTemplate(e,t){const i=this._beforeInside[e];return i?ms(i,t):""}getAfterInsideTemplate(e,t){const i=this._afterInside[e];return i?ms(i,t):""}getAfterOutsideTemplate(e,t){const i=this._afterOutside[e];return i?ms(i,t):""}hasAppendProcessing(e){return void 0===e?this._requireFormat:e in this._beforeOutside||e in this._beforeInside||e in this._afterInside||e in this._afterOutside}includeElement(e){return!(this._unsupportedTagName.has(e.tagName)||"INPUT"===e.tagName&&this._unsupportedTagName.has(e.tagName+":"+e.type))||"true"===e.contentEditable}visibleElement(e,t){let i,s,n;if(t){const a=e.parentElement;i=a?ts(a,t):ts(e),s=1,n=1}else if(i=ts(e),"none"!==i.getPropertyValue("display")){const t=us(e,this.sessionId);if(!as(t))return false;({width:s,height:n}=t)}else return false;if(s>0&&n>0)return"visible"===i.getPropertyValue("visibility")||!bs(i);else if(!t){if(hs(e.children,e=>this.visibleElement(e))===1/0)return true;if("IMG"===e.tagName&&"none"!==i.getPropertyValue("display"))return true}if(!bs(i))return s>0&&"none"!==i.getPropertyValue("float")||!!t&&"none"!==i.getPropertyValue("clear")||"block"===i.getPropertyValue("display")&&(0!==vs(i,"margin-top")||0!==vs(i,"margin-bottom"));else return false}evaluateNonStatic(e,t){const i=new Set,s=new Set;t.each(t=>{if(!t.documentRoot&&!t.pageFlow){const n=t.parent;let a;switch(t.css("position")){case"fixed":if(!t.autoPosition){a=e;break}case"absolute":{const i=t.absoluteParent;if(i)if(a=i,t.autoPosition){if(!t.siblingsLeading.some(e=>e.multiline||e.excluded&&!e.blockStatic))t.cssApply({display:"inline-block",verticalAlign:"top"},true);else t.autoPosition=false;a=n}else if(this.userSettings.supportNegativeLeftTop){let s=false;while(a&&a!==e&&(!a.rightAligned&&!a.centerAligned||!a.pageFlow)){const e=a.linear;if(!s)if(t.hasPX("top")&&t.hasPX("bottom")||t.hasPX("left")&&t.hasPX("right"))break;else{const i="hidden"===a.css("overflowX"),n="hidden"===a.css("overflowY");if(i&&n)break;const r=!i&&t.outsideX(e),l=!n&&t.outsideY(e);if(r&&(t.left<0||t.right>0)||l&&(t.top<0||0!==t.bottom))s=true;else if(!i&&((t.left<0||t.right>0)&&Math.ceil(t.bounds.right)<e.left||(t.left>0||t.right<0)&&Math.floor(t.bounds.left)>e.right)&&a.some(e=>e.pageFlow))s=true;else if(!n&&((t.top<0||t.bottom>0)&&Math.ceil(t.bounds.bottom)<a.bounds.top||(t.top>0||t.bottom<0)&&Math.floor(t.bounds.top)>a.bounds.bottom))s=true;else if(r&&l&&(!a.pageFlow||a.actualParent.documentRoot)&&(t.top>0||t.left>0))s=true;else if(!(i||n||t.intersectX(e)||t.intersectY(e)))s=true;else break}else if(a.layoutElement){a=i;break}else if(t.withinX(e)&&t.withinY(e))break;a=a.actualParent}}break}}if(!a)a=e;if(a!==n){const e=t.absoluteParent;if((null==e?void 0:e.positionRelative)&&a!==e){const{left:i,right:s,top:n,bottom:a}=e,r=t.bounds;if(0!==i)r.left+=i,r.right+=i;else if(!e.hasPX("left")&&0!==s)r.left-=s,r.right-=s;if(0!==n)r.top+=n,r.bottom+=n;else if(!e.hasPX("top")&&0!==a)r.top-=a,r.bottom-=a;t.unset("box"),t.unset("linear")}let r=t.toFloat("opacity",1),l=n;do{r*=l.toFloat("opacity",1),l=l.actualParent}while(l&&l!==a);t.css("opacity",r.toString()),t.parent=a,t.containerIndex=1/0,i.add(a),s.add(n)}t.documentParent=a}});for(const e of s)e.each((e,t)=>e.containerIndex=t);for(const e of i){const t=[];let i=-1;e.each(s=>{if(s.containerIndex===1/0)e.some(e=>{let i=e.naturalElements.includes(s);if(!i){const t=e.cascade();i=s.ascend({condition:e=>t.includes(e)}).length>0}if(i)ds(t,e.containerIndex+(s.zIndex>=0||e!==s.actualParent?1:0)).push(s);return i});else if(s.containerIndex>i)i=s.containerIndex});const s=t.length;if(s){const n=e.children;for(let e=0,a=0,r=1;e<s;++e,++a){const s=t[e];if(s){s.sort((e,t)=>{if(e.parent===t.parent){const i=e.zIndex,s=t.zIndex;if(i===s)return e.id<t.id?-1:1;else return i<s?-1:1}return 0}).forEach(e=>e.containerIndex=i+r++);const e=n.length;for(let t=0;t<e;++t)if(s.includes(n[t]))n[t]=void 0;n.splice(a,0,...s),a+=s.length}}e.retain(os(n))}}}sortInitialCache(e){(e||this.cache).sort((e,t)=>{if(e.depth!==t.depth)return e.depth<t.depth?-1:1;else{const i=e.documentParent,s=t.documentParent;if(i!==s){const e=i.depth,t=s.depth;if(e!==t)return e<t?-1:1;else if(i.actualParent===s.actualParent)return i.childIndex<s.childIndex?-1:1;return i.id<s.id?-1:1}}return 0})}cascadeDocument(e,t){const i=this.userSettings.showAttributes,s="\t".repeat(t);let n="";const a=e.length;let r=0;while(r<a){const a=e[r++],l=a.node;switch(a.type){case 1:{const{controlName:e,attributes:r}=a,{id:o,renderTemplates:c}=l,h=t+1,d=l.depth<0?t+l.depth:t,u=this.getBeforeInsideTemplate(o,h),f=this.getAfterInsideTemplate(o,h);let g=s+"<"+e+(0===t?"{#0}":"")+(i?r?ps(r,h):l.extractAttributes(h):"");if(c||""!==u||""!==f)g+=">\n"+u+(c?this.cascadeDocument(this.sortRenderPosition(l,c),h):"")+f+s+`</${e}>\n`;else g+=" />\n";n+=this.getBeforeOutsideTemplate(o,d)+g+this.getAfterOutsideTemplate(o,d);break}case 2:{const e=a.content;if(e)n+=ps(e,t);break}}}return n}getEnclosingXmlTag(e,t="",i){return"<"+e+t+(i?`>\n${i}</${e}>\n`:" />\n")}setElementDimension(e,t,i,s,n){const a=i[s];if(!cs(a)||"auto"===a){const a=new RegExp(`\\s+${s}="([^"]+)"`).exec(e.outerHTML);if(a){const e=a[1];if(is(e))i[s]=e+"px";else if(ss(e))i[s]=e}else if("IFRAME"===t)if("width"===s)i.width="300px";else i.height="150px";else{const t=i[n];if(t&&is(t)){const a="max"+rs(s);if(!cs(i[a])||!ss(a)){const a=this.application.resourceHandler.getImage(e.src);if(a&&a.width>0&&a.height>0)i[s]=es(a[s]*parseFloat(t)/a[n])}}}}}get generateSessionId(){return(new Date).getTime().toString()}},e.Extension=Extension,e.ExtensionManager=ExtensionManager,e.ExtensionUI=ExtensionUI,e.File=File,e.FileUI=class FileUI extends File{get directory(){return this.resource.controllerSettings.directory}},e.LayoutUI=LayoutUI,e.Node=Node,e.NodeGroupUI=class NodeGroupUI extends NodeUI{init(){var e;if(this.length)this.each(e=>e.parent=this),this.setBounds(),this.saveAsInitial(),this.dir=(null===(e=this.actualParent)||void 0===e?void 0:e.dir)||""}setBounds(){if(this.length)return this._bounds=NodeUI.outerRegion(this),this._bounds}previousSiblings(e){var t;const i=((null===(t=this._initial)||void 0===t?void 0:t.children)||this.children)[0];return(null==i?void 0:i.previousSiblings(e))||[]}nextSiblings(e){var t;const i=(null===(t=this._initial)||void 0===t?void 0:t.children)||this.children,s=i[i.length-1];return(null==s?void 0:s.nextSiblings(e))||[]}get block(){let e=this._cached.block;if(void 0===e)e=this.some(e=>e.block),this._cached.block=e;return e}get blockStatic(){let e=this._cached.blockStatic;if(void 0===e){const t=this.actualParent||this.documentParent;if(e=this.some(e=>e.blockStatic||e.percentWidth>0)||t.percentWidth>0||this.layoutVertical&&(t.hasWidth||this.some(e=>e.centerAligned||e.rightAligned))||t.blockStatic&&(t.layoutVertical||this.hasAlign(256)),e||0!==this.containerType)this._cached.blockStatic=e}return e||this.hasAlign(64)}get blockDimension(){let e=this._cached.blockDimension;if(void 0===e)e=this.every(e=>e.blockDimension),this._cached.blockDimension=e;return e}get blockVertical(){let e=this._cached.blockVertical;if(void 0===e)e=this.every(e=>e.blockVertical),this._cached.blockVertical=e;return e}get inline(){let e=this._cached.inline;if(void 0===e)e=this.every(e=>e.inline),this._cached.inline=e;return e&&!this.hasAlign(64)}get inlineStatic(){let e=this._cached.inlineStatic;if(void 0===e)e=this.every(e=>e.inlineStatic),this._cached.inlineStatic=e;return e&&!this.hasAlign(64)}get inlineVertical(){let e=this._cached.inlineVertical;if(void 0===e)e=this.every(e=>e.inlineVertical),this._cached.inlineVertical=e;return e&&!this.hasAlign(64)}get inlineFlow(){let e=this._cached.inlineFlow;if(void 0===e)e=this.every(e=>e.inlineFlow),this._cached.inlineFlow=e;return e&&!this.hasAlign(64)}get inlineDimension(){let e=this._cached.inlineDimension;if(void 0===e)e=this.every(e=>e.inlineDimension),this._cached.inlineDimension=e;return e&&!this.hasAlign(64)}get pageFlow(){let e=this._cached.pageFlow;if(void 0===e){const t=this.css("position");e="absolute"!==t&&"fixed"!==t,this._cached.pageFlow=e}return e}set baseline(e){this._cached.baseline=e}get baseline(){let e=this._cached.baseline;if(void 0===e){const t=this.cssInitial("verticalAlign",true);if(""===t)e=this.every(e=>e.baseline);else e="baseline"===t||ws(t,true);this._cached.baseline=e}return e}get float(){let e=this._cached.float;if(void 0===e){if(this.floating)if(this.hasAlign(2048))e="right";else if(this.every(e=>"right"===e.float))this.addAlign(2048),e="right";else e="left";else e="none";this._cached.float=e}return e}get floating(){let e=this._cached.floating;if(void 0===e)e=this.every(e=>e.floating||e.hasAlign(512)),this._cached.floating=e;return e}get display(){return super.display||(this.some(e=>e.blockStatic)?"block":this.blockDimension?"inline-block":"inline")}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}set childIndex(e){super.childIndex=e}get childIndex(){let e=super.childIndex;if(e===1/0)this.each(t=>e=Math.min(t.childIndex,e)),super.childIndex=e;return e}set containerIndex(e){super.containerIndex=e}get containerIndex(){let e=super.containerIndex;if(e===1/0)this.each(t=>e=Math.min(t.containerIndex,e)),super.containerIndex=e;return e}get centerAligned(){let e=this._cached.centerAligned;if(void 0===e)e=this.every(e=>e.centerAligned),this._cached.centerAligned=e;return e}get rightAligned(){let e=this._cached.rightAligned;if(void 0===e)e=this.every(e=>e.rightAligned),this._cached.rightAligned=e;return e||this.hasAlign(2048)}get tagName(){return""}get plainText(){return false}get styleText(){return false}get multiline(){return false}get nodeGroup(){return true}get naturalChild(){return false}get naturalElement(){return false}get pseudoElement(){return false}get previousSibling(){return null}get nextSibling(){return null}get previousElementSibling(){return null}get nextElementSibling(){return null}},e.NodeList=NodeList,e.NodeUI=NodeUI,e.Resource=Resource,e.ResourceUI=ResourceUI,e.extensions=fr,e.lib=gr,Object.defineProperty(e,"__esModule",{value:true})}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).chrome=t()}(this,(function(){"use strict";class Resource extends squared.base.Resource{constructor(e,t){super(),this.application=e,this.cache=t}get userSettings(){return this.application.userSettings}}const{isTextNode:e}=squared.lib.dom;class Application extends squared.base.Application{constructor(){super(...arguments),this.builtInExtensions={},this.extensions=[],this.systemName="chrome",this.queryState=0}finalize(){}createNode(e){return new this.Node(this.nextId,this.processing.sessionId,e.element)}insertNode(t,s){if(e(t)){if(this.userSettings.excludePlainText)return;this.controllerHandler.applyDefaultStyles(t);const e=this.createNode({element:t});if(s)e.cssApply(s.textStyle);return e}return this.createNode({element:t})}afterCreateCache(e){switch(this.queryState){case 1:this.controllerHandler.cacheElement(e);break;default:this.controllerHandler.cacheElementList(this.processing.cache);break}}get length(){const e=Resource.ASSETS;let t=0;for(const s in e)t+=e[s].size;return t}}const t=squared.lib,{isTextNode:s}=t.dom,{setElementCache:i}=t.session;class Controller extends squared.base.Controller{constructor(e,t){super(),this.application=e,this.cache=t,this.localSettings={mimeType:{font:"*",image:"*",audio:"*",video:"*"}},this._elementMap=new Map}sortInitialCache(){}init(){this.application.processing.unusedStyles.clear()}reset(){this._elementMap.clear()}applyDefaultStyles(e){if(s(e))i(e,"styleMap",this.sessionId,{position:"static",display:"inline",verticalAlign:"baseline",float:"none",clear:"none"})}includeElement(){return true}cacheElement(e){this._elementMap.set(e.element,e)}cacheElementList(e){const t=this._elementMap;e.each(e=>t.set(e.element,e))}get elementMap(){return this._elementMap}get userSettings(){return this.application.userSettings}}const r=squared.lib,{CHAR:n,COMPONENT:o,FILE:a,XML:l}=r.regex,{appendSeparator:c,convertWord:p,fromLastIndexOf:u,isString:m,iterateReverseArray:f,objectMap:h,parseMimeType:g,partitionLastIndexOf:d,randomUUID:v,resolvePath:y,safeNestedArray:A,trimEnd:T}=r.util,S=Resource.ASSETS,E=/[\s\n]*(.+?\.[^\s,]+).*?,?/g;function x(e,t){if(t){const s=new RegExp(e+':\\s*((?:[^"]|\\\\")+)').exec(t.replace(/\\/g,"/"));if(s){const e=s[1].split("::").map(e=>e.trim());return[e[0],e[1]||void 0,"preserve"===e[2]]}}}function O(e){let t;if("/"===(e=e.replace(/\\/g,"/")).charAt(0))t="__serverroot__";else if(e.startsWith("../")){t="__serverroot__";const s=location.pathname.split("/");s.pop();for(let t=0;t<e.length&&s.length>0;t+=3)if("../"===e.substring(t,t+3))s.pop();else break;e=s.join("/")+"/"+e.split("../").pop()}else if(e.startsWith("./"))e=e.substring(2);const s=d(e,"/");return s.unshift(t),s}function b(e,t){const s=y(t.src);if(""!==s)e.set(t,s)}function C(e){var t,s;if(e){const i=e.dataset,r=(null===(t=i.useChrome)||void 0===t?void 0:t.trim())||(null===(s=i.use)||void 0===s?void 0:s.trim());if(r)return r.split(l.SEPARATOR)}return[]}function _(e,t){const s=[];this.application.extensions.forEach(t=>{if(t.processFile(e))s.push(t)});for(const i of t){const t=this.application.extensionManager.retrieve(i,true);if(t&&!s.includes(t))t.processFile(e,true)}}function F(e){for(const t in e){const s=e[t],i=s.length;if(i>1){let e=0;while(e<i)s[e].bundleIndex=e++}}}function P(e,t,s,i,r){const n=t.innerHTML.trim();if(n){const[t,o,a]=O(s);if(f(e,e=>{if((e.moveTo===t||!e.moveTo&&!t)&&e.pathname===o&&e.filename===a)return A(e,"trailingContent").push({value:n,format:i,preserve:r}),true})!==1/0)return{uri:y(s,location.href),pathname:o,filename:a,moveTo:t,content:n,format:i,preserve:r}}}class File extends squared.base.File{static parseUri(e,t={}){const{preserveCrossOrigin:s,saveTo:i}=t;let{saveAs:r,format:n,preserve:a}=t,l=T(e,"/");const c=l.startsWith(T(location.origin,"/"));if(!c&&s)return;let m;if(r){r=T(r.replace(/\\/g,"/"),"/");const e=x("saveAs",r);if(e)[m,n,a]=e;else m=r;if(c&&m)l=y(m,location.href)}const f=o.PROTOCOL.exec(l);if(f){const t=f[2],s=f[3],r=f[4],o=e.includes(".")?u(e,".").toLowerCase():void 0;let l,h,d,y="",A="";const T=e=>r.substring(e,r.lastIndexOf("/"));if(!c)if(i&&m)[h,y,A]=O(m+"/"+v()+(o?"."+o:""));else y=p(t)+(s?"/"+s.substring(1):"")+"/";else{d=location.pathname.substring(0,location.pathname.lastIndexOf("/")+1);let e=0;const t=Math.min(r.length,d.length);for(let s=0;s<t;++s)if(r.charAt(s)===d.charAt(s))e=s;else break;l=r.substring(0,e+1)}if(""===A)if(c&&m)[h,y,A]=O(m);else if(r&&"/"!==r)if(A=u(r,"/","\\"),c)if(r.startsWith(d))y=T(d.length);else h="__serverroot__",l="",y=T(0);else y+=T(1);else A="index.html";return{uri:e,rootDir:l,moveTo:h,pathname:y.replace(/\\/g,"/"),filename:A,mimeType:o&&g(o),format:n,preserve:a}}}reset(){super.reset(),this._outputFileExclusions=void 0}copyToDisk(e,t){return this.copying(Object.assign(Object.assign({},t),{assets:this.getAssetsAll().concat((null==t?void 0:t.assets)||[]),directory:e}))}appendToArchive(e,t){return this.archiving(Object.assign(Object.assign({filename:this.userSettings.outputArchiveName},t),{assets:this.getAssetsAll(t).concat((null==t?void 0:t.assets)||[]),appendTo:e}))}saveToArchive(e,t){return this.archiving(Object.assign(Object.assign({},t),{assets:this.getAssetsAll(t).concat((null==t?void 0:t.assets)||[]),filename:e}))}getHtmlPage(e){var t;const s=[],i=location.href,r=document.querySelector("html"),n=null===(t=null==e?void 0:e.saveAs)||void 0===t?void 0:t.html;let o,l;if(r)o=r.dataset.chromeFile;if(!m(o)&&(null==n?void 0:n.filename))o=u(n.filename),l=n.format;const p=File.parseUri(i,{preserveCrossOrigin:null==e?void 0:e.preserveCrossOrigin,saveAs:o,format:l});if(p){const t=null==e?void 0:e.name;if(t)p.filename=t;else{const e=p.filename;if(!a.NAME.test(e))p.pathname=c(p.pathname,e),p.filename="index.html"}if(this.validFile(p))p.requestMain=true,p.mimeType=g("html"),_.call(this,p,C(document.querySelector("html"))),s.push(p)}return s}getScriptAssets(e){var t;let s,i;if(e)s=e.preserveCrossOrigin,i=null===(t=e.saveAs)||void 0===t?void 0:t.script;const r=[],n={};return document.querySelectorAll("script").forEach(e=>{const t=e.src.trim();let o=e.dataset.chromeFile;if("exclude"!==o){let a,l,p,u;if(!m(o)&&i){const{pathname:t,filename:s}=i;if(s)o=c(t||"",s),a=i.format,l=e.outerHTML}if(""!==t)u=File.parseUri(y(t),{preserveCrossOrigin:s,saveAs:o,format:a});else if(m(o)){if(!l){const e=x("exportAs",o);if(e)[o,a,p]=e}if(o)u=P(r,e,o,a,p)}if(this.validFile(u)){if(A(n,(u.moveTo||"")+u.pathname+u.filename).push(u),u.mimeType=e.type.trim()||u.uri&&g(u.uri)||"text/javascript",l)u.outerHTML=l;_.call(this,u,C(e)),r.push(u)}}}),F(n),r}getLinkAssets(e){var t;let s,i,r;if(e)({rel:r,preserveCrossOrigin:s}=e),i=null===(t=e.saveAs)||void 0===t?void 0:t.link;const n=[],o={};document.querySelectorAll((r?`link[rel="${r}"]`:"link")+", style").forEach(e=>{let t=e.dataset.chromeFile;if("exclude"!==t){let r,a,l,p,u;if(!m(t)&&i&&("text/css"===a||e instanceof HTMLStyleElement)){const{pathname:s,filename:r}=i;if(r)t=c(s||"",r),l=i.format,p=i.preserve,u=e.outerHTML}if(e instanceof HTMLLinkElement){const i=e.href.trim();if(""!==i){switch(e.rel.trim()){case"stylesheet":a="text/css";break;case"icon":a="image/x-icon";break;default:a=e.type.trim()||g(i);break}r=File.parseUri(y(i),{preserveCrossOrigin:s,saveAs:t,format:l,preserve:p})}}else if(m(t)){if(!u){const e=x("exportAs",t);if(e)[t,l,p]=e}if(t)r=P(n,e,t,l,p)}if(this.validFile(r)){if(A(o,(r.moveTo||"")+r.pathname+r.filename).push(r),r.mimeType=a||"text/css",u)r.outerHTML=u;_.call(this,r,C(e)),n.push(r)}}});for(const[e,t]of S.rawData.entries()){const r=t.mimeType;if("text/css"===r){const t=File.parseUri(y(e),{preserveCrossOrigin:s,format:null==i?void 0:i.format});if(this.validFile(t))t.mimeType=r,_.call(this,t,[]),n.push(t)}}return F(o),n}getImageAssets(e){var t;let s,i;if(e)s=e.preserveCrossOrigin,i=null===(t=e.saveAs)||void 0===t?void 0:t.base64;const r=[],o=(e,t,i)=>{if(""!==t){let n;if(e){const t=x("saveTo",e.dataset.chromeFile);if(t)[n,i]=t}const o=File.parseUri(t,{preserveCrossOrigin:s,saveAs:n,saveTo:true});if(this.validFile(o)&&!r.find(e=>e.uri===t)){if(i)o.mimeType=n?i+":"+o.mimeType:i;return _.call(this,o,C(e)),r.push(o),o}}};document.querySelectorAll("video").forEach(e=>o(null,y(e.poster))),document.querySelectorAll("picture > source").forEach(e=>e.srcset.split(l.SEPARATOR).forEach(t=>o(e,y(t.split(n.SPACE)[0])))),document.querySelectorAll("img, input[type=image]").forEach(e=>{const t=e.src.trim();if(!t.startsWith("data:image/"))o(e,y(t))}),document.querySelectorAll("img[srcset], picture > source[srcset]").forEach(e=>{let t;E.lastIndex=0;while(null!==(t=E.exec(e.srcset.trim())))o(e,y(t[1]))});for(const e of S.image.keys())o(null,e);for(const e of S.rawData.values())if(!e.pathname){const{base64:t,content:s,filename:n}=e;let a,l=e.mimeType;if(t){if(i){const e=i.format;if(e&&(null==l?void 0:l.startsWith("image/")))switch(e){case"png":case"jpeg":case"bmp":case"gif":case"tiff":l=`@${e}:${l}`;break}const s=T(i.pathname||"","/").replace(/\\/g,"/");if(a=o(null,y(O(s+(""!==s?"/":"")+n)[1]+n,location.href),l),a){a.base64=t;continue}}a={pathname:"__generated__/base64",filename:n,mimeType:l,base64:t}}else if(s&&l)a={pathname:"__generated__/"+l.split("/").pop(),filename:n,content:s};else continue;if(this.validFile(a))a.mimeType=l,_.call(this,a,[]),r.push(a)}return r}getVideoAssets(e){return this.getRawAssets("video",e)}getAudioAssets(e){return this.getRawAssets("audio",e)}getFontAssets(e){const t=null==e?void 0:e.preserveCrossOrigin,s=[];for(const e of S.fonts.values())e.forEach(e=>{const i=e.srcUrl;if(i){const e=File.parseUri(i,{preserveCrossOrigin:t});if(this.validFile(e))_.call(this,e,[]),s.push(e)}});return s}getDataMap(e){if(e.removeUnusedStyles)return{unusedStyles:Array.from(this.application.processing.unusedStyles)}}getCopyQueryParameters(e){return e.productionRelease?"&release=1":""}getArchiveQueryParameters(e){return e.productionRelease?"&release=1":""}validFile(e){if(e){const t=e.pathname+"/"+e.filename;return!this.outputFileExclusions.some(e=>e.test(t))}return false}getRawAssets(e,t){const s=null==t?void 0:t.preserveCrossOrigin,i=[];return document.querySelectorAll(e).forEach(e=>{const t=new Map;b(t,e),e.querySelectorAll("source").forEach(e=>b(t,e));for(const[e,r]of t.entries()){const t=File.parseUri(r,{preserveCrossOrigin:s});if(this.validFile(t))_.call(this,t,C(e)),i.push(t)}}),i}getAssetsAll(e={}){const t=this.getHtmlPage(e).concat(this.getLinkAssets(e));if(e.saveAsWebPage)t.forEach(e=>{const t=e.mimeType;switch(t){case"text/html":case"application/xhtml+xml":case"text/css":e.mimeType="@"+t;break}});return t.concat(this.getScriptAssets(e)).concat(this.getImageAssets(e)).concat(this.getVideoAssets(e)).concat(this.getAudioAssets(e)).concat(this.getFontAssets(e))}get outputFileExclusions(){let e=this._outputFileExclusions;if(void 0===e)e=h(this.userSettings.outputFileExclusions,e=>function(e){return e=e.trim().replace(/([.|/\\{}()?])/g,(e,...t)=>"\\"+t[0]).replace(/\*/g,".*?"),new RegExp(e+"$")}(e)),this._outputFileExclusions=e;return e}get userSettings(){return this.resource.userSettings}get application(){return this.resource.application}}class View extends squared.base.Node{constructor(e,t,s){super(e,t,s),this._cached={},this._preferInitial=false,this.init()}}const R=e=>"("+Math.max(e.largerThan,0)+","+(e.smallerThan<1/0?e.smallerThan:"*")+")";class Extension extends squared.base.Extension{static getCompressOptions(e){const t=(e.whenSmaller?"%":"")+R(e);return"(0,*)"!==t?t:void 0}static getConvertOptions(e,t){let s="";if(t.replaceWith)s+="@";else if(t.whenSmaller)s+="%";return s+=R(t),e+("(0,*)"!==s?s:"")+":"}processFile(e,t=false){return false}}const{safeNestedArray:w}=squared.lib.util;class Brotli extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["text/css","text/javascript","text/plain","text/csv","application/json","application/javascript","application/ld+json","application/xml"],largerThan:0,smallerThan:1/0,whenSmaller:true,level:11}}processFile(e,t=false){if(!t){const s=e.mimeType;if(s){const e=this.options.mimeTypes;t="*"===e||Array.isArray(e)&&e.includes(s)}}if(t)return w(e,"compress").push({format:"br",level:this.options.level,condition:Extension.getCompressOptions(this.options)}),true;else return false}}const{safeNestedArray:M}=squared.lib.util;class Gzip extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["text/css","text/javascript","text/plain","text/csv","application/json","application/javascript","application/ld+json","application/xml"],largerThan:0,smallerThan:1/0,whenSmaller:true,level:9}}processFile(e,t=false){if(!t){const s=e.mimeType;if(s){const e=this.options.mimeTypes;t="*"===e||Array.isArray(e)&&e.includes(s)}}if(t)return M(e,"compress").push({format:"gz",level:this.options.level,condition:Extension.getCompressOptions(this.options)}),true;else return false}}const{safeNestedArray:N}=squared.lib.util;class Jpeg extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/jpeg"],largerThan:0,smallerThan:1/0,whenSmaller:true,level:100}}processFile(e,t=false){if(!t){const s=e.mimeType;if(s){const e=this.options.mimeTypes;t=s.includes("jpeg:")||"*"===e&&s.includes("image/")||Array.isArray(e)&&!!e.find(e=>s.endsWith(e))}}if(t)return N(e,"compress").push({format:"png",condition:Extension.getCompressOptions(this.options)},{format:"jpeg",level:this.options.level}),true;else return false}}const{safeNestedArray:I}=squared.lib.util;class Png extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/png"],largerThan:0,smallerThan:1/0,whenSmaller:true}}processFile(e,t=false){if(!t){const s=e.mimeType;if(s){const e=this.options.mimeTypes;t=s.includes("png:")||"*"===e&&s.includes("image/")||Array.isArray(e)&&!!e.find(e=>s.endsWith(e))}}if(t)return I(e,"compress").push({format:"png",condition:Extension.getCompressOptions(this.options)}),true;else return false}}class Bmp extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/png","image/jpeg","image/gif","image/tiff"],largerThan:0,smallerThan:1/0,whenSmaller:false,replaceWith:true}}processFile(e,t=false){const s=e.mimeType;if(s&&!/bmp[(%@:]/.test(s)){const i=this.options.mimeTypes;if(t||Array.isArray(i)&&i.find(e=>s.endsWith(e)))return e.mimeType=Extension.getConvertOptions("bmp",this.options)+s,true}return false}}class Jpeg$1 extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/png","image/bmp","image/gif","image/tiff"],largerThan:0,smallerThan:1/0,whenSmaller:false,replaceWith:true}}processFile(e,t=false){const s=e.mimeType;if(s&&!/jpeg[(%@:]/.test(s)){const i=this.options.mimeTypes;if(t||Array.isArray(i)&&i.find(e=>s.endsWith(e)))return e.mimeType=Extension.getConvertOptions("jpeg",this.options)+s,true}return false}}class Png$1 extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/jpeg","image/bmp","image/gif","image/tiff"],largerThan:0,smallerThan:1/0,whenSmaller:false,replaceWith:true}}processFile(e,t=false){const s=e.mimeType;if(s&&!/png[(%@:]/.test(s)){const i=this.options.mimeTypes;if(t||Array.isArray(i)&&i.find(e=>s.endsWith(e)))return e.mimeType=Extension.getConvertOptions("png",this.options)+s,true}return false}}class Gif extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/png","image/jpeg","image/bmp","image/tiff"],largerThan:0,smallerThan:1/0,whenSmaller:false,replaceWith:true}}processFile(e,t=false){const s=e.mimeType;if(s&&!/gif[(%@:]/.test(s)){const i=this.options.mimeTypes;if(t||Array.isArray(i)&&i.find(e=>s.endsWith(e)))return e.mimeType=Extension.getConvertOptions("gif",this.options)+s,true}return false}}class Tiff extends Extension{constructor(){super(...arguments),this.options={mimeTypes:["image/png","image/jpeg","image/gif","image/bmp"],largerThan:0,smallerThan:1/0,whenSmaller:false,replaceWith:true}}processFile(e,t=false){const s=e.mimeType;if(s&&!/tiff[(%@:]/.test(s)){const i=this.options.mimeTypes;if(t||Array.isArray(i)&&i.find(e=>s.endsWith(e)))return e.mimeType=Extension.getConvertOptions("tiff",this.options)+s,true}return false}}const q={builtInExtensions:[],preloadImages:false,excludePlainText:true,createQuerySelectorMap:true,showErrorMessages:false,outputFileExclusions:[],outputEmptyCopyDirectory:false,outputArchiveName:"chrome-data",outputArchiveFormat:"zip"};var j=Object.freeze({__proto__:null});const G={COMPRESS_BROTLI:"chrome.compress.brotli",COMPRESS_GZIP:"chrome.compress.gzip",COMPRESS_PNG:"chrome.compress.png",COMPRESS_JPEG:"chrome.compress.jpeg",CONVERT_PNG:"chrome.convert.png",CONVERT_JPEG:"chrome.convert.jpeg",CONVERT_BMP:"chrome.convert.bmp",CONVERT_GIF:"chrome.convert.gif",CONVERT_TIFF:"chrome.convert.tiff"};var k=Object.freeze({__proto__:null,EXT_CHROME:G});const{util:L,session:V}=squared.lib,{flatArray:W,isString:H,isObject:B,promisify:J}=L,{frameworkNotInstalled:D}=V;let U,z,$,Q,Z=false;function X(e,t){let s=function(e,t){if(t)return Q.get(e);else Q.clear()}(e,t);if(void 0===s)U.queryState=1,(async()=>{await U.parseDocument(e)})(),s=Q.get(e),U.queryState=0;return s||null}function K(e){U.queryState=2;let t=false;const s=e.length,i=new Array(s);if((async()=>{for(let r=0;r<s;++r){const s=e[r];let n=Q.get(s);if(n)i[r]=n;else if(await U.parseDocument(s),n=Q.get(s),n)i[r]=n;else t=true}})(),t)W(i);return U.queryState=0,i}function Y(e,t,s,i){if(B(t)){const s=t.assets;if(s)e=e.concat(s)}else t=void 0;return Object.assign(Object.assign({},t),{assets:e,directory:s,filename:i})}const ee={base:{Application:Application,Controller:Controller,File:File,Resource:Resource,View:View},lib:{constant:k,enumeration:j},extensions:{compress:{Brotli:Brotli,Gzip:Gzip,Jpeg:Jpeg,Png:Png},convert:{Bmp:Bmp,Gif:Gif,Jpeg:Jpeg$1,Png:Png$1,Tiff:Tiff}},system:{getElementById(e,t=true){if(U){const s=document.getElementById(e);if(s)return X(s,t)}return null},querySelector(e,t=true){if(U){const s=document.querySelector(e);if(s)return X(s,t)}return null},querySelectorAll(e,t=true){if(U){const s=document.querySelectorAll(e);if(s.length){if(!t)Q.clear();return K(s)}}return[]},getElement(e,t=false){if(U)return X(e,t);else return null},getElementMap:()=>(null==z?void 0:z.elementMap)||new Map,clearElementMap(){null==z||z.elementMap.clear()},copyHtmlPage(e,t){if(H(e))null==$||$.copying(Y($.getHtmlPage(t),t,e))},copyScriptAssets(e,t){if(H(e))null==$||$.copying(Y($.getScriptAssets(t),t,e))},copyLinkAssets(e,t){if(H(e))null==$||$.copying(Y($.getLinkAssets(t),t,e))},copyImageAssets(e,t){if($&&H(e))$.copying(Y($.getImageAssets(t),t,e))},copyVideoAssets(e,t){if(H(e))null==$||$.copying(Y($.getVideoAssets(t),t,e))},copyAudioAssets(e,t){if(H(e))null==$||$.copying(Y($.getAudioAssets(t),t,e))},copyFontAssets(e,t){if(H(e))null==$||$.copying(Y($.getFontAssets(t),t,e))},saveHtmlPage(e,t){null==$||$.archiving(Y($.getHtmlPage(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-html"))},saveScriptAssets(e,t){null==$||$.archiving(Y($.getScriptAssets(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-script"))},saveLinkAssets(e,t){null==$||$.archiving(Y($.getLinkAssets(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-link"))},saveImageAssets(e,t){null==$||$.archiving(Y($.getImageAssets(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-image"))},saveVideoAssets(e,t){null==$||$.archiving(Y($.getVideoAssets(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-video"))},saveAudioAssets(e,t){null==$||$.archiving(Y($.getAudioAssets(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-audio"))},saveFontAssets(e,t){null==$||$.archiving(Y($.getFontAssets(t),t,void 0,(e||U.userSettings.outputArchiveName)+"-font"))}},create(){const e=G;return U=new Application(4,View,Controller,Resource),z=U.controllerHandler,$=new File,U.resourceHandler.setFileHandler($),Q=z.elementMap,Object.assign(U.builtInExtensions,{[e.COMPRESS_BROTLI]:new Brotli(e.COMPRESS_BROTLI,4),[e.COMPRESS_GZIP]:new Gzip(e.COMPRESS_GZIP,4),[e.COMPRESS_JPEG]:new Jpeg(e.COMPRESS_JPEG,4),[e.COMPRESS_PNG]:new Png(e.COMPRESS_PNG,4),[e.CONVERT_BMP]:new Bmp(e.CONVERT_BMP,4),[e.CONVERT_GIF]:new Gif(e.CONVERT_GIF,4),[e.CONVERT_JPEG]:new Jpeg$1(e.CONVERT_JPEG,4),[e.CONVERT_PNG]:new Png$1(e.CONVERT_PNG,4),[e.CONVERT_TIFF]:new Tiff(e.CONVERT_TIFF,4)}),Z=true,{application:U,framework:4,userSettings:Object.assign({},q)}},cached(){if(Z)return{application:U,framework:4,userSettings:U.userSettings};else return ee.create()},getElementById:(e,t=true)=>{if(U){const s=document.getElementById(e);if(s)return J(X)(s,t)}return D()},querySelector:(e,t=true)=>{if(U){const s=document.querySelector(e);if(s)return J(X)(s,t)}return D()},querySelectorAll:(e,t=true)=>{if(U){const s=document.querySelectorAll(e);if(s.length){if(!t)Q.clear();return J(K)(s)}}return D()},getElement:(e,t=false)=>{if(U)return J(X)(e,t);else return D()},saveAsWebPage:(e,t)=>{if($){(t=!B(t)?{}:Object.assign({},t)).saveAsWebPage=true;const s=U.userSettings,i=s.preloadImages;return s.preloadImages=false,U.reset(),U.parseDocument(document.body).then(r=>($.saveToArchive(e||U.userSettings.outputArchiveName,t),s.preloadImages=i,r))}return D()}};return ee}));
