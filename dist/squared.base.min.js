!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.base={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){this.wrapped=e}function n(e){var t,n;function r(t,n){try{var o=e[t](n),s=o.value,l=s instanceof i;Promise.resolve(l?s.wrapped:s).then(function(e){l?r("next",e):a(o.done?"return":"normal",e)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(a,o){var s={key:e,arg:i,resolve:a,reject:o,next:null};n?n=n.next=s:(t=n=s,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function f(e,t,i){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=d(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};function g(e,t){return v(e)||function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(e,t)||p()}function v(e){if(Array.isArray(e))return e}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var m,y,b,k=squared.lib.dom,x=squared.lib.util,A=function(e){function t(e){var i;return r(this,t),(i=u(this,c(t).call(this,e)))._currentId=0,i}return l(t,squared.lib.base.Container),o(t,[{key:"append",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f(c(t.prototype),"append",this).call(this,e),i&&this.afterAppend&&this.afterAppend.call(this,e),this}},{key:"reset",value:function(){return this._currentId=0,this.clear(),this}},{key:"nextId",get:function(){return++this._currentId}}],[{key:"actualParent",value:function(e){for(var t=Array.isArray(n=e),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.naturalElement&&r.actualParent)return r.actualParent}}},{key:"baseline",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=x.filterArray(e,function(e){if(e.baseline||x.isUnit(e.verticalAlign)&&"0px"!==e.verticalAlign){var t=e.cssInitial("position");return"absolute"!==t&&"fixed"!==t}return!1});i.length&&(e=i),i=x.filterArray(e,function(e){return e.textElement||"text-top"!==e.verticalAlign&&"text-bottom"!==e.verticalAlign}),i.length&&(e=i),t&&x.spliceArray(e,function(e){return e.imageElement||!e.naturalElement});for(var n=0,r=0,a=Array.isArray(s=e),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}var c=l;n=Math.max(n,c.lineHeight),r=Math.max(r,c.bounds.height)}return x.spliceArray(e,function(e){return n>r?e.lineHeight!==n:!x.withinRange(e.bounds.height,r)}),e.sort(function(e,t){if(e.groupParent||e.length||!e.baseline&&t.baseline)return 1;if(t.groupParent||t.length||e.baseline&&!t.baseline)return-1;if(!e.imageElement||!t.imageElement){if(e.multiline||t.multiline){if(e.lineHeight>0&&t.lineHeight>0)return e.lineHeight<=t.lineHeight?1:-1;if(e.fontSize===t.fontSize)return e.htmlElement||!t.htmlElement?-1:1}if(e.containerType!==t.containerType)return e.textElement||e.imageElement?-1:t.textElement||t.imageElement?1:e.containerType<t.containerType?-1:1;if(t.imageElement)return-1;if(e.imageElement)return 1;if(e.fontSize===t.fontSize)return e.htmlElement&&!t.htmlElement?-1:!e.htmlElement&&t.htmlElement?1:e.siblingIndex>=t.siblingIndex?1:-1;if(e.fontSize!==t.fontSize&&e.fontSize>0&&t.fontSize>0)return e.fontSize>t.fontSize?-1:1}return 0})}},{key:"floated",value:function(e){for(var t=new Set,i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}a.floating&&t.add(a.float)}return t}},{key:"cleared",value:function(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e.length>1){e.slice(0).sort(this.siblingIndex);var t=this.actualParent(e);if(t&&t.element){for(var i=[],n=e[e.length-1],r=!1,a=0;a<t.element.childNodes.length;a++){var o=k.getElementAsNode(t.element.childNodes[a]);if(o&&(o===e[0]&&(r=!0),r&&i.push(o),o===n))break}i.length>=e.length&&(e=i)}}for(var s=new Map,l=new Set,c={},h=Array.isArray(d=e),u=0,d=h?d:d[Symbol.iterator]();;){var f;if(h){if(u>=d.length)break;f=d[u++]}else{if((u=d.next()).done)break;f=u.value}var g=f;if(g.pageFlow){var v=g.css("clear");if(l.size){var p=[];switch(v){case"left":p.push(c.left);break;case"right":p.push(c.right);break;case"both":p.push(c.left,c.right)}for(var m=0;m<p.length;m++){var y=p[m];y&&!g.floating&&g.linear.top>y.linear.bottom&&l.has(y.float)&&(l.delete(y.float),c[y.float]=void 0)}"both"===v?(s.set(g,2===l.size?"both":l.values().next().value),l.clear(),c.left=void 0,c.right=void 0):l.has(v)&&(s.set(g,v),l.delete(v),c[v]=void 0)}g.floating&&(l.add(g.float),c[g.float]=g)}}return s}},{key:"floatedAll",value:function(e){return this.floated(x.filterArray(e.actualChildren,function(e){return e.pageFlow}))}},{key:"clearedAll",value:function(e){return this.cleared(x.filterArray(e.actualChildren,function(e){return e.pageFlow}),!1)}},{key:"linearX",value:function(e){var i=x.filterArray(e,function(e){return e.pageFlow}).sort(t.siblingIndex);switch(i.length){case 0:return!1;case 1:return!0;default:var n=this.actualParent(i);if(n){for(var r=this.clearedAll(n),a=1;a<i.length;a++)if(i[a].alignedVertically(i[a].previousSiblings(),void 0,r))return!1;for(var o=1/0,s=-1/0,l=-1/0,c=1/0,h=Array.isArray(d=i),u=0,d=h?d:d[Symbol.iterator]();;){var f;if(h){if(u>=d.length)break;f=d[u++]}else{if((u=d.next()).done)break;f=u.value}var g=f;o=Math.min(o,g.linear.left),s=Math.max(s,g.linear.right),g.floating&&("left"===g.float?l=Math.max(l,g.linear.right):c=Math.min(c,g.linear.left))}for(var v=0,p=0,m=0,y=0,b=0;v<i.length;v++){var k=i[v];if(Math.floor(k.linear.left)<=o&&p++,Math.ceil(k.linear.right)>=s&&m++,k.floating||(k.linear.left===l&&y++,k.linear.right===c&&b++),0!==v){if(2===p||2===m||2===y||2===b)return!1;var A=i[v-1];if(A.floating&&k.linear.top>=A.linear.bottom||x.withinRange(k.linear.left,A.linear.left))return!1}}return!0}return!1}}},{key:"linearY",value:function(e){var i=x.filterArray(e,function(e){return e.pageFlow}).sort(t.siblingIndex);switch(i.length){case 0:return!1;case 1:return!0;default:var n=this.actualParent(i);if(n){for(var r=this.clearedAll(n),a=1;a<i.length;a++)if(!i[a].alignedVertically(i[a].previousSiblings(),i,r))return!1;return!0}return!1}}},{key:"partitionRows",value:function(e){for(var t,i=this,n=g((t=i.actualParent(e))?[t.actualChildren,i.clearedAll(t)]:[e,i.cleared(e)],2),r=n[0],a=n[1],o=[],s=[],l=0;l<r.length;l++){var c=r[l],h=c.previousSiblings();0===l||0===h.length?e.includes(c)&&s.push(c):c.alignedVertically(h,s,a)?(s.length&&o.push(s),s=e.includes(c)?[c]:[]):e.includes(c)&&s.push(c),l===r.length-1&&s.length&&o.push(s)}return o}},{key:"siblingIndex",value:function(e,t){return e.siblingIndex>=t.siblingIndex?1:-1}}]),t}(),S=squared.lib.util,_=function(e){function t(e,i){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5?arguments[5]:void 0;return r(this,t),(n=u(this,c(t).call(this,l))).parent=e,n.node=i,n.containerType=a,n.alignmentType=o,n.itemCount=s,n.rowCount=0,n.columnCount=0,n.renderType=0,n.renderPosition=!1,n}return l(t,squared.lib.base.Container),o(t,[{key:"init",value:function(){this.floated=this.getFloated(),this.cleared=this.getCleared(),this.linearX=this.isLinearX()}},{key:"setType",value:function(e){this.containerType=e;for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0;r<i.length;r++){this.add(i[r])}}},{key:"add",value:function(e){return this.alignmentType|=e,this.alignmentType}},{key:"retain",value:function(e){return f(c(t.prototype),"retain",this).call(this,e),this.itemCount=e.length,this}},{key:"delete",value:function(e){return S.hasBit(this.alignmentType,e)&&(this.alignmentType^=e),this.alignmentType}},{key:"getFloated",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?A.floatedAll(this.parent):A.floated(this.children)}},{key:"getCleared",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?A.clearedAll(this.parent):A.cleared(this.children)}},{key:"isLinearX",value:function(){return A.linearX(this.children)}},{key:"isLinearY",value:function(){return A.linearY(this.children)}},{key:"floated",set:function(e){e.size?this.add(64):this.delete(64),this.every(function(e){return"right"===e.float})?this.add(512):this.delete(512),this._floated=e},get:function(){return this._floated||this.getFloated()}},{key:"cleared",set:function(e){this._cleared=e},get:function(){return this._cleared||this.getCleared()}},{key:"visible",get:function(){return this.filter(function(e){return e.visible})}},{key:"linearX",set:function(e){this._linearX=e},get:function(){return this._linearX||this.isLinearX()}},{key:"linearY",set:function(e){this._linearY=e},get:function(){return this._linearY||this.isLinearY()}}]),t}();!function(e){e[e.DOM_TRAVERSE=2]="DOM_TRAVERSE",e[e.EXTENSION=4]="EXTENSION",e[e.RENDER=8]="RENDER",e[e.ALL=14]="ALL"}(m||(m={})),function(e){e[e.BOX_STYLE=2]="BOX_STYLE",e[e.BOX_SPACING=4]="BOX_SPACING",e[e.FONT_STYLE=8]="FONT_STYLE",e[e.VALUE_STRING=16]="VALUE_STRING",e[e.IMAGE_SOURCE=32]="IMAGE_SOURCE",e[e.ASSET=56]="ASSET",e[e.ALL=126]="ALL"}(y||(y={})),function(e){e[e.CONSTRAINT=2]="CONSTRAINT",e[e.LAYOUT=4]="LAYOUT",e[e.ALIGNMENT=8]="ALIGNMENT",e[e.AUTOFIT=16]="AUTOFIT",e[e.OPTIMIZATION=32]="OPTIMIZATION",e[e.CUSTOMIZATION=64]="CUSTOMIZATION",e[e.ACCESSIBILITY=128]="ACCESSIBILITY",e[e.LOCALIZATION=256]="LOCALIZATION",e[e.POSITIONAL=46]="POSITIONAL",e[e.NONPOSITIONAL=464]="NONPOSITIONAL",e[e.ALL=510]="ALL"}(b||(b={}));var w=Object.freeze({get APP_SECTION(){return m},get NODE_RESOURCE(){return y},get NODE_PROCEDURE(){return b}}),E=squared.lib.color,T=squared.lib.css,I=squared.lib.dom,R=squared.lib.element,B=squared.lib.util,C=squared.lib.xml,N="(?:\\s*(rgba?\\(\\d+, \\d+, \\d+(?:, [\\d.]+)?\\)|#[a-zA-Z\\d]{3,}|[a-z]+)\\s*(\\d+%|".concat(B.REGEXP_STRING.DEGREE,"|").concat(B.REGEXP_STRING.UNIT,"|(?:calc(\\(.+\\))(?=,)|").concat(B.REGEXP_STRING.CALC,"))?,?\\s*)"),P=/(.+?)?\s*at (.+?)$/,M=RegExp('(?:initial|url\\("?.+?"?\\)|(repeating)?-?(linear|radial|conic)-gradient\\(((?:to [a-z ]+|(?:from )?-?[\\d.]+(?:deg|rad|turn|grad)|circle|ellipse|closest-side|closest-corner|farthest-side|farthest-corner)?(?:\\s*at [\\w %]+)?),?\\s*('.concat(N,"+)\\))"),"g");function L(e,t){for(var i=e[t],n=0;n<e.children.length;n++){var r=I.getElementAsNode(e.children[n]);r&&(r.excluded||r.dataset.target&&B.isString(r[t]))&&(i=i.replace(r[t],""))}return i}function D(e,t,i,n,r,a){var o,s=[],l=RegExp(N,"g"),c="conic"===t.type,h=e.bounds.width,u=e.bounds.height;if(a){var d=a.split(B.REGEXP_COMPILED.SEPARATOR),f=W.getBackgroundSize(e,d[r%d.length]);f&&(h=f.width,u=f.height,t.dimension=f)}for(;null!==(o=l.exec(i));){var g=E.parseColor(o[1],n,!0);if(g){var v={color:g,offset:-1};if(c)o[3]&&o[4]&&(v.offset=B.convertAngle(o[3],o[4])/360);else if(o[2])if(B.isPercent(o[2]))v.offset=parseFloat(o[2])/100;else if(t.repeating){var p=t.horizontal?h:u;B.isUnit(o[2])?v.offset=e.calculateUnit(o[2],t.horizontal,!1)/p:B.isCalc(o[2])&&(v.offset=B.calculate(o[7],p,e.fontSize)/p)}0===s.length&&(-1===v.offset?v.offset=0:v.offset>0&&s.push({color:g,offset:0})),s.push(v)}}var m=s[s.length-1];-1===m.offset&&(m.offset=1);for(var y=0,b=0;b<s.length;b++){var k=s[b];if(-1===k.offset)if(0===b)k.offset=0;else{for(var x=b+1,A=2;x<s.length-1;x++,A++)if(-1!==s[x].offset){k.offset=(y+s[x].offset)/A;break}-1===k.offset&&(k.offset=y+m.offset/(s.length-1))}y=k.offset}if(t.repeating){if(y<100){var S=s.slice(0);e:for(var _=y;y<100;){for(var w=0;w<S.length;w++)if(s.push(Object.assign({},S[w],{offset:y=Math.min(_+S[w].offset,1)})),1===y)break e;_=y}}}else if(y<1){var T=Object.assign({},s[s.length-1]);T.offset=1,s.push(T)}return s}function O(e){if(e){var t=RegExp(B.REGEXP_STRING.DEGREE).exec(e.trim());if(t){var i=B.convertAngle(t[1],t[2])%360;return i<0&&(i+=360),i}}return 0}function H(e,t,i){var n=e.renderParent;switch(e.multiline&&n&&!n.layoutVertical&&(i=i.replace(/^\s*\n/,"")),e.css("whiteSpace")){case"nowrap":i=i.replace(/\n/g," ");break;case"pre":case"pre-wrap":n&&!n.layoutVertical&&(i=i.replace(/^\n/,"")),i=i.replace(/\n/g,"\\n").replace(/\s/g,"&#160;");break;case"pre-line":i=i.replace(/\n/g,"\\n").replace(/\s+/g," ");break;default:return t.previousSibling&&R.isLineBreak(t.previousSibling)&&(i=i.replace(/^\s+/,"")),t.nextSibling&&R.isLineBreak(t.nextSibling)&&(i=i.replace(/\s+$/,"")),[i,!1]}return[i,!0]}var W=function(){function e(t,i){r(this,e),this.application=t,this.cache=i}return o(e,[{key:"finalize",value:function(e){}},{key:"reset",value:function(){for(var t in e.ASSETS)e.ASSETS[t]=new Map;for(var i in e.STORED)e.STORED[i]=new Map;this.fileHandler&&this.fileHandler.reset()}},{key:"setBoxStyle",value:function(){for(var t=Array.isArray(n=this.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(a.visible&&a.styleElement){var o={borderTop:void 0,borderRight:void 0,borderBottom:void 0,borderLeft:void 0,borderRadius:void 0,backgroundColor:void 0,backgroundSize:void 0,backgroundRepeat:void 0,backgroundPositionX:void 0,backgroundPositionY:void 0,backgroundImage:void 0};for(var s in o){var l=a.css(s);switch(s){case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":var c=a.css("".concat(s,"Color"));switch(c.toLowerCase()){case"initial":c="#000000";break;case"inherit":case"currentcolor":c=T.getInheritedStyle(a.element,"".concat(s,"Color"))}var h=a.css("".concat(s,"Style"))||"none",u=a.css("".concat(s,"Width"))||"1px",d=void 0;switch(h){case"none":break;case"inset":"0px"===u&&(u="1px");default:d=E.parseColor(c,a.css("opacity"))}o[s]={width:u,style:h,color:d?d.valueAsRGBA:""};break;case"borderRadius":var f=a.css("borderTopLeftRadius"),v=a.css("borderTopRightRadius"),p=a.css("borderBottomLeftRadius"),m=a.css("borderBottomRightRadius");o.borderRadius=f===v&&v===p&&p===m?B.convertInt(f)>0?[f]:void 0:[f,v,p,m];break;case"backgroundColor":if(!a.has("backgroundColor")&&(l===a.cssAscend("backgroundColor",!1,!0)||a.documentParent.visible&&T.isInheritedStyle(a.element,"backgroundColor")))o.backgroundColor="";else{var b=E.parseColor(l,a.css("opacity"));o.backgroundColor=b?b.valueAsRGBA:""}break;case"backgroundImage":if("none"!==l&&!a.hasBit("excludeResource",y.IMAGE_SOURCE)){for(var k=[],x=a.css("opacity"),A=void 0,S=0,_=function(){var e=g(A,5),t=e[0],i=e[1],n=e[2],r=e[3],s=e[4];if("initial"===t||t.startsWith("url"))k.push(t);else{var l={type:n,repeating:"repeating"===i,fontSize:a.fontSize};switch(n){case"linear":var c=180;switch(r){case"to top":c=0;break;case"to right top":c=45;break;case"to right":c=90;break;case"to right bottom":c=135;break;case"to bottom":break;case"to left bottom":c=225;break;case"to left":c=270;break;case"to left top":c=315;break;default:r&&(c=O(r))}l.horizontal=c>=45&&c<=135||c>=225&&c<=315,l.colorStops=D(a,l,s,x,S,o.backgroundSize),l.angle=c;break;case"radial":l.horizontal=a.bounds.width<=a.bounds.height,l.colorStops=D(a,l,s,x,S,o.backgroundSize),l.position=function(){var e=["center","ellipse"];if(r){var t=P.exec(r);if(t){switch(t[1]){case"ellipse":case"circle":case"closest-side":case"closest-corner":case"farthest-side":case"farthest-corner":e[1]=t[1]}t[2]&&(e[0]=t[2])}}return e}();break;case"conic":l.colorStops=D(a,l,s,x,S,o.backgroundSize),l.angle=O(r),l.position=function(){if(r){var e=P.exec(r);if(e)return[e[2]]}return["center"]}()}k.push(l)}S++};null!==(A=M.exec(l));)_();k.length&&(o.backgroundImage=k)}break;case"backgroundSize":case"backgroundRepeat":case"backgroundPositionX":case"backgroundPositionY":o[s]=l}}var w=JSON.stringify(o.borderTop);w===JSON.stringify(o.borderRight)&&w===JSON.stringify(o.borderBottom)&&w===JSON.stringify(o.borderLeft)&&(o.border=o.borderTop),a.data(e.KEY_NAME,"boxStyle",o)}}}},{key:"setFontStyle",value:function(){for(var t=Array.isArray(n=this.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r,o=e.hasDrawableBackground(a.data(e.KEY_NAME,"boxStyle"));if(!(null===a.element||a.renderChildren.length||a.imageElement||a.svgElement||"HR"===a.tagName||a.inlineText&&!o&&!a.preserveWhiteSpace&&""===a.element.innerHTML.trim())){var s=a.css("opacity"),l=E.parseColor(a.css("color"),s),c=a.css("fontFamily"),h=a.css("fontSize"),u=a.css("fontWeight");if(B.isUserAgent(16)&&!a.has("fontFamily"))switch(a.tagName){case"TT":case"CODE":case"KBD":case"SAMP":c="monospace"}if(0===B.convertInt(h))switch(h){case"xx-small":h="8px";break;case"x-small":h="10px";break;case"small":h="13px";break;case"medium":h="16px";break;case"large":h="18px";break;case"x-large":h="24px";break;case"xx-large":h="32px"}if(!B.isNumber(u))switch(u){case"lighter":u="200";break;case"bold":u="700";break;case"bolder":u="900";break;default:u="400"}var d={fontFamily:c,fontStyle:a.css("fontStyle"),fontSize:h,fontWeight:u,color:l?l.valueAsRGBA:""};a.data(e.KEY_NAME,"fontStyle",d)}}}},{key:"setValueString",value:function(){for(var t=Array.isArray(n=this.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r,o=a.element;if(o&&a.visible){var s="",l="",c=!1,h=!0;switch(o.tagName){case"INPUT":switch(o.type){case"text":case"number":case"email":case"search":case"submit":case"reset":case"button":l=o.value.trim();break;default:a.companion&&!a.companion.visible&&(l=a.companion.textContent.trim())}break;case"BUTTON":l=o.innerText;break;case"TEXTAREA":l=o.value.trim();break;default:if(a.plainText){s=a.textContent.trim(),l=a.textContent.replace(/&[A-Za-z]+;/g,function(e){return e.replace("&","&amp;")});var u=g(H(a,o,l),2);l=u[0],c=u[1]}else if(a.inlineText){s=a.textContent.trim();var d=g(H(a,o,l="CODE"===o.tagName?L(o,"innerHTML"):R.hasLineBreak(o,!0)?L(o,"innerHTML").replace(/\s*<br[^>]*>\s*/g,"\\n").replace(/(<([^>]+)>)/gi,""):L(o,"textContent")),2);l=d[0],c=d[1]}else a.htmlElement&&""===o.innerText.trim()&&e.hasDrawableBackground(a.data(e.KEY_NAME,"boxStyle"))&&(l=o.innerText,h=!1)}if(this.application.userSettings.replaceCharacterEntities&&(l=C.replaceEntity(l)),""!==l){if(h){var f=a.previousSiblings().pop(),v=a.nextSiblings().shift(),p=!1;if(void 0===f||f.multiline||f.lineBreak||f.plainText&&/\s+$/.test(f.textContent)?l=l.replace(/^\s+/,""):f.element&&(p=/\s+$/.test(f.element.innerText||f.textContent)),c){var m=l;l=l.trim(),!f||f.block||f.lineBreak||p||!/^\s+/.test(m)||(l="&#160;"+l),v&&!v.lineBreak&&/\s+$/.test(m)&&(l+="&#160;")}else/^\s+$/.test(l)?l.length&&(l="&#160;"+l.substring(1)):l=(l=l.replace(/^\s+/,f&&(f.block||f.lineBreak||p&&f.htmlElement&&f.textContent.length>1||a.multiline&&R.hasLineBreak(o))?"":"&#160;")).replace(/\s+$/,"table-cell"===a.display||v&&v.lineBreak||a.blockStatic?"":"&#160;")}""!==l&&a.data(e.KEY_NAME,"valueString",{name:s,value:l})}}}}},{key:"stored",get:function(){return e.STORED}}],[{key:"generateId",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t,r=i;1===i&&(t+="_".concat(""+r));for(var a=this.ASSETS.ids.get(e)||[];;){if(!a.includes(t)){a.push(t);break}t="".concat(n,"_").concat(""+ ++r)}return this.ASSETS.ids.set(e,a),t}},{key:"getStoredName",value:function(t,i){if(e.STORED[t]){var n=e.STORED[t].entries(),r=Array.isArray(n),a=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=g(o,2),l=s[0],c=s[1];if(JSON.stringify(i)===JSON.stringify(c))return l}}return""}},{key:"insertStoredAsset",value:function(t,i,n){var r=e.STORED[t];if(r){var a=this.getStoredName(t,n);if(""===a&&((B.isNumber(i)||/^\d/.test(i))&&(i="__".concat(i)),B.hasValue(n))){var o=0;do{a=i,o>0&&(a+="_".concat(o)),r.has(a)||r.set(a,n),o++}while(r.has(a)&&r.get(a)!==n)}return a}return""}},{key:"isBorderVisible",value:function(e){return!!e&&!("none"===e.style||"0px"===e.width||""===e.color||9===e.color.length&&e.color.endsWith("00"))}},{key:"hasDrawableBackground",value:function(e){return!!e&&(!!e.backgroundImage||this.isBorderVisible(e.borderTop)||this.isBorderVisible(e.borderRight)||this.isBorderVisible(e.borderBottom)||this.isBorderVisible(e.borderLeft)||!!e.borderRadius)}},{key:"getBackgroundSize",value:function(e,t){var i=0,n=0;switch(t){case"":case"cover":case"contain":case"100% 100%":case"auto":case"auto auto":case"initial":return;default:var r=t.split(" ");1===r.length&&(r[1]=r[0]);for(var a=0;a<r.length;a++)"auto"===r[a]&&(r[a]="100%"),0===a?i=e.calculateUnit(r[a],!0,!1):n=e.calculateUnit(r[a],!1,!1)}return i>0&&n>0?{width:Math.round(i),height:Math.round(n)}:void 0}}]),e}();W.KEY_NAME="squared.resource",W.ASSETS={ids:new Map,images:new Map},W.STORED={strings:new Map,arrays:new Map,fonts:new Map,colors:new Map,images:new Map};var z=squared.lib.css,F=squared.lib.dom,U=squared.lib.element,V=squared.lib.util,q=squared.lib.xml,X=["top","right","bottom","left"];function j(e,t,i){var n=[],r=t;do{if(r.dataset.use){var a=r.dataset.use.split(V.REGEXP_COMPILED.SEPARATOR),o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var l;if(o){if(s>=a.length)break;l=a[s++]}else{if((s=a.next()).done)break;l=s.value}n.push(l.trim())}}r=r!==e?r.parentElement:null}while(r);if(n.length){for(var c=[],h=[],u=Array.isArray(f=i),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}var v=g,p=n.indexOf(v.name);-1!==p?c[p]=v:h.push(v)}return V.concatArray(V.spliceArray(c,function(e){return void 0===e}),h)}return i}function G(e,t){var i=e.previousSiblings(),n=e.nextSiblings();return!(0!==i.length&&i.some(function(e){return e.multiline>0||e.excluded&&!e.blockStatic})||!(0===n.length||n.every(function(e){return e.blockStatic||e.lineBreak||e.excluded})||t&&e.element===F.getLastChildElement(t.element)))&&(e.cssApply({display:"inline-block",verticalAlign:"top"},!0),e.positionStatic=!0,!0)}function Y(e,t,i){switch(e){case"<=":return t<=i;case"<":return t<i;case">=":return t>=i;case">":return t>i;default:return t===i}}var Q=function(){function e(t,i,n,a,o){r(this,e),this.framework=t,this.nodeConstructor=i,this.initialized=!1,this.closed=!1,this.builtInExtensions={},this.extensions=new Set,this.parseElements=new Set,this.session={cache:new A,image:new Map,renderQueue:new Map,excluded:new A,targeted:new Map},this.processing={cache:new A,depthMap:new Map,node:void 0,layout:void 0,excluded:new A},this._renderPosition=new Map,this._views=[],this._includes=[],this.controllerHandler=new n(this,this.processing.cache),this.resourceHandler=new a(this,this.processing.cache),this.extensionManager=new o(this,this.processing.cache)}return o(e,[{key:"registerController",value:function(e){e.application=this,e.cache=this.processing.cache,this.controllerHandler=e}},{key:"registerResource",value:function(e){e.application=this,e.cache=this.processing.cache,this.resourceHandler=e}},{key:"finalize",value:function(){for(var e=this.rendered,t=Array.isArray(n=e),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;a.hasBit("excludeProcedure",b.LAYOUT)||a.setLayout(),a.hasBit("excludeProcedure",b.ALIGNMENT)||a.setAlignment()}for(var o=Array.isArray(l=e),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}var h=c;h.hasBit("excludeProcedure",b.OPTIMIZATION)||h.applyOptimizations(),h.hasBit("excludeProcedure",b.CUSTOMIZATION)||h.applyCustomizations()}for(var u=Array.isArray(f=this.extensions),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}for(var v=g,p=Array.isArray(k=v.subscribers),m=0,k=p?k:k[Symbol.iterator]();;){var x;if(p){if(m>=k.length)break;x=k[m++]}else{if((m=k.next()).done)break;x=m.value}v.postProcedure(x)}}for(var A=Array.isArray(_=this.rendered),S=0,_=A?_:_[Symbol.iterator]();;){var w;if(A){if(S>=_.length)break;w=_[S++]}else{if((S=_.next()).done)break;w=S.value}var E=w;E.hasBit("excludeResource",y.BOX_SPACING)||E.setBoxSpacing()}for(var T=Array.isArray(R=this.extensions),I=0,R=T?R:R[Symbol.iterator]();;){var B;if(T){if(I>=R.length)break;B=R[I++]}else{if((I=R.next()).done)break;B=I.value}B.afterProcedure()}this.processRenderQueue();var C=this.sessionData;this.resourceHandler.finalize(C),this.controllerHandler.finalize(C);for(var N=Array.isArray(M=this.extensions),P=0,M=N?M:M[Symbol.iterator]();;){var L;if(N){if(P>=M.length)break;L=M[P++]}else{if((P=M.next()).done)break;L=P.value}L.afterFinalize()}F.removeElementsByClassName("__css.placeholder"),this.closed=!0}},{key:"saveAllToDisk",value:function(){this.resourceHandler.fileHandler&&this.resourceHandler.fileHandler.saveAllToDisk(this.sessionData)}},{key:"reset",value:function(){this.session.cache.each(function(e){return e.element&&F.deleteElementCache(e.element,"node","style","styleMap")});for(var e=Array.isArray(i=this.parseElements),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}var r=n;r.dataset.iteration="",r.dataset.layoutName=""}this.appName="",this.session.renderQueue.clear(),this.session.image.clear(),this.session.cache.reset(),this.session.excluded.reset(),this.session.targeted.clear(),this.processing.cache.reset(),this.controllerHandler.reset(),this.resourceHandler.reset(),this._views.length=0,this._includes.length=0,this._renderPosition.clear();for(var a=Array.isArray(s=this.extensions),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}var c=l;c.subscribers.clear(),c.subscribersChild.clear()}this.closed=!1}},{key:"parseDocument",value:function(){var e,t=this;this.parseElements.clear(),this.initialized=!1,this.setStyleMap();for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];""===this.appName&&0===n.length&&n.push(document.body);for(var a=0;a<n.length;a++){var o=n[a],s="string"==typeof o?document.getElementById(o):o;z.hasComputedStyle(s)&&this.parseElements.add(s)}var l=this.parseElements.values().next().value,c=[],h=function(){if(t.initialized=!1,c.length)for(var i=0;i<c.length;i++){l.removeChild(c[i])}var n=t.session.image.entries(),r=Array.isArray(n),a=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=g(o,2);W.ASSETS.images.set(s[0],s[1])}for(var h=Array.isArray(d=t.extensions),u=0,d=h?d:d[Symbol.iterator]();;){var f;if(h){if(u>=d.length)break;f=d[u++]}else{if((u=d.next()).done)break;f=u.value}f.beforeParseDocument()}for(var v=Array.isArray(m=t.parseElements),p=0,m=v?m:m[Symbol.iterator]();;){var y;if(v){if(p>=m.length)break;y=m[p++]}else{if((p=m.next()).done)break;y=p.value}var b=y;""===t.appName&&(t.appName=b.id||"untitled");var k=b.dataset.filename&&b.dataset.filename.replace(RegExp(".".concat(t.controllerHandler.localSettings.layout.fileExtension,"$")),"")||b.id||"document_".concat(t.size),x=parseInt(b.dataset.iteration||"0")+1;b.dataset.iteration=""+x,b.dataset.layoutName=V.convertWord(x>1?"".concat(k,"_").concat(x):k,!0),t.createCache(b)&&(t.setBaseLayout(),t.setConstraints(),t.setResources())}for(var A=Array.isArray(_=t.extensions),S=0,_=A?_:_[Symbol.iterator]();;){var w;if(A){if(S>=_.length)break;w=_[S++]}else{if((S=_.next()).done)break;w=S.value}for(var E=w,T=Array.isArray(R=E.subscribers),I=0,R=T?R:R[Symbol.iterator]();;){var B;if(T){if(I>=R.length)break;B=R[I++]}else{if((I=R.next()).done)break;B=I.value}E.postParseDocument(B)}}for(var C=Array.isArray(P=t.extensions),N=0,P=C?P:P[Symbol.iterator]();;){var M;if(C){if(N>=P.length)break;M=P[N++]}else{if((N=P.next()).done)break;M=N.value}M.afterParseDocument()}"function"==typeof e&&e.call(t)};if(this.userSettings.preloadImages){for(var u=Array.isArray(f=this.parseElements),d=0,f=u?f:f[Symbol.iterator]();;){var v;if(u){if(d>=f.length)break;v=f[d++]}else{if((d=f.next()).done)break;v=d.value}v.querySelectorAll("svg image").forEach(function(e){var i=V.resolvePath(e.href.baseVal);""!==i&&t.session.image.set(i,{width:e.width.baseVal.value,height:e.height.baseVal.value,uri:i})})}var p=this.session.image.values(),m=Array.isArray(p),y=0;for(p=m?p:p[Symbol.iterator]();;){var b;if(m){if(y>=p.length)break;b=p[y++]}else{if((y=p.next()).done)break;b=y.value}var k=b;if(0===k.width&&0===k.height&&k.uri){var x=document.createElement("img");x.src=k.uri,x.complete&&x.naturalWidth>0&&x.naturalHeight>0?(k.width=x.naturalWidth,k.height=x.naturalHeight):(l.appendChild(x),c.push(x))}}}for(var A=[],S=Array.isArray(w=this.parseElements),_=0,w=S?w:w[Symbol.iterator]();;){var E;if(S){if(_>=w.length)break;E=w[_++]}else{if((_=w.next()).done)break;E=_.value}E.querySelectorAll("IMG").forEach(function(e){"IMG"===e.tagName&&(e.complete?t.addImagePreload(e):A.push(e))})}return 0===A.length?h():(this.initialized=!0,Promise.all(V.objectMap(A,function(e){return new Promise(function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(e)}})})).then(function(e){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}t.addImagePreload(a)}h()}).catch(function(e){var t=e.target?e.target.src:"";V.hasValue(t)&&!confirm("FAIL: ".concat(t))||h()})),{then:function(i){t.initialized?e=i:i()}}}},{key:"renderNode",value:function(e){return 0===e.itemCount?this.controllerHandler.renderNode(e):(this.saveRenderPosition(e.node,e.renderPosition),this.controllerHandler.renderNodeGroup(e))}},{key:"renderLayout",value:function(e){var t="",i=V.hasBit(e.renderType,64);return i&&V.hasBit(e.renderType,8)?t=this.processFloatHorizontal(e):i&&V.hasBit(e.renderType,16)?t=this.processFloatVertical(e):0!==e.containerType&&(t=this.renderNode(e)),t}},{key:"addLayoutFile",value:function(e,t,i){var n={pathname:i=i||this.controllerHandler.localSettings.layout.pathName,filename:e,content:t};arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&this._views.length&&""===this._views[0].content?this._views[0]=n:this._views.push(n),this.processing.layout=n}},{key:"addIncludeFile",value:function(e,t){this._includes.push({filename:e,content:t,pathname:this.controllerHandler.localSettings.layout.pathName})}},{key:"addRenderTemplate",value:function(e,t,i){var n=this;if(""!==i){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&t.renderChildren.some(function(e){var i=n.processing.depthMap.values(),r=Array.isArray(i),a=0;for(i=r?i:i[Symbol.iterator]();;){var o;if(r){if(a>=i.length)break;o=i[a++]}else{if((a=i.next()).done)break;o=a.value}var s=o,l=e.renderPositionId,c=s.get(l);if(c){var h=t.renderDepth+1;return e.renderDepth!==h&&s.set(l,n.controllerHandler.replaceIndent(c,h,n.processing.cache.children)),!0}}return!1}),!this.parseElements.has(t.element))if(t.dataset.target){var r=document.getElementById(t.dataset.target);if(r&&r!==e.element)return this.addRenderQueue(t.dataset.target,i),void(t.positioned=!0)}else if(e.dataset.target){if(document.getElementById(e.dataset.target)){var a=e.elementId||e.controlId;return this.addRenderQueue(a,i),void(t.dataset.target=a)}}this.processing.depthMap.has(e.id)||this.processing.depthMap.set(e.id,new Map);var o=this.processing.depthMap.get(e.id);o&&o.set(t.renderPositionId,i)}}},{key:"addRenderQueue",value:function(e,t){var i=this.session.renderQueue.get(e)||[];i.push(t),this.session.renderQueue.set(e,i)}},{key:"addImagePreload",value:function(e){e&&e.complete&&V.hasValue(e.src)&&this.session.image.set(e.src,{width:e.naturalWidth,height:e.naturalHeight,uri:e.src})}},{key:"saveRenderPosition",value:function(e,t){var i;if(e.groupParent){var n=e.parent;if(n){var r,a=n.id,o=this._renderPosition.get(a);if(o){var s=V.filterArray(o.children,function(t){return!e.contains(t)});if(e.siblingIndex<s.length){s.splice(e.siblingIndex,0,e);for(var l=e.siblingIndex+1;l<s.length;l++)s[l].siblingIndex=l;r=s}else e.siblingIndex=s.length,s.push(e);this._renderPosition.set(a,{parent:n,children:s})}else r=n.children;if(r)for(var c=e.siblingIndex+1;c<r.length;c++)r[c]&&(r[c].siblingIndex=c)}}if(t){var h=this._renderPosition.get(e.id);i=h?V.concatArray(V.filterArray(h.children,function(t){return!e.contains(t)}),e.children):e.duplicate(),this._renderPosition.set(e.id,{parent:e,children:i})}}},{key:"createNode",value:function(e){return new this.nodeConstructor(this.nextId,e,this.controllerHandler.afterInsertNode)}},{key:"resolveTarget",value:function(e,t){for(var i=Array.isArray(r=this.processing.cache),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}if(a.elementId===e||a.controlId===e)return a}for(var o=Array.isArray(l=this.session.cache),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}if(c.elementId===e||c.controlId===e)return c}var h=this.session.targeted.get(e)||[];h.push(t),this.session.targeted.set(e,h)}},{key:"toString",value:function(){return this._views.length?this._views[0].content:""}},{key:"createCache",value:function(e){var t=this,i=function(){if(e===document.body){for(var i=0,n=0;i<document.body.childNodes.length;i++)if(t.conditionElement(document.body.childNodes[i])&&++n>1)return document.querySelectorAll("body, body *");return document.querySelectorAll("body *")}return e.querySelectorAll("*")}();this.processing.cache.afterAppend=void 0,this.processing.cache.clear(),this.processing.excluded.clear(),this.processing.node=void 0;for(var n=Array.from(this.extensions),r=0;r<n.length;r++){n[r].beforeInit(e)}var a=this.insertNode(e);if(!a)return!1;a.parent=new this.nodeConstructor(0,e.parentElement||document.body,this.controllerHandler.afterInsertNode),a.documentRoot=!0,a.documentParent=a.parent,this.processing.node=a;var o=this.controllerHandler.localSettings;if(i.forEach(function(i){if(!t.parseElements.has(i)&&(j(e,i,n).some(function(e){return e.init(i)}),!t.parseElements.has(i)&&!(o.unsupported.tagName.has(i.tagName)||"INPUT"===i.tagName&&o.unsupported.tagName.has("".concat(i.tagName,":").concat(i.type))))){for(var r=!0,a=i.parentElement;a&&a!==e;){if(t.parseElements.has(a)){r=!1;break}a=a.parentElement}r&&t.insertNode(i)}}),this.processing.cache.length){for(var s=Array.isArray(c=this.processing.cache),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}var u=h;u.htmlElement&&"SELECT"!==u.tagName&&function(){var e=[],i=!1;if(u.element.childNodes.forEach(function(t){if("#text"===t.nodeName)e.push(t);else if("BR"!==t.tagName){var n=F.getElementAsNode(t);n&&!n.excluded&&(i=!0)}}),i)for(var n=0;n<e.length;n++){t.insertNode(e[n],u)}}()}for(var d={},f=new Set,g=Array.isArray(p=this.processing.cache),v=0,p=g?p:p[Symbol.iterator]();;){var m;if(g){if(v>=p.length)break;m=p[v++]}else{if((v=p.next()).done)break;m=v.value}var y=m;if(y.styleElement){var b=y.element,k={};if("BUTTON"!==b.tagName&&"button"!==b.type){var x=y.css("textAlign");switch(x){case"center":case"right":case"end":k.textAlign=x,b.style.textAlign="left"}}if(y.positionRelative&&!y.positionStatic)for(var S=0;S<X.length;S++){var _=X[S];y.has(_)&&(k[_]=y.css(_),b.style[_]="auto")}"rtl"===b.dir&&(b.dir="ltr",f.add(b)),d[y.id]=k}}a.parent.setBounds();for(var w=Array.isArray(T=this.processing.cache),E=0,T=w?T:T[Symbol.iterator]();;){var I;if(w){if(E>=T.length)break;I=T[E++]}else{if((E=T.next()).done)break;I=E.value}I.setBounds()}for(var R=Array.isArray(C=this.processing.excluded),B=0,C=R?C:C[Symbol.iterator]();;){var N;if(R){if(B>=C.length)break;N=C[B++]}else{if((B=C.next()).done)break;N=B.value}N.lineBreak||N.setBounds()}for(var P=Array.isArray(L=this.processing.cache),M=0,L=P?L:L[Symbol.iterator]();;){var D;if(P){if(M>=L.length)break;D=L[M++]}else{if((M=L.next()).done)break;D=M.value}if(D.styleElement){var O=d[D.id];if(O){var H=D.element;for(var W in O)H.style[W]=O[W];f.has(H)&&(H.dir="rtl")}}}for(var z=Array.isArray(q=this.processing.cache),U=0,q=z?q:q[Symbol.iterator]();;){var Y;if(z){if(U>=q.length)break;Y=q[U++]}else{if((U=q.next()).done)break;Y=U.value}var Q=Y;if(!Q.documentRoot){var Z=Q.actualParent;switch(Q.position){case"fixed":if(!Q.positionAuto){Z=a;break}case"absolute":if(Q.positionAuto&&G(Q,Z))break;if(this.userSettings.supportNegativeLeftTop){for(var $=Q.absoluteParent,K=void 0,J=!1;Z&&(Z!==a||0!==Z.id);){if(void 0===K){if($===Z){if(K=Z,"hidden"===Z.css("overflow"))break;if(Q.has("right")&&!(Q.right<0)||Q.has("bottom")&&!(Q.bottom<0)||!(Q.left<0&&Q.outsideX(Z.box)||!Q.has("left")&&Q.right<0&&Q.outsideX(Z.box)||Q.top<0&&Q.outsideY(Z.box)||!Q.has("top")&&Q.bottom<0&&Q.outsideX(Z.box)))break;J=!0}}else if(J&&(Z.documentRoot||"hidden"===Z.css("overflow")||Q.withinX(Z.box)&&Q.withinY(Z.box))){K=Z;break}Z=Z.actualParent}K&&(Z=K);break}Z=Q.absoluteParent}Q.pageFlow||void 0!==Z&&0!==Z.id||(Z=a),Z?(Q.parent=Z,Q.documentParent=Z):Q.hide()}}for(var ee=this.session.targeted.size>0,te=function(){if(ie){if(ne>=re.length)return"break";ae=re[ne++]}else{if((ne=re.next()).done)return"break";ae=ne.value}var e=ae;if(e.htmlElement&&e.length){var i=0;e.element.childNodes.forEach(function(t){var n=F.getElementAsNode(t);!n||n.excluded||!n.pageFlow&&n.documentParent!==e||(n.siblingIndex=i++)});var n=[];e.each(function(t){if(t.siblingIndex===1/0)for(var i=function(){if(r){if(a>=o.length)return"break";s=o[a++]}else{if((a=o.next()).done)return"break";s=a.value}var e=s;if(e.actualChildren.includes(t)||t.ascend().some(function(t){return e.cascade().includes(t)})){var i=-1;return void 0===n[i=t.zIndex>=0||e!==t.actualParent?e.siblingIndex+1:e.siblingIndex-1]&&(n[i]=[]),n[i].push(t),"break"}},r=Array.isArray(o=e.children),a=0,o=r?o:o[Symbol.iterator]();;){var s;if("break"===i())break}});for(var r=function(t){var i=n[t];if(i){i.sort(function(e,t){return e.zIndex===t.zIndex?e.id<t.id?-1:1:e.zIndex<t.zIndex?-1:1}),e.each(function(e){e.siblingIndex>=t&&e.siblingIndex!==1/0&&(e.siblingIndex+=i.length)});for(var r=0;r<i.length;r++)i[r].siblingIndex=t+r}},a=0;a<n.length;a++)r(a);e.sort(A.siblingIndex)}if(e.saveAsInitial(),ee&&e.elementId){var o=t.session.targeted.get(e.elementId);if(o){for(var s=Array.isArray(c=o),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}h.render(e)}t.session.targeted.delete(e.elementId)}}},ie=Array.isArray(re=this.processing.cache),ne=0,re=ie?re:re[Symbol.iterator]();;){var ae;if("break"===te())break}V.sortArray(this.processing.cache.children,!0,"depth","id");for(var oe=0;oe<n.length;oe++){n[oe].afterInit(e)}return!0}return!1}},{key:"setBaseLayout",value:function(){for(var e=this,t=this.userSettings,i=this.controllerHandler.localSettings,n=[],r=Array.isArray(o=this.extensions),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}s.eventOnly||n.push(s)}var l=this.processing.node,c=new Map,h=i.baseTemplate,u=!0;function d(e,t,i){var n=c.get(e)||new Map;n.set(t,i),c.set(e,n)}function f(e){var t=c.values(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=r,o=a.values(),s=Array.isArray(o),l=0;for(o=s?o:o[Symbol.iterator]();;){var h;if(s){if(l>=o.length)break;h=o[l++]}else{if((l=o.next()).done)break;h=l.value}if(h.id===e)return void a.delete(h.id)}}}d(-1,0,l.parent);for(var v=0,p=Array.isArray(b=this.processing.cache),y=0,b=p?b:b[Symbol.iterator]();;){var k;if(p){if(y>=b.length)break;k=b[y++]}else{if((y=b.next()).done)break;k=y.value}var x=k;x.visible&&(d(x.depth,x.id,x),v=Math.max(x.depth,v))}for(var S=0;S<v;S++)c.set(-1*S-2,new Map);this.processing.cache.afterAppend=function(e){f(e.id),d(-1*e.depth-2,e.id,e);var t=e.cascade(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=r;f(a.id),d(-1*a.depth-2,a.id,a)}};var w=c.values(),E=Array.isArray(w),T=0;for(w=E?w:w[Symbol.iterator]();;){var I;if(E){if(T>=w.length)break;I=w[T++]}else{if((T=w.next()).done)break;I=T.value}var R=I;this.processing.depthMap.clear();var B=function(){if(N){if(P>=C.length)return"break";M=C[P++]}else{if((P=C.next()).done)return"break";M=P.value}var i=M;if(0===i.length||i.every(function(e){return e.rendered}))return"continue";for(var r=i.duplicate(),a=r.some(function(e){return e.floating}),o=a?A.clearedAll(i):new Map,s=i.renderExtension.size?Array.from(i.renderExtension):[],c=V.filterArray(n,function(e){return e.subscribersChild.size>0}),h=-1,u=function(){var i=r[h];if(i.rendered||!i.visible)return"continue";if(i.htmlElement){var u=i.element;if(e.parseElements.has(u)&&!i.documentRoot&&!i.documentBody)return"continue";if(0===i.length&&u.children.length){for(var d=!0,f=0;f<u.children.length;f++)if(!e.parseElements.has(u.children[f])){d=!1;break}d&&(i.inlineText=!1)}}var g=i.hasAlign(8192),v=i.parent,p=v.hasAlign(2);if(r.length>1&&h<r.length-1&&i.pageFlow&&(0===v.alignmentType||g||p)&&!v.hasAlign(4)&&!i.hasBit("excludeSection",m.DOM_TRAVERSE)){var y,b,k=function(e){return!w.length&&!T&&(S.push(e),!0)},x=function(e){if(v.layoutVertical&&w.length){var t=w[w.length-1];if(t.layoutVertical)return void(e.parent=t)}w.push(e)},S=[],w=[],E=new Set,T=!1,I=h,R=0;g&&v.layoutVertical&&(S.push(i),I++,R++);e:for(;I<r.length;I++,R++){var B=r[I];if(B.pageFlow){if(a){var C=o.get(B);C&&("both"===C?E.clear():E.delete(C)),B.floating&&E.add(B.float)}var N=B.previousSiblings(),P=N[N.length-1],M=B.nextSiblings().shift();if(0===R&&M)B.blockStatic||M.alignedVertically([B],[B],o)?w.push(B):S.push(B);else{if(!P)break e;if(a){var L=[];S.length?V.concatArray(L,S):w.length&&V.concatArray(L,w),L.push(B);var D=B.alignedVertically(N,L,o,!1);if(D||t.floatOverlapDisabled&&P.floating&&B.blockStatic&&2===E.size){if(S.length){if(!t.floatOverlapDisabled&&E.size&&!P.autoMargin.horizontal&&!N.some(function(e){return e.lineBreak&&!o.has(e)})&&"both"!==o.get(B))switch(function(){var e=-1/0;if(V.captureMap(S,function(e){return e.floating},function(t){return e=Math.max(e,t.linear.bottom)}),!B.floating||B.linear.top<e){var t=A.floated(S);if(o.has(B))return!B.floating&&E.size<2&&2===t.size?(B.alignmentType|=8192,T=!0,S.push(B),"continue"):"break|domNested";if(!D||1===t.size&&(!B.floating||E.has(B.float)))return S.push(B),B.linear.bottom>e?"break|domNested":"continue"}}()){case"continue":continue;case"break|domNested":break e}break e}x(B)}else if(!k(B))break e}else if(B.alignedVertically(N))x(B);else if(!k(B))break e}}}if(S.length>1){var O=new _(v,i,0,0,S.length,S);O.init(),y=e.controllerHandler.processTraverseHorizontal(O,r),b=S[S.length-1]}else if(w.length>1){var H=new _(v,i,0,0,w.length,w);H.init(),y=e.controllerHandler.processTraverseVertical(H,r),(b=w[w.length-1]).blockStatic||b===r[r.length-1]||(b.alignmentType|=8192)}if(p&&b===r[r.length-1]&&(v.alignmentType^=2,p=!1),y){var W=y.layout,z=e.renderLayout(W);""!==z&&(e.addRenderTemplate(v,W.node,z,!0),v=i.parent)}}if(g&&(i.alignmentType^=8192),p&&h===r.length-1&&(v.alignmentType^=2),i.renderAs&&v.appendTry(i,i.renderAs,!1)&&(i.hide(),(i=i.renderAs).positioned&&(v=i.parent)),!i.rendered&&!i.hasBit("excludeSection",m.EXTENSION)){var F=!1;if(s.length||c.length){var U=s.slice(0);c.length&&V.concatArray(U,V.filterArray(c,function(e){return e.subscribersChild.has(i)}));for(var q=Array.isArray(G=U),X=0,G=q?G:G[Symbol.iterator]();;){var Y;if(q){if(X>=G.length)break;Y=G[X++]}else{if((X=G.next()).done)break;Y=X.value}var Q=Y.processChild(i,v);if(Q.output&&e.addRenderTemplate(v,i,Q.output),Q.renderAs&&Q.outputAs&&e.addRenderTemplate(v,Q.renderAs,Q.outputAs),Q.parent&&(v=Q.parent),F=!0===Q.next,Q.complete||Q.next)break}}if(F)return"continue";if(i.styleElement&&(j(l.element,i.element,n).some(function(t){if(t.is(i)&&t.condition(i,v)){var n=t.processNode(i,v);if(n.output&&e.addRenderTemplate(v,i,n.output),n.renderAs&&n.outputAs&&e.addRenderTemplate(v,n.renderAs,n.outputAs),n.parent&&(v=n.parent),(n.output||!0===n.include)&&(t.subscribers.add(i),i.renderExtension.add(t)),F=!0===n.next,n.complete||n.next)return!0}return!1}),F))return"continue"}if(!i.rendered&&!i.hasBit("excludeSection",m.RENDER)){var Z=new _(v,i,i.containerType,i.alignmentType,i.length,i.children);if(0===Z.containerType){var $;if(!0===($=i.length?e.controllerHandler.processUnknownParent(Z):e.controllerHandler.processUnknownChild(Z)).next)return"continue";if($.renderAs)return r[h]=$.renderAs,h--,"continue";Z=$.layout}var K=e.renderLayout(Z);""!==K&&e.addRenderTemplate(v,i,K)}};++h<r.length;)u()};var C=R.values(),N=Array.isArray(C),P=0;e:for(C=N?C:C[Symbol.iterator]();;){var M;switch(B()){case"break":break e;case"continue":continue}}var L=this.processing.depthMap.entries(),D=Array.isArray(L),O=0;for(L=D?L:L[Symbol.iterator]();;){var H;if(D){if(O>=L.length)break;H=L[O++]}else{if((O=L.next()).done)break;H=O.value}var W=g(H,2),z=W[1],F=this._renderPosition.get(he=W[0]),U=void 0;if(F)U=this.controllerHandler.sortRenderPosition(F.parent,F.children);else if(0!==he){var X=this.processing.cache.find("id",he);X&&(U=this.controllerHandler.sortRenderPosition(X,X.children))}if(U&&U.length){for(var G=new Map,Y=Array.isArray(Z=U),Q=0,Z=Y?Z:Z[Symbol.iterator]();;){var $;if(Y){if(Q>=Z.length)break;$=Z[Q++]}else{if((Q=Z.next()).done)break;$=Q.value}var K=$,J=K.renderPositionId,ee=z.get(J)||(K.companion?z.get(K.companion.renderPositionId):null);ee&&G.set(J,ee)}G.size===z.size&&this.processing.depthMap.set(he,G)}}for(var te=Array.isArray(ne=this.extensions),ie=0,ne=te?ne:ne[Symbol.iterator]();;){var re;if(te){if(ie>=ne.length)break;re=ne[ie++]}else{if((ie=ne.next()).done)break;re=ie.value}re.afterDepthLevel()}var ae=this.processing.depthMap.entries(),oe=Array.isArray(ae),se=0;for(ae=oe?ae:ae[Symbol.iterator]();;){var le;if(oe){if(se>=ae.length)break;le=ae[se++]}else{if((se=ae.next()).done)break;le=se.value}var ce=g(le,2),he=ce[0],ue=(z=ce[1]).entries(),de=Array.isArray(ue),fe=0;for(ue=de?ue:ue[Symbol.iterator]();;){var ge;if(de){if(fe>=ue.length)break;ge=ue[fe++]}else{if((fe=ue.next()).done)break;ge=fe.value}var ve=g(ge,2),pe=ve[0],me=ve[1],ye=q.formatPlaceholder(-1!==pe.indexOf("^")?pe:he);-1!==h.indexOf(ye)?(h=q.replacePlaceholder(h,ye,me),u=!1):this.addRenderQueue(-1!==pe.indexOf("^")?"".concat(he,"|").concat(pe):""+he,me)}}}!l.dataset.layoutName||l.dataset.target&&0!==l.renderExtension.size||this.addLayoutFile(l.dataset.layoutName,u?"":h,V.trimString(V.trimNull(l.dataset.pathname),"/"),l.renderExtension.size>0&&V.hasInSet(l.renderExtension,function(e){return e.documentRoot})),u&&0===l.renderExtension.size&&l.hide(),this.processing.cache.sort(function(e,t){return e.visible&&e.rendered?e.renderDepth!==t.renderDepth?e.renderDepth<t.renderDepth?-1:1:e.renderParent!==t.renderParent?e.documentParent.id<t.documentParent.id?-1:1:e.siblingIndex<t.siblingIndex?-1:1:1}),this.session.cache.concat(this.processing.cache.children),this.session.excluded.concat(this.processing.excluded.children);for(var be=Array.isArray(xe=this.extensions),ke=0,xe=be?xe:xe[Symbol.iterator]();;){var Ae;if(be){if(ke>=xe.length)break;Ae=xe[ke++]}else{if((ke=xe.next()).done)break;Ae=ke.value}for(var Se=Ae,_e=Array.isArray(Ee=Se.subscribers),we=0,Ee=_e?Ee:Ee[Symbol.iterator]();;){var Te;if(_e){if(we>=Ee.length)break;Te=Ee[we++]}else{if((we=Ee.next()).done)break;Te=we.value}Se.postBaseLayout(Te)}}for(var Ie=Array.isArray(Be=this.extensions),Re=0,Be=Ie?Be:Be[Symbol.iterator]();;){var Ce;if(Ie){if(Re>=Be.length)break;Ce=Be[Re++]}else{if((Re=Be.next()).done)break;Ce=Re.value}Ce.afterBaseLayout()}}},{key:"setConstraints",value:function(){this.controllerHandler.setConstraints();for(var e=Array.isArray(i=this.extensions),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}for(var r=n,a=Array.isArray(s=r.subscribers),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}r.postConstraints(l)}}for(var c=Array.isArray(u=this.extensions),h=0,u=c?u:u[Symbol.iterator]();;){var d;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}d.afterConstraints()}}},{key:"setResources",value:function(){this.resourceHandler.setBoxStyle(),this.resourceHandler.setFontStyle(),this.resourceHandler.setValueString();for(var e=Array.isArray(i=this.extensions),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}n.afterResources()}}},{key:"processRenderQueue",value:function(){var e={},t=this.session.renderQueue.entries(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=g(r,2),o=a[1],s=g((x=a[0]).split("|"),2),l=s[0],c=s[1],h=l;if(!V.isNumber(h)){var u=document.getElementById(h);if(u){var d=F.getElementAsNode(u);d&&(h=""+d.id)}}var f=o.join("\n");if(h!==l){var v=this.session.cache.find("id",parseInt(h));v&&(f=this.controllerHandler.replaceIndent(f,v.renderDepth+1,this.session.cache.children))}e[c||h]=f}for(var p=Array.isArray(y=this.viewData),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b;for(var x in e)k.content=k.content.replace(q.formatPlaceholder(x),e[x]);k.content=this.controllerHandler.replaceRenderQueue(k.content)}}},{key:"processFloatHorizontal",value:function(e){var t=this.userSettings,i=[],n="";if(0===e.cleared.size&&!e.some(function(e){return e.autoMargin.horizontal})){for(var r=[],a=[],o=[],s=Array.isArray(c=e),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}var u=h;"right"===u.float?o.push(u):"left"===u.float?a.push(u):r.push(u)}var d=new _(e.parent,e.node,0,0,e.itemCount,e.children);if(d.init(),r.length===d.itemCount||a.length===d.itemCount||o.length===d.itemCount)return this.controllerHandler.processLayoutHorizontal(d),this.renderNode(d);if((0===a.length||0===o.length)&&(this.userSettings.floatOverlapDisabled||!r.some(function(e){return e.blockStatic}))){var f=[];if(0===o.length){V.concatMultiArray(f,a,r);var g=this.controllerHandler.containerTypeHorizontal;d.setType(g.containerType,g.alignmentType),i=[a,r]}else{V.concatMultiArray(f,r,o);var v=this.controllerHandler.containerTypeVerticalMargin;d.setType(v.containerType,v.alignmentType),i=[r,o]}d.retain(f),n=this.renderNode(d)}}var p=[],m=[],y=[],b=[],k=[],x=[],S=[],w=[];if(0===i.length){for(var E="",T=0,I=0;I<e.length;I++){var R=e.item(I),B=e.cleared.get(R);if(B&&(V.hasBit(T,"right"===B?4:2)||0!==T&&"both"===B))switch(B){case"left":V.hasBit(T,2)&&(T^=2),E="left";break;case"right":V.hasBit(T,4)&&(T^=4),E="right";break;case"both":switch(T){case 2:E="left";break;case 4:E="right";break;default:E="both"}T=0}if(""===E)"right"===R.float?(b.push(R),R.floating&&(T|=4)):"left"===R.float?(y.push(R),R.floating&&(T|=2)):R.autoMargin.horizontal?R.autoMargin.left?b.length?x.push(R):b.push(R):R.autoMargin.right?y.length?k.push(R):y.push(R):p.length?0===y.length?y.push(R):b.push(R):p.push(R):p.push(R);else if("right"===R.float)0===x.length&&(T|=4),!t.floatOverlapDisabled&&"right"!==E&&b.length?b.push(R):x.push(R);else if("left"===R.float)0===k.length&&(T|=2),!t.floatOverlapDisabled&&"left"!==E&&y.length?y.push(R):k.push(R);else if(R.autoMargin.horizontal)R.autoMargin.left&&x.length?x.push(R):R.autoMargin.right&&k.length?k.push(R):m.push(R);else switch(E){case"left":k.push(R);break;case"right":x.push(R);break;default:m.push(R)}}y.length&&k.length?S=[y,k]:y.length?S=y:k.length&&(S=k),b.length&&x.length?w=[b,x]:b.length?w=b:x.length&&(w=x);var C=new _(e.parent,e.node,0,b.length+x.length===e.length?512:0);if(t.floatOverlapDisabled){if(e.node.groupParent&&e.parent.layoutVertical)e.node.alignmentType|=C.alignmentType,n=q.formatPlaceholder(e.node.id),e.node.render(e.parent),e.node.renderDepth--;else{var N=this.controllerHandler.containerTypeVertical;C.setType(N.containerType,N.alignmentType),n=this.renderNode(C)}p.length&&i.push(p),(y.length||b.length)&&i.push([y,b]),(k.length||x.length)&&i.push([k,x]),m.length&&i.push(m),C.itemCount=i.length}else{p.length?x.length?i.push(S=[p,y],w):k.length?i.push(w=[p,b],S):i.push(p,S,w):S===k&&w===b||S===y&&w===x?i.push(0===k.length?[y,x]:[b,k]):i.push(S,w),V.spliceArray(i,function(e){return 0===e.length}),C.itemCount=i.length;var P=0!==p.length||0!==S.length&&0!==w.length?this.controllerHandler.containerTypeVerticalMargin:this.controllerHandler.containerTypeVertical;C.setType(P.containerType,P.alignmentType),n=this.renderNode(C)}}if(i.length)for(var M,L=[p,y,k,b,x],D=0;D<i.length;D++){var O=i[D],H=void 0;if(Array.isArray(O[0])){for(var W=[],z=Array.isArray(U=H=O),F=0,U=z?U:U[Symbol.iterator]();;){var X;if(z){if(F>=U.length)break;X=U[F++]}else{if((F=U.next()).done)break;X=F.value}V.concatArray(W,X)}W.sort(A.siblingIndex),M=this.controllerHandler.createNodeGroup(W[0],W,e.node);var j=new _(e.node,M,0,H.some(function(e){return e===w||e===b})?512:0,H.length),G=void 0;t.floatOverlapDisabled?G=this.controllerHandler.containerTypeVerticalMargin:e.node.layoutVertical?M=e.node:G=this.controllerHandler.containerTypeVertical,G&&(j.setType(G.containerType,G.alignmentType),n=q.replacePlaceholder(n,e.node.id,this.renderNode(j)))}else H=[O],M=void 0;for(var Y=Array.isArray(Z=H),Q=0,Z=Y?Z:Z[Symbol.iterator]();;){var $;if(Y){if(Q>=Z.length)break;$=Z[Q++]}else{if((Q=Z.next()).done)break;$=Q.value}var K=$,J=e.node;M&&L.includes(K)&&(J=M);var ee=void 0;if(K.length>1){ee=this.controllerHandler.createNodeGroup(K[0],K,J);var te=new _(J,ee,0,128,K.length,K);if(te.linearY){var ie=this.controllerHandler.containerTypeVertical;te.setType(ie.containerType,ie.alignmentType)}else te.init(),this.controllerHandler.processLayoutHorizontal(te);n=q.replacePlaceholder(n,J.id,this.renderNode(te))}else K.length&&((ee=K[0]).alignmentType|=2048,ee.renderPosition=D,n=q.replacePlaceholder(n,J.id,q.formatPlaceholder(ee.renderPositionId)));if(!t.floatOverlapDisabled&&ee&&K===p&&K.some(function(e){return e.blockStatic&&!e.hasWidth})){var ne=this.controllerHandler.containerTypeVertical,re=ee.of(ne.containerType,ne.alignmentType)?ee.children:[ee];if(y.length){for(var ae=-1/0,oe=1/0,se=0;se<y.length;se++){ae=Math.max(ae,y[se].linear.right)}for(var le=Array.isArray(he=K),ce=0,he=le?he:he[Symbol.iterator]();;){var ue;if(le){if(ce>=he.length)break;ue=he[ce++]}else{if((ce=he.next()).done)break;ue=ce.value}oe=Math.min(oe,ue.bounds.left)}for(var de=Array.isArray(ge=re),fe=0,ge=de?ge:ge[Symbol.iterator]();;){var ve;if(de){if(fe>=ge.length)break;ve=ge[fe++]}else{if((fe=ge.next()).done)break;ve=fe.value}ve.modifyBox(256,ae-oe)}}if(b.length){for(var pe=1/0,me=-1/0,ye=0;ye<b.length;ye++){pe=Math.min(pe,b[ye].linear.left)}for(var be=Array.isArray(xe=K),ke=0,xe=be?xe:xe[Symbol.iterator]();;){var Ae;if(be){if(ke>=xe.length)break;Ae=xe[ke++]}else{if((ke=xe.next()).done)break;Ae=ke.value}me=Math.max(me,Ae.bounds.right)}for(var Se=Array.isArray(we=re),_e=0,we=Se?we:we[Symbol.iterator]();;){var Ee;if(Se){if(_e>=we.length)break;Ee=we[_e++]}else{if((_e=we.next()).done)break;Ee=_e.value}Ee.modifyBox(64,me-pe)}}}}}return n}},{key:"processFloatVertical",value:function(e){for(var t=this.controllerHandler,i=t.containerTypeVertical,n=e.node,r=new _(e.parent,n,i.containerType,i.alignmentType,e.length),a=this.renderNode(r),o=[],s=[],l=[],c=[],h=!1,u=!1,d=!0,f=Array.isArray(v=e),g=0,v=f?v:v[Symbol.iterator]();;){var p;if(f){if(g>=v.length)break;p=v[g++]}else{if((g=v.next()).done)break;p=g.value}var m=p;m.blockStatic&&0===c.length?(l.push(m),u=!0):(e.cleared.has(m)&&(m.floating?h=!0:(m.modifyBox(2,null),o.push(l.slice(0)),l.length=0,s.push(c.slice(0)),c.length=0)),m.floating?(u&&(o.push(l.slice(0)),s.push(null),l.length=0,c.length=0,u=!1),c.push(m)):(h&&!e.cleared.has(m)&&(d=!1),l.push(m)))}if(c.length&&s.push(c),l.length&&o.push(l),!d){for(var y="",b=0;b<Math.max(s.length,o.length);b++){var k=o[b]||[];if(null===s[b]&&k.length)if(k.length>1){var x=t.containerTypeVertical;x.alignmentType|=128;var A=new _(n,t.createNodeGroup(k[0],k,n),x.containerType,x.alignmentType,k.length,k);y+=this.renderNode(A)}else{var S=k[0];S.alignmentType|=2048,S.renderPosition=b,a=q.replacePlaceholder(a,n.id,q.formatPlaceholder(S.renderPositionId))}else{var w=s[b]||[];if(k.length||w.length){var E=t.createNodeGroup(w[0]||k[0],[],n),T=t.containerTypeVerticalMargin,I=new _(n,E,T.containerType,T.alignmentType),R=[],B=void 0;w.length&&(w.length>1?(B=t.createNodeGroup(w[0],w,E),I.add(64),0===k.length&&w.every(function(e){return"right"===e.float})&&I.add(512)):(B=w[0]).parent=E),B&&(R.push(B),B=void 0),k.length&&(k.length>1?B=t.createNodeGroup(k[0],k,E):(B=k[0]).parent=E),B&&R.push(B),E.init(),I.itemCount=R.length,y+=this.renderNode(I);for(var C=0;C<R.length;C++){var N=R[C];if(e.contains(N)||0===N.length)y=q.replacePlaceholder(y,E.id,q.formatPlaceholder(N.id));else{var P=new _(E,N,i.containerType,128|i.alignmentType,N.length,N.children);y=q.replacePlaceholder(y,E.id,this.renderNode(P))}}}}}a=q.replacePlaceholder(a,n.id,y)}return a}},{key:"insertNode",value:function(e,t){var i;if("#"===e.nodeName.charAt(0)&&"#text"===e.nodeName)(U.isPlainText(e,!0)||z.isParentStyle(e,"whiteSpace","pre","pre-wrap"))&&(i=this.createNode(e),t?i.inherit(t,"textStyle"):i.css("whiteSpace",z.getStyle(e.parentElement).whiteSpace||"normal"),i.cssApply({position:"static",display:"inline",verticalAlign:"baseline",cssFloat:"none",clear:"none"}));else if(e.parentElement instanceof HTMLElement){if(i=this.createNode(e),this.controllerHandler.localSettings.unsupported.excluded.has(e.tagName)||!this.conditionElement(e))return i.visible=!1,i.excluded=!0,void this.processing.excluded.append(i);i.setExclusions()}return i&&this.processing.cache.append(i),i}},{key:"conditionElement",value:function(e){if(z.hasComputedStyle(e)){if(F.isElementVisible(e,!0)||e.dataset.use)return!0;for(var t=e.parentElement,i=!0;t;){if("none"===z.getStyle(t).display){i=!1;break}t=t.parentElement}if(i)for(var n=0;n<e.children.length;n++)if(F.isElementVisible(e.children[n],!0))return!0;return!1}return U.isPlainText(e)}},{key:"setStyleMap",value:function(){e:for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.cssRules)for(var i=0;i<t.cssRules.length;i++){var n=t.cssRules[i];try{switch(n.type){case CSSRule.STYLE_RULE:this.applyStyleRule(n);break;case CSSRule.MEDIA_RULE:for(var r=/(?:(not|only)?\s*(?:all|screen) and )?((?:\([^)]+\)(?: and )?)+),?\s*/g,a=void 0,o=!1;!o&&null!==(a=r.exec(n.conditionText));){for(var s="not"===a[1],l=/\(([a-z\-]+)\s*(:|<?=?|=?>?)?\s*([\w.%]+)?\)(?: and )?/g,c=void 0,h=!1;!o&&null!==(c=l.exec(a[2]));){var u=c[1],d=void 0;d=c[1].startsWith("min")?">=":c[1].startsWith("max")?"<=":a[2];var f=c[3];switch(u){case"aspect-ratio":case"min-aspect-ratio":case"max-aspect-ratio":var v=g(V.replaceMap(f.split("/"),function(e){return parseInt(e)}),2);h=Y(d,window.innerWidth/window.innerHeight,v[0]/v[1]);break;case"width":case"min-width":case"max-width":case"height":case"min-height":case"max-height":h=Y(d,-1!==u.indexOf("width")?window.innerWidth:window.innerHeight,V.calculateUnit(f,V.convertInt(z.getStyle(document.body).fontSize)));break;case"orientation":h="portrait"===f&&window.innerWidth<=window.innerHeight||"landscape"===f&&window.innerWidth>window.innerHeight;break;case"resolution":case"min-resolution":case"max-resolution":var p=parseFloat(f);f.endsWith("dpcm")?p*=2.54:(f.endsWith("dppx")||f.endsWith("x"))&&(p*=96),h=Y(d,V.getDeviceDPI(),p);break;case"grid":h="0"===f;break;case"color":h=void 0===f||V.convertInt(f)>0;break;case"min-color":h=V.convertInt(f)<=screen.colorDepth/3;break;case"max-color":h=V.convertInt(f)>=screen.colorDepth/3;break;case"color-index":case"min-color-index":case"monochrome":case"min-monochrome":h="0"===f;break;case"max-color-index":case"max-monochrome":h=V.convertInt(f)>=0;break;default:h=!1}if(!h)break}(!s&&h||s&&!h)&&(o=!0)}if(o)for(var m=n.cssRules,y=0;y<m.length;y++)this.applyStyleRule(m[y])}}catch(e){alert("External CSS files cannot be parsed with some browsers when loading HTML pages directly from your hard drive. Either use a local web server, embed your CSS into a <style> element, or you can also try a different browser. See the README for more detailed instructions.\n\n"+"".concat(t.href,"\n\n").concat(e));break e}}}}},{key:"applyStyleRule",value:function(e){for(var t=this,i=V.isUserAgent(8),n=[],r=Array.from(e.style),a=0;a<r.length;a++){n.push(V.convertCamelCase(r[a]))}document.querySelectorAll(e.selectorText).forEach(function(r){for(var a=z.getStyle(r),o=V.calculateUnit(a.fontSize),s={},l=0;l<n.length;l++){var c=n[l],h=z.checkStyleValue(r,c,e.style[c],a,o);h&&(s[c]=h)}if(t.userSettings.preloadImages&&V.hasValue(s.backgroundImage)&&"initial"!==s.backgroundImage){var u=s.backgroundImage.split(V.REGEXP_COMPILED.SEPARATOR),d=Array.isArray(u),f=0;for(u=d?u:u[Symbol.iterator]();;){var g;if(d){if(f>=u.length)break;g=u[f++]}else{if((f=u.next()).done)break;g=f.value}var v=z.resolveURL(g.trim());""===v||t.session.image.has(v)||t.session.image.set(v,{width:0,height:0,uri:v})}}if(i&&void 0===s.display)switch(r.tagName){case"INPUT":case"TEXTAREA":case"SELECT":case"BUTTON":s.display="inline-block"}var p=F.getElementCache(r,"styleMap");p?Object.assign(p,s):(F.setElementCache(r,"style",a),F.setElementCache(r,"styleMap",s))})}},{key:"appName",set:function(e){this.resourceHandler.fileHandler&&(this.resourceHandler.fileHandler.appName=e)},get:function(){return this.resourceHandler.fileHandler?this.resourceHandler.fileHandler.appName:""}},{key:"userSettings",set:function(e){this._userSettings=e},get:function(){return this._userSettings||{}}},{key:"viewData",get:function(){return[].concat(this._views,this._includes)}},{key:"sessionData",get:function(){return{cache:this.session.cache,templates:this.viewData}}},{key:"rendered",get:function(){return this.session.cache.filter(function(e){return e.visible&&e.rendered})}},{key:"nextId",get:function(){return this.processing.cache.nextId}},{key:"size",get:function(){return this._views.length+this._includes.length}}]),e}(),Z=squared.lib.xml,$=/^({[^}]+})(\t*)(<.*)/,K=/{[<:@#>]\d+(\^\d+)?}\n?/g,J=function(){function e(t,i){r(this,e),this.application=t,this.cache=i,this._before={},this._after={}}return o(e,[{key:"reset",value:function(){this._before={},this._after={}}},{key:"replaceRenderQueue",value:function(e){for(var t in this._before)e=e.replace("{<".concat(t,"}"),this._before[t].join(""));for(var i in this._after)e=e.replace("{>".concat(i,"}"),this._after[i].join(""));return e}},{key:"prependBefore",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._before[e]&&(this._before[e]=[]),-1!==i&&i<this._before[e].length?this._before[e].splice(i,0,t):this._before[e].push(t)}},{key:"appendAfter",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._after[e]&&(this._after[e]=[]),-1!==i&&i<this._after[e].length?this._after[e].splice(i,0,t):this._after[e].push(t)}},{key:"hasAppendProcessing",value:function(e){return void 0!==this._before[e]||void 0!==this._after[e]}},{key:"getEnclosingTag",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r="\t".repeat(Math.max(0,i)),a="{<".concat(t,"}");return a+=""!==n?r+"<".concat(e).concat(0===i?"{#0}":"","{@").concat(t,"}>\n")+n+r+"</".concat(e,">\n"):r+"<".concat(e).concat(0===i?"{#0}":"","{@").concat(t,"} />\n"),a+="{>".concat(t,"}")}},{key:"removePlaceholders",value:function(e){return e.replace(K,"").trim()}},{key:"replaceIndent",value:function(e,t,i){if(e=Z.replaceIndent(e,t,$),i)for(var n,r=/{@(\d+)}/g,a=0,o=function(){var e=parseInt(n[1]),r=i.find(function(t){return t.id===e});r&&(0==a++?r.renderDepth=t:r.renderParent&&(r.renderDepth=r.renderParent.renderDepth+1))};null!==(n=r.exec(e));)o();return e}}]),e}(),ee=squared.lib.css,te=squared.lib.util,ie=function(){function e(t,i,n,a){r(this,e),this.name=t,this.framework=i,this.tagNames=[],this.documentRoot=!1,this.eventOnly=!1,this.preloaded=!1,this.options={},this.dependencies=[],this.subscribers=new Set,this.subscribersChild=new Set,Array.isArray(n)&&(this.tagNames=te.replaceMap(n,function(e){return e.trim().toUpperCase()})),a&&Object.assign(this.options,a)}return o(e,[{key:"is",value:function(e){return!!e.styleElement&&(0===this.tagNames.length||this.tagNames.includes(e.element.tagName))}},{key:"require",value:function(e){this.dependencies.push({name:e,preload:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}},{key:"included",value:function(e){return te.includes(e.dataset.use,this.name)}},{key:"beforeInit",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.included(e))for(var t=Array.isArray(n=this.dependencies),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.preload){var a=this.application.extensionManager.retrieve(r.name);a&&!a.preloaded&&(a.beforeInit(e,!0),a.preloaded=!0)}}}},{key:"init",value:function(e){return!1}},{key:"afterInit",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.included(e))for(var t=Array.isArray(n=this.dependencies),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.preload){var a=this.application.extensionManager.retrieve(r.name);a&&a.preloaded&&(a.afterInit(e,!0),a.preloaded=!1)}}}},{key:"condition",value:function(e,t){return!!ee.hasComputedStyle(e.element)&&(e.dataset.use?this.included(e.element):this.tagNames.length>0)}},{key:"processNode",value:function(e,t){return{output:"",complete:!1}}},{key:"processChild",value:function(e,t){return{output:"",complete:!1}}},{key:"postBaseLayout",value:function(e){}},{key:"postConstraints",value:function(e){}},{key:"postParseDocument",value:function(e){}},{key:"postProcedure",value:function(e){}},{key:"beforeParseDocument",value:function(){}},{key:"afterDepthLevel",value:function(){}},{key:"afterBaseLayout",value:function(){}},{key:"afterConstraints",value:function(){}},{key:"afterResources",value:function(){}},{key:"afterParseDocument",value:function(){}},{key:"afterProcedure",value:function(){}},{key:"afterFinalize",value:function(){}},{key:"application",set:function(e){this._application=e},get:function(){return this._application||{}}},{key:"installed",get:function(){return!!this.application.extensions&&this.application.extensions.has(this)}}],[{key:"findNestedByName",value:function(e,t){if(ee.hasComputedStyle(e))for(var i=0;i<e.children.length;i++){var n=e.children[i];if(te.includes(n.dataset.use,t))return n}return null}}]),e}(),ne=squared.lib.util,re=function(){function e(t){r(this,e),this.application=t}return o(e,[{key:"include",value:function(e){var t=this,i=this.retrieve(e.name);return i?(Array.isArray(e.tagNames)&&(i.tagNames=e.tagNames),Object.assign(i.options,e.options),!0):!(0!==e.framework&&!ne.hasBit(e.framework,this.application.framework)||!e.dependencies.every(function(e){return!!t.retrieve(e.name)}))&&(e.application=this.application,this.application.extensions.add(e),!0)}},{key:"exclude",value:function(e){return this.application.extensions.delete(e)}},{key:"retrieve",value:function(e){for(var t=Array.isArray(n=this.application.extensions),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.name===e)return r}return null}},{key:"optionValue",value:function(e,i){var n=this.retrieve(e);if(n&&"object"===t(n.options))return n.options[i]}},{key:"optionValueAsObject",value:function(e,i){var n=this.optionValue(e,i);return"object"===t(n)?n:null}},{key:"optionValueAsString",value:function(e,t){var i=this.optionValue(e,t);return"string"==typeof i?i:""}},{key:"optionValueAsNumber",value:function(e,t){var i=this.optionValue(e,t);return"number"==typeof i?i:0}},{key:"optionValueAsBoolean",value:function(e,t){var i=this.optionValue(e,t);return"boolean"==typeof i&&i}}]),e}(),ae=squared.lib.util,oe=function(){function e(t){r(this,e),this.resource=t,this.appName="",this.assets=[],t.fileHandler=this}return o(e,[{key:"addAsset",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(""!==i||""!==n){var r=this.assets.findIndex(function(i){return i.pathname===e&&i.filename===t});-1!==r?(this.assets[r].content=i||"",this.assets[r].uri=n||""):this.assets.push({pathname:e,filename:t,content:i,uri:n})}}},{key:"reset",value:function(){this.assets.length=0}},{key:"saveToDisk",value:function(t){if(location.protocol.startsWith("http")){if(t.length){var i=this.userSettings;ae.concatArray(t,this.assets),fetch("/api/savetodisk"+"?directory=".concat(encodeURIComponent(ae.trimString(i.outputDirectory,"/")))+"&appname=".concat(encodeURIComponent(this.appName.trim()))+"&filetype=".concat(i.outputArchiveFileType.toLowerCase())+"&processingtime=".concat((""+i.outputMaxProcessingTime).trim()),{method:"POST",headers:new Headers({Accept:"application/json, text/plain, */*","Content-Type":"application/json"}),body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(t){t&&(t.zipname?fetch("/api/downloadtobrowser?filename=".concat(encodeURIComponent(t.zipname))).then(function(e){return e.blob()}).then(function(i){return e.downloadToDisk(i,ae.fromLastIndexOf(t.zipname))}):t.system&&alert("".concat(t.application,"\n\n").concat(t.system)))}).catch(function(e){return alert("ERROR: ".concat(e))})}}else alert("SERVER (required): See README for instructions")}},{key:"stored",get:function(){return this.resource.stored}}],[{key:"downloadToDisk",value:function(e,t){var i=new Blob([e],{type:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")||"application/octet-stream"}),n=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=n,r.setAttribute("download",t),void 0===r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(function(){return window.URL.revokeObjectURL(n)},1)}}]),e}(),se=new Map([[2,"marginTop"],[4,"marginRight"],[8,"marginBottom"],[16,"marginLeft"],[32,"paddingTop"],[64,"paddingRight"],[128,"paddingBottom"],[256,"paddingLeft"]]),le={ACCESSIBILITY:"squared.accessibility",CSS_GRID:"squared.css-grid",EXTERNAL:"squared.external",FLEXBOX:"squared.flexbox",GRID:"squared.grid",LIST:"squared.list",RELATIVE:"squared.relative",SPRITE:"squared.sprite",SUBSTITUTE:"squared.substitute",TABLE:"squared.table",VERTICAL_ALIGN:"squared.verticalalign",WHITESPACE:"squared.whitespace"},ce=Object.freeze({CSS_SPACING:se,EXT_NAME:le}),he=squared.lib.css,ue=squared.lib.dom,de=squared.lib.element,fe=squared.lib.util,ge=["position","top","right","bottom","left","display","verticalAlign","cssFloat","clear","zIndex"],ve=["marginTop","marginRight","marginBottom","marginLeft"],pe=Array.from(se.keys()),me=Array.from(se.values()),ye=function(e){function i(e,t){var n;return r(this,i),(n=u(this,c(i).call(this))).id=e,n.alignmentType=0,n.depth=-1,n.siblingIndex=1/0,n.renderPosition=-1,n.documentRoot=!1,n.visible=!0,n.excluded=!1,n.rendered=!1,n.baselineActive=!1,n.positioned=!1,n.renderExtension=new Set,n.controlId="",n._cached={},n._styleMap={},n._initial={iteration:-1,children:[],styleMap:{}},n._renderDepth=-1,n._data={},n._excludeSection=0,n._excludeProcedure=0,n._excludeResource=0,n._element=null,t?(n._element=t,n.init()):n.style={},n}return l(i,squared.lib.base.Container),o(i,[{key:"init",value:function(){var e=this._element;if(e&&(ue.setElementCache(e,"node",this),this.style=ue.getElementCache(e,"style")||he.getStyle(e,!1)),this.styleElement){for(var t=ue.getElementCache(e,"styleMap")||{},i=parseInt(this.style.fontSize)||void 0,n=Array.from(e.style),r=0;r<n.length;r++){var a=n[r];a=fe.convertCamelCase(a);var o=he.checkStyleValue(e,a,e.style[a],this.style,i);o&&(t[a]=o)}this._styleMap=Object.assign({},t)}}},{key:"saveAsInitial",value:function(){-1===this._initial.iteration&&(this._initial.children=this.duplicate(),this._initial.styleMap=Object.assign({},this._styleMap),this._initial.documentParent=this._documentParent),this._bounds&&(this._initial.bounds=ue.assignRect(this._bounds),this._initial.linear=ue.assignRect(this.linear),this._initial.box=ue.assignRect(this.box)),this._initial.iteration++}},{key:"is",value:function(){for(var e=this,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.some(function(t){return e.containerType===t})}},{key:"of",value:function(e){for(var t=this,i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return this.containerType===e&&n.some(function(e){return t.hasAlign(e)})}},{key:"unsafe",value:function(e){return this["_".concat(e)]||void 0}},{key:"attr",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r="__".concat(e);if(fe.hasValue(i)){if(void 0===this[r]&&(this._namespaces.add(e),this[r]={}),!n&&void 0!==this[r][t])return"";this[r][t]=""+i}return this[r][t]||""}},{key:"namespace",value:function(e){return this["__".concat(e)]||{}}},{key:"delete",value:function(e){var t="__".concat(e);if(this[t]){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a++){var o=n[a];if(-1!==o.indexOf("*")){var s=fe.searchObject(this[t],o),l=Array.isArray(s),c=0;for(s=l?s:s[Symbol.iterator]();;){var h;if(l){if(c>=s.length)break;h=s[c++]}else{if((c=s.next()).done)break;h=c.value}var u=g(h,1);delete this[t][u[0]]}}else delete this[t][o]}}}},{key:"apply",value:function(e){for(var i in e){var n=e[i];if("object"===t(n)){for(var r in n)this.attr(i,r,n[r]);delete e[i]}}}},{key:"render",value:function(e){this.renderParent=e,this.renderDepth=this.documentRoot||void 0===e||e.dataset.target?0:e.renderDepth+1,this.rendered=!0}},{key:"renderEach",value:function(e){for(var t=0;t<this.renderChildren.length;t++)this.renderChildren[t].visible&&e(this.renderChildren[t],t,this.renderChildren);return this}},{key:"renderFilter",value:function(e){return fe.filterArray(this.renderChildren,e)}},{key:"hide",value:function(e){this.rendered=!0,this.visible=!1}},{key:"data",value:function(e,i,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return fe.hasValue(n)?(void 0===this._data[e]&&(this._data[e]={}),"object"===t(this._data[e])&&(r||void 0===this._data[e][i])&&(this._data[e][i]=n)):null===n&&delete this._data[e],void 0===this._data[e]||void 0===this._data[e][i]?void 0:this._data[e][i]}},{key:"unsetCache",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t.length)for(var n=0;n<t.length;n++){var r=t[n];switch(r){case"position":return void(this._cached={});case"width":case"minWidth":this._cached.hasWidth=void 0;break;case"height":case"minHeight":this._cached.hasHeight=void 0;break;case"verticalAlign":this._cached.baseline=void 0;break;case"display":this._cached.inline=void 0,this._cached.inlineVertical=void 0,this._cached.inlineFlow=void 0,this._cached.block=void 0,this._cached.blockDimension=void 0,this._cached.blockStatic=void 0,this._cached.autoMargin=void 0;break;case"pageFlow":this._cached.positionAuto=void 0,this._cached.blockStatic=void 0,this._cached.baseline=void 0,this._cached.floating=void 0,this._cached.autoMargin=void 0,this._cached.rightAligned=void 0,this._cached.bottomAligned=void 0;break;default:r.startsWith("margin")&&(this._cached.autoMargin=void 0)}this._cached[r]=void 0}else this._cached={}}},{key:"ascend",value:function(){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=[],i=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.renderParent?"renderParent":"parent":"actualParent",n=this[i],r=-1;n&&0!==n.id&&!t.includes(n)&&(t.push(n),++r!==e);)n=n[i];return t}},{key:"cascade",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=f(c(i.prototype),"cascade",this).call(this);return e?fe.spliceArray(t,function(e){return null===e.element}):t}},{key:"inherit",value:function(e){for(var t=e.unsafe("initial"),i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a++){switch(n[a]){case"initial":Object.assign(this._initial,t);break;case"base":this._documentParent=e.documentParent,this._bounds=ue.assignRect(e.bounds),this._linear=ue.assignRect(e.linear),this._box=ue.assignRect(e.box);var o=e.actualParent;o&&this.css("direction",o.dir);break;case"alignment":for(var s=0;s<ge.length;s++){var l=ge[s];this._styleMap[l]=e.css(l),this._initial.styleMap[l]=t.styleMap[l]}for(var c=0;c<ve.length;c++){var h=ve[c];"auto"===e.cssInitial(h)&&(this._initial.styleMap[h]="auto"),"auto"===e.cssInitial(h,!0)&&(this._styleMap[h]="auto")}break;case"styleMap":fe.assignEmptyProperty(this._styleMap,e.unsafe("styleMap"));break;case"textStyle":var u={whiteSpace:e.css("whiteSpace")};for(var d in e.style)if(d.startsWith("font")||d.startsWith("color")){var f=fe.convertCamelCase(d);u[f]=e.style[f]}this.cssApply(u)}}}},{key:"alignedVertically",value:function(e,t,i){var n=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this.lineBreak)return!0;if(this.pageFlow&&e.length){if(fe.isArray(t)&&this!==t[0]){if(i&&i.has(this))return!0;if(r)if(this.floating&&(this.linear.top>=t[t.length-1].linear.bottom||"left"===this.float&&void 0!==t.find(function(e){return e.siblingIndex<n.siblingIndex&&fe.withinRange(n.linear.left,e.linear.left)})||"right"===this.float&&void 0!==t.find(function(e){return e.siblingIndex<n.siblingIndex&&fe.withinRange(n.linear.right,e.linear.right)})))return!0}for(var a=this.actualParent,o=Array.isArray(l=e),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}var h=c;if(h.blockStatic||this.blockStatic&&(!h.inlineFlow||!!i&&i.has(h))||!!i&&"both"===i.get(h)&&(!fe.isArray(t)||t[0]!==h)||!h.floating&&(this.blockStatic||!this.floating&&!this.inlineFlow)||a&&h.bounds.width>(a.has("width",2)?a.width:a.box.width)&&(!h.textElement||h.textElement&&"nowrap"===h.css("whiteSpace"))||h.lineBreak||h.autoMargin.leftRight||"left"===h.float&&this.autoMargin.right||"right"===h.float&&this.autoMargin.left)return!0}}return!1}},{key:"intersectX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return e.top>=t.top&&e.top<t.bottom||e.bottom>t.top&&e.bottom<=t.bottom||t.top>=e.top&&t.bottom<=e.bottom||e.top>=t.top&&e.bottom<=t.bottom}},{key:"intersectY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return e.left>=t.left&&e.left<t.right||e.right>t.left&&e.right<=t.right||t.left>=e.left&&t.right<=e.right||e.left>=t.left&&e.right<=t.right}},{key:"withinX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.top)>=Math.floor(e.top)&&Math.floor(t.bottom)<=Math.ceil(e.bottom)}},{key:"withinY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.left)>=Math.floor(e.left)&&Math.floor(t.right)<=Math.ceil(e.right)}},{key:"outsideX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.left)<Math.floor(e.left)||Math.ceil(t.left)>=Math.floor(e.right)}},{key:"outsideY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.top)<Math.floor(e.top)||Math.ceil(t.top)>=Math.floor(e.bottom)}},{key:"css",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return arguments.length>=2&&(this._styleMap[e]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t&&this.unsetCache(e)),this._styleMap[e]||this.style&&this.style[e]||""}},{key:"cssApply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object.assign(this._styleMap,e),t)for(var i in e)this.unsetCache(i);return this}},{key:"cssInitial",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];-1!==this._initial.iteration||t||(i=!0);var n=t?this._styleMap[e]:this._initial.styleMap[e];return i&&!fe.hasValue(n)&&(n=this.style[e]),n||""}},{key:"cssAscend",value:function(e){for(var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this:this.actualParent;n;){if(""!==(i=n.cssInitial(e))){if(!t||n.visible)break;i=""}if(n.documentBody)break;n=n.actualParent}return i}},{key:"cssSort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.duplicate():this.children;return i.sort(function(i,n){var r=i.toInt(e),a=n.toInt(e);return r===a?0:t?r>a?-1:1:r<a?-1:1}),i}},{key:"cssPX",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this._styleMap[e];if(r&&fe.isUnit(r)){t+=fe.calculateUnit(r,this.fontSize),i||(t=Math.max(0,t));var a=fe.formatPX(t);return this.css(e,a),n&&this.unsetCache(e),a}return""}},{key:"cssTry",value:function(e,t){if(this.styleElement){var i=this._element,n=this.css(e);if(i.style[e]=t,i.style[e]===t)return ue.setElementCache(i,e,n),!0}return!1}},{key:"cssFinally",value:function(e){if(this.styleElement){var t=this._element,i=ue.getElementCache(t,e);if(i)return t.style[e]=i,ue.deleteElementCache(t,e),!0}return!1}},{key:"toInt",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return parseInt((arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._initial.styleMap:this._styleMap)[e])||t}},{key:"calculateUnit",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(fe.isPercent(e)){var n,r=i&&this.absoluteParent||this,a=t?"width":"height";return n=r.has(a,2)?r.toInt(a):r[i?"box":"bounds"][a],(parseFloat(e)>=1?parseInt(e)/100:parseFloat(e))*n}return fe.calculateUnit(e,this.fontSize)}},{key:"convertPX",value:function(e){return"".concat(Math.round(this.calculateUnit(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2])),"px")}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=(i&&"initial"===i.map?this._initial.styleMap:this._styleMap)[e];if(fe.hasValue(n))switch(n){case"0px":if(fe.hasBit(t,64))return!0;switch(e){case"top":case"right":case"bottom":case"left":return!0}case"left":if(fe.hasBit(t,8))return!0;case"baseline":if(fe.hasBit(t,16))return!0;case"auto":if(fe.hasBit(t,4))return!0;case"none":case"initial":case"unset":case"normal":case"transparent":case"rgba(0, 0, 0, 0)":return!1;default:if(i&&i.not)if(Array.isArray(i.not))for(var r=Array.isArray(o=i.not),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}if(n===s)return!1}else if(n===i.not)return!1;return!(!fe.hasBit(t,2)||!fe.isUnit(n))||(!(!fe.hasBit(t,32)||!fe.isPercent(n))||!fe.hasBit(t,4)&&0===t)}return!1}},{key:"hasBit",value:function(e,t){return void 0!==this[e]&&fe.hasBit(this[e],t)}},{key:"hasAlign",value:function(e){return fe.hasBit(this.alignmentType,e)}},{key:"exclude",value:function(e){var t=e.section,i=void 0===t?0:t,n=e.procedure,r=void 0===n?0:n,a=e.resource,o=void 0===a?0:a;i>0&&!fe.hasBit(this._excludeSection,i)&&(this._excludeSection|=i),r>0&&!fe.hasBit(this._excludeProcedure,r)&&(this._excludeProcedure|=r),o>0&&!fe.hasBit(this._excludeResource,o)&&(this._excludeResource|=o)}},{key:"setExclusions",value:function(){var e=this;if(this.styleElement){var t=function(t,i){var n=e.actualParent,r=0,a=fe.spliceArray([fe.trimNull(e.dataset["exclude".concat(t)]),n?fe.trimNull(n.dataset["exclude".concat(t,"Child")]):""],function(e){return""===e.trim()}).join("|").split("|"),o=Array.isArray(a),l=0;for(a=o?a:a[Symbol.iterator]();;){var c;if(o){if(l>=a.length)break;c=a[l++]}else{if((l=a.next()).done)break;c=l.value}var h=c;void 0!==i[h=h.trim().toUpperCase()]&&(r|=i[h])}r>0&&e.exclude(s({},t.toLowerCase(),r))};t("Section",m),t("Procedure",b),t("Resource",y)}}},{key:"setBounds",value:function(){var e=this._element;if(e&&!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]))if(this.styleElement){if(this._bounds=ue.assignRect(e.getBoundingClientRect()),this.documentBody){if(this.marginTop>0){var t=this.firstChild;t&&t.blockStatic&&t.marginTop>=this.marginTop&&!t.lineBreak&&this.css("marginTop","0px",!0)}this._bounds.top=this.marginTop}}else if(this.plainText){var i=ue.getRangeClientRect(e);this._bounds=ue.assignRect(i)}}},{key:"appendTry",value:function(e,t){for(var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;n<this.length;n++)if(e===this.item(n))return t.siblingIndex=e.siblingIndex,this.item(n,t),t.parent=this,!0;if(i){var r=-1;return this.each(function(e){e.siblingIndex!==1/0&&(r=Math.max(e.siblingIndex,r))}),t.siblingIndex=r+1,t.parent=this,!0}return!1}},{key:"modifyBox",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0!==t){var n=se.get(e);n&&(null===t?this._boxReset[n]=1:(this._boxAdjustment[n]+=t,!i&&this._boxAdjustment[n]<0&&(this._boxAdjustment[n]=0)))}}},{key:"valueBox",value:function(e){var t=se.get(e);return t?[this._boxReset[t],this._boxAdjustment[t]]:[0,0]}},{key:"resetBox",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,r){var a=0,o=me.slice(e,r),s=Array.isArray(o),l=0;for(o=s?o:o[Symbol.iterator]();;){var c;if(s){if(l>=o.length)break;c=o[l++]}else{if((l=o.next()).done)break;c=l.value}if(i._boxReset[c]=1,t){var h=se.get(pe[a+e]);h&&t.modifyBox(pe[a+(n?0:4)],i[h])}a++}};fe.hasBit(e,30)&&r(0,4),fe.hasBit(e,480)&&r(4,8)}},{key:"inheritBox",value:function(e,t){var i=this,n=function(e,n){var r=e,a=me.slice(e,n),o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var l;if(o){if(s>=a.length)break;l=a[s++]}else{if((s=a.next()).done)break;l=s.value}var c=l;i._boxAdjustment[c]>0&&(t.modifyBox(pe[r],i._boxAdjustment[c],!1),i._boxAdjustment[c]=0),r++}};fe.hasBit(e,30)&&n(0,4),fe.hasBit(e,480)&&n(4,8)}},{key:"previousSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=null,r=[];if(this._element)n=this._element.previousSibling;else if(this._initial.children.length){var a=fe.filterArray(this._initial.children,function(e){return e.pageFlow});n=a.length&&a[0].element?a[0].element.previousSibling:null}for(;n;){var o=ue.getElementAsNode(n);if(o)if(e&&o.lineBreak||t&&o.excluded)r.push(o);else if(!o.excluded&&o.pageFlow&&(r.push(o),!i||o.visible&&!o.floating))break;n=n.previousSibling}return r}},{key:"nextSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=null,r=[];if(this._element)n=this._element.nextSibling;else if(this._initial.children.length){var a=fe.filterArray(this._initial.children,function(e){return e.pageFlow});if(a.length){var o=a[a.length-1];n=o.element&&o.element.nextSibling}}for(;n;){var s=ue.getElementAsNode(n);if(s){if(!s.naturalElement)break;if(e&&s.lineBreak||t&&s.excluded)r.push(s);else if(!s.excluded&&s.pageFlow&&(r.push(s),!i||s.visible&&!s.floating))break}n=n.nextSibling}return r}},{key:"actualRight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"linear";return(this.companion&&!this.companion.visible&&this.companion[e].right>this[e].right?this.companion:this)[e].right}},{key:"setDimensions",value:function(e){var t=this.unsafe(e);if(t){if(t.width=this.bounds.width,t.height=t.bottom-t.top,this.styleElement)switch(e){case"linear":t.width+=(this.marginLeft>0?this.marginLeft:0)+this.marginRight;break;case"box":t.width-=this.contentBoxWidth}void 0===this._initial[e]&&(this._initial[e]=ue.assignRect(t))}}},{key:"convertPosition",value:function(e){var t=0;if(!this.positionStatic){var i=this.cssInitial(e);(fe.isUnit(i)||fe.isPercent(i))&&(t=fe.convertInt(this.convertUnit(e,i,"left"===e||"right"===e)))}return t}},{key:"convertBox",value:function(e,t){var i=e+t;return fe.convertInt(this.convertUnit(i,this.css(i),"Left"===t||"Right"===t))}},{key:"convertUnit",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return fe.isPercent(t)?fe.isUnit(this.style[e])?this.style[e]:this.convertPX(t,i,n):t}},{key:"parent",set:function(e){e&&(e!==this._parent&&(this._parent&&this._parent.remove(this),this._parent=e),e.contains(this)||e.append(this),-1===this.depth&&(this.depth=e.depth+1))},get:function(){return this._parent}},{key:"tagName",set:function(e){this._cached.tagName=e.toUpperCase()},get:function(){if(void 0===this._cached.tagName){var e="";this._element&&(e="#text"===this._element.nodeName?"PLAINTEXT":"INPUT"===this._element.tagName?this._element.type:this._element.tagName),this._cached.tagName=e.toUpperCase()}return this._cached.tagName}},{key:"element",get:function(){return this._element}},{key:"elementId",get:function(){return this._element&&this._element.id||""}},{key:"htmlElement",get:function(){return void 0===this._cached.htmlElement&&(this._cached.htmlElement=this._element instanceof HTMLElement),this._cached.htmlElement}},{key:"svgElement",get:function(){return null!==this._element&&"svg"===this._element.tagName}},{key:"styleElement",get:function(){return he.hasComputedStyle(this._element)}},{key:"naturalElement",get:function(){return void 0===this._cached.naturalElement&&(this._cached.naturalElement=null!==this._element&&"__css.placeholder"!==this._element.className),this._cached.naturalElement}},{key:"imageElement",get:function(){return"IMG"===this.tagName}},{key:"flexElement",get:function(){return"flex"===this.display||"inline-flex"===this.display}},{key:"gridElement",get:function(){return"grid"===this.display}},{key:"textElement",get:function(){return this.plainText||this.inlineText}},{key:"tableElement",get:function(){return"TABLE"===this.tagName||"table"===this.display}},{key:"groupParent",get:function(){return!1}},{key:"plainText",get:function(){return"PLAINTEXT"===this.tagName}},{key:"lineBreak",get:function(){return"BR"===this.tagName}},{key:"documentBody",get:function(){return this._element===document.body}},{key:"bounds",get:function(){return this._bounds||ue.newRectDimension()}},{key:"linear",get:function(){if(void 0===this._linear&&this._bounds){if(this._element){var e=this._bounds;this._linear={top:e.top-(this.marginTop>0?this.marginTop:0),right:e.right+this.marginRight,bottom:e.bottom+this.marginBottom,left:e.left-(this.marginLeft>0?this.marginLeft:0),width:0,height:0}}else this._linear=ue.assignRect(this._bounds);this.setDimensions("linear")}return this._linear||ue.newRectDimension()}},{key:"box",get:function(){if(void 0===this._box&&this._bounds){if(this._element){var e=this._bounds;this._box={top:e.top+(this.paddingTop+this.borderTopWidth),right:e.right-(this.paddingRight+this.borderRightWidth),bottom:e.bottom-(this.paddingBottom+this.borderBottomWidth),left:e.left+(this.paddingLeft+this.borderLeftWidth),width:0,height:0}}else this._box=ue.assignRect(this._bounds);this.setDimensions("box")}return this._box||ue.newRectDimension()}},{key:"renderAs",set:function(e){this.rendered||!e||e.rendered||(this._renderAs=e)},get:function(){return this._renderAs}},{key:"renderDepth",set:function(e){this._renderDepth=e},get:function(){return-1!==this._renderDepth?this._renderDepth:0}},{key:"dataset",get:function(){return this.htmlElement?this._element.dataset:{}}},{key:"excludeSection",get:function(){return this._excludeSection}},{key:"excludeProcedure",get:function(){return this._excludeProcedure}},{key:"excludeResource",get:function(){return this._excludeResource}},{key:"extensions",get:function(){return void 0===this._cached.extensions&&(this._cached.extensions=this.dataset.use?fe.spliceArray(this.dataset.use.split(/\s*,\s*/),function(e){return""===e}):[]),this._cached.extensions}},{key:"flexbox",get:function(){if(void 0===this._cached.flexbox){var e=this.actualParent;this._cached.flexbox={order:fe.convertInt(this.css("order")),wrap:this.css("flexWrap"),direction:this.css("flexDirection"),alignSelf:!this.has("alignSelf")&&e&&e.has("alignItems")?e.css("alignItems"):this.css("alignSelf"),justifyContent:this.css("justifyContent"),basis:this.css("flexBasis"),grow:fe.convertInt(this.css("flexGrow")),shrink:fe.convertInt(this.css("flexShrink"))}}return this._cached.flexbox}},{key:"width",get:function(){if(void 0===this._cached.width){for(var e=0,t=[this._styleMap.width,this._styleMap.minWidth],i=0;i<t.length;i++){var n=t[i];if((fe.isUnit(n)||fe.isPercent(n))&&(e=this.calculateUnit(n))>0)break}this._cached.width=e}return this._cached.width}},{key:"height",get:function(){if(void 0===this._cached.height){for(var e=0,t=[this._styleMap.height,this._styleMap.minHeight],i=0;i<t.length;i++){var n=t[i];if((fe.isUnit(n)||this.hasHeight&&fe.isPercent(n))&&(e=this.calculateUnit(n,!1))>0)break}this._cached.height=e}return this._cached.height}},{key:"hasWidth",get:function(){var e=this;if(void 0===this._cached.hasWidth){var t=this.cssInitial("width",!0);this._cached.hasWidth=!e.inlineStatic&&(fe.isPercent(t)?"0%"!==t:!!(fe.isUnit(t)&&"0px"!==t||e.toInt("minWidth")>0))}return this._cached.hasWidth}},{key:"hasHeight",get:function(){var e=this;if(void 0===this._cached.hasHeight){var t=this.cssInitial("height",!0);this._cached.hasHeight=function(){if(e.inlineStatic)return!1;if(fe.isPercent(t)){var i=e.actualParent;if(i&&i.hasHeight)return"0%"!==t}else if(fe.isUnit(t)&&"0px"!==t||e.toInt("minHeight")>0)return!0;return!1}()}return this._cached.hasHeight}},{key:"lineHeight",get:function(){if(void 0===this._cached.lineHeight)if(0===this.length||this.textElement)this._cached.lineHeight=this.toInt("lineHeight");else{var e=fe.convertInt(this.cssAscend("lineHeight",!0));this._cached.lineHeight=e>this.bounds.height||this.some(function(e){return e.plainText})?e:0}return this._cached.lineHeight}},{key:"display",get:function(){return this.css("display")}},{key:"position",get:function(){return this.css("position")}},{key:"positionStatic",set:function(e){this._cached.positionStatic=e,this.unsetCache("pageFlow")},get:function(){var e=this;return void 0===this._cached.positionStatic&&(this._cached.positionStatic=function(){switch(e.position){case"fixed":case"absolute":return!1;case"sticky":case"relative":return 0===e.toInt("top")&&0===e.toInt("right")&&0===e.toInt("bottom")&&0===e.toInt("left");case"inherit":var t=e._element?he.getParentAttribute(e._element.parentElement,"position"):"";return""!==t&&!("absolute"===t||"fixed"===t);default:return!0}}()),this._cached.positionStatic}},{key:"positionRelative",get:function(){var e=this.position;return"relative"===e||"sticky"===e}},{key:"positionAuto",get:function(){if(void 0===this._cached.positionAuto){var e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap;this._cached.positionAuto=!(this.pageFlow||"auto"!==e.top&&e.top||"auto"!==e.right&&e.right||"auto"!==e.bottom&&e.bottom||"auto"!==e.left&&e.left)}return this._cached.positionAuto}},{key:"top",get:function(){return void 0===this._cached.top&&(this._cached.top=this.convertPosition("top")),this._cached.top}},{key:"right",get:function(){return void 0===this._cached.right&&(this._cached.right=this.convertPosition("right")),this._cached.right}},{key:"bottom",get:function(){return void 0===this._cached.bottom&&(this._cached.bottom=this.convertPosition("bottom")),this._cached.bottom}},{key:"left",get:function(){return void 0===this._cached.left&&(this._cached.left=this.convertPosition("left")),this._cached.left}},{key:"marginTop",get:function(){return void 0===this._cached.marginTop&&(this._cached.marginTop=this.inlineStatic&&!this.baselineActive?0:this.convertBox("margin","Top")),this._cached.marginTop}},{key:"marginRight",get:function(){return void 0===this._cached.marginRight&&(this._cached.marginRight=this.convertBox("margin","Right")),this._cached.marginRight}},{key:"marginBottom",get:function(){return void 0===this._cached.marginBottom&&(this._cached.marginBottom=this.inlineStatic&&!this.baselineActive?0:this.convertBox("margin","Bottom")),this._cached.marginBottom}},{key:"marginLeft",get:function(){return void 0===this._cached.marginLeft&&(this._cached.marginLeft=this.convertBox("margin","Left")),this._cached.marginLeft}},{key:"borderTopWidth",get:function(){return"none"!==this.css("borderTopStyle")?fe.convertInt(this.css("borderTopWidth")):0}},{key:"borderRightWidth",get:function(){return"none"!==this.css("borderRightStyle")?fe.convertInt(this.css("borderRightWidth")):0}},{key:"borderBottomWidth",get:function(){return"none"!==this.css("borderBottomStyle")?fe.convertInt(this.css("borderBottomWidth")):0}},{key:"borderLeftWidth",get:function(){return"none"!==this.css("borderLeftStyle")?fe.convertInt(this.css("borderLeftWidth")):0}},{key:"paddingTop",get:function(){return void 0===this._cached.paddingTop&&(this._cached.paddingTop=this.convertBox("padding","Top")),this._cached.paddingTop}},{key:"paddingRight",get:function(){return void 0===this._cached.paddingRight&&(this._cached.paddingRight=this.convertBox("padding","Right")),this._cached.paddingRight}},{key:"paddingBottom",get:function(){return void 0===this._cached.paddingBottom&&(this._cached.paddingBottom=this.convertBox("padding","Bottom")),this._cached.paddingBottom}},{key:"paddingLeft",get:function(){return void 0===this._cached.paddingLeft&&(this._cached.paddingLeft=this.convertBox("padding","Left")),this._cached.paddingLeft}},{key:"contentBoxWidth",get:function(){return this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth}},{key:"contentBoxHeight",get:function(){return this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth}},{key:"inline",get:function(){if(void 0===this._cached.inline){var e=this.display;this._cached.inline="inline"===e||("initial"===e||"unset"===e)&&de.ELEMENT_INLINE.includes(this.tagName)}return this._cached.inline}},{key:"inlineStatic",get:function(){return void 0===this._cached.inlineStatic&&(this._cached.inlineStatic=this.inline&&!this.floating&&!this.imageElement),this._cached.inlineStatic}},{key:"inlineVertical",get:function(){if(void 0===this._cached.inlineVertical){var e=this.display;this._cached.inlineVertical=(e.startsWith("inline")||"table-cell"===e)&&!this.floating&&!this.plainText}return this._cached.inlineVertical}},{key:"inlineText",set:function(e){this._cached.inlineText=e},get:function(){if(void 0===this._cached.inlineText){var e=this._element,t=!1;if(e&&this.htmlElement&&!this.svgElement)switch(e.tagName){case"INPUT":case"BUTTON":case"IMG":case"SELECT":case"TEXTAREA":break;default:if(de.hasFreeFormText(e)){t=!0;for(var i=0;i<e.children.length;i++){var n=ue.getElementAsNode(e.children[i]);if(void 0!==n&&!n.excluded&&!n.dataset.target){t=!1;break}}}}this._cached.inlineText=t}return this._cached.inlineText}},{key:"block",get:function(){if(void 0===this._cached.block){var e=this.display;this._cached.block="block"===e||"list-item"===e||"initial"===e&&de.ELEMENT_BLOCK.includes(this.tagName)}return this._cached.block}},{key:"blockStatic",get:function(){return void 0===this._cached.blockStatic&&(this._cached.blockStatic=this.block&&this.pageFlow&&(!this.floating||"100%"===this.cssInitial("width"))),this._cached.blockStatic}},{key:"blockDimension",get:function(){if(void 0===this._cached.blockDimension){var e=this.display;this._cached.blockDimension=this.block||"inline-block"===e||"table-cell"===e}return this._cached.blockDimension}},{key:"pageFlow",get:function(){return void 0===this._cached.pageFlow&&(this._cached.pageFlow=this.positionStatic||this.positionRelative),this._cached.pageFlow}},{key:"inlineFlow",get:function(){if(void 0===this._cached.inlineFlow){var e=this.display;this._cached.inlineFlow=this.inline||e.startsWith("inline")||"table-cell"===e||this.imageElement||this.floating}return this._cached.inlineFlow}},{key:"rightAligned",get:function(){return void 0===this._cached.rightAligned&&(this._cached.rightAligned="right"===this.float||this.autoMargin.left||this.inlineVertical&&"right"===this.cssAscend("textAlign",!0)||!this.pageFlow&&this.has("right")),this._cached.rightAligned||this.hasAlign(512)}},{key:"bottomAligned",get:function(){return void 0===this._cached.bottomAligned&&(this._cached.bottomAligned=!this.pageFlow&&this.has("bottom")&&this.bottom>=0),this._cached.bottomAligned}},{key:"autoMargin",get:function(){if(void 0===this._cached.autoMargin)if(!this.pageFlow||this.blockStatic||"table"===this.display){var e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap,t="auto"===e.marginLeft&&(this.pageFlow||this.has("right")),i="auto"===e.marginRight&&(this.pageFlow||this.has("left")),n="auto"===e.marginTop&&(this.pageFlow||this.has("bottom")),r="auto"===e.marginBottom&&(this.pageFlow||this.has("top"));this._cached.autoMargin={horizontal:t||i,left:t&&!i,right:!t&&i,leftRight:t&&i,vertical:n||r,top:n&&!r,bottom:!n&&r,topBottom:n&&r}}else this._cached.autoMargin={horizontal:!1,left:!1,right:!1,leftRight:!1,top:!1,bottom:!1,vertical:!1,topBottom:!1};return this._cached.autoMargin}},{key:"floating",get:function(){if(void 0===this._cached.floating)if(this.pageFlow){var e=this.css("cssFloat");this._cached.floating="left"===e||"right"===e}else this._cached.floating=!1;return this._cached.floating}},{key:"float",get:function(){return void 0===this._cached.float&&(this._cached.float=this.floating?this.css("cssFloat"):"none"),this._cached.float}},{key:"zIndex",get:function(){return this.toInt("zIndex")}},{key:"textContent",get:function(){if(void 0===this._cached.textContent){var e=this._element,t="";e&&(this.htmlElement?t=e.textContent||e.innerText:this.plainText&&(t=e.textContent||"")),this._cached.textContent=t}return this._cached.textContent}},{key:"overflow",set:function(e){0!==e&&16!==e&&8!==e&&24!==e||(this._cached.overflow=e)},get:function(){if(void 0===this._cached.overflow){var e=this._element,t=this.css("overflow"),i=this.css("overflowX"),n=this.css("overflowY"),r=0;this.hasWidth&&("scroll"===t||"scroll"===i||"auto"===i&&e&&e.clientWidth!==e.scrollWidth)&&(r|=8),this.hasHeight&&("scroll"===t||"scroll"===n||"auto"===n&&e&&e.clientHeight!==e.scrollHeight)&&(r|=16),this._cached.overflow=r}return this._cached.overflow}},{key:"overflowX",get:function(){return fe.hasBit(this.overflow,8)}},{key:"overflowY",get:function(){return fe.hasBit(this.overflow,16)}},{key:"baseline",get:function(){if(void 0===this._cached.baseline){var e=this.verticalAlign,t=this.cssInitial("verticalAlign");this._cached.baseline=this.pageFlow&&!this.floating&&!this.svgElement&&("baseline"===e||"initial"===e||fe.isUnit(t)&&0===parseInt(t))}return this._cached.baseline}},{key:"verticalAlign",get:function(){return this.css("verticalAlign")}},{key:"multiline",set:function(e){this._cached.multiline=e},get:function(){return void 0===this._cached.multiline&&(this._cached.multiline=this.plainText||this.inlineText&&(this.inlineFlow||0===this.length)?ue.getRangeClientRect(this._element).multiline:0),this._cached.multiline}},{key:"visibleStyle",get:function(){if(void 0===this._cached.visibleStyle){var e=this.borderTopWidth>0||this.borderRightWidth>0||this.borderBottomWidth>0||this.borderLeftWidth>0,t=fe.REGEXP_COMPILED.URL.test(this.css("backgroundImage"))||fe.REGEXP_COMPILED.URL.test(this.css("background")),i=this.has("backgroundColor"),n=this.css("backgroundRepeat"),r=this.paddingLeft+this.paddingRight>0,a=this.paddingTop+this.paddingBottom>0;this._cached.visibleStyle={padding:r||a,paddingHorizontal:r,paddingVertical:a,background:e||t||i,borderWidth:e,backgroundImage:t,backgroundColor:i,backgroundRepeat:"no-repeat"!==n,backgroundRepeatX:"repeat"===n||"repeat-x"===n||n.startsWith("repeat "),backgroundRepeatY:"repeat"===n||"repeat-y"===n||n.endsWith(" repeat")}}return this._cached.visibleStyle}},{key:"preserveWhiteSpace",get:function(){if(void 0===this._cached.preserveWhiteSpace){var e=this.css("whiteSpace");this._cached.preserveWhiteSpace="pre"===e||"pre-wrap"===e}return this._cached.preserveWhiteSpace}},{key:"layoutHorizontal",get:function(){return this.hasAlign(8)}},{key:"layoutVertical",get:function(){return this.hasAlign(16)}},{key:"controlName",set:function(e){this.rendered&&void 0!==this._controlName||(this._controlName=e)},get:function(){return this._controlName||""}},{key:"documentParent",set:function(e){this._documentParent=e},get:function(){return this._documentParent||this.actualParent||this.parent||this}},{key:"absoluteParent",get:function(){var e=this.actualParent;if(!this.pageFlow)for(;e&&0!==e.id;){var t=e.cssInitial("position",!1,!0);if(e.documentBody||"static"!==t&&"initial"!==t&&"unset"!==t)return e;e=e.actualParent}return e}},{key:"renderParent",set:function(e){e&&(e!==this&&-1===e.renderChildren.indexOf(this)&&e.renderChildren.push(this),this._renderParent=e)},get:function(){return this._renderParent}},{key:"renderPositionId",set:function(e){this._renderPositionId=e},get:function(){return this._renderPositionId||this.id+(-1!==this.renderPosition?"^".concat(this.renderPosition):"")}},{key:"actualParent",get:function(){return this._element&&this._element.parentElement?ue.getElementAsNode(this._element.parentElement):void 0}},{key:"actualChildren",get:function(){if(void 0===this._cached.actualChildren)if(this.htmlElement){var e=[];this._element.childNodes.forEach(function(t){var i=ue.getElementAsNode(t);i&&e.push(i)}),this._cached.actualChildren=e}else this._cached.actualChildren=this.groupParent?this._initial.children.slice(0):[];return this._cached.actualChildren}},{key:"actualHeight",get:function(){return this.plainText?this.bounds.bottom-this.bounds.top:this.bounds.height}},{key:"firstChild",get:function(){if(this.htmlElement)for(var e=this._element,t=0;t<e.childNodes.length;t++){var i=ue.getElementAsNode(e.childNodes[t]);if(i)return i}}},{key:"lastChild",get:function(){if(this.htmlElement)for(var e=this._element,t=e.childNodes.length-1;t>=0;t--){var i=ue.getElementAsNode(e.childNodes[t]);if(i&&i.naturalElement)return i}}},{key:"dir",get:function(){if(void 0===this._cached.dir)switch(this._cached.dir=this.css("direction"),this._cached.dir){case"unset":case"inherit":for(var e=this.actualParent;e&&0!==e.id;){var t=e.dir;if(""!==t){this._cached.dir=t;break}e=e.actualParent}this._cached.dir=document.body.dir}return this._cached.dir}},{key:"nodes",get:function(){return this.rendered?this.renderChildren:this.children}},{key:"center",get:function(){return{x:this.bounds.left+Math.floor(this.bounds.width/2),y:this.bounds.top+Math.floor(this.actualHeight/2)}}}]),i}(),be=squared.lib.dom,ke=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ye),o(t,[{key:"init",value:function(){if(this.length){for(var e=1/0,t=Array.isArray(n=this.children),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;e=Math.min(e,a.siblingIndex),a.parent=this}this.siblingIndex===1/0&&(this.siblingIndex=e),this.parent&&this.parent.sort(A.siblingIndex),this.setBounds();var o=this.actualParent;o&&this.css("direction",o.dir),this.saveAsInitial()}}},{key:"setBounds",value:function(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.length){var e=this.outerRegion;this._bounds=Object.assign({},e,{width:e.right-e.left,height:e.bottom-e.top})}}},{key:"previousSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.item(0);return n?n.previousSiblings(e,t,i):[]}},{key:"nextSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.item();return n?n.nextSiblings(e,t,i):[]}},{key:"actualParent",get:function(){return A.actualParent(this._initial.children)}},{key:"firstChild",get:function(){var e=this.actualParent;if(e){var t=e.element;if(t)for(var i=0;i<t.childNodes.length;i++){var n=be.getElementAsNode(t.childNodes[i]);if(n&&this.nodes.includes(n))return n}}if(this._initial.children.length)return this._initial.children[0]}},{key:"lastChild",get:function(){var e=this.actualParent;if(e&&e.element){var t=e.element;if(t)for(var i=t.childNodes.length-1;i>=0;i--){var n=be.getElementAsNode(t.childNodes[i]);if(n&&this.nodes.includes(n))return n}}if(this._initial.children.length)return this._initial.children[this._initial.children.length-1]}},{key:"inline",get:function(){return this.every(function(e){return e.inline})}},{key:"pageFlow",get:function(){return this.every(function(e){return e.pageFlow})}},{key:"inlineFlow",get:function(){return this.inlineStatic||this.hasAlign(128)}},{key:"inlineStatic",get:function(){return this.every(function(e){return e.inlineStatic})}},{key:"inlineVertical",get:function(){return this.every(function(e){return e.inlineVertical})}},{key:"block",get:function(){return this.some(function(e){return e.block})}},{key:"blockStatic",get:function(){return this.some(function(e){return e.blockStatic})}},{key:"blockDimension",get:function(){return this.some(function(e){return e.blockDimension})}},{key:"floating",get:function(){return this.every(function(e){return e.floating})}},{key:"float",get:function(){return this.floating?this.hasAlign(512)?"right":"left":"none"}},{key:"baseline",get:function(){var e=this.cssInitial("verticalAlign",!0);return""!==e?"baseline"===e:this.every(function(e){return e.baseline})}},{key:"multiline",get:function(){return this.children.reduce(function(e,t){return e+t.multiline},0)}},{key:"display",get:function(){return this.css("display")||this.some(function(e){return e.block})?"block":this.some(function(e){return e.blockDimension})?"inline-block":"inline"}},{key:"groupParent",get:function(){return!0}},{key:"outerRegion",get:function(){var e=this.children.slice(0),t=e[0],i=t,n=t,r=t;this.each(function(t){return t.companion&&!t.companion.visible&&e.push(t.companion)});for(var a=1;a<e.length;a++){var o=e[a];o.linear.top<t.linear.top&&(t=o),o.linear.right>i.linear.right&&(i=o),o.linear.bottom>n.linear.bottom&&(n=o),o.linear.left<r.linear.left&&(r=o)}return{top:t.linear.top,right:i.linear.right,bottom:n.linear.bottom,left:r.linear.left}}}]),t}(),xe=squared.lib.dom,Ae=squared.lib.util,Se=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"afterInit",value:function(){for(var e=this,t=function(){if(i){if(n>=r.length)return"break";a=r[n++]}else{if((n=r.next()).done)return"break";a=n.value}var t=a,o=t.element;if(o&&"INPUT"===o.tagName&&!t.hasBit("excludeProcedure",b.ACCESSIBILITY))switch(o.type){case"radio":case"checkbox":[xe.getPreviousElementSibling(o),xe.getNextElementSibling(o)].some(function(i){if(i){var n=xe.getElementAsNode(i),r=i.parentElement&&"LABEL"===i.parentElement.tagName?xe.getElementAsNode(i.parentElement):void 0;if(n&&n.visible&&n.pageFlow&&(Ae.hasValue(i.htmlFor)&&i.htmlFor===o.id?t.companion=n:n.textElement&&r&&(t.companion=n,r.renderAs=t),t.companion))return e.options.showLabel||n.hide(),!0}return!1})}},i=Array.isArray(r=this.application.processing.cache),n=0,r=i?r:r[Symbol.iterator]();;){var a;if("break"===t())break}}}]),t}(),_e=squared.lib.util,we="[\\d.]+[a-z%]+|auto|max-content|min-content",Ee="minmax\\(([^,]+), ([^)]+)\\)",Te={UNIT:RegExp("^(".concat(we,")$")),NAMED:"\\s*(repeat\\((auto-fit|auto-fill|[0-9]+), (.+)\\)|\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|".concat(we,")\\s*"),REPEAT:"\\s*(\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|".concat(we,")\\s*")};function Ie(e,t){for(var i=[],n=[],r=0;r<t.length;r++)e.repeat[r]?n.push(t[r]):i.push(t[r]);for(var a=e.count-i.length,o=[],s=0;s<e.count;s++){if(e.repeat[s]){for(var l=0,c=0;l<a;s++,l++,c++)c===n.length&&(c=0),o[s]=n[c];break}i.length&&(o[s]=i.shift())}return o}function Re(e,t){return _e.isUnit(t)?e.convertPX(t):t}function Be(e){for(var t=0,i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}a&&t++}return t}var Ce=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"condition",value:function(e){return e.gridElement&&e.length>0}},{key:"processNode",value:function(e){var i=Object.assign({},t.createDataAttribute(),{alignItems:e.css("alignItems"),alignContent:e.css("alignContent"),justifyItems:e.css("justifyItems"),justifyContent:e.css("justifyContent")}),n=e.css("gridAutoFlow"),r=-1!==n.indexOf("row"),a=-1!==n.indexOf("dense"),o=[],s=[],l=[],c={};if(i.row.gap=e.calculateUnit(e.css("rowGap"),!1,!1),i.column.gap=e.calculateUnit(e.css("columnGap"),!0,!1),[e.cssInitial("gridTemplateRows",!0),e.cssInitial("gridTemplateColumns",!0),e.css("gridAutoRows"),e.css("gridAutoColumns")].forEach(function(t,n){if(t&&"none"!==t&&"auto"!==t)for(var r,a=RegExp(Te.NAMED,"g"),o=1;null!==(r=a.exec(t));)if(n<2){var s=i[0===n?"row":"column"];if(r[1].startsWith("repeat")){var l=1;switch(r[2]){case"auto-fit":s.autoFit=!0;break;case"auto-fill":s.autoFill=!0;break;default:l=_e.convertInt(r[3])}if(l>0){for(var c=[],h=RegExp(Te.REPEAT,"g"),u=void 0;null!==(u=h.exec(r[3]));){var d=void 0;null!==(d=/\[([\w\-\s]+)\]/.exec(u[1]))?(void 0===s.name[d[1]]&&(s.name[d[1]]=[]),c.push({name:d[1]})):null!==(d=RegExp(Ee).exec(u[1]))?c.push({unit:Re(e,d[2]),unitMin:Re(e,d[1])}):null!==(d=/fit-content\(([\d.]+[a-z%]+)\)/.exec(u[1]))?c.push({unit:Re(e,d[1]),unitMin:"0px"}):null!==(d=RegExp(we).exec(u[1]))&&c.push({unit:Re(e,d[0])})}if(c.length)for(var f=0;f<l;f++)for(var g=0;g<c.length;g++){var v=c[g];v.name?s.name[v.name].push(o):v.unit&&(s.unit.push(v.unit),s.unitMin.push(v.unitMin||""),s.repeat.push(!0),o++)}}}else"["===r[1].charAt(0)?(void 0===s.name[r[4]]&&(s.name[r[4]]=[]),s.name[r[4]].push(o)):r[1].startsWith("minmax")?(s.unit.push(Re(e,r[6])),s.unitMin.push(Re(e,r[5])),s.repeat.push(!1),o++):r[1].startsWith("fit-content")?(s.unit.push(Re(e,r[7])),s.unitMin.push("0px"),s.repeat.push(!1),o++):Te.UNIT.test(r[1])&&(s.unit.push(Re(e,r[1])),s.unitMin.push(""),s.repeat.push(!1),o++)}else i[2===n?"row":"column"].auto.push(e.convertPX(r[1]))}),e.cssSort("order"),!e.has("gridTemplateAreas")&&e.every(function(e){return"auto"===e.css("gridRowStart")&&"auto"===e.css("gridColumnStart")})){var h,u=r?["top","bottom"]:["left","right"],d=0,f=0,g=0;e.each(function(e,t){(void 0===h||e.linear[u[0]]>=h.linear[u[1]]||f>0&&f===g)&&(g=Math.max(f,g),d++,f=1);var n=e.css("gridRowEnd"),a=e.css("gridColumnEnd"),o=1,s=1;if(n.startsWith("span")?o=parseInt(n.split(" ")[1]):_e.isNumber(n)&&(o=parseInt(n)-d),a.startsWith("span")?s=parseInt(a.split(" ")[1]):_e.isNumber(a)&&(s=parseInt(a)-f),1===f&&g>0){var c=r?[2,1,3]:[3,0,2],v=!1;do{for(var p=Array(g-1).fill(1),m=0;m<l.length;m++){var y=l[m].placement;if(y[c[0]]>d)for(var b=y[c[1]];b<y[c[2]];b++)p[b-1]=0}for(var k=0,x=0,A=0;k<p.length;k++)if(p[k]){if(0===x&&(A=k),++x===s){f=A+1,v=!0;break}}else x=0;v||(i.emptyRows[d-1]=p,d++)}while(!v)}l[t]={placement:r?[d,f,d+o,f+s]:[f,d,f+s,d+o],rowSpan:o,columnSpan:s},f+=s,h=e})}else e.css("gridTemplateAreas").split(/"[\s\n]+"/).forEach(function(e,t){_e.trimString(e.trim(),'"').split(" ").forEach(function(e,n){"."!==e&&(void 0===i.templateAreas[e]?i.templateAreas[e]={rowStart:t,rowSpan:1,columnStart:n,columnSpan:1}:(i.templateAreas[e].rowSpan=t-i.templateAreas[e].rowStart+1,i.templateAreas[e].columnSpan++))})}),e.each(function(e,t){for(var n=[e.css("gridRowStart"),e.css("gridColumnStart"),e.css("gridRowEnd"),e.css("gridColumnEnd")],r=[],a=1,o=1,s=0;s<n.length;s++){var c=n[s],h=i.templateAreas[c];if(h)switch(s){case 0:r[s]=h.rowStart+1;break;case 1:r[s]=h.columnStart+1;break;case 2:r[s]=h.rowStart+h.rowSpan+1;break;case 3:r[s]=h.columnStart+h.columnSpan+1}else{var u=/^([\w\-]+)-(start|end)$/.exec(c);if(u&&(h=i.templateAreas[u[1]]))if("start"===u[2])switch(s){case 0:case 2:r[s]=h.rowStart+1;break;case 1:case 3:r[s]=h.columnStart+1}else switch(s){case 0:case 2:r[s]=h.rowStart+h.rowSpan+1;break;case 1:case 3:r[s]=h.columnStart+h.columnSpan+1}}}if(!(r[0]&&r[1]&&r[2]&&r[3]))for(var d=function(e,t){if(_e.isNumber(e))return r[t]=parseInt(e),!0;if(e.startsWith("span")){var i=parseInt(e.split(" ")[1]);return r[t-2]?r[t]=r[t-2]+i:t%2==0?a=i:o=i,!0}return!1},f=0;f<n.length;f++){var g=n[f];if("auto"!==g&&!r[f]&&!d(g,f)){var v=i[f%2==0?"row":"column"],p=g.split(" ");1===p.length&&(p[1]=p[0],p[0]="1");var m=parseInt(p[0]);if(v.name[p[1]]){var y=v.name[p[1]].length;m<=y?r[f]=v.name[p[1]][m-1]+(p[1]===n[f-2]?1:0):v.autoFill&&m>y&&(r[f]=m+(p[1]===n[f-2]?1:0))}}r[f]||d(g,f)}l[t]={placement:r,rowSpan:a,columnSpan:o}});var v=i[r?"column":"row"];v.count=Math.max(v.unit.length,1);for(var p=0;p<l.length;p++){var m=l[p];m&&(v.count=Math.max(v.count,r?m.columnSpan:m.rowSpan,m.placement[r?1:0]||0,(m.placement[r?3:2]||0)-1))}if((v.autoFill||v.autoFit)&&(0===v.unit.length&&(v.unit.push("auto"),v.unitMin.push(""),v.repeat.push(!0)),v.unit=Ie(v,v.unit),v.unitMin=Ie(v,v.unitMin)),e.each(function(e,t){for(var n=l[t],h=n.placement,u=r?n.rowSpan:n.columnSpan,d=r?n.columnSpan:n.rowSpan,f=r?i.column.count:i.row.count,g=r?0:1,v=r?1:0,p=r?2:3,m=r?3:2;!h[0]||!h[1];){var y=h.slice(0);if(!y[g])for(var b=o.length,k=0,x=0,A=-1;k<b;k++)if(!c[k])if(void 0===s[k]||s[k]<f){if(0===x&&(A=k,b=Math.max(b,k+u)),++x===u){y[g]=A+1;break}}else x=0,A=-1,b=o.length;if(y[g]){if(!y[v]){y[p]||(y[p]=y[g]+u);for(var S=[],_=y[g]-1;_<y[p]-1;_++)if(void 0===o[_])S.push([[0,-1]]);else{if(!(Be(o[_])+d<=f))break;for(var w=[],E=0,T=0,I=-1;T<f;T++)void 0===o[_][T]&&(-1===I&&(I=T),E++),(o[_][T]||T===f-1)&&(E>=d&&w.push([I,I+E]),I=-1,E=0);if(!w.length)break;S.push(w)}if(d===S.length)if(S.length>1)e:for(var R=Array.isArray(C=S[0]),B=0,C=R?C:C[Symbol.iterator]();;){var N;if(R){if(B>=C.length)break;N=C[B++]}else{if((B=C.next()).done)break;N=B.value}for(var P=N,M=P[0];M<P[1];M++)for(var L=1;L<S.length;L++)for(var D=0;D<S[L].length;D++){var O=S[L][D];if(M>=O[0]&&(-1===O[1]||M+d<=O[1])){y[v]=M+1;break e}}}else y[v]=S[0][0][0]+1}}else h[g]=o.length+1,h[v]||(h[v]=1);y[g]&&y[v]?(h[g]=y[g],h[v]=y[v]):y[g]&&(c[y[g]-1]=!0)}h[p]||(h[p]=h[g]+u),h[m]||(h[m]=h[v]+d),function(e,t){if(t.every(function(e){return e>0})){for(var i=t[r?0:1]-1;i<t[r?2:3]-1;i++){void 0===o[i]&&(o[i]=[]);for(var n=t[r?1:0]-1;n<t[r?3:2]-1;n++)void 0===s[i]&&(s[i]=0),void 0===o[i][n]&&(o[i][n]=[],s[i]++),o[i][n].push(e)}return!0}return!1}(e,h)&&(e.data(le.CSS_GRID,"cellData",{rowStart:h[0]-1,rowSpan:h[2]-h[0],columnStart:h[1]-1,columnSpan:h[3]-h[1]}),a&&(c={}))}),r)i.rowData=o;else for(var y=0;y<o.length;y++)for(var b=0;b<o[y].length;b++)void 0===i.rowData[b]&&(i.rowData[b]=[]),i.rowData[b][y]=o[y][b];if(i.rowData.length){for(var k=Array.isArray(A=i.rowData),x=0,A=k?A:A[Symbol.iterator]();;){var S;if(k){if(x>=A.length)break;S=A[x++]}else{if((x=A.next()).done)break;S=x.value}var _=S;i.column.count=Math.max(_.length,i.column.count);for(var w=Array.isArray(T=_),E=0,T=w?T:T[Symbol.iterator]();;){var I;if(w){if(E>=T.length)break;I=T[E++]}else{if((E=T.next()).done)break;I=E.value}if(I)for(var R=Array.isArray(C=I),B=0,C=R?C:C[Symbol.iterator]();;){var N;if(R){if(B>=C.length)break;N=C[B++]}else{if((B=C.next()).done)break;N=B.value}i.children.add(N)}}}if(i.children.size===e.length){i.row.count=i.rowData.length;for(var P=new Set,M=0;M<i.row.count;M++)for(var L=0;L<i.column.count;L++){var D=i.rowData[M][L];if(D)for(var O=Array.isArray(W=D),H=0,W=O?W:W[Symbol.iterator]();;){var z;if(O){if(H>=W.length)break;z=W[H++]}else{if((H=W.next()).done)break;z=H.value}var F=z;if(F&&!P.has(F)){var U=F.data(le.CSS_GRID,"cellData"),V=M+(U?U.rowSpan-1:0);L+(U?U.columnSpan-1:0)<i.column.count-1&&F.modifyBox(4,i.column.gap),V<i.row.count-1&&F.modifyBox(8,i.row.gap),P.add(F)}}}e.retain(Array.from(i.children)),e.cssSort("zIndex"),e.data(le.CSS_GRID,"mainData",i)}}return{output:""}}}],[{key:"createDataAttribute",value:function(){return{children:new Set,rowData:[],templateAreas:{},row:t.createDataRowAttribute(),column:t.createDataRowAttribute(),emptyRows:[],alignItems:"",alignContent:"",justifyItems:"",justifyContent:""}}},{key:"createDataRowAttribute",value:function(){return{count:0,gap:0,unit:[],unitMin:[],repeat:[],auto:[],autoFill:!1,autoFit:!1,name:{},normal:!0}}}]),t}(),Ne=squared.lib.util,Pe=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"condition",value:function(e){return e.flexElement&&e.length>0}},{key:"processNode",value:function(e){var i=this.application.controllerHandler,n=e.filter(function(e){return e.pageFlow}),r=t.createDataAttribute(e,n);if(e.cssTry("display","block")){for(var a=Array.isArray(s=n),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}var c=l;if(c.element){var h=c.element.getBoundingClientRect(),u=c.unsafe("initial");Object.assign(u.bounds,{width:h.width,height:h.height})}}e.cssFinally("display")}if(r.wrap){var d=function(t,a,o){var s=new Map;n.sort(function(e,i){return Ne.withinRange(e.linear[t],i.linear[t])?e.linear[a]>=i.linear[a]?1:-1:e.linear[t]<i.linear[t]?-1:1});for(var l=Array.isArray(h=n),c=0,h=l?h:h[Symbol.iterator]();;){var u;if(l){if(c>=h.length)break;u=h[c++]}else{if((c=h.next()).done)break;u=c.value}var d=u,f=Math.round(d.linear[t]),g=s.get(f)||[];g.push(d),s.set(f,g)}var v=0,p=0,m=s.values(),y=Array.isArray(m),b=0;for(m=y?m:m[Symbol.iterator]();;){var k;if(y){if(b>=m.length)break;k=m[b++]}else{if((b=m.next()).done)break;k=b.value}var x=k,S=i.createNodeGroup(x[0],x,e);S.siblingIndex=p++;var _=S.unsafe("box");_&&(_[o]=e.box[o]),S.alignmentType|=128,v=Math.max(x.length,v)}e.sort(A.siblingIndex),r.rowDirection?(r.rowCount=s.size,r.columnCount=v):(r.rowCount=v,r.columnCount=s.size)};r.rowDirection?d(r.wrapReverse?"bottom":"top","left","right"):d("left","top","bottom")}else n.some(function(e){return 0!==e.flexbox.order})&&e.sort(r.directionReverse?function(e,t){return e.flexbox.order<=t.flexbox.order?1:-1}:function(e,t){return e.flexbox.order>=t.flexbox.order?1:-1}),r.rowDirection?(r.rowCount=1,r.columnCount=e.length):(r.rowCount=e.length,r.columnCount=1);return e.data(le.FLEXBOX,"mainData",r),{output:""}}}],[{key:"createDataAttribute",value:function(e,t){var i=e.flexbox;return{wrap:i.wrap.startsWith("wrap"),wrapReverse:"wrap-reverse"===i.wrap,directionReverse:i.direction.endsWith("reverse"),justifyContent:i.justifyContent,rowDirection:i.direction.startsWith("row"),rowCount:0,columnDirection:i.direction.startsWith("column"),columnCount:0,children:t}}}]),t}(),Me=squared.lib.css,Le=squared.lib.dom,De=squared.lib.dom,Oe=squared.lib.util;function He(e,t){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a.findIndex(function(e){return Oe.withinRange(t.linear.top,e.linear.top)||t.linear.top>e.linear.top&&t.linear.top<e.linear.bottom});if(-1!==o)return o}return-1}var We=squared.lib.util;function ze(e){return e.visibleStyle.backgroundImage&&!e.visibleStyle.backgroundRepeat}var Fe=squared.lib.util,Ue=squared.lib.css,Ve=squared.lib.util,qe=squared.lib.css,Xe=squared.lib.css,je=squared.lib.math,Ge=squared.lib.util,Ye=squared.lib.util,Qe=squared.lib.dom,Ze=squared.lib.util;function $e(e,t){var i=e.has("minHeight",2)?e.toInt("minHeight"):0;e.css("minHeight",Ze.formatPX(Math.max(t,i)))}function Ke(e,t,i){!t.lineBreak&&!t.plainText&&t===e[i?"firstChild":"lastChild"]&&e[i?"marginTop":"marginBottom"]>0&&0===e[i?"borderTopWidth":"borderBottomWidth"]&&0===e[i?"paddingTop":"paddingBottom"]&&t.modifyBox(i?2:8,null)}var Je={Accessibility:Se,CssGrid:Ce,External:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"beforeInit",value:function(e){if((arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.included(e))&&!Le.getElementCache(e,"squaredExternalDisplay")){for(var t=[],i=e;i;)t.push(Me.getStyle(i).display),i.style.display="block",i=i.parentElement;Le.setElementCache(e,"squaredExternalDisplay",t)}}},{key:"init",value:function(e){return this.included(e)&&this.application.parseElements.add(e),!1}},{key:"afterInit",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.included(e)){var t=Le.getElementCache(e,"squaredExternalDisplay");if(t){for(var i=t,n=e,r=0;n;)n.style.display=i[r],n=n.parentElement,r++;Le.deleteElementCache(e,"squaredExternalDisplay")}}}}]),t}(),Flexbox:Pe,Grid:function(e){function t(){var e;return r(this,t),(e=u(this,c(t).apply(this,arguments))).options={columnBalanceEqual:!1},e}return l(t,ie),o(t,[{key:"condition",value:function(e){return e.length>1&&!e.flexElement&&!e.gridElement&&!e.has("listStyle")&&(e.every(function(e){return e.pageFlow&&!e.visibleStyle.background&&(!e.inlineFlow||e.blockStatic)})&&(e.some(function(e){return e.length>1})&&e.every(function(e){return e.length>0&&A.linearX(e.children)})||e.every(function(e){return"list-item"===e.display&&!e.has("listStyleType")}))||"table"===e.display&&e.every(function(e){return"table-row"===e.display&&e.every(function(e){return"table-cell"===e.display})}))}},{key:"processNode",value:function(e){var i=[],n=this.options.columnBalanceEqual,r=[];if(n){var a=[];e.each(function(e,t){a[t]=[],e.each(function(e){return a[t].push(e.bounds.width)}),r.push(e.duplicate())});var o=r[a.findIndex(function(e){return e===a.reduce(function(e,t){return e.length===t.length?e.reduce(function(e,t){return e+t},0)<t.reduce(function(e,t){return e+t},0)?e:t:e.length<t.length?e:t})})];if(o&&o.length>1)for(var s=[],l=!1,c=function(e){var t=o[e].bounds,i=[];if(e<o.length-1)for(var n=function(n){if(r[n]===o)i.push(e);else{var a=r[n].findIndex(function(i,a){return a>=e&&Math.floor(i.bounds.width)===Math.floor(t.width)&&a<r[n].length-1});if(-1===a)return i.length=0,"break";i.push(a)}},a=0;a<r.length;a++){if("break"===n(a))break}else for(a=0;a<r.length;a++)if(r[a].length>o.length){var c=r[a].splice(s[a]+(l?2:1),r[a].length-o.length);r[a][s[a]+(l?1:0)].data(le.GRID,"cellData",{siblings:c})}if(i.length===r.length){var h=i.reduce(function(e,t){return Math.min(e,t)});if(i.reduce(function(e,t){return Math.max(e,t)})>h)for(var u=0;u<r.length;u++)if(i[u]>h){var d=r[u].splice(h,i[u]-h);r[u][s[u]+(l?1:0)].data(le.GRID,"cellData",{siblings:d})}s=i,l=!0}else s=Array(r.length).fill(e),l=!1},h=0;h<o.length;h++)c(h);else r.length=0}else{for(var u={},d=Array.isArray(g=e),f=0,g=d?g:g[Symbol.iterator]();;){var v;if(d){if(f>=g.length)break;v=g[f++]}else{if((f=g.next()).done)break;v=f.value}for(var p=Array.isArray(y=v),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b,x=Math.floor(k.linear.left);void 0===u[x]&&(u[x]=[]),u[x].push(k)}}var A=Object.keys(u);if(A.length){for(var S=[],_=0;_<A.length;_++){var w=u[A[_]];if(0===_&&0===w.length)return{output:""};S[_]=0===_?0:S[_-1];for(var E=0;E<w.length;E++){var T=w[E];if(0===_||T.linear.left>=S[_-1])if(void 0===r[_]&&(r[_]=[]),0===_||r[0].length===w.length)r[_][E]=T;else{var I=He(r,T);if(-1===I)return{output:""};r[_][I]=T}else{var R=r.length-1;if(r[R]){for(var B=r[R][0].linear.left,C=r[R][0].linear.right,N=1;N<r[R].length;N++)B=Math.min(B,r[R][N].linear.left),C=Math.max(C,r[R][N].linear.right);if(T.linear.left>B&&T.linear.right>C){var P=He(r,T);if(-1!==P)for(var M=r.length-1;M>=0;M--)if(r[M]){void 0===r[M][P]&&(r[R].length=0);break}}}}S[_]=Math.max(T.linear.right,S[_])}}for(var L=0,D=-1;L<S.length;L++)void 0===r[L]?-1===D?D=L-1:L===S.length-1&&(S[D]=S[L]):-1!==D&&(S[D]=S[L-1],D=-1);for(var O=0;O<r.length;O++)r[O]&&r[O].length?i.push(S[O]):r.splice(O--,1);var H=r.reduce(function(e,t){return Math.max(e,t.length)},0);for(h=0;h<H;h++)for(var W=0;W<r.length;W++)void 0===r[W][h]&&(r[W][h]={spacer:1})}i.push(e.box.right)}if(r.length>1&&r[0].length===e.length){for(var z=Array.isArray(U=e),F=0,U=z?U:U[Symbol.iterator]();;){var V;if(z){if(F>=U.length)break;V=U[F++]}else{if((F=U.next()).done)break;V=F.value}V.hide()}e.clear();for(var q=Object.assign({},t.createDataAttribute(),{columnCount:n?r[0].length:r.length}),X=0,j=0;X<r.length;X++)for(var G=0,Y=0,Q=0;Y<r[X].length;Y++){var Z=r[X][Y];if(Z.spacer)1===Z.spacer&&G++;else{Z.parent=e;var $=Object.assign(t.createDataCellAttribute(),Z.data(le.GRID,"cellData"));if(n)$.rowStart=0===Y,$.rowEnd=Y===r[X].length-1,$.cellStart=0===X&&0===Y,$.cellEnd=X===r.length-1&&$.rowEnd,$.index=Y;else{for(var K=1,J=1+G,ee=X+1;ee<r.length&&1===r[ee][Y].spacer;ee++)J++,r[ee][Y].spacer=2;if(1===J)for(var te=Y+1;te<r[X].length&&1===r[X][te].spacer;te++)K++,r[X][te].spacer=2;var ie=Math.min(X+(J-1),i.length-1),ne=Z.documentParent.element;if(ne)for(var re=0;re<ne.children.length;re++){var ae=De.getElementAsNode(ne.children[re]);ae&&ae.visible&&!ae.rendered&&ae.linear.left>=Z.linear.right&&ae.linear.right<=i[ie]&&$.siblings.push(ae)}$.rowSpan=K,$.columnSpan=J,$.rowStart=0==Q++,$.rowEnd=J+X===r.length,$.cellStart=0==j++,$.cellEnd=$.rowEnd&&Y===r[X].length-1,$.index=X,G=0}Z.data(le.GRID,"cellData",$)}}Oe.sortArray(e.children,!0,"documentParent.siblingIndex","siblingIndex"),e.each(function(e,t){return e.siblingIndex=t}),e.tableElement&&"collapse"===e.css("borderCollapse")&&(e.modifyBox(32,null),e.modifyBox(64,null),e.modifyBox(128,null),e.modifyBox(256,null)),e.data(le.GRID,"mainData",q)}return{output:""}}}],[{key:"createDataAttribute",value:function(){return{paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,columnCount:0}}},{key:"createDataCellAttribute",value:function(){return{rowSpan:0,columnSpan:0,index:-1,cellStart:!1,cellEnd:!1,rowEnd:!1,rowStart:!1,siblings:[]}}}]),t}(),List:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"condition",value:function(e){return f(c(t.prototype),"condition",this).call(this,e)&&e.length>0&&(e.every(function(e){return e.blockStatic})||e.every(function(e){return e.inlineVertical})||e.every(function(e){return e.floating})&&1===A.floated(e.children).size||e.every(function(t,i){return!t.floating&&(0===i||i===e.length-1||t.blockStatic||t.inlineFlow&&e.item(i-1).blockStatic&&e.item(i+1).blockStatic)}))&&(e.some(function(e){return"list-item"===e.display&&("none"!==e.css("listStyleType")||ze(e))})||e.every(function(e){return"LI"!==e.tagName&&"none"===e.cssInitial("listStyleType")&&ze(e)}))}},{key:"processNode",value:function(e){var i=0;return e.each(function(e){var n=t.createDataAttribute();if("list-item"===e.display||e.has("listStyleType")||ze(e)){var r=e.css("listStyleImage");if(r&&"none"!==r)n.imageSrc=r;else switch(e.css("listStyleType")){case"disc":n.ordinal="";break;case"square":n.ordinal="";break;case"decimal":n.ordinal="".concat(""+(i+1),".");break;case"decimal-leading-zero":n.ordinal="".concat((i<9?"0":"")+(i+1),".");break;case"lower-alpha":case"lower-latin":n.ordinal="".concat(We.convertAlpha(i).toLowerCase(),".");break;case"upper-alpha":case"upper-latin":n.ordinal="".concat(We.convertAlpha(i),".");break;case"lower-roman":n.ordinal="".concat(We.convertRoman(i+1).toLowerCase(),".");break;case"upper-roman":n.ordinal="".concat(We.convertRoman(i+1),".");break;case"none":r="";var a="";e.visibleStyle.backgroundRepeat||(r=e.css("backgroundImage"),a=e.css("backgroundPosition")),r&&"none"!==r&&(n.imageSrc=r,n.imagePosition=a,e.exclude({resource:y.IMAGE_SOURCE}));break;default:n.ordinal=""}i++}e.data(le.LIST,"mainData",n)}),{output:""}}},{key:"postBaseLayout",value:function(e){e.modifyBox(16,null),e.modifyBox(256,null)}}],[{key:"createDataAttribute",value:function(){return{ordinal:"",imageSrc:"",imagePosition:""}}}]),t}(),Relative:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"condition",value:function(e){return e.positionRelative&&!e.positionStatic||0!==Fe.convertInt(e.cssInitial("verticalAlign"))}},{key:"processNode",value:function(){return{output:"",include:!0}}},{key:"postProcedure",value:function(e){var t=e.renderParent;if(t){var i=Fe.convertInt(e.verticalAlign),n=e;if(t.support.container.positionRelative&&0===e.length&&(0!==e.top||0!==e.bottom||0!==i)){n=e.clone(this.application.nextId,!0,!0),e.hide(!0);var r=new _(t,n,n.containerType,n.alignmentType);this.application.controllerHandler.appendAfter(e.id,this.application.renderLayout(r)),this.application.session.cache.append(n,!1),t.renderEach(function(t){t.alignSibling("topBottom")===e.documentId?t.alignSibling("topBottom",n.documentId):t.alignSibling("bottomTop")===e.documentId&&t.alignSibling("bottomTop",n.documentId)})}0!==e.top?n.modifyBox(2,e.top):0!==e.bottom&&n.modifyBox(2,-1*e.bottom),0!==i&&n.modifyBox(2,-1*i),0!==e.left?n.autoMargin.left?n.modifyBox(4,-1*e.left):n.modifyBox(16,e.left):0!==e.right&&n.modifyBox(16,-1*e.right)}}}]),t}(),Sprite:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"condition",value:function(e){var t=!1;if(e.hasWidth&&e.hasHeight&&0===e.length){var i=e.css("backgroundImage");if(!Ve.hasValue(i)||"none"===i){i="";var n=Ve.REGEXP_COMPILED.URL.exec(e.css("background"));n&&(i=n[0])}if(""!==i){i=Ue.resolveURL(i);var r=this.application.session.image.get(i);if(r){var a=e.fontSize,o=Ve.convertUnit(e.has("width")?e.css("width"):e.css("minWidth"),e.bounds.width,a),s=Ve.convertUnit(e.has("height")?e.css("width"):e.css("minHeight"),e.bounds.height,a),l=Ue.getBackgroundPosition("".concat(e.css("backgroundPositionX")," ").concat(e.css("backgroundPositionY")),e.bounds,a);l.left<=0&&l.top<=0&&r.width>o&&r.height>s&&(r.position={x:l.left,y:l.top},e.data(le.SPRITE,"mainData",r),t=!0)}}}return t&&(!e.dataset.use||this.included(e.element))}}]),t}(),Substitute:function(e){function t(e,i,n,a){var o;return r(this,t),(o=u(this,c(t).call(this,e,i,n,a))).require(le.EXTERNAL,!0),o}return l(t,ie),o(t,[{key:"processNode",value:function(e,t){var i=this,n=qe.getDataSet(e.element,this.name),r="";return n.tag&&(e.setControlType(n.tag),e.render(t),r=this.application.controllerHandler.renderNodeStatic(n.tag,e.renderDepth,{},"","",e,e.length>0)),n.tagChild&&e.each(function(e){e.styleElement&&(e.dataset.use=i.name,e.dataset.squaredSubstituteTag=n.tagChild)}),{output:r}}}]),t}(),Table:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"processNode",value:function(e){var i=t.createDataAttribute(),n=[];function r(t){t.data(le.TABLE,"percent","".concat(Math.round(t.bounds.width/e.bounds.width*100),"%")),t.data(le.TABLE,"expand",!0)}function a(e){e.css("width",Ge.formatPX(e.bounds.width),!0)}function o(e){if(e.length){var t=e[0].cascade(),i=Array.isArray(t),r=0;for(t=i?t:t[Symbol.iterator]();;){var a;if(i){if(r>=t.length)break;a=t[r++]}else{if((r=t.next()).done)break;a=r.value}var o=a;"TH"!==o.tagName&&"TD"!==o.tagName||(o.inherit(e[0],"styleMap"),o.unsetCache("visibleStyle"))}Ge.concatArray(n,e[0].children);for(var s=Array.isArray(c=e),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}h.hide()}}}var s=[],l=[],c=[];e.each(function(e){switch(e.tagName){case"THEAD":s.push(e);break;case"TBODY":l.push(e);break;case"TFOOT":c.push(e)}}),o(s);for(var h=0;h<l.length;h++){var u=l[h];Ge.concatArray(n,u.children),u.hide()}o(c);var d="fixed"===e.css("tableLayout"),f="collapse"===e.css("borderCollapse"),v=g(f?[0,0]:Ge.replaceMap(e.css("borderSpacing").split(" "),function(e){return parseInt(e)}),2),p=v[0],m=v[1];p>0?(e.modifyBox(256,p),e.modifyBox(64,p)):(e.modifyBox(256,null),e.modifyBox(64,null)),m>0?(e.modifyBox(32,m),e.modifyBox(128,m)):(e.modifyBox(32,null),e.modifyBox(128,null));for(var y=Ge.formatPX(p>1?Math.round(p/2):p),b=Ge.formatPX(m>1?Math.round(m/2):m),k=e.element&&e.element.querySelector("COLGROUP"),x=[],A=[],S=[],_=[],w=n.length,E=Array(w).fill(0),T=0,I=0,R=function(e){var t=n[e];x[e]=p,S[e]=[],t.each(function(i,r){for(var a=i.element,o=0;o<a.rowSpan-1;o++){var s=e+1+o;void 0!==E[s]&&(E[s]+=a.colSpan)}if(!i.visibleStyle.backgroundImage&&!i.visibleStyle.backgroundColor)if(k){var l=Xe.getStyle(k.children[E[e]]);l.background?a.style.background=l.background:l.backgroundColor&&(a.style.backgroundColor=l.backgroundColor)}else{var c=/rgba\(0, 0, 0, 0\)|transparent/,h=Xe.getInheritedStyle(a,"background",c,"TABLE");""!==h?a.style.background=h:""!==(h=Xe.getInheritedStyle(a,"backgroundColor",c,"TABLE"))&&(a.style.backgroundColor=h)}switch(i.tagName){case"TH":i.cssInitial("textAlign")||i.css("textAlign","center");case"TD":i.cssInitial("verticalAlign")||i.css("verticalAlign","middle")}var u=i.cssInitial("width"),f=E[e],g=void 0===_[f]||"auto"===_[f];if(0===e||g||!d)if(""===u||"auto"===u)void 0===_[f]?(_[f]=u||"0px",A[f]=0):e===n.length-1&&g&&0===A[f]&&(A[f]=i.bounds.width);else{var v=Ge.isUnit(_[f]),m=Ge.isPercent(u);(g||i.bounds.width<A[f]||i.bounds.width===A[f]&&(v||m||v&&m||m&&Ge.isPercent(_[f])&&Ge.convertFloat(u)>Ge.convertFloat(_[f])||v&&Ge.isUnit(u)&&Ge.convertInt(u)>Ge.convertInt(_[f])))&&(_[f]=u),(g||1===a.colSpan)&&(A[f]=i.bounds.width)}0===I&&(I=i.multiline),(i.length||i.inlineText)&&(x[e]+=i.bounds.width+p),i.cssApply({marginTop:0===e?"0px":b,marginRight:r<t.length-1?y:"0px",marginBottom:e+a.rowSpan-1>=n.length-1?"0px":b,marginLeft:0===E[e]?"0px":y},!0),E[e]+=a.colSpan}),T=Math.max(T,E[e])},B=0;B<w;B++)R(B);if(e.has("width",2)&&_.some(function(e){return Ge.isPercent(e)})&&Ge.replaceMap(_,function(e,t){return"auto"===e&&A[t]>0&&(e=Ge.formatPX(A[t])),e}),_.every(function(e){return Ge.isPercent(e)})&&_.reduce(function(e,t){return e+parseFloat(t)},0)>1){var C=100;Ge.replaceMap(_,function(e){var t=parseFloat(e);return C<=0?e="0px":C-t<0&&(e=Ge.formatPercent(C)),C-=t,e})}else if(_.every(function(e){return Ge.isUnit(e)})){var N=_.reduce(function(e,t){return e+parseInt(t)},0);if(N<e.width)Ge.replaceMap(_,function(e){return"0px"!==e?"".concat(parseInt(e)/N*100,"%"):e});else if(N>e.width&&(e.css("width","auto",!0),!d)){var P=e.cascade(),M=Array.isArray(P),L=0;for(P=M?P:P[Symbol.iterator]();;){var D;if(M){if(L>=P.length)break;D=P[L++]}else{if((L=P.next()).done)break;D=L.value}D.css("width","auto",!0)}}}var O=_.reduce(function(e,t){return e+(Ge.isPercent(t)?parseFloat(t):0)},0);i.layoutType=function(){if(_.some(function(e){return Ge.isPercent(e)})||_.every(function(e){return Ge.isUnit(e)&&"0px"!==e}))return 3;if(_.every(function(e){return e===_[0]})){if(I)return e.some(function(e){return e.has("height")})?2:3;if("auto"===_[0])return e.has("width")?3:0;if(e.hasWidth)return 2}return _.every(function(e){return"auto"===e||Ge.isUnit(e)&&"0px"!==e})?1:0}(),(I||1===i.layoutType&&!e.hasWidth)&&(i.expand=!0);var H=e.find(function(e){return"CAPTION"===e.tagName});e.clear(),H&&(H.hasWidth||Ge.isUserAgent(16)||(H.textElement?H.has("maxWidth")||H.css("maxWidth",Ge.formatPX(H.bounds.width)):H.bounds.width>je.maxArray(x)&&a(H)),H.cssInitial("textAlign")||H.css("textAlign","center"),w++,H.data(le.TABLE,"colSpan",T),H.parent=e),E=Array(n.length).fill(0);var W=e.hasWidth;for(B=0;B<n.length;B++){for(var z=n[B],F=z.duplicate(),U=0;U<F.length;U++){for(var V=F[U],q=V.element,X=q.rowSpan,j=q.colSpan,G=0;G<X-1;G++){var Y=B+1+G;void 0!==E[Y]&&(E[Y]+=j)}X>1&&V.data(le.TABLE,"rowSpan",X),j>1&&V.data(le.TABLE,"colSpan",j),V.has("verticalAlign")||V.css("verticalAlign","middle");var Q=_[E[B]];if("undefined"!==Q)switch(i.layoutType){case 3:"auto"===Q?O>=1?(a(V),V.data(le.TABLE,"exceed",!W),V.data(le.TABLE,"downsized",!0)):r(V):Ge.isPercent(Q)?(V.data(le.TABLE,"percent",Q),V.data(le.TABLE,"expand",!0)):Ge.isUnit(Q)&&parseInt(Q)>0?V.bounds.width>=parseInt(Q)?(a(V),V.data(le.TABLE,"expand",!1),V.data(le.TABLE,"downsized",!1)):d?(r(V),V.data(le.TABLE,"downsized",!0)):(a(V),V.data(le.TABLE,"expand",!1)):(V.has("width")&&!V.has("width",32)||a(V),V.data(le.TABLE,"expand",!1));break;case 2:V.css("width","0px");break;case 1:"auto"===Q?V.css("width","0px"):(d?V.data(le.TABLE,"downsized",!0):a(V),V.data(le.TABLE,"expand",!1))}E[B]+=j;for(var Z=0;Z<X;Z++)for(var $=0;$<j;$++)S[B+Z].push(V);V.parent=e}if(E[B]<T)F[F.length-1].data(le.TABLE,"spaceSpan",T-E[B]);z.hide()}if(f){for(var K=e.css("borderTopColor"),J=e.css("borderTopStyle"),ee=e.css("borderTopWidth"),te=e.css("borderRightColor"),ie=e.css("borderRightStyle"),ne=e.css("borderRightWidth"),re=e.css("borderBottomColor"),ae=e.css("borderBottomStyle"),oe=e.css("borderBottomWidth"),se=e.css("borderLeftColor"),ce=e.css("borderLeftStyle"),he=e.css("borderLeftWidth"),ue=0;ue<w;ue++)for(var de=0;de<T;de++){var fe=S[ue][de];if(fe&&"visible"===fe.css("visibility")){if(0===ue&&fe.borderTopWidth<parseInt(ee)&&fe.cssApply({borderTopColor:K,borderTopStyle:J,borderTopWidth:ee}),ue>=0&&ue<w-1){var ge=S[ue+1][de];ge&&ge!==fe&&"visible"===ge.css("visibility")&&(fe.borderBottomWidth>=ge.borderTopWidth?ge.css("borderTopWidth","0px"):fe.css("borderBottomWidth","0px"))}if(ue===w-1&&fe.borderBottomWidth<parseInt(oe)&&fe.cssApply({borderBottomColor:re,borderBottomStyle:ae,borderBottomWidth:oe}),0===de&&fe.borderLeftWidth<parseInt(he)&&fe.cssApply({borderLeftColor:se,borderLeftStyle:ce,borderLeftWidth:he}),de>=0&&de<T-1){var ve=S[ue][de+1];ve&&ve!==fe&&"visible"===ve.css("visibility")&&(fe.borderRightWidth>=ve.borderLeftWidth?ve.css("borderLeftWidth","0px"):fe.css("borderRightWidth","0px"))}de===T-1&&fe.borderRightWidth<parseInt(ne)&&fe.cssApply({borderRightColor:te,borderRightStyle:ie,borderRightWidth:ne})}}e.cssApply({borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px",borderLeftWidth:"0px"})}return i.rowCount=w,i.columnCount=T,e.data(le.TABLE,"mainData",i),{output:""}}}],[{key:"createDataAttribute",value:function(){return{layoutType:0,rowCount:0,columnCount:0,expand:!1}}}]),t}(),VerticalAlign:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"condition",value:function(e){var t=e.filter(function(e){return e.inlineVertical});return t.length>1&&t.some(function(e){return 0!==Ye.convertInt(e.verticalAlign)})&&A.linearX(e.children)}},{key:"processNode",value:function(e){var t=[],i=[],n=1/0;return e.each(function(e){e.inlineVertical&&e.linear.top<=n&&(e.linear.top<n&&(i.length=0),i.push(e),n=e.linear.top)}),e.every(function(e){return e.positionStatic||e.positionRelative&&e.length>0})?i.length!==e.length&&e.each(function(e){var n=!1;i.includes(e)?n=!0:e.inlineVertical&&!e.baseline&&Ye.isUnit(e.verticalAlign)&&(e.modifyBox(2,e.linear.top-i[0].linear.top),t.push(e),n=!0),n&&e.css("verticalAlign","0px",!0)}):Ye.spliceArray(i,function(e){return!(Ye.isUnit(e.verticalAlign)&&Ye.convertInt(e.verticalAlign)>0)}),i.length&&e.data(le.VERTICAL_ALIGN,"mainData",{aboveBaseline:i,belowBaseline:t}),{output:""}}},{key:"postProcedure",value:function(e){var t=e.data(le.VERTICAL_ALIGN,"mainData");if(t){var i=e.find(function(e){return e.baselineActive});i?i.modifyBox(2,i.linear.top-t.aboveBaseline[0].linear.top):[].concat(t.belowBaseline,t.aboveBaseline).some(function(e){var t=Ye.convertInt(e.cssInitial("verticalAlign"));return t>0&&(e.modifyBox(8,t),!0)})}}}]),t}(),WhiteSpace:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ie),o(t,[{key:"afterBaseLayout",value:function(){for(var e=new Set,t=Array.isArray(n=this.application.processing.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(a.htmlElement&&a.blockStatic){for(var o=a.element,s=void 0,l=void 0,c=0;c<o.children.length;c++){var h=Qe.getElementAsNode(o.children[c]);if(h&&h.pageFlow&&(void 0===s&&(s=h),l=h,!h.lineBreak&&h.blockStatic)){var u=h.previousSiblings();if(u.length){var d=u[0],f=d.block&&d.floating;if(!d.lineBreak&&(d.blockStatic||f)){d=d.renderAs||d;var g=Ze.convertInt((h=h.renderAs||h).cssInitial("marginTop",!1,!0)),v=Ze.convertInt(h.cssInitial("marginBottom",!1,!0)),p=Ze.convertInt(d.cssInitial("marginTop",!1,!0)),m=Ze.convertInt(d.cssInitial("marginBottom",!1,!0));if(d.excluded&&!h.excluded){var y=Math.min(p,m);y<0&&(h.modifyBox(2,Math.abs(y)>=g?null:y),e.add(d))}else if(!d.excluded&&h.excluded){var b=Math.min(g,v);b<0&&(d.modifyBox(8,Math.abs(b)>=m?null:b),e.add(h))}else{if(0===m&&d.length&&!f){var k=d.lastChild;k&&k.blockStatic&&(m=Ze.convertInt(k.cssInitial("marginBottom",!1,!0)),d=k)}if(0===g&&h.length){var x=h.firstChild;x&&x.blockStatic&&(g=Ze.convertInt(x.cssInitial("marginTop",!1,!0)),h=x)}(m>0||f)&&g>0&&(g<=m||f&&0===m?h.modifyBox(2,null):d.modifyBox(8,null))}}}}}s&&Ke(a,s,!0),l&&Ke(a,l,!1)}}if(this.application.processing.node&&this.application.processing.node.htmlElement)for(var A=this.application.processing.node.element.getElementsByTagName("BR"),S=0;S<A.length;S++){var _=Qe.getElementAsNode(A[S]);if(_&&!e.has(_)){var w=_.actualParent,E=_.previousSiblings(!0,!0,!0),T=_.nextSiblings(!0,!0,!0),I=!1;if(E.length&&T.length){if(T[0].lineBreak)continue;I=!0;var R=E.pop(),B=T.pop();if(R.inlineStatic&&B.inlineStatic&&0===E.length){e.add(_);continue}var C=void 0,N=void 0;R.lineHeight>0&&R.element&&R.cssTry("lineHeight","0px")?(C=R.element.getBoundingClientRect().bottom+R.marginBottom,R.cssFinally("lineHeight")):C=R.linear.bottom,B.lineHeight>0&&B.element&&B.cssTry("lineHeight","0px")?(N=B.element.getBoundingClientRect().top-B.marginTop,B.cssFinally("lineHeight")):N=B.linear.top;var P=R.visible?R.renderParent:void 0,M=B.visible?B.renderParent:void 0,L=N-C;L>0&&(M&&M.groupParent&&M.firstChild===B?M.modifyBox(2,L):P&&P.groupParent&&P.lastChild===R?P.modifyBox(8,L):M&&M.layoutVertical&&(B.visible||B.renderAs)?(B.renderAs||B).modifyBox(2,L):P&&P.layoutVertical&&(R.visible||R.renderAs)?(R.renderAs||R).modifyBox(8,L):!M&&!P&&w&&w.visible?B.lineBreak||B.excluded?w.modifyBox(128,L):R.lineBreak||R.excluded?w.modifyBox(32,L):I=!1:I=!1)}else if(w&&w.visible){if(!w.documentRoot&&E.length){var D=E[E.length-1],O=w.box.bottom-D.linear[D.lineBreak||D.excluded?"top":"bottom"];O>0&&(D.visible?w.modifyBox(128,O):w.hasHeight||$e(w,O))}else if(T.length){var H=T[T.length-1],W=H.linear[H.lineBreak||H.excluded?"bottom":"top"]-w.box.top;W>0&&(H.visible?w.modifyBox(32,W):w.hasHeight||$e(w,W))}I=!0}if(I){e.add(_);for(var z=Array.isArray(U=E),F=0,U=z?U:U[Symbol.iterator]();;){var V;if(z){if(F>=U.length)break;V=U[F++]}else{if((F=U.next()).done)break;V=F.value}e.add(V)}for(var q=Array.isArray(j=T),X=0,j=q?j:j[Symbol.iterator]();;){var G;if(q){if(X>=j.length)break;G=j[X++]}else{if((X=j.next()).done)break;G=X.value}e.add(G)}}}}for(var Y=Array.isArray(Z=this.application.processing.excluded),Q=0,Z=Y?Z:Z[Symbol.iterator]();;){var $;if(Y){if(Q>=Z.length)break;$=Z[Q++]}else{if((Q=Z.next()).done)break;$=Q.value}var K=$;if(!e.has(K)&&!K.lineBreak){var J=K.marginTop+K.marginBottom;if(0!==J){var ee=K.nextSiblings(!0,!0,!0);if(ee.length){var te=ee.pop();te.visible&&(te.modifyBox(2,J),e.add(K))}}}}}},{key:"afterConstraints",value:function(){for(var e=Array.isArray(i=this.application.processing.cache),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}var r=n,a=r.renderAs?r.renderAs.renderParent:r.renderParent;if(a&&r.pageFlow&&!a.hasAlign(4)&&!r.alignParent("left")&&r.styleElement&&r.inlineVertical)for(var o=[],s=r;;){if(Ze.concatArray(o,s.previousSiblings()),o.length&&!o.some(function(e){return e.lineBreak||e.excluded&&e.blockStatic})){var l=o[o.length-1];if(l.inlineVertical){var c=r.linear.left-o[o.length-1].actualRight();c>0&&(r.renderAs||r).modifyBox(16,c)}else if(l.floating){o.length=0,s=l;continue}}break}}}}]),t}()},et={constant:ce,enumeration:w};e.Application=Q,e.Controller=J,e.Extension=ie,e.ExtensionManager=re,e.File=oe,e.Layout=_,e.Node=ye,e.NodeGroup=ke,e.NodeList=A,e.Resource=W,e.extensions=Je,e.lib=et,Object.defineProperty(e,"__esModule",{value:!0})});
