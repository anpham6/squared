!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.base={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){this.wrapped=e}function n(e){var t,n;function r(t,n){try{var o=e[t](n),s=o.value,l=s instanceof i;Promise.resolve(l?s.wrapped:s).then(function(e){l?r("next",e):a(o.done?"return":"normal",e)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(a,o){var s={key:e,arg:i,resolve:a,reject:o,next:null};n?n=n.next=s:(t=n=s,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function f(e,t,i){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=d(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};function g(e,t){return v(e)||function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(e,t)||p()}function v(e){if(Array.isArray(e))return e}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var m,y,b,k=squared.lib.util,x=function(e){function t(e){var i;return r(this,t),(i=u(this,c(t).call(this,e)))._currentId=0,i}return l(t,squared.lib.base.Container),o(t,[{key:"append",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f(c(t.prototype),"append",this).call(this,e),i&&this.afterAppend&&this.afterAppend.call(this,e),this}},{key:"reset",value:function(){return this._currentId=0,this.clear(),this}},{key:"nextId",get:function(){return++this._currentId}}],[{key:"outerRegion",value:function(e){var t=e.duplicate(),i=t[0],n=i,r=i,a=i;e.each(function(e){return e.companion&&!e.companion.visible&&t.push(e.companion)});for(var o=1;o<t.length;o++){var s=t[o];s.linear.top<i.linear.top&&(i=s),s.linear.right>n.linear.right&&(n=s),s.linear.bottom>r.linear.bottom&&(r=s),s.linear.left<a.linear.left&&(a=s)}return{top:i.linear.top,right:n.linear.right,bottom:r.linear.bottom,left:a.linear.left}}},{key:"actualParent",value:function(e){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}if(a.naturalElement){if(a.actualParent)return a.actualParent}else if(a.length){var o=t.actualParent(a.children);if(o)return o}}}},{key:"baseline",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=k.filterArray(e,function(e){return e.baseline||k.isLength(e.verticalAlign)&&"0px"!==e.verticalAlign});i.length&&(e=i),i=k.filterArray(e,function(e){return e.textElement||!e.verticalAlign.startsWith("text-")}),i.length&&(e=i),t&&k.spliceArray(e,function(e){return e.imageElement||!e.naturalElement});for(var n=0,r=0,a=Array.isArray(s=e),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}var c=l;n=Math.max(n,c.lineHeight),r=Math.max(r,c.actualHeight)}return k.spliceArray(e,function(e){return n>r?e.lineHeight!==n:!k.withinRange(e.actualHeight,r)}),e.sort(function(e,t){if(e.groupParent||e.length||!e.baseline&&t.baseline)return 1;if(t.groupParent||t.length||e.baseline&&!t.baseline)return-1;if(!e.imageElement||!t.imageElement)if(e.multiline||t.multiline){if(e.lineHeight>0&&t.lineHeight>0)return e.lineHeight<=t.lineHeight?1:-1;if(e.fontSize===t.fontSize)return e.htmlElement||!t.htmlElement?-1:1}else{if(e.textElement&&t.textElement)return e.fontSize===t.fontSize?e.htmlElement&&!t.htmlElement?-1:!e.htmlElement&&t.htmlElement?1:e.siblingIndex>=t.siblingIndex?1:-1:e.fontSize>t.fontSize?-1:1;if(e.containerType!==t.containerType)return e.textElement?-1:t.textElement?1:e.imageElement?-1:t.imageElement?1:e.containerType<t.containerType?-1:1}return e.actualHeight<=t.actualHeight?1:-1})}},{key:"linearData",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[],n=new Set,r={},a=new Set,o=new Map,s=!1,l=!1,c=Array.isArray(u=e),h=0,u=c?u:u[Symbol.iterator]();;){var d;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}var f=d;if(f.pageFlow){if(n.size){var g=[],v=f.css("clear");switch(v){case"left":g.push(r.left);break;case"right":g.push(r.right);break;case"both":g.push(r.left,r.right)}for(var p=g,m=0;m<p.length;m++){var y=p[m];y&&n.has(y.float)&&!f.floating&&f.linear.top>=y.linear.bottom&&(n.delete(y.float),r[y.float]=void 0)}"both"===v?(o.set(f,2===n.size?"both":n.values().next().value),n.clear(),r.left=void 0,r.right=void 0):n.has(v)&&(o.set(f,v),n.delete(v),r[v]=void 0)}f.floating&&(n.add(f.float),a.add(f.float),r[f.float]=f),i.push(f)}}if(i.length>0&&!t){for(var b=[i[0]],x=1,A=1,S=1;S<i.length;S++){var _=i[S].previousSiblings();i[S].alignedVertically(_,b,o)?A++:x++,b.push(i[S])}if(l=A===i.length,(s=x===i.length)&&a.size){for(var w=1/0,E=-1/0,T=-1/0,I=1/0,B=i,C=0;C<B.length;C++){var R=B[C];w=Math.min(w,R.linear.left),E=Math.max(E,R.linear.right),R.floating&&("left"===R.float?T=Math.max(T,R.linear.right):I=Math.min(I,R.linear.left))}for(var P=0,M=0,L=0,N=0,O=0;P<i.length;P++){var D=i[P];if(Math.floor(D.linear.left)<=w&&M++,Math.ceil(D.linear.right)>=E&&L++,D.floating||(D.linear.left===T&&N++,D.linear.right===I&&O++),0!==P){if(2===M||2===L||2===N||2===O){s=!1;break}var W=i[P-1];if(W.floating&&D.linear.top>=W.linear.bottom||k.withinRange(D.linear.left,W.linear.left)){s=!1;break}}}}}return{linearX:s,linearY:l,cleared:o,floated:a}}},{key:"partitionRows",value:function(e){for(var t=this.actualParent(e),i=t?t.actualChildren:e,n=this.linearData(e,!0).cleared,r=k.filterArray(e,function(e){return e.groupParent}),a=[],o=[],s=0;s<i.length;s++){for(var l=i[s],c=!1,h=0;h<r.length;h++){var u=r[h];if(u.contains(l)||u===l){o.length&&a.push(o),a.push([u]),o=[],r.splice(h,1),c=!0;break}}if(!c){var d=l.previousSiblings();0===s||0===d.length?e.includes(l)&&o.push(l):l.alignedVertically(d,o,n)?(o.length&&a.push(o),o=e.includes(l)?[l]:[]):e.includes(l)&&o.push(l),s===i.length-1&&o.length&&a.push(o)}}return a}},{key:"siblingIndex",value:function(e,t){return e.siblingIndex>=t.siblingIndex?1:-1}}]),t}(),A=squared.lib.util,S=function(e){function t(e,i){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0;return r(this,t),(n=u(this,c(t).call(this,s))).parent=e,n.node=i,n.containerType=a,n.alignmentType=o,n.rowCount=0,n.columnCount=0,n.renderType=0,n.renderIndex=-1,n.itemCount=0,s&&n.init(),n}return l(t,squared.lib.base.Container),o(t,[{key:"init",value:function(){var e=x.linearData(this.children);this._floated=e.floated,this._cleared=e.cleared,this._linearX=e.linearX,this._linearY=e.linearY,e.floated.size?this.add(64):this.delete(64),this.every(function(e){return e.rightAligned})?this.add(512):this.delete(512),this.itemCount=this.children.length}},{key:"setType",value:function(e){this.containerType=e;for(var t=arguments.length,i=[],n=1;n<t;n++)i[n-1]=arguments[n];for(var r=i,a=0;a<r.length;a++){this.add(r[a])}}},{key:"add",value:function(e){return A.hasBit(this.alignmentType,e)||(this.alignmentType|=e),this.alignmentType}},{key:"delete",value:function(e){return A.hasBit(this.alignmentType,e)&&(this.alignmentType^=e),this.alignmentType}},{key:"retain",value:function(e){return f(c(t.prototype),"retain",this).call(this,e),this.init(),this}},{key:"floated",get:function(){return this._floated||new Set}},{key:"cleared",get:function(){return this._cleared||new Map}},{key:"linearX",get:function(){return void 0===this._linearX||this._linearX}},{key:"linearY",get:function(){return void 0!==this._linearY&&this._linearY}},{key:"visible",get:function(){return this.filter(function(e){return e.visible})}}]),t}();!function(e){e[e.DOM_TRAVERSE=2]="DOM_TRAVERSE",e[e.EXTENSION=4]="EXTENSION",e[e.RENDER=8]="RENDER",e[e.ALL=14]="ALL"}(m||(m={})),function(e){e[e.BOX_STYLE=2]="BOX_STYLE",e[e.BOX_SPACING=4]="BOX_SPACING",e[e.FONT_STYLE=8]="FONT_STYLE",e[e.VALUE_STRING=16]="VALUE_STRING",e[e.IMAGE_SOURCE=32]="IMAGE_SOURCE",e[e.ASSET=56]="ASSET",e[e.ALL=126]="ALL"}(y||(y={})),function(e){e[e.CONSTRAINT=2]="CONSTRAINT",e[e.LAYOUT=4]="LAYOUT",e[e.ALIGNMENT=8]="ALIGNMENT",e[e.AUTOFIT=16]="AUTOFIT",e[e.OPTIMIZATION=32]="OPTIMIZATION",e[e.CUSTOMIZATION=64]="CUSTOMIZATION",e[e.ACCESSIBILITY=128]="ACCESSIBILITY",e[e.LOCALIZATION=256]="LOCALIZATION",e[e.POSITIONAL=46]="POSITIONAL",e[e.NONPOSITIONAL=464]="NONPOSITIONAL",e[e.ALL=510]="ALL"}(b||(b={}));var _=Object.freeze({get APP_SECTION(){return m},get NODE_RESOURCE(){return y},get NODE_PROCEDURE(){return b}}),w=squared.lib.color,E=squared.lib.css,T=squared.lib.element,I=squared.lib.math,B=squared.lib.util,C="(rgba?\\(\\d+, \\d+, \\d+(?:, [\\d.]+)?\\)|#[a-zA-Z\\d]{3,}|[a-z]+)\\s*(".concat(B.STRING_PATTERN.LENGTH_PERCENTAGE,"|").concat(B.STRING_PATTERN.ANGLE,"|(?:").concat(B.STRING_PATTERN.CALC,"(?=,)|").concat(B.STRING_PATTERN.CALC,"))?,?\\s*"),R=RegExp('(?:initial|url\\("?.+?"?\\)|(repeating)?-?(linear|radial|conic)-gradient\\(((?:to [a-z ]+|(?:from )?-?[\\d.]+(?:deg|rad|turn|grad)|circle|ellipse|closest-side|closest-corner|farthest-side|farthest-corner)?(?:\\s*at [\\w %]+)?),?\\s*((?:'.concat(C,")+)\\))"),"g"),P=/(<([^>]+)>)/gi,M=/\s*<br[^>]*>\s*/g;function L(e,t,i){for(var n=t[i],r=Array.isArray(o=e.actualChildren),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}var l=s;(l.excluded||l.dataset.target)&&B.isString(l[i])&&(n=n.replace(l[i],""))}return n}function N(e,t,i,n){for(var r,a=t,o=!!a.repeating,s=o&&"radial"===t.type?a.radiusExtent/a.radius:1,l=[],c=RegExp(C,"g");null!==(r=c.exec(i));){var h=w.parseColor(r[1],n,!0);if(h){var u={color:h,offset:-1};if("conic"===t.type)r[3]&&r[4]&&(u.offset=B.convertAngle(r[3],r[4])/360);else if(r[2]){if(B.isPercent(r[2]))u.offset=parseFloat(r[2])/100;else if(o){var d=a.horizontal,f="radial"===t.type?a.radius:t.dimension[d?"width":"height"];B.isLength(r[2])?u.offset=e.parseUnit(r[2],d,!1)/f:B.isCalc(r[2])&&(u.offset=B.calculate(r[6],f,e.fontSize)/f)}o&&-1!==u.offset&&(u.offset*=s)}0===l.length&&(-1===u.offset?u.offset=0:u.offset>0&&l.push({color:h,offset:0})),l.push(u)}}var g=l[l.length-1];-1===g.offset&&(g.offset=1);for(var v=0,p=0;p<l.length;p++){var m=l[p];if(-1===m.offset)if(0===p)m.offset=0;else{for(var y=p+1,b=2;y<l.length-1;y++,b++)if(-1!==l[y].offset){m.offset=(v+l[y].offset)/b;break}-1===m.offset&&(m.offset=v+g.offset/(l.length-1))}v=m.offset}if(o){if(v<100){var k=l.slice(0);e:for(var x=v;v<100;){for(var A=0;A<k.length;A++)if(l.push(Object.assign({},k[A],{offset:v=Math.min(x+k[A].offset,1)})),1===v)break e;x=v}}}else v<1&&l.push(Object.assign({},l[l.length-1],{offset:1}));return l}function O(e){if(e){var t=B.parseAngle(e.trim());return t<0&&(t+=360),t}return 0}function D(e){return e?/(.+?)?\s*at (.+?)$/.exec(e):null}function W(e,t,i){var n=e.renderParent;switch(e.multiline&&n&&!n.layoutVertical&&(i=i.replace(/^\s*\n/,"")),e.css("whiteSpace")){case"nowrap":i=i.replace(/\n/g," ");break;case"pre":case"pre-wrap":n&&!n.layoutVertical&&(i=i.replace(/^\n/,"")),i=i.replace(/\n/g,"\\n").replace(/\s/g,"&#160;");break;case"pre-line":i=i.replace(/\n/g,"\\n").replace(/\s+/g," ");break;default:return t.previousSibling&&T.isLineBreak(t.previousSibling)&&(i=i.replace(B.REGEXP_COMPILED.LEADINGSPACE,"")),t.nextSibling&&T.isLineBreak(t.nextSibling)&&(i=i.replace(B.REGEXP_COMPILED.TRAILINGSPACE,"")),[i,!1]}return[i,!0]}function F(e,t,i){if(i){var n=i.split(B.REGEXP_COMPILED.SEPARATOR);return z.getBackgroundSize(e,n[t%n.length])}}function H(e,t){switch(t){case"uppercase":e=e.toUpperCase();break;case"lowercase":e=e.toLowerCase()}return e}var z=function(){function e(t,i){r(this,e),this.application=t,this.cache=i}return o(e,[{key:"finalize",value:function(e){}},{key:"reset",value:function(){for(var t in e.ASSETS)e.ASSETS[t]=new Map;for(var i in e.STORED)e.STORED[i]=new Map;this.fileHandler&&this.fileHandler.reset()}},{key:"setBoxStyle",value:function(){for(var t=Array.isArray(n=this.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(a.visible&&a.styleElement){var o={backgroundColor:"",backgroundSize:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundImage:void 0};for(var s in"0px none rgb(0, 0, 0)"!==a.css("border")&&(o.borderTop=void 0,o.borderRight=void 0,o.borderBottom=void 0,o.borderLeft=void 0,o.borderRadius=void 0),o){var l=a.css(s);switch(s){case"backgroundColor":if(a.has("backgroundColor")||!(l===a.cssAscend("backgroundColor",!1,!0)||a.documentParent.visible&&E.isInheritedStyle(a.element,"backgroundColor"))){var c=w.parseColor(l,a.css("opacity"));o.backgroundColor=c?c.valueAsRGBA:""}break;case"backgroundSize":case"backgroundRepeat":case"backgroundPositionX":case"backgroundPositionY":o[s]=l;break;case"backgroundImage":if("none"!==l&&a.hasResource(y.IMAGE_SOURCE)){for(var h=[],u=a.css("opacity"),d=void 0,f=0;null!==(d=R.exec(l));){var v=g(d,5),p=v[0],m=v[1],b=v[2],k=v[3],x=v[4];if("initial"===p||p.startsWith("url"))h.push(p);else{var A=F(a,f,o.backgroundSize)||a.actualDimension,S=void 0;switch(b){case"conic":var _=D(k),T={type:b,dimension:A,angle:O(k)};T.center=E.getBackgroundPosition(_&&_[2]||"center",A,a.fontSize),T.colorStops=N(a,T,x,u),S=T;break;case"radial":var C=D(k),P={type:b,repeating:"repeating"===m,horizontal:a.actualWidth<=a.actualHeight,dimension:A,shape:C&&"circle"===C[1]?"circle":"ellipse"};P.center=E.getBackgroundPosition(C&&C[2]||"center",A,a.fontSize),P.closestCorner=1/0,P.farthestCorner=-1/0;for(var M=[[0,0],[A.width,0],[A.width,A.height],[0,A.height]],L=0;L<M.length;L++){var W=M[L],H=Math.round(Math.sqrt(Math.pow(Math.abs(W[0]-P.center.left),2)+Math.pow(Math.abs(W[1]-P.center.top),2)));H<P.closestCorner&&(P.closestCorner=H),H>P.farthestCorner&&(P.farthestCorner=H)}P.closestSide=P.center.top,P.farthestSide=P.center.top;for(var z=[A.width-P.center.left,A.height-P.center.top,P.center.left],G=0;G<z.length;G++){var X=z[G];X<P.closestSide&&(P.closestSide=X),X>P.farthestSide&&(P.farthestSide=X)}P.radius=P.farthestCorner;var q=C&&C[1];switch(q){case"closest-corner":case"closest-side":case"farthest-side":var V=P[B.convertCamelCase(q)];m?P.radiusExtent=V:P.radius=V;break;default:P.radiusExtent=P.farthestCorner}P.colorStops=N(a,P,x,u),S=P;break;default:var U=180;switch(k){case"to top":U=0;break;case"to right top":U=45;break;case"to right":U=90;break;case"to right bottom":U=135;break;case"to bottom":break;case"to left bottom":U=225;break;case"to left":U=270;break;case"to left top":U=315;break;default:k&&(U=O(k))}var j={type:b,repeating:"repeating"===m,horizontal:U>=45&&U<=135||U>=225&&U<=315,dimension:A,angle:U};j.colorStops=N(a,j,x,u);var Y=A.width,Z=A.height,K=I.offsetAngleX(U,Y),Q=I.offsetAngleY(U,Z);if(!I.isEqual(Math.abs(K),Math.abs(Q))){var $=void 0;$=U<=90?I.offsetAngle({x:0,y:Z},{x:Y,y:0}):U<=180?I.offsetAngle({x:0,y:0},{x:Y,y:Z}):U<=270?I.offsetAngle({x:0,y:0},{x:-Y,y:Z}):I.offsetAngle({x:0,y:Z},{x:-Y,y:0});var J=Math.abs($-U),ee=90-J,te=I.trianguleASA(J,ee,Math.sqrt(Math.pow(Y,2)+Math.pow(Z,2)));K=I.truncateFraction(I.offsetAngleX(U,te[1]));var ie=I.trianguleASA(J=90,ee=90-U,K);Q=I.truncateFraction(I.offsetAngleY(U,ie[0]))}j.angleExtent={x:K,y:Q},S=j}h.push(S)}f++}f>0&&(o.backgroundImage=h)}break;case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":var ne=a.css("".concat(s,"Style"))||"none",re=a.css("".concat(s,"Width"))||"0px";switch(re){case"thin":re="1px";break;case"medium":re="2px";break;case"thick":re="3px"}var ae=a.css("".concat(s,"Color"))||"initial";switch(ae.toLowerCase()){case"initial":ae="rgb(0, 0, 0)";break;case"inherit":case"currentcolor":ae=E.getInheritedStyle(a.element,"".concat(s,"Color"))}if("none"!==ne&&"0px"!==re){var oe=w.parseColor(ae,a.css("opacity"));oe&&!oe.transparent&&(o[s]={width:re,style:ne,color:oe.valueAsRGBA})}break;case"borderRadius":if("none"!==l)if("continue"===function(){var e=a.actualWidth>=a.actualHeight,t=g(a.css("borderTopLeftRadius").split(" "),2),i=t[0],n=t[1],r=g(a.css("borderTopRightRadius").split(" "),2),s=r[0],l=r[1],c=g(a.css("borderBottomRightRadius").split(" "),2),h=c[0],u=c[1],d=g(a.css("borderBottomLeftRadius").split(" "),2),f=d[0],v=d[1],p=void 0;if((p=n||l||u||v?[i,n||i,s,l||s,h,u||h,f,v||f]:[i,s,h,f]).every(function(e){return e===p[0]})){if("0px"===p[0])return"continue";p.length=1}for(var m=0;m<p.length;m++)p[m]=a.convertPX(p[m],e,!1);o.borderRadius=p}())continue}}if(o.borderTop&&o.borderRight&&o.borderBottom&&o.borderLeft){var se=!0;for(var le in o.borderTop){var ce=o.borderTop[le];if(ce!==o.borderRight[le]||ce!==o.borderBottom[le]||ce!==o.borderLeft[le]){se=!1;break}}se&&(o.border=o.borderTop)}a.data(e.KEY_NAME,"boxStyle",o)}}}},{key:"setFontStyle",value:function(){for(var t=Array.isArray(n=this.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(!(null===a.element||a.renderChildren.length||a.imageElement||a.svgElement||"HR"===a.tagName||a.inlineText&&!a.preserveWhiteSpace&&""===a.element.innerHTML.trim()&&!e.isBackgroundVisible(a.data(e.KEY_NAME,"boxStyle")))){var o=a.css("opacity"),s=w.parseColor(a.css("color"),o),l=a.css("fontFamily"),c=a.css("fontSize"),h=a.css("fontWeight");if(B.isUserAgent(16)&&!a.has("fontFamily"))switch(a.tagName){case"TT":case"CODE":case"KBD":case"SAMP":l="monospace"}if(0===B.convertInt(c))switch(c){case"xx-small":c="8px";break;case"x-small":c="10px";break;case"small":c="13px";break;case"medium":c="16px";break;case"large":c="18px";break;case"x-large":c="24px";break;case"xx-large":c="32px"}if(!B.isNumber(h))switch(h){case"lighter":h="200";break;case"bold":h="700";break;case"bolder":h="900";break;default:h="400"}var u={fontFamily:l,fontStyle:a.css("fontStyle"),fontSize:c,fontWeight:h,color:s?s.valueAsRGBA:""};a.data(e.KEY_NAME,"fontStyle",u)}}}},{key:"setValueString",value:function(){for(var t=Array.isArray(n=this.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r,o=a.element;if(o&&a.visible){var s="",l="",c=!1,h=!0;switch(o.tagName){case"INPUT":switch(l=o.value.trim(),o.type){case"radio":case"checkbox":a.companion&&!a.companion.visible&&(l=a.companion.textContent.trim());break;case"submit":""!==l||B.REGEXP_COMPILED.URL.test(a.css("background"))||(l="Submit");break;case"time":""===l&&(l="--:-- --");break;case"date":case"datetime-local":if(""===l){switch((new Intl.DateTimeFormat).resolvedOptions().locale){case"en-US":l="mm/dd/yyyy";break;default:l="dd/mm/yyyy"}"datetime-local"===o.type&&(l+=" --:-- --")}break;case"week":""===l&&(l="Week: --, ----");break;case"month":""===l&&(l="--------- ----");break;case"url":case"email":case"search":case"number":case"tel":""===l&&(l=o.placeholder);break;case"file":l=B.isUserAgent(8)?"Browse...":"Choose File"}break;case"TEXTAREA":l=o.value.trim();break;case"BUTTON":l=o.innerText;break;case"IFRAME":l=o.src,h=!1;break;default:if(a.plainText){s=a.textContent.trim(),l=a.textContent.replace(/&[A-Za-z]+;/g,function(e){return e.replace("&","&amp;")}).replace(/\u00A0/g,"&#160;");var u=g(W(a,o,l),2);l=u[0],c=u[1]}else if(a.inlineText){s=a.textContent.trim();var d=g(W(a,o,l="CODE"===o.tagName?L(a,o,"innerHTML"):T.hasLineBreak(o,!0)?L(a,o,"innerHTML").replace(M,"\\n").replace(P,""):L(a,o,"textContent")),2);l=d[0],c=d[1]}else a.htmlElement&&""===o.innerText.trim()&&e.isBackgroundVisible(a.data(e.KEY_NAME,"boxStyle"))&&(l=o.innerText,h=!1)}if(""!==l){if(h){var f=a.previousSiblings().pop(),v=a.nextSiblings().shift(),p=!1;if(void 0===f||f.multiline||f.lineBreak||f.plainText&&B.REGEXP_COMPILED.TRAILINGSPACE.test(f.textContent)?l=l.replace(B.REGEXP_COMPILED.LEADINGSPACE,""):f.element&&(p=B.REGEXP_COMPILED.TRAILINGSPACE.test(f.element.innerText||f.textContent)),c){var m=l;l=l.trim(),!f||f.block||f.lineBreak||p||!B.REGEXP_COMPILED.LEADINGSPACE.test(m)||(l="&#160;"+l),v&&!v.lineBreak&&B.REGEXP_COMPILED.TRAILINGSPACE.test(m)&&(l+="&#160;")}else""!==l.trim()?l=(l=l.replace(B.REGEXP_COMPILED.LEADINGSPACE,f&&(f.block||f.lineBreak||p&&f.htmlElement&&f.textContent.length>1||a.multiline&&T.hasLineBreak(o))?"":"&#160;")).replace(B.REGEXP_COMPILED.TRAILINGSPACE,"table-cell"===a.display||v&&v.lineBreak||a.blockStatic?"":"&#160;"):l.length&&(l="&#160;"+l.substring(1))}""!==l&&a.data(e.KEY_NAME,"valueString",{name:s,value:H(l,a.css("textTransform"))})}}}}},{key:"stored",get:function(){return e.STORED}}],[{key:"generateId",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t,r=i;1===i&&(t+="_".concat(""+r));for(var a=this.ASSETS.ids.get(e)||[];;){if(!a.includes(t)){a.push(t);break}t="".concat(n,"_").concat(""+ ++r)}return this.ASSETS.ids.set(e,a),t}},{key:"insertStoredAsset",value:function(t,i,n){var r=e.STORED[t];if(r&&B.hasValue(n)){var a=this.getStoredName(t,n);if(""===a){B.isNumber(i)&&(i="__".concat(i));var o=0;do{a=i,o>0&&(a+="_".concat(o)),r.has(a)||r.set(a,n),o++}while(r.has(a)&&r.get(a)!==n)}return a}return""}},{key:"getOptionArray",value:function(e){for(var t=[],i=E.getStyle(e).textTransform,n=[],r=-1;++r<e.children.length;){var a=e.children[r].text.trim();if(""!==a)if(n&&0===t.length&&B.isNumber(a))n.push(a);else{if(n&&n.length){r=-1,n=void 0;continue}""!==a&&t.push(H(a,i))}}return[t.length?t:void 0,n&&n.length?n:void 0]}},{key:"isBackgroundVisible",value:function(e){return void 0!==e&&(void 0!==e.backgroundImage||void 0!==e.borderTop||void 0!==e.borderRight||void 0!==e.borderBottom||void 0!==e.borderLeft)}},{key:"getBackgroundSize",value:function(e,t){var i=0,n=0;switch(t){case"":case"cover":case"contain":case"100% 100%":case"auto":case"auto auto":case"initial":return;default:var r=t.split(" ");1===r.length&&(r[1]=r[0]);for(var a=0;a<r.length;a++)"auto"===r[a]&&(r[a]="100%"),0===a?i=e.parseUnit(r[a],!0,!1):n=e.parseUnit(r[a],!1,!1)}return i>0&&n>0?{width:Math.round(i),height:Math.round(n)}:void 0}},{key:"getStoredName",value:function(t,i){if(e.STORED[t]){var n=e.STORED[t].entries(),r=Array.isArray(n),a=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=g(o,2),l=s[0];if(B.isEqual(i,s[1]))return l}}return""}}]),e}();z.KEY_NAME="squared.resource",z.ASSETS={ids:new Map,images:new Map},z.STORED={strings:new Map,arrays:new Map,fonts:new Map,colors:new Map,images:new Map};var G=squared.lib.css,X=squared.lib.dom,q=squared.lib.element,V=squared.lib.util;function U(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=[],r=e;r;){if(r.dataset.use){var a=r.dataset.use.split(V.REGEXP_COMPILED.SEPARATOR),o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var l;if(o){if(s>=a.length)break;l=a[s++]}else{if((s=a.next()).done)break;l=s.value}n.push(l)}}if(null===i||r===i)break;r!==i&&(r=r.parentElement)}if(n.length){for(var c=[],h=[],u=Array.isArray(f=t),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}var v=g,p=n.indexOf(v.name);-1!==p?c[p]=v:h.push(v)}return V.concatArray(V.spliceArray(c,function(e){return void 0===e}),h)}return t}function j(e,t,i){switch(e){case"<=":return t<=i;case"<":return t<i;case">=":return t>=i;case">":return t>i;default:return t===i}}var Y=function(){function e(t,i,n,a,o){r(this,e),this.framework=t,this.nodeConstructor=i,this.initialized=!1,this.closed=!1,this.builtInExtensions={},this.extensions=new Set,this.parseElements=new Set,this.session={cache:new x,documentRoot:[],image:new Map,targetQueue:new Map,excluded:new x,renderPosition:new Map,extensionMap:new Map},this.processing={cache:new x,node:void 0,excluded:new x},this._views=[],this._includes=[],this.controllerHandler=new n(this,this.processing.cache),this.resourceHandler=new a(this,this.processing.cache),this.extensionManager=new o(this,this.processing.cache)}return o(e,[{key:"registerController",value:function(e){e.application=this,e.cache=this.processing.cache,this.controllerHandler=e}},{key:"registerResource",value:function(e){e.application=this,e.cache=this.processing.cache,this.resourceHandler=e}},{key:"finalize",value:function(){var e=this.controllerHandler,t=this.session.targetQueue.entries(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=g(r,2),o=a[1];if((f=a[0]).dataset.target){var s=this.resolveTarget(f.dataset.target);s?(f.render(s),this.addRenderTemplate(s,f,o)):void 0===f.renderParent&&this.session.cache.remove(f)}}for(var l=this.rendered,c=Array.isArray(u=l),h=0,u=c?u:u[Symbol.iterator]();;){var d,f;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}(f=d).hasProcedure(b.LAYOUT)&&f.setLayout(),f.hasProcedure(b.ALIGNMENT)&&f.setAlignment()}for(var v=Array.isArray(m=l),p=0,m=v?m:m[Symbol.iterator]();;){var k;if(v){if(p>=m.length)break;k=m[p++]}else{if((p=m.next()).done)break;k=p.value}var x=k;x.hasProcedure(b.OPTIMIZATION)&&x.applyOptimizations(),!this.userSettings.customizationsDisabled&&x.hasProcedure(b.CUSTOMIZATION)&&x.applyCustomizations(this.userSettings.customizationsOverwritePrivilege)}for(var A=Array.isArray(_=this.extensions),S=0,_=A?_:_[Symbol.iterator]();;){var w;if(A){if(S>=_.length)break;w=_[S++]}else{if((S=_.next()).done)break;w=S.value}for(var E=w,T=Array.isArray(B=E.subscribers),I=0,B=T?B:B[Symbol.iterator]();;){var C;if(T){if(I>=B.length)break;C=B[I++]}else{if((I=B.next()).done)break;C=I.value}E.postProcedure(C)}}for(var R=Array.isArray(M=this.rendered),P=0,M=R?M:M[Symbol.iterator]();;){var L;if(R){if(P>=M.length)break;L=M[P++]}else{if((P=M.next()).done)break;L=P.value}var N=L;N.hasResource(y.BOX_SPACING)&&N.setBoxSpacing()}for(var O=Array.isArray(W=this.extensions),D=0,W=O?W:W[Symbol.iterator]();;){var F;if(O){if(D>=W.length)break;F=W[D++]}else{if((D=W.next()).done)break;F=D.value}F.beforeCascadeDocument()}for(var H=Array.isArray(G=this.session.documentRoot),z=0,G=H?G:G[Symbol.iterator]();;){var q;if(H){if(z>=G.length)break;q=G[z++]}else{if((z=G.next()).done)break;q=z.value}var V=q.node,U=q.node.renderParent;U&&U.renderTemplates&&this.addLayoutFile(q.layoutName,e.localSettings.baseTemplate+e.cascadeDocument(U.renderTemplates,0),V.dataset.pathname,!!V.renderExtension&&V.renderExtension.some(function(e){return e.documentBase}))}var j=this.sessionData;this.resourceHandler.finalize(j),e.finalize(j);for(var Y=Array.isArray(K=this.extensions),Z=0,K=Y?K:K[Symbol.iterator]();;){var Q;if(Y){if(Z>=K.length)break;Q=K[Z++]}else{if((Z=K.next()).done)break;Q=Z.value}Q.afterFinalize()}X.removeElementsByClassName("__css.placeholder"),this.closed=!0}},{key:"saveAllToDisk",value:function(){this.resourceHandler.fileHandler&&this.resourceHandler.fileHandler.saveAllToDisk(this.sessionData)}},{key:"reset",value:function(){this.session.cache.each(function(e){return e.element&&X.deleteElementCache(e.element,"node","style","styleMap")});for(var e=Array.isArray(i=this.parseElements),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}n.dataset.iteration=""}this.session.documentRoot.length=0,this.session.targetQueue.clear(),this.session.image.clear(),this.session.cache.reset(),this.session.excluded.reset(),this.session.renderPosition.clear(),this.session.extensionMap.clear(),this.processing.cache.reset(),this.controllerHandler.reset(),this.resourceHandler.reset(),this._views.length=0,this._includes.length=0;for(var r=Array.isArray(o=this.extensions),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}s.subscribers.clear()}this.closed=!1}},{key:"parseDocument",value:function(){var e,t=this;this.parseElements.clear(),this.initialized=!1,this.setStyleMap();for(var i=arguments.length,n=[],r=0;r<i;r++)n[r]=arguments[r];0===n.length&&n.push(document.body);for(var a=n,o=0;o<a.length;o++){var s=a[o],l="string"==typeof s?document.getElementById(s):s;G.hasComputedStyle(l)&&this.parseElements.add(l)}var c=this.parseElements.values().next().value,h=RegExp(".".concat(this.controllerHandler.localSettings.layout.fileExtension,"$")),u=[],d=function(){t.initialized=!1;for(var i=u,n=0;n<i.length;n++){c.removeChild(i[n])}var r=t.session.image.entries(),a=Array.isArray(r),o=0;for(r=a?r:r[Symbol.iterator]();;){var s;if(a){if(o>=r.length)break;s=r[o++]}else{if((o=r.next()).done)break;s=o.value}var l=g(s,2);z.ASSETS.images.set(l[0],l[1])}for(var d=Array.isArray(v=t.extensions),f=0,v=d?v:v[Symbol.iterator]();;){var p;if(d){if(f>=v.length)break;p=v[f++]}else{if((f=v.next()).done)break;p=f.value}p.beforeParseDocument()}for(var m=Array.isArray(b=t.parseElements),y=0,b=m?b:b[Symbol.iterator]();;){var k;if(m){if(y>=b.length)break;k=b[y++]}else{if((y=b.next()).done)break;k=y.value}var x=k,A=(x.dataset.iteration?V.convertInt(x.dataset.iteration):-1)+1;if(x.dataset.iteration=""+A,t.createCache(x)){var S=x.dataset.filename&&x.dataset.filename.replace(h,"")||x.id||"document_".concat(t.size);x.dataset.layoutName=V.convertWord(A>1?"".concat(S,"_").concat(A):S,!0),t.setBaseLayout(x.dataset.layoutName),t.setConstraints(),t.setResources()}}for(var _=Array.isArray(E=t.extensions),w=0,E=_?E:E[Symbol.iterator]();;){var T;if(_){if(w>=E.length)break;T=E[w++]}else{if((w=E.next()).done)break;T=w.value}for(var I=T,B=Array.isArray(R=I.subscribers),C=0,R=B?R:R[Symbol.iterator]();;){var P;if(B){if(C>=R.length)break;P=R[C++]}else{if((C=R.next()).done)break;P=C.value}I.postParseDocument(P)}I.afterParseDocument()}"function"==typeof e&&e.call(t)},f=[];if(this.userSettings.preloadImages){for(var v=Array.isArray(m=this.parseElements),p=0,m=v?m:m[Symbol.iterator]();;){var y;if(v){if(p>=m.length)break;y=m[p++]}else{if((p=m.next()).done)break;y=p.value}var b=y;b.querySelectorAll("input[type=image]").forEach(function(e){var i=e.src;""!==i&&t.session.image.set(i,{width:e.width,height:e.height,uri:i})}),b.querySelectorAll("svg image").forEach(function(e){var i=V.resolvePath(e.href.baseVal);""!==i&&t.session.image.set(i,{width:e.width.baseVal.value,height:e.height.baseVal.value,uri:i})})}var k=this.session.image.values(),x=Array.isArray(k),A=0;for(k=x?k:k[Symbol.iterator]();;){var S;if(x){if(A>=k.length)break;S=k[A++]}else{if((A=k.next()).done)break;S=A.value}var _=S;if(0===_.width&&0===_.height&&_.uri){var w=document.createElement("img");w.src=_.uri,w.complete&&w.naturalWidth>0&&w.naturalHeight>0?(_.width=w.naturalWidth,_.height=w.naturalHeight):(c.appendChild(w),u.push(w))}}for(var E=Array.isArray(I=this.parseElements),T=0,I=E?I:I[Symbol.iterator]();;){var B;if(E){if(T>=I.length)break;B=I[T++]}else{if((T=I.next()).done)break;B=T.value}B.querySelectorAll("IMG").forEach(function(e){"IMG"===e.tagName&&(e.complete?t.addImagePreload(e):f.push(e))})}}return 0===f.length?d():(this.initialized=!0,Promise.all(V.objectMap(f,function(e){return new Promise(function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(e)}})})).then(function(e){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}t.addImagePreload(a)}d()}).catch(function(e){var t=e.target?e.target.src:"";V.hasValue(t)&&!confirm("FAIL: ".concat(t))||d()})),{then:function(i){t.initialized?e=i:i()}}}},{key:"renderNode",value:function(e){return 0===e.itemCount?this.controllerHandler.renderNode(e):this.controllerHandler.renderNodeGroup(e)}},{key:"renderLayout",value:function(e,t){return V.hasBit(e.renderType,64)&&(V.hasBit(e.renderType,8)?e=this.processFloatHorizontal(e):V.hasBit(e.renderType,16)&&(e=this.processFloatVertical(e,t))),0!==e.containerType?this.renderNode(e):void 0}},{key:"addLayoutFile",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(""!==t){var r={pathname:V.trimString(i||this.controllerHandler.localSettings.layout.pathName,"/"),filename:e,content:t};n?this._views.unshift(r):this._views.push(r)}}},{key:"addIncludeFile",value:function(e,t,i){this._includes.push({id:e,pathname:this.controllerHandler.localSettings.layout.pathName,filename:t,content:i})}},{key:"addRenderLayout",value:function(e,t){var i;return i=t?this.renderLayout(e,t):this.renderNode(e),this.addRenderTemplate(e.parent,e.node,i,e.renderIndex)}},{key:"addRenderTemplate",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return!!i&&(void 0===t.renderParent?this.session.targetQueue.set(t,i):(void 0===e.renderTemplates&&(e.renderTemplates=[]),n>=0&&n<e.renderChildren.length?(e.renderChildren.splice(n,0,t),e.renderTemplates.splice(n,0,i)):(e.renderChildren.push(t),e.renderTemplates.push(i))),!0)}},{key:"addImagePreload",value:function(e){if(e&&e.complete){var t=e.src.trim();""!==t&&this.session.image.set(t,{width:e.naturalWidth,height:e.naturalHeight,uri:t})}}},{key:"createNode",value:function(e){return new this.nodeConstructor(this.nextId,e,this.controllerHandler.afterInsertNode)}},{key:"resolveTarget",value:function(e){for(var t=Array.isArray(n=this.processing.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.elementId===e||r.controlId===e)return r}for(var a=Array.isArray(s=this.session.cache),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}if(l.elementId===e||l.controlId===e)return l}}},{key:"toString",value:function(){return this._views.length?this._views[0].content:""}},{key:"createCache",value:function(e){var t=this,i=this.controllerHandler.localSettings;this.processing.cache.afterAppend=void 0,this.processing.cache.clear(),this.processing.excluded.clear(),this.processing.node=void 0;for(var n=Array.from(this.extensions),r=n,a=0;a<r.length;a++){r[a].beforeInit(e)}var o=function e(r,a){var o=t.insertNode(r);if(o&&(o.depth=a,0===a&&t.processing.cache.append(o),"SELECT"!==o.tagName)){for(var s=[],l=!1,c=function(c){var h=r.childNodes[c];if("#"===h.nodeName.charAt(0)){if("#text"===h.nodeName){var u=t.insertNode(h,o);u&&s.push(u)}}else if((!i.unsupported.tagName.has(h.tagName)||"INPUT"===h.tagName&&!i.unsupported.tagName.has("".concat(h.tagName,":").concat(h.type)))&&(U(h,n).some(function(e){return e.init(h)}),!t.parseElements.has(h))){var d=e(h,a+1);d&&(s.push(d),d.excluded||(l=!0))}},h=0;h<r.childNodes.length;h++)c(h);for(h=0;h<s.length;h++){var u=s[h];u.excluded?t.processing.excluded.append(u):(l||"PLAINTEXT"!==u.tagName)&&(u.parent=o,t.processing.cache.append(u)),u.siblingIndex=h}o.actualChildren=s}return o}(e,0);if(!o)return!1;if(o.parent=new this.nodeConstructor(0,e.parentElement||document.body,this.controllerHandler.afterInsertNode),o.siblingIndex=0,o.documentRoot=!0,o.documentParent=o.parent,this.processing.node=o,this.processing.cache.length){for(var s={},l=new Set,c=Array.isArray(u=this.processing.cache),h=0,u=c?u:u[Symbol.iterator]();;){var d;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}var f=d;if(f.styleElement){var g=f.element;if("BUTTON"!==g.tagName&&"button"!==g.type){var v=f.css("textAlign");switch(v){case"center":case"right":case"end":s[f.id]={textAlign:v},g.style.textAlign="left"}}if(f.positionRelative&&!f.positionStatic){void 0===s[f.id]&&(s[f.id]={});for(var p=Array.isArray(y=G.BOX_POSITION),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b;f.has(k)&&(s[f.id][k]=f.css(k),g.style[k]="auto")}}"rtl"===g.dir&&(g.dir="ltr",l.add(g))}}o.parent.setBounds();for(var A=Array.isArray(_=this.processing.cache),S=0,_=A?_:_[Symbol.iterator]();;){var w;if(A){if(S>=_.length)break;w=_[S++]}else{if((S=_.next()).done)break;w=S.value}w.setBounds()}for(var E=Array.isArray(I=this.processing.excluded),T=0,I=E?I:I[Symbol.iterator]();;){var B;if(E){if(T>=I.length)break;B=I[T++]}else{if((T=I.next()).done)break;B=T.value}B.lineBreak||B.setBounds()}for(var C=function(){if(R){if(P>=M.length)return"break";L=M[P++]}else{if((P=M.next()).done)return"break";L=P.value}var e=L;if(e.styleElement){var i=e.element,n=s[e.id];if(n)for(var r in n)i.style[r]=n[r];l.has(i)&&(i.dir="rtl")}if(!e.documentRoot){var a=e.actualParent;switch(e.position){case"fixed":if(!e.positionAuto){a=o;break}case"absolute":if(e.positionAuto&&function(e,t){var i=e.previousSiblings(),n=e.nextSiblings();return!(i.some(function(e){return e.multiline||e.excluded&&!e.blockStatic})||!(n.every(function(e){return e.blockStatic||e.lineBreak||e.excluded})||t&&e.element===X.getLastChildElement(t.element))||(e.cssApply({display:"inline-block",verticalAlign:"top"},!0),e.positionStatic=!0,0))}(e,a))break;if(t.userSettings.supportNegativeLeftTop){for(var c,h=e.absoluteParent,u=!1;a&&(a!==o||0!==a.id);){if(void 0===c){if(h===a){if(c=a,"hidden"===a.css("overflow"))break;if(e.has("right")&&!(e.right<0)||e.has("bottom")&&!(e.bottom<0)||!(e.left<0&&e.outsideX(a.box)||!e.has("left")&&e.right<0&&e.outsideX(a.box)||e.top<0&&e.outsideY(a.box)||!e.has("top")&&e.bottom<0&&e.outsideX(a.box)))break;u=!0}}else if(u&&(a.documentRoot||"hidden"===a.css("overflow")||e.withinX(a.box)&&e.withinY(a.box))){c=a;break}a=a.actualParent}c&&(a=c)}else a=e.absoluteParent}e.pageFlow||void 0!==a&&0!==a.id||(a=o),a&&(a!==e.parent&&(e.parent=a,e.siblingIndex=1/0),e.documentParent=a)}if(e.length){var d=[];e.each(function(t){if(t.siblingIndex===1/0)for(var i=Array.isArray(r=e.children),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a,s=o.actualChildren.includes(t);if(s||function(){var e=o.cascade();s=t.ascend().some(function(t){return e.includes(t)})}(),s){var l=o.siblingIndex+(t.zIndex>=0||o!==t.actualParent?1:-1);void 0===d[l]&&(d[l]=[]),d[l].push(t);break}}});for(var f=function(t){var i=d[t];if(i){i.sort(function(e,t){return e.zIndex===t.zIndex?e.id<t.id?-1:1:e.zIndex<t.zIndex?-1:1}),e.each(function(e){e.siblingIndex>=t&&e.siblingIndex!==1/0&&(e.siblingIndex+=i.length)});for(var n=0;n<i.length;n++)i[n].siblingIndex=t+n}},g=0;g<d.length;g++)f(g);e.sort(x.siblingIndex)}e.saveAsInitial()},R=Array.isArray(M=this.processing.cache),P=0,M=R?M:M[Symbol.iterator]();;){var L;if("break"===C())break}this.processing.cache.sort(function(e,t){return e.depth!==t.depth?e.depth<t.depth?-1:1:e.documentParent!==t.documentParent?e.documentParent.siblingIndex<t.documentParent.siblingIndex?-1:1:e.siblingIndex<t.siblingIndex?-1:1});for(var N=n,O=0;O<N.length;O++){N[O].afterInit(e)}return!0}return!1}},{key:"setBaseLayout",value:function(e){for(var t=this,i=this.controllerHandler,n=[],r=Array.isArray(o=this.extensions),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}s.eventOnly||n.push(s)}var l=this.processing.node,c=new Map;function h(e,t,i){var n=c.get(e)||new Map;c.set(e,n.set(t,i))}function u(e){var t=c.values(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=r,o=a.values(),s=Array.isArray(o),l=0;for(o=s?o:o[Symbol.iterator]();;){var h;if(s){if(l>=o.length)break;h=o[l++]}else{if((l=o.next()).done)break;h=l.value}if(h.id===e)return void a.delete(h.id)}}}h(-1,0,l.parent);for(var d=0,f=Array.isArray(v=this.processing.cache),g=0,v=f?v:v[Symbol.iterator]();;){var p;if(f){if(g>=v.length)break;p=v[g++]}else{if((g=v.next()).done)break;p=g.value}var y=p;y.visible&&(h(y.depth,y.id,y),d=Math.max(y.depth,d))}for(var b=0;b<d;b++)c.set(-1*b-2,new Map);this.processing.cache.afterAppend=function(e){u(e.id),h(-1*e.depth-2,e.id,e);var t=e.cascade(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=r;u(a.id),h(-1*a.depth-2,a.id,a)}};var k=c.values(),A=Array.isArray(k),_=0;for(k=A?k:k[Symbol.iterator]();;){var w;if(A){if(_>=k.length)break;w=k[_++]}else{if((_=k.next()).done)break;w=_.value}var E=function(){if(I){if(B>=T.length)return"break";C=T[B++]}else{if((B=T.next()).done)return"break";C=B.value}var e=C;if(0===e.length)return"continue";var r=e.duplicate(),a=r.some(function(e){return e.floating}),o=void 0;a&&(o=x.linearData(e.actualChildren).cleared);for(var s=-1,c=function(){var c=r[s];if(!c.visible||c.rendered)return"continue";if(c.htmlElement){var h=c.element;if(t.parseElements.has(h)&&!c.documentRoot&&!c.documentBody)return"continue";if(0===c.length&&h.children.length){for(var u=!0,d=0;d<h.children.length;d++)if(!t.parseElements.has(h.children[d])){u=!1;break}u&&(c.inlineText=!1)}}var f=c.parent,g=t.session.extensionMap.get(c.id),v=c.hasAlign(8192);if(r.length>1&&s<r.length-1&&c.pageFlow&&(0===f.alignmentType||v||f.hasAlign(2))&&!f.hasAlign(4)&&c.hasSection(m.DOM_TRAVERSE)){var p,y,b=function(e){return!A.length&&!_&&(x.push(e),!0)},k=function(e){if(f.layoutVertical&&A.length){var t=A[A.length-1];if(t.layoutVertical)return void(e.parent=t)}A.push(e)},x=[],A=[],_=!1,w=s,E=0;v&&f.layoutVertical&&(x.push(c),w++,E++);e:for(var T=new Set,I=new Set;w<r.length;w++,E++){var B=r[w];if(B.pageFlow){if(a){var C=o.get(B);C&&("both"===C?I.clear():I.delete(C)),B.floating&&(T.add(B.float),I.add(B.float))}var R=B.previousSiblings(),P=R[R.length-1],M=B.nextSiblings().shift();if(0===E&&M)B.blockStatic||M.alignedVertically([B],[B],o)?A.push(B):x.push(B);else{if(!P)break e;if(a){var L=[];if(x.length?V.concatArray(L,x):A.length&&V.concatArray(L,A),L.push(B),B.alignedVertically(R,L,o,!1)){if(x.length){if(I.size&&!P.autoMargin.horizontal&&"both"!==o.get(B)&&!R.some(function(e){return e.lineBreak&&!o.has(e)}))switch(function(){var e=-1/0;if(V.captureMap(x,function(e){return e.floating},function(t){return e=Math.max(e,t.linear.bottom)}),!B.floating||B.linear.top<e){if(o.has(B))return!B.floating&&I.size<2&&2===T.size?(B.alignmentType|=8192,_=!0,x.push(B),"continue"):"break|domNested";if(1===T.size&&(!B.floating||I.has(B.float)))return x.push(B),B.linear.bottom>e?"break|domNested":"continue"}}()){case"continue":continue;case"break|domNested":break e}break e}k(B)}else if(!b(B))break e}else if(B.alignedVertically(R))k(B);else if(!b(B))break e}}}x.length>1?(p=i.processTraverseHorizontal(new S(f,c,0,0,x),r),y=x[x.length-1]):A.length>1&&(p=i.processTraverseVertical(new S(f,c,0,0,A),r),(y=A[A.length-1]).blockStatic||y===r[r.length-1]||(y.alignmentType|=8192)),f.hasAlign(2)&&y===r[r.length-1]&&(f.alignmentType^=2),p&&t.addRenderLayout(p.layout,f)&&(f=c.parent)}if(c.hasAlign(8192)&&(c.alignmentType^=8192),s===r.length-1&&f.hasAlign(2)&&(f.alignmentType^=2),c.renderAs&&f.appendTry(c,c.renderAs,!1)&&(c.hide(),(c=c.renderAs).positioned&&(f=c.parent)),!c.rendered&&c.hasSection(m.EXTENSION)){var N=e.renderExtension?e.renderExtension.slice(0):void 0;if(g&&(N?V.concatArray(N,g):N=g.slice(0)),N){for(var O=!1,D=Array.isArray(F=N),W=0,F=D?F:F[Symbol.iterator]();;){var H;if(D){if(W>=F.length)break;H=F[W++]}else{if((W=F.next()).done)break;H=W.value}var z=H.processChild(c,f);if(z&&(z.output&&t.addRenderTemplate(z.parentAs||f,c,z.output),z.renderAs&&z.outputAs&&t.addRenderTemplate(f,z.renderAs,z.outputAs),z.parent&&(f=z.parent),O=!0===z.next,z.complete||O))break}if(O)return"continue"}if(c.styleElement){var G=!1;if(U(c.element,n,l.element).some(function(e){if(e.is(c)&&e.condition(c,f)&&(void 0===g||!g.includes(e))){var i=e.processNode(c,f);if(i&&(i.output&&t.addRenderTemplate(i.parentAs||f,c,i.output),i.renderAs&&i.outputAs&&t.addRenderTemplate(f,i.renderAs,i.outputAs),i.parent&&(f=i.parent),(i.output||!0===i.include)&&(void 0===c.renderExtension&&(c.renderExtension=[]),c.renderExtension.push(e),e.subscribers.add(c)),G=!0===i.next,i.complete||G))return!0}return!1}),G)return"continue"}}if(!c.rendered&&c.hasSection(m.RENDER)){var X=t.createLayoutControl(f,c),q=c.length?i.processUnknownParent(X):i.processUnknownChild(X);if(!0===q.next)return"continue";if(q.renderAs)return r[s]=q.renderAs,s--,"continue";t.addRenderLayout(q.layout,f)}};++s<r.length;)c()};var T=w.values(),I=Array.isArray(T),B=0;e:for(T=I?T:T[Symbol.iterator]();;){var C;switch(E()){case"break":break e;case"continue":continue}}}this.session.cache.concat(this.processing.cache.children),this.session.excluded.concat(this.processing.excluded.children);for(var R=Array.isArray(M=this.processing.cache),P=0,M=R?M:M[Symbol.iterator]();;){var L;if(R){if(P>=M.length)break;L=M[P++]}else{if((P=M.next()).done)break;L=P.value}L.documentRoot&&L.rendered&&this.session.documentRoot.push({node:L,layoutName:L===l?e:""})}for(var N=Array.isArray(D=this.extensions),O=0,D=N?D:D[Symbol.iterator]();;){var W;if(N){if(O>=D.length)break;W=D[O++]}else{if((O=D.next()).done)break;W=O.value}for(var F=W,H=Array.isArray(G=F.subscribers),z=0,G=H?G:G[Symbol.iterator]();;){var X;if(H){if(z>=G.length)break;X=G[z++]}else{if((z=G.next()).done)break;X=z.value}F.postBaseLayout(X)}F.afterBaseLayout()}}},{key:"setConstraints",value:function(){this.controllerHandler.setConstraints();for(var e=Array.isArray(i=this.extensions),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}for(var r=n,a=Array.isArray(s=r.subscribers),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}r.postConstraints(l)}r.afterConstraints()}}},{key:"setResources",value:function(){this.resourceHandler.setBoxStyle(),this.resourceHandler.setFontStyle(),this.resourceHandler.setValueString();for(var e=Array.isArray(i=this.extensions),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}n.afterResources()}}},{key:"processFloatHorizontal",value:function(e){var t,i=this.controllerHandler,n=e.itemCount;if(0===e.cleared.size&&!e.some(function(e){return e.autoMargin.horizontal})){for(var r=[],a=[],o=[],s=Array.isArray(c=e),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}var u=h;"right"===u.float?o.push(u):"left"===u.float?a.push(u):r.push(u)}if(r.length===n||a.length===n||o.length===n)i.processLayoutHorizontal(e);else if((0===a.length||0===o.length)&&!r.some(function(e){return e.blockStatic})){var d=[];if(0===o.length){V.concatMultiArray(d,a,r);var f=i.containerTypeHorizontal;e.setType(f.containerType,f.alignmentType),t=[a,r]}else{V.concatMultiArray(d,r,o);var g=i.containerTypeVerticalMargin;e.setType(g.containerType,g.alignmentType),t=[r,o]}e.retain(d)}}var v,p=i.containerTypeVertical,m=[],y=[],b=[],k=[],A=[],_=[],w=[],E=[];if(void 0===t){t=[];for(var T="",I=0,B=Array.isArray(R=e),C=0,R=B?R:R[Symbol.iterator]();;){var P;if(B){if(C>=R.length)break;P=R[C++]}else{if((C=R.next()).done)break;P=C.value}var M=P,L=e.cleared.get(M);if(L&&(V.hasBit(I,"right"===L?4:2)||0!==I&&"both"===L))switch(L){case"left":V.hasBit(I,2)&&(I^=2),T="left";break;case"right":V.hasBit(I,4)&&(I^=4),T="right";break;case"both":switch(I){case 2:T="left";break;case 4:T="right";break;default:T="both"}I=0}if(""===T)"right"===M.float?(k.push(M),M.floating&&(I|=4)):"left"===M.float?(b.push(M),M.floating&&(I|=2)):M.autoMargin.horizontal?M.autoMargin.left?k.length?_.push(M):k.push(M):M.autoMargin.right?b.length?A.push(M):b.push(M):m.length?0===b.length?b.push(M):k.push(M):m.push(M):m.push(M);else if("right"===M.float)0===_.length&&(I|=4),"right"!==T&&k.length?k.push(M):_.push(M);else if("left"===M.float)0===A.length&&(I|=2),"left"!==T&&b.length?b.push(M):A.push(M);else if(M.autoMargin.horizontal)M.autoMargin.left&&_.length?_.push(M):M.autoMargin.right&&A.length?A.push(M):y.push(M);else switch(T){case"left":A.push(M);break;case"right":_.push(M);break;default:y.push(M)}}b.length&&A.length?w=[b,A]:b.length?w=b:A.length&&(w=A),k.length&&_.length?E=[k,_]:k.length?E=k:_.length&&(E=_),e=new S(e.parent,e.node,0,k.length+_.length===e.length?512:0),m.length?_.length?t.push(w=[m,b],E):A.length?t.push(E=[m,k],w):t.push(m,w,E):w===A&&E===k||w===b&&E===_?t.push(0===A.length?[b,_]:[k,A]):t.push(w,E),y.length&&t.push(y),V.spliceArray(t,function(e){return 0===e.length}),e.itemCount=t.length;var N=0!==m.length||0!==w.length&&0!==E.length?i.containerTypeVerticalMargin:p;e.setType(N.containerType,N.alignmentType)}for(var O=0;O<t.length;O++){var D=t[O],W=void 0;if(Array.isArray(D[0])){for(var F=[],H=Array.isArray(G=W=D),z=0,G=H?G:G[Symbol.iterator]();;){var X;if(H){if(z>=G.length)break;X=G[z++]}else{if((z=G.next()).done)break;X=z.value}V.concatArray(F,X)}if(F.sort(x.siblingIndex),e.node.layoutVertical)v=e.node;else{v=i.createNodeGroup(F[0],F,e.node);var q=new S(e.node,v,p.containerType,p.alignmentType|(W.some(function(e){return e===E||e===k})?512:0));q.itemCount=W.length,this.addRenderLayout(q)}}else W=[D],v=void 0;for(var U=Array.isArray(Y=W),j=0,Y=U?Y:Y[Symbol.iterator]();;){var Z;if(U){if(j>=Y.length)break;Z=Y[j++]}else{if((j=Y.next()).done)break;Z=j.value}var K=Z,Q=!v||K!==m&&K!==b&&K!==A&&K!==k&&K!==_?e.node:v,$=i.createNodeGroup(K[0],K,Q),J=new S(Q,$,0,K.length<n?128:0,K);if(1===K.length||J.linearY?(J.setType(p.containerType,p.alignmentType),1===K.length&&($.innerChild=K[0],K[0].outerParent=$)):i.processLayoutHorizontal(J),this.addRenderLayout(J),K===m&&K.some(function(e){return e.blockStatic&&!e.hasWidth})){var ee=$.of(p.containerType,p.alignmentType)?$.children:[$];if(b.length){for(var te=-1/0,ie=1/0,ne=b,re=0;re<ne.length;re++){te=Math.max(te,ne[re].linear.right)}for(var ae=Array.isArray(se=K),oe=0,se=ae?se:se[Symbol.iterator]();;){var le;if(ae){if(oe>=se.length)break;le=se[oe++]}else{if((oe=se.next()).done)break;le=oe.value}ie=Math.min(ie,le.bounds.left)}for(var ce=Array.isArray(ue=ee),he=0,ue=ce?ue:ue[Symbol.iterator]();;){var de;if(ce){if(he>=ue.length)break;de=ue[he++]}else{if((he=ue.next()).done)break;de=he.value}de.modifyBox(256,te-ie)}}if(k.length){for(var fe=1/0,ge=-1/0,ve=k,pe=0;pe<ve.length;pe++){fe=Math.min(fe,ve[pe].bounds.left)}for(var me=Array.isArray(be=K),ye=0,be=me?be:be[Symbol.iterator]();;){var ke;if(me){if(ye>=be.length)break;ke=be[ye++]}else{if((ye=be.next()).done)break;ke=ye.value}ge=Math.max(ge,ke.bounds.right)}for(var xe=Array.isArray(Se=ee),Ae=0,Se=xe?Se:Se[Symbol.iterator]();;){var _e;if(xe){if(Ae>=Se.length)break;_e=Se[Ae++]}else{if((Ae=Se.next()).done)break;_e=Ae.value}_e.modifyBox(64,ge-fe)}}}}}return e}},{key:"processFloatVertical",value:function(e,t){var i=this.controllerHandler,n=i.containerTypeVertical;if(0!==e.containerType){var r=i.createNodeGroup(e.node,[e.node],t);this.addRenderLayout(new S(r,e.node,n.containerType,n.alignmentType,r.children)),e.node=r}else e.containerType=n.containerType,e.add(n.alignmentType);for(var a=[],o=[],s=[],l=[],c=!1,h=!1,u=!0,d=Array.isArray(g=e),f=0,g=d?g:g[Symbol.iterator]();;){var v;if(d){if(f>=g.length)break;v=g[f++]}else{if((f=g.next()).done)break;v=f.value}var p=v;p.blockStatic&&0===l.length?(s.push(p),h=!0):(e.cleared.has(p)&&(p.floating?c=!0:(p.modifyBox(2,null),a.push(s.slice(0)),o.push(l.slice(0)),s.length=0,l.length=0)),p.floating?(h&&(a.push(s.slice(0)),o.push(null),s.length=0,l.length=0,h=!1),l.push(p)):(c&&!e.cleared.has(p)&&(u=!1),s.push(p)))}if(l.length&&o.push(l),s.length&&a.push(s),!u)for(var m=0;m<Math.max(o.length,a.length);m++){var y=a[m]||[];if(null===o[m]&&y.length){var b=i.containerTypeVertical;b.alignmentType|=128,this.addRenderLayout(new S(e.node,i.createNodeGroup(y[0],y,e.node),b.containerType,b.alignmentType,y))}else{var k=o[m]||[];if(y.length||k.length){var x=i.createNodeGroup(k[0]||y[0],[],e.node),A=i.containerTypeVerticalMargin,_=new S(e.node,x,A.containerType,A.alignmentType),w=[],E=void 0;k.length&&(k.length>1?(E=i.createNodeGroup(k[0],k,x),_.add(64),0===y.length&&k.every(function(e){return"right"===e.float})&&_.add(512)):(E=k[0]).parent=x),E&&(w.push(E),E=void 0),y.length&&(y.length>1?E=i.createNodeGroup(y[0],y,x):(E=y[0]).parent=x),E&&w.push(E),x.init(),_.itemCount=w.length,this.addRenderLayout(_);for(var T=w,I=0;I<T.length;I++){var B=T[I];B.groupParent||(B=i.createNodeGroup(B,[B],x)),this.addRenderLayout(new S(x,B,n.containerType,128|n.alignmentType,B.children))}}}}return e}},{key:"insertNode",value:function(e,t){var i;return"#text"===e.nodeName?(q.isPlainText(e,!0)||G.isParentStyle(e,"whiteSpace","pre","pre-wrap"))&&(i=this.createNode(e),t&&i.inherit(t,"textStyle"),i.cssApply({position:"static",display:"inline",verticalAlign:"baseline",cssFloat:"none",clear:"none"})):(!this.controllerHandler.localSettings.svg.enabled||e.parentElement instanceof HTMLElement)&&(this.controllerHandler.applyDefaultStyles(e),i=this.createNode(e),!this.controllerHandler.localSettings.unsupported.excluded.has(e.tagName)&&this.conditionElement(e)?this.userSettings.exclusionsDisabled||i.setExclusions():(i.visible=!1,i.excluded=!0)),i}},{key:"conditionElement",value:function(e){if(G.hasComputedStyle(e)){if(X.isElementVisible(e,!0)||e.dataset.use)return!0;for(var t=e.parentElement,i=!0;t;){if("none"===G.getStyle(t).display){i=!1;break}t=t.parentElement}if(i)for(var n=0;n<e.children.length;n++)if(X.isElementVisible(e.children[n],!0))return!0;return!1}return q.isPlainText(e)}},{key:"createLayoutControl",value:function(e,t){return new S(e,t,t.containerType,t.alignmentType,t.children)}},{key:"setStyleMap",value:function(){e:for(var e=0;e<document.styleSheets.length;e++){var t=document.styleSheets[e];if(t.cssRules)for(var i=0;i<t.cssRules.length;i++){var n=t.cssRules[i];try{switch(n.type){case CSSRule.STYLE_RULE:this.applyStyleRule(n);break;case CSSRule.MEDIA_RULE:for(var r=/(?:(not|only)?\s*(?:all|screen) and )?((?:\([^)]+\)(?: and )?)+),?\s*/g,a=void 0,o=!1;!o&&null!==(a=r.exec(n.conditionText));){for(var s="not"===a[1],l=/\(([a-z\-]+)\s*(:|<?=?|=?>?)?\s*([\w.%]+)?\)(?: and )?/g,c=void 0,h=!1;!o&&null!==(c=l.exec(a[2]));){var u=c[1],d=void 0;d=c[1].startsWith("min")?">=":c[1].startsWith("max")?"<=":a[2];var f=c[3];switch(u){case"aspect-ratio":case"min-aspect-ratio":case"max-aspect-ratio":var v=g(V.replaceMap(f.split("/"),function(e){return parseInt(e)}),2);h=j(d,window.innerWidth/window.innerHeight,v[0]/v[1]);break;case"width":case"min-width":case"max-width":case"height":case"min-height":case"max-height":h=j(d,-1!==u.indexOf("width")?window.innerWidth:window.innerHeight,V.parseUnit(f,V.convertInt(G.getStyle(document.body).fontSize)));break;case"orientation":h="portrait"===f&&window.innerWidth<=window.innerHeight||"landscape"===f&&window.innerWidth>window.innerHeight;break;case"resolution":case"min-resolution":case"max-resolution":var p=parseFloat(f);f.endsWith("dpcm")?p*=2.54:(f.endsWith("dppx")||f.endsWith("x"))&&(p*=96),h=j(d,V.getDeviceDPI(),p);break;case"grid":h="0"===f;break;case"color":h=void 0===f||V.convertInt(f)>0;break;case"min-color":h=V.convertInt(f)<=screen.colorDepth/3;break;case"max-color":h=V.convertInt(f)>=screen.colorDepth/3;break;case"color-index":case"min-color-index":case"monochrome":case"min-monochrome":h="0"===f;break;case"max-color-index":case"max-monochrome":h=V.convertInt(f)>=0;break;default:h=!1}if(!h)break}(!s&&h||s&&!h)&&(o=!0)}if(o)for(var m=n.cssRules,y=0;y<m.length;y++)this.applyStyleRule(m[y])}}catch(e){alert("External CSS files cannot be parsed with some browsers when loading HTML pages directly from your hard drive. Either use a local web server, embed your CSS into a <style> element, or you can also try a different browser. See the README for more detailed instructions.\n\n"+"".concat(t.href,"\n\n").concat(e));break e}}}}},{key:"applyStyleRule",value:function(e){for(var t=this,i=[],n=Array.from(e.style),r=0;r<n.length;r++){i.push(V.convertCamelCase(n[r]))}document.querySelectorAll(e.selectorText).forEach(function(n){for(var r=G.getStyle(n),a=V.parseUnit(r.fontSize),o={},s=i,l=0;l<s.length;l++){var c=s[l],h=G.checkStyleValue(n,c,e.style[c],r,a);h&&(o[c]=h)}if(t.userSettings.preloadImages&&o.backgroundImage&&"initial"!==o.backgroundImage){var u=o.backgroundImage.split(V.REGEXP_COMPILED.SEPARATOR),d=Array.isArray(u),f=0;for(u=d?u:u[Symbol.iterator]();;){var g;if(d){if(f>=u.length)break;g=u[f++]}else{if((f=u.next()).done)break;g=f.value}var v=G.resolveURL(g.trim());""===v||t.session.image.has(v)||t.session.image.set(v,{width:0,height:0,uri:v})}}var p=X.getElementCache(n,"styleMap");p?Object.assign(p,o):(X.setElementCache(n,"style",r),X.setElementCache(n,"styleMap",o))})}},{key:"userSettings",set:function(e){this._userSettings=e},get:function(){return this._userSettings||{}}},{key:"viewData",get:function(){return[].concat(this._views,this._includes)}},{key:"sessionData",get:function(){return{cache:this.session.cache,templates:this.viewData}}},{key:"rendered",get:function(){return this.session.cache.filter(function(e){return e.visible&&e.rendered})}},{key:"nextId",get:function(){return this.processing.cache.nextId}},{key:"size",get:function(){return this.session.documentRoot.length}}]),e}(),Z=squared.lib.color,K=squared.lib.css,Q=squared.lib.dom,$=squared.lib.util,J=squared.lib.xml,ee=function(){function e(t,i){r(this,e),this.application=t,this.cache=i,this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}return o(e,[{key:"reset",value:function(){this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}},{key:"applyDefaultStyles",value:function(e){var t=this,i=Q.getElementCache(e,"styleMap")||{};if($.isUserAgent(8)&&void 0===i.display)switch(e.tagName){case"INPUT":case"TEXTAREA":case"SELECT":case"BUTTON":i.display="inline-block"}switch(e.tagName){case"INPUT":switch(e.type){case"file":var n=K.getStyle(e);if(void 0===Z.parseColor(n.backgroundColor||"")&&(i.backgroundColor="#DDDDDD","none"===n.borderStyle))for(var r=["borderTop","borderRight","borderBottom","borderLeft"],a=0;a<r.length;a++){var o=r[a];i["".concat(o,"Style")]="solid",i["".concat(o,"Color")]="#DDDDDD",i["".concat(o,"Width")]="2px"}}break;case"FORM":void 0===i.marginTop&&(i.marginTop="0px");break;case"IFRAME":void 0===i.display&&(i.display="block");case"IMG":var s=function(n,r){if(void 0===i[n]||"auto"===i[n]){var a=RegExp("\\s+".concat(n,'="([^"]+)"')).exec(e.outerHTML);if(a)i[n]=$.formatPX($.isPercent(a[1])?parseFloat(a[1])/100*(e.parentElement||e).getBoundingClientRect()[n]:a[1]);else if("IFRAME"===e.tagName)"width"===n?i.width="300px":i.height="150px";else if(void 0===i[r]||"auto"!==i[r]&&!$.isPercent(i[r])){var o=t.application.session.image.get(e.src);o&&o.width>0&&o.height>0&&(i[n]=$.formatPX(o[n]*(i[r]&&$.isLength(i[r])?parseFloat(i[r])/o[r]:1)))}}};s("width","height"),s("height","width")}Q.setElementCache(e,"styleMap",i)}},{key:"addBeforeOutsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._beforeOutside[e]&&(this._beforeOutside[e]=[]),-1!==i&&i<this._beforeOutside[e].length?this._beforeOutside[e].splice(i,0,t):this._beforeOutside[e].push(t)}},{key:"addBeforeInsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._beforeInside[e]&&(this._beforeInside[e]=[]),-1!==i&&i<this._beforeInside[e].length?this._beforeInside[e].splice(i,0,t):this._beforeInside[e].push(t)}},{key:"addAfterInsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._afterInside[e]&&(this._afterInside[e]=[]),-1!==i&&i<this._afterInside[e].length?this._afterInside[e].splice(i,0,t):this._afterInside[e].push(t)}},{key:"addAfterOutsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._afterOutside[e]&&(this._afterOutside[e]=[]),-1!==i&&i<this._afterOutside[e].length?this._afterOutside[e].splice(i,0,t):this._afterOutside[e].push(t)}},{key:"getBeforeOutsideTemplate",value:function(e){return this._beforeOutside[e]?J.pushIndentArray(this._beforeOutside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"getBeforeInsideTemplate",value:function(e){return this._beforeInside[e]?J.pushIndentArray(this._beforeInside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"getAfterInsideTemplate",value:function(e){return this._afterInside[e]?J.pushIndentArray(this._afterInside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"getAfterOutsideTemplate",value:function(e){return this._afterOutside[e]?J.pushIndentArray(this._afterOutside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"hasAppendProcessing",value:function(e){return void 0!==this._beforeOutside[e]||void 0!==this._beforeInside[e]||void 0!==this._afterInside[e]||void 0!==this._afterOutside[e]}},{key:"cascadeDocument",value:function(e,t){for(var i=t>0?"\t".repeat(t):"",n="",r=0;r<e.length;r++){var a=e[r];if(a){var o=a.node;switch(a.type){case 1:var s=a.controlName,l=a.attributes,c=i+"<".concat(s+(0===t?"{#0} ":"")+(this.userSettings.showAttributes?l?J.pushIndent(l,t+1):o.extractAttributes(t+1):""));if(o.renderTemplates){var h=t+1;c+=">\n"+this.getBeforeInsideTemplate(o.id,h)+this.cascadeDocument(this.sortRenderPosition(o,o.renderTemplates),h)+this.getAfterInsideTemplate(o.id,h)+i+"</".concat(s,">\n")}else c+=" />\n";n+=this.getBeforeOutsideTemplate(o.id,t)+c+this.getAfterOutsideTemplate(o.id,t);break;case 2:var u=a.content;u&&(n+=J.pushIndent(u,t))}}}return n}},{key:"getEnclosingTag",value:function(e,t){switch(e){case 1:var i=t.controlName,n=t.content;return"<"+i+(t.attributes||"")+(n?">\n"+n+"</"+i+">\n":" />\n")}return""}}]),e}(),te=squared.lib.css,ie=squared.lib.util,ne=function(){function e(t,i,n,a){r(this,e),this.name=t,this.framework=i,this.eventOnly=!1,this.preloaded=!1,this.documentBase=!1,this.options={},this.dependencies=[],this.subscribers=new Set,this.tagNames=Array.isArray(n)?ie.replaceMap(n,function(e){return e.trim().toUpperCase()}):[],a&&Object.assign(this.options,a)}return o(e,[{key:"is",value:function(e){return!!e.styleElement&&(0===this.tagNames.length||this.tagNames.includes(e.element.tagName))}},{key:"require",value:function(e){this.dependencies.push({name:e,preload:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}},{key:"included",value:function(e){return ie.includes(e.dataset.use,this.name)}},{key:"beforeInit",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.included(e))for(var t=Array.isArray(n=this.dependencies),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.preload){var a=this.application.extensionManager.retrieve(r.name);a&&!a.preloaded&&(a.beforeInit(e,!0),a.preloaded=!0)}}}},{key:"init",value:function(e){return!1}},{key:"afterInit",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.included(e))for(var t=Array.isArray(n=this.dependencies),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.preload){var a=this.application.extensionManager.retrieve(r.name);a&&a.preloaded&&(a.afterInit(e,!0),a.preloaded=!1)}}}},{key:"condition",value:function(e,t){return!!te.hasComputedStyle(e.element)&&(e.dataset.use?this.included(e.element):this.tagNames.length>0)}},{key:"processNode",value:function(e,t){}},{key:"processChild",value:function(e,t){}},{key:"addDescendant",value:function(e){var t=this.application.session.extensionMap.get(e.id)||[];t.includes(this)||t.push(this),this.application.session.extensionMap.set(e.id,t)}},{key:"postBaseLayout",value:function(e){}},{key:"postConstraints",value:function(e){}},{key:"postParseDocument",value:function(e){}},{key:"postProcedure",value:function(e){}},{key:"beforeParseDocument",value:function(){}},{key:"afterBaseLayout",value:function(){}},{key:"afterConstraints",value:function(){}},{key:"afterResources",value:function(){}},{key:"afterParseDocument",value:function(){}},{key:"beforeCascadeDocument",value:function(){}},{key:"afterFinalize",value:function(){}},{key:"installed",get:function(){return!!this.application.extensions&&this.application.extensions.has(this)}}],[{key:"findNestedElement",value:function(e,t){if(te.hasComputedStyle(e))for(var i=0;i<e.children.length;i++){var n=e.children[i];if(ie.includes(n.dataset.use,t))return n}return null}}]),e}(),re=squared.lib.util,ae=function(){function e(t){r(this,e),this.application=t}return o(e,[{key:"include",value:function(e){var t=this,i=this.retrieve(e.name);return i?(Array.isArray(e.tagNames)&&(i.tagNames=e.tagNames),Object.assign(i.options,e.options),!0):!(0!==e.framework&&!re.hasBit(e.framework,this.application.framework)||!e.dependencies.every(function(e){return!!t.retrieve(e.name)}))&&(e.application=this.application,this.application.extensions.add(e),!0)}},{key:"exclude",value:function(e){return this.application.extensions.delete(e)}},{key:"retrieve",value:function(e){for(var t=Array.isArray(n=this.application.extensions),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.name===e)return r}return null}},{key:"optionValue",value:function(e,i){var n=this.retrieve(e);if(n&&"object"===t(n.options))return n.options[i]}},{key:"optionValueAsObject",value:function(e,i){var n=this.optionValue(e,i);return"object"===t(n)?n:null}},{key:"optionValueAsString",value:function(e,t){var i=this.optionValue(e,t);return"string"==typeof i?i:""}},{key:"optionValueAsNumber",value:function(e,t){var i=this.optionValue(e,t);return"number"==typeof i?i:0}},{key:"optionValueAsBoolean",value:function(e,t){var i=this.optionValue(e,t);return"boolean"==typeof i&&i}}]),e}(),oe=squared.lib.util,se=function(){function e(t){r(this,e),this.resource=t,this.appName="",this.assets=[],t.fileHandler=this}return o(e,[{key:"addAsset",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(i||n){var r=this.assets.findIndex(function(i){return i.pathname===e&&i.filename===t});-1!==r?(this.assets[r].content=i,this.assets[r].uri=n):this.assets.push({pathname:e,filename:t,content:i,uri:n})}}},{key:"reset",value:function(){this.assets.length=0}},{key:"saveToDisk",value:function(t,i){if(location.protocol.startsWith("http")){if(t.length){var n=this.userSettings;oe.concatArray(t,this.assets),fetch("/api/savetodisk"+"?directory=".concat(encodeURIComponent(oe.trimString(n.outputDirectory,"/")))+(i?"&appname=".concat(encodeURIComponent(i.trim())):"")+"&filetype=".concat(n.outputArchiveFileType.toLowerCase())+"&processingtime=".concat((""+n.outputMaxProcessingTime).trim()),{method:"POST",headers:new Headers({Accept:"application/json, text/plain, */*","Content-Type":"application/json"}),body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(t){t&&(t.zipname?fetch("/api/downloadtobrowser?filename=".concat(encodeURIComponent(t.zipname))).then(function(e){return e.blob()}).then(function(i){return e.downloadToDisk(i,oe.fromLastIndexOf(t.zipname))}):t.system&&alert("".concat(t.application,"\n\n").concat(t.system)))}).catch(function(e){return alert("ERROR: ".concat(e))})}}else alert("SERVER (required): See README for instructions")}},{key:"stored",get:function(){return this.resource.stored}}],[{key:"downloadToDisk",value:function(e,t){var i=new Blob([e],{type:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")||"application/octet-stream"}),n=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=n,r.setAttribute("download",t),void 0===r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(function(){return window.URL.revokeObjectURL(n)},1)}}]),e}(),le=new Map([[2,"marginTop"],[4,"marginRight"],[8,"marginBottom"],[16,"marginLeft"],[32,"paddingTop"],[64,"paddingRight"],[128,"paddingBottom"],[256,"paddingLeft"]]),ce={ACCESSIBILITY:"squared.accessibility",CSS_GRID:"squared.css-grid",EXTERNAL:"squared.external",FLEXBOX:"squared.flexbox",GRID:"squared.grid",LIST:"squared.list",RELATIVE:"squared.relative",SPRITE:"squared.sprite",SUBSTITUTE:"squared.substitute",TABLE:"squared.table",VERTICAL_ALIGN:"squared.verticalalign",WHITESPACE:"squared.whitespace"},he=Object.freeze({CSS_SPACING:le,EXT_NAME:ce}),ue=squared.lib.css,de=squared.lib.dom,fe=squared.lib.element,ge=squared.lib.util,ve=["position","display","verticalAlign","cssFloat","clear","zIndex"],pe=Array.from(le.keys()),me=function(e){function i(e,t){var n;return r(this,i),(n=u(this,c(i).call(this))).id=e,n.alignmentType=0,n.depth=-1,n.siblingIndex=1/0,n.documentRoot=!1,n.visible=!0,n.excluded=!1,n.rendered=!1,n.baselineActive=!1,n.positioned=!1,n.controlId="",n._cached={},n._styleMap={},n._initial={iteration:-1,children:[],styleMap:{}},n._data={},n._excludeSection=0,n._excludeProcedure=0,n._excludeResource=0,n._element=null,t?(n._element=t,n.init()):n.style={},n}return l(i,squared.lib.base.Container),o(i,[{key:"init",value:function(){var e=this._element;if(e&&(de.setElementCache(e,"node",this),this.style=de.getElementCache(e,"style")||ue.getStyle(e,!1)),this.styleElement){for(var t=de.getElementCache(e,"styleMap")||{},i=parseInt(this.style.fontSize)||void 0,n=Array.from(e.style),r=0;r<n.length;r++){var a=n[r];a=ge.convertCamelCase(a);var o=ue.checkStyleValue(e,a,e.style[a],this.style,i);o&&(t[a]=o)}this._styleMap=Object.assign({},t)}}},{key:"saveAsInitial",value:function(){-1===this._initial.iteration&&(this._initial.children=this.duplicate(),this._initial.styleMap=Object.assign({},this._styleMap),this._initial.documentParent=this._documentParent),this._bounds&&(this._initial.bounds=de.assignRect(this._bounds),this._initial.linear=de.assignRect(this.linear),this._initial.box=de.assignRect(this.box)),this._initial.iteration++}},{key:"is",value:function(){for(var e=this,t=arguments.length,i=[],n=0;n<t;n++)i[n]=arguments[n];return i.some(function(t){return e.containerType===t})}},{key:"of",value:function(e){for(var t=this,i=arguments.length,n=[],r=1;r<i;r++)n[r-1]=arguments[r];return this.containerType===e&&n.some(function(e){return t.hasAlign(e)})}},{key:"unsafe",value:function(e){return this["_".concat(e)]||void 0}},{key:"attr",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r="__".concat(e);if(ge.hasValue(i)){if(void 0===this[r]&&(this._namespaces.add(e),this[r]={}),!n&&void 0!==this[r][t])return"";this[r][t]=""+i}return this[r][t]||""}},{key:"namespace",value:function(e){return this["__".concat(e)]||{}}},{key:"delete",value:function(e){var t="__".concat(e);if(this[t]){for(var i=arguments.length,n=[],r=1;r<i;r++)n[r-1]=arguments[r];for(var a=n,o=0;o<a.length;o++){var s=a[o];if(-1!==s.indexOf("*")){var l=ge.searchObject(this[t],s),c=Array.isArray(l),h=0;for(l=c?l:l[Symbol.iterator]();;){var u;if(c){if(h>=l.length)break;u=l[h++]}else{if((h=l.next()).done)break;u=h.value}var d=g(u,1);delete this[t][d[0]]}}else delete this[t][s]}}}},{key:"apply",value:function(e){for(var i in e){var n=e[i];if("object"===t(n)){for(var r in n)this.attr(i,r,n[r]);delete e[i]}}}},{key:"render",value:function(e){this.renderParent=e,this.rendered=!0}},{key:"renderEach",value:function(e){for(var t=0;t<this.renderChildren.length;t++)this.renderChildren[t].visible&&e(this.renderChildren[t],t,this.renderChildren);return this}},{key:"renderFilter",value:function(e){return ge.filterArray(this.renderChildren,e)}},{key:"hide",value:function(e){this.rendered=!0,this.visible=!1}},{key:"data",value:function(e,i,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return ge.hasValue(n)?(void 0===this._data[e]&&(this._data[e]={}),"object"===t(this._data[e])&&(r||void 0===this._data[e][i])&&(this._data[e][i]=n)):null===n&&delete this._data[e],void 0===this._data[e]||void 0===this._data[e][i]?void 0:this._data[e][i]}},{key:"unsetCache",value:function(){for(var e=arguments.length,t=[],i=0;i<e;i++)t[i]=arguments[i];if(t.length)for(var n=t,r=0;r<n.length;r++){var a=n[r];switch(a){case"position":return void(this._cached={});case"width":case"minWidth":this._cached.hasWidth=void 0;break;case"height":case"minHeight":this._cached.hasHeight=void 0;break;case"verticalAlign":this._cached.baseline=void 0;break;case"display":this._cached.inline=void 0,this._cached.inlineVertical=void 0,this._cached.inlineFlow=void 0,this._cached.block=void 0,this._cached.blockDimension=void 0,this._cached.blockStatic=void 0,this._cached.autoMargin=void 0;break;case"pageFlow":this._cached.positionAuto=void 0,this._cached.blockStatic=void 0,this._cached.baseline=void 0,this._cached.floating=void 0,this._cached.autoMargin=void 0,this._cached.rightAligned=void 0,this._cached.bottomAligned=void 0;break;default:a.startsWith("margin")&&(this._cached.autoMargin=void 0)}this._cached[a]=void 0}else this._cached={}}},{key:"ascend",value:function(){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=[],i=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.renderParent?"renderParent":"parent":"actualParent",n=this[i],r=-1;n&&0!==n.id&&!t.includes(n)&&(t.push(n),++r!==e);)n=n[i];return t}},{key:"cascade",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=f(c(i.prototype),"cascade",this).call(this);return e?ge.spliceArray(t,function(e){return null===e.element}):t}},{key:"inherit",value:function(e){for(var t=e.unsafe("initial"),i=arguments.length,n=[],r=1;r<i;r++)n[r-1]=arguments[r];for(var a=n,o=0;o<a.length;o++){switch(a[o]){case"initial":Object.assign(this._initial,t);break;case"base":this._documentParent=e.documentParent,this._bounds=de.assignRect(e.bounds),this._linear=de.assignRect(e.linear),this._box=de.assignRect(e.box);var s=e.actualParent;s&&this.css("direction",s.dir);break;case"alignment":for(var l=ve,c=0;c<l.length;c++){var h=l[c];this._styleMap[h]=e.css(h),this._initial.styleMap[h]=t.styleMap[h]}if(!this.positionStatic)for(var u=Array.isArray(f=ue.BOX_POSITION),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}var v=g;this._styleMap[v]=e.css(v),this._initial.styleMap[v]=t.styleMap[v]}if(e.autoMargin.horizontal||e.autoMargin.vertical)for(var p=Array.isArray(y=ue.BOX_MARGIN),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b;"auto"===e.cssInitial(k,!0)&&(this._styleMap[k]="auto"),"auto"===e.cssInitial(k)&&(this._initial.styleMap[k]="auto")}break;case"styleMap":ge.assignEmptyProperty(this._styleMap,e.unsafe("styleMap"));break;case"textStyle":this.cssApply({fontFamily:e.css("fontFamily"),fontSize:e.css("fontSize"),fontWeight:e.css("fontWeight"),color:e.css("color"),whiteSpace:e.css("whiteSpace"),opacity:e.css("opacity")})}}}},{key:"alignedVertically",value:function(e,t,i){var n=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.actualParent;if(this.lineBreak||void 0===a)return!0;if(this.pageFlow&&e.length){if(ge.isArray(t)&&this!==t[0]){if(i&&i.has(this))return!0;if(r&&this.floating&&(this.linear.top>=Math.floor(t[t.length-1].linear.bottom)||"left"===this.float&&void 0!==t.find(function(e){return e.siblingIndex<n.siblingIndex&&ge.withinRange(n.linear.left,e.linear.left)})||"right"===this.float&&void 0!==t.find(function(e){return e.siblingIndex<n.siblingIndex&&ge.withinRange(n.linear.right,e.linear.right)})))return!0}for(var o=Array.isArray(l=e),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}var h=c;if(h.blockStatic||this.blockStatic&&(!h.inlineFlow||i&&i.has(h))||i&&"both"===i.get(h)&&(!ge.isArray(t)||t[0]!==h)||!h.floating&&(this.blockStatic||!this.floating&&!this.inlineFlow||t&&"inline-block"===this.display&&this.linear.top>=Math.floor(t[t.length-1].linear.bottom))||h.bounds.width>(a.has("width",2)?a.width:a.box.width)&&(!h.textElement||h.textElement&&"nowrap"===h.css("whiteSpace"))||h.lineBreak||h.autoMargin.leftRight||"left"===h.float&&this.autoMargin.right||"right"===h.float&&this.autoMargin.left)return!0}}return!1}},{key:"intersectX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return e.top>=t.top&&e.top<t.bottom||e.bottom>t.top&&e.bottom<=t.bottom||t.top>=e.top&&t.bottom<=e.bottom||e.top>=t.top&&e.bottom<=t.bottom}},{key:"intersectY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return e.left>=t.left&&e.left<t.right||e.right>t.left&&e.right<=t.right||t.left>=e.left&&t.right<=e.right||e.left>=t.left&&e.right<=t.right}},{key:"withinX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.top)>=Math.floor(e.top)&&Math.floor(t.bottom)<=Math.ceil(e.bottom)}},{key:"withinY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.left)>=Math.floor(e.left)&&Math.floor(t.right)<=Math.ceil(e.right)}},{key:"outsideX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.left)<Math.floor(e.left)||Math.ceil(t.left)>=Math.floor(e.right)}},{key:"outsideY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.top)<Math.floor(e.top)||Math.ceil(t.top)>=Math.floor(e.bottom)}},{key:"css",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return arguments.length>=2&&(this._styleMap[e]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t&&this.unsetCache(e)),this._styleMap[e]||this.style&&this.style[e]||""}},{key:"cssApply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object.assign(this._styleMap,e),t)for(var i in e)this.unsetCache(i);return this}},{key:"cssInitial",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];-1!==this._initial.iteration||t||(i=!0);var n=t?this._styleMap[e]:this._initial.styleMap[e];return i&&!ge.hasValue(n)&&(n=this.style[e]),n||""}},{key:"cssAny",value:function(e){for(var t=arguments.length,i=[],n=1;n<t;n++)i[n-1]=arguments[n];for(var r=i,a=0;a<r.length;a++){var o=r[a];if(this.css(e)===o)return!0}return!1}},{key:"cssInitialAny",value:function(e){for(var t=arguments.length,i=[],n=1;n<t;n++)i[n-1]=arguments[n];for(var r=i,a=0;a<r.length;a++){var o=r[a];if(this.cssInitial(e)===o)return!0}return!1}},{key:"cssAscend",value:function(e){for(var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this:this.actualParent;n;){if(""!==(i=n.cssInitial(e))){if(!t||n.visible)break;i=""}if(n.documentBody)break;n=n.actualParent}return i}},{key:"cssSort",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.duplicate():this.children;return i.sort(function(i,n){var r=i.toFloat(e),a=n.toFloat(e);return r===a?0:t?r>=a?1:-1:r<=a?1:-1}),i}},{key:"cssPX",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this._styleMap[e];if(r&&ge.isLength(r)){t+=ge.parseUnit(r,this.fontSize),!i&&t<0&&(t=0);var a=ge.formatPX(t);return this.css(e,a),n&&this.unsetCache(e),a}return""}},{key:"cssTry",value:function(e,t){if(this.styleElement){var i=this._element,n=this.css(e);if(i.style[e]=t,i.style[e]===t)return de.setElementCache(i,e,n),!0}return!1}},{key:"cssFinally",value:function(e){if(this.styleElement){var t=this._element,i=de.getElementCache(t,e);if(i)return t.style[e]=i,de.deleteElementCache(t,e),!0}return!1}},{key:"toInt",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=parseInt((arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._initial.styleMap:this._styleMap)[e]);return isNaN(i)?t:i}},{key:"toFloat",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=parseFloat((arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._initial.styleMap:this._styleMap)[e]);return isNaN(i)?t:i}},{key:"parseUnit",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(ge.isPercent(e)){var n=i&&this.absoluteParent||this,r=t?"width":"height";return parseFloat(e)/100*(n.has(r,2)?n.toFloat(r):n[i?"box":"bounds"][r])}return ge.parseUnit(e,this.fontSize)}},{key:"convertPX",value:function(e){return"".concat(Math.round(this.parseUnit(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2])),"px")}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=(i&&"initial"===i.map?this._initial.styleMap:this._styleMap)[e];if(ge.hasValue(n))switch(n){case"0px":if(ge.hasBit(t,64))return!0;switch(e){case"top":case"right":case"bottom":case"left":return!0}case"left":if(ge.hasBit(t,8))return!0;case"baseline":if(ge.hasBit(t,16))return!0;case"auto":if(ge.hasBit(t,4))return!0;case"none":case"initial":case"unset":case"normal":case"transparent":case"rgba(0, 0, 0, 0)":return!1;default:if(i&&i.not)if(Array.isArray(i.not))for(var r=Array.isArray(o=i.not),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}if(n===s)return!1}else if(n===i.not)return!1;return!(!ge.hasBit(t,2)||!ge.isLength(n))||(!(!ge.hasBit(t,32)||!ge.isPercent(n))||!ge.hasBit(t,4)&&0===t)}return!1}},{key:"hasAlign",value:function(e){return ge.hasBit(this.alignmentType,e)}},{key:"hasProcedure",value:function(e){return!ge.hasBit(this.excludeProcedure,e)}},{key:"hasResource",value:function(e){return!ge.hasBit(this.excludeResource,e)}},{key:"hasSection",value:function(e){return!ge.hasBit(this.excludeSection,e)}},{key:"exclude",value:function(e){var t=e.section,i=void 0===t?0:t,n=e.procedure,r=void 0===n?0:n,a=e.resource,o=void 0===a?0:a;i>0&&!ge.hasBit(this._excludeSection,i)&&(this._excludeSection|=i),r>0&&!ge.hasBit(this._excludeProcedure,r)&&(this._excludeProcedure|=r),o>0&&!ge.hasBit(this._excludeResource,o)&&(this._excludeResource|=o)}},{key:"setExclusions",value:function(){var e=this;if(this.styleElement){var t=this.actualParent;if(t){var i=function(i,n){var r=e.dataset["exclude".concat(i)]||"";if(t.dataset["exclude".concat(i,"Child")]&&(r+=(""!==r?"|":"")+t.dataset["exclude".concat(i,"Child")]),""!==r){var a=0,o=r.split("|"),l=Array.isArray(o),c=0;for(o=l?o:o[Symbol.iterator]();;){var h;if(l){if(c>=o.length)break;h=o[c++]}else{if((c=o.next()).done)break;h=c.value}var u=h;n[u=u.trim().toUpperCase()]&&!ge.hasBit(a,n[u])&&(a|=n[u])}a>0&&e.exclude(s({},i.toLowerCase(),a))}};i("Section",m),i("Procedure",b),i("Resource",y)}}}},{key:"setBounds",value:function(){if(this.styleElement){if(this._bounds=de.assignRect(this._element.getBoundingClientRect()),this.documentBody){var e=this.marginTop;if(e>0){var t=this.firstChild;t&&t.blockStatic&&!t.lineBreak&&t.marginTop>=e&&(e=0)}this._bounds.top=e}}else if(this.plainText){var i=de.getRangeClientRect(this._element);this._bounds=de.assignRect(i),this._cached.multiline=i.multiline>0}}},{key:"appendTry",value:function(e,t){for(var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!1,r=0;r<this.length;r++)if(this.children[r]===e){t.siblingIndex=e.siblingIndex,this.children[r]=t,t.parent=this,t.innerChild=e,n=!0;break}return i&&(t.parent=this,n=!0),n&&this.each(function(e,t){return e.siblingIndex=t}),n}},{key:"modifyBox",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0!==t){var n=le.get(e);n&&(null===t||!i&&0===this._boxAdjustment[n]&&t<0?this._boxReset[n]=1:(this._boxAdjustment[n]+=t,!i&&this._boxAdjustment[n]<0&&(this._boxAdjustment[n]=0)))}}},{key:"valueBox",value:function(e){var t=le.get(e);return t?[this._boxReset[t],this._boxAdjustment[t]]:[0,0]}},{key:"resetBox",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,r){for(var a=0;a<e.length;a++){i._boxReset[e[a]]=1;var o=le.get(pe[a+r]),s=i[o];t&&0!==s&&(t.naturalElement||0!==t[o]?t.modifyBox(pe[a+(n?0:4)],s):t.css(o,ge.formatPX(s),!0))}};ge.hasBit(e,30)&&r(ue.BOX_MARGIN,0),ge.hasBit(e,480)&&r(ue.BOX_PADDING,4)}},{key:"inheritBox",value:function(e,t){var i=this,n=function(e,n){for(var r=0;r<e.length;r++){var a=i._boxAdjustment[e[r]];a>0&&(t.modifyBox(pe[r+n],a,!1),i._boxAdjustment[e[r]]=0)}};ge.hasBit(e,30)&&n(ue.BOX_MARGIN,0),ge.hasBit(e,480)&&n(ue.BOX_PADDING,4)}},{key:"previousSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],r=null;if(this._element)r=this._element.previousSibling;else if(this._initial.children.length){var a=ge.filterArray(this._initial.children,function(e){return e.pageFlow});r=a.length&&a[0].element?a[0].element.previousSibling:null}for(;r;){var o=de.getElementAsNode(r);if(o)if(e&&o.lineBreak||t&&o.excluded)n.push(o);else if(!o.excluded&&o.pageFlow&&(n.push(o),!i||(o.visible||o.rendered)&&!o.floating))break;r=r.previousSibling}return n}},{key:"nextSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],r=null;if(this._element)r=this._element.nextSibling;else if(this._initial.children.length){var a=ge.filterArray(this._initial.children,function(e){return e.pageFlow});if(a.length){var o=a[a.length-1];r=o.element&&o.element.nextSibling}}for(;r;){var s=de.getElementAsNode(r);if(s){if(!s.naturalElement)break;if(e&&s.lineBreak||t&&s.excluded)n.push(s);else if(!s.excluded&&s.pageFlow&&(n.push(s),!i||(s.visible||s.rendered)&&!s.floating))break}r=r.nextSibling}return n}},{key:"actualRight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"linear";return(this.companion&&!this.companion.visible&&this.companion[e].right>this[e].right?this.companion:this)[e].right}},{key:"setDimensions",value:function(e){var t=this.unsafe(e);if(t){if(t.width=this.bounds.width,t.height=t.bottom-t.top,this.styleElement)switch(e){case"linear":t.width+=(this.marginLeft>0?this.marginLeft:0)+this.marginRight;break;case"box":t.width-=this.contentBoxWidth}void 0===this._initial[e]&&(this._initial[e]=de.assignRect(t))}}},{key:"convertPosition",value:function(e){var t=0;if(!this.positionStatic){var i=this.cssInitial(e);(ge.isLength(i)||ge.isPercent(i))&&(t=ge.convertFloat(this.convertLength(e,i,"left"===e||"right"===e)))}return t}},{key:"convertBox",value:function(e,t){var i=e+t;return ge.convertFloat(this.convertLength(i,this.css(i),"Left"===t||"Right"===t))}},{key:"convertLength",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return ge.isPercent(t)?ge.isLength(this.style[e])?this.style[e]:this.convertPX(t,i,n):t}},{key:"parent",set:function(e){e&&(e!==this._parent&&(this._parent&&this._parent.remove(this),this._parent=e),e.contains(this)||e.append(this),-1===this.depth&&(this.depth=e.depth+1))},get:function(){return this._parent}},{key:"tagName",set:function(e){this._cached.tagName=e.toUpperCase()},get:function(){if(void 0===this._cached.tagName){var e=this._element,t="";e&&(t="#text"===e.nodeName?"PLAINTEXT":"INPUT"===e.tagName?e.type:e.tagName),this._cached.tagName=t.toUpperCase()}return this._cached.tagName}},{key:"element",get:function(){if(!this.naturalElement&&this.innerChild){var e=this.innerChild.unsafe("element");if(e)return e}return this._element}},{key:"elementId",get:function(){return this._element&&this._element.id||""}},{key:"htmlElement",get:function(){return void 0===this._cached.htmlElement&&(this._cached.htmlElement=this._element instanceof HTMLElement),this._cached.htmlElement}},{key:"svgElement",get:function(){return null!==this._element&&"svg"===this._element.tagName}},{key:"styleElement",get:function(){return ue.hasComputedStyle(this._element)}},{key:"naturalElement",get:function(){return void 0===this._cached.naturalElement&&(this._cached.naturalElement=null!==this._element&&"__css.placeholder"!==this._element.className),this._cached.naturalElement}},{key:"imageElement",get:function(){return"IMG"===this.tagName}},{key:"flexElement",get:function(){return"flex"===this.display||"inline-flex"===this.display}},{key:"gridElement",get:function(){return"grid"===this.display}},{key:"textElement",get:function(){return this.plainText||this.inlineText}},{key:"tableElement",get:function(){return"TABLE"===this.tagName||"table"===this.display}},{key:"inputElement",get:function(){return null!==this._element&&"INPUT"===this._element.tagName}},{key:"groupParent",get:function(){return!1}},{key:"plainText",get:function(){return"PLAINTEXT"===this.tagName}},{key:"lineBreak",get:function(){return"BR"===this.tagName}},{key:"documentBody",get:function(){return this._element===document.body}},{key:"bounds",get:function(){return this._bounds||de.newRectDimension()}},{key:"linear",get:function(){if(void 0===this._linear&&this._bounds){if(this._element){var e=this._bounds;this._linear={top:e.top-(this.marginTop>0?this.marginTop:0),right:e.right+this.marginRight,bottom:e.bottom+this.marginBottom,left:e.left-(this.marginLeft>0?this.marginLeft:0),width:0,height:0}}else this._linear=de.assignRect(this._bounds);this.setDimensions("linear")}return this._linear||de.newRectDimension()}},{key:"box",get:function(){if(void 0===this._box&&this._bounds){if(this._element){var e=this._bounds;this._box={top:e.top+(this.paddingTop+this.borderTopWidth),right:e.right-(this.paddingRight+this.borderRightWidth),bottom:e.bottom-(this.paddingBottom+this.borderBottomWidth),left:e.left+(this.paddingLeft+this.borderLeftWidth),width:0,height:0}}else this._box=de.assignRect(this._bounds);this.setDimensions("box")}return this._box||de.newRectDimension()}},{key:"renderAs",set:function(e){this.rendered||!e||e.rendered||(this._renderAs=e)},get:function(){return this._renderAs}},{key:"dataset",get:function(){return this.htmlElement?this._element.dataset:{}}},{key:"excludeSection",get:function(){return this._excludeSection}},{key:"excludeProcedure",get:function(){return this._excludeProcedure}},{key:"excludeResource",get:function(){return this._excludeResource}},{key:"extensions",get:function(){return void 0===this._cached.extensions&&(this._cached.extensions=this.dataset.use?ge.spliceArray(this.dataset.use.split(/\s*,\s*/),function(e){return""===e}):[]),this._cached.extensions}},{key:"flexbox",get:function(){if(void 0===this._cached.flexbox){var e=this.actualParent;this._cached.flexbox={wrap:this.css("flexWrap"),direction:this.css("flexDirection"),alignSelf:!this.has("alignSelf")&&e&&e.has("alignItems")?e.css("alignItems"):this.css("alignSelf"),justifyContent:this.css("justifyContent"),basis:this.css("flexBasis"),order:this.toInt("order"),grow:this.toInt("flexGrow"),shrink:this.toInt("flexShrink")}}return this._cached.flexbox}},{key:"width",get:function(){if(void 0===this._cached.width){for(var e=0,t=[this._styleMap.width,this._styleMap.minWidth],i=0;i<t.length;i++){var n=t[i];if((ge.isLength(n)||ge.isPercent(n))&&(e=this.parseUnit(n))>0)break}this._cached.width=e}return this._cached.width}},{key:"height",get:function(){if(void 0===this._cached.height){for(var e=0,t=[this._styleMap.height,this._styleMap.minHeight],i=0;i<t.length;i++){var n=t[i];if((ge.isLength(n)||this.hasHeight&&ge.isPercent(n))&&(e=this.parseUnit(n,!1))>0)break}this._cached.height=e}return this._cached.height}},{key:"hasWidth",get:function(){if(void 0===this._cached.hasWidth){var e=this.cssInitial("width",!0);this._cached.hasWidth=!this.inlineStatic&&(ge.isPercent(e)?parseFloat(e)>0:!!(ge.isLength(e)&&"0px"!==e||this.toInt("minWidth")>0))}return this._cached.hasWidth}},{key:"hasHeight",get:function(){var e=this;if(void 0===this._cached.hasHeight){var t=this.cssInitial("height",!0);this._cached.hasHeight=function(){if(e.inlineStatic)return!1;if(ge.isPercent(t)){var i=e.actualParent;if(i&&i.hasHeight)return parseFloat(t)>0}else if(ge.isLength(t)&&"0px"!==t||e.toFloat("minHeight")>0)return!0;return!1}()}return this._cached.hasHeight}},{key:"lineHeight",get:function(){if(void 0===this._cached.lineHeight){var e=ge.convertFloat(this.cssAscend("lineHeight",!0));this._cached.lineHeight=this.has("lineHeight")||e>this.actualHeight||this.block&&this.actualChildren.some(function(e){return e.textElement})?e:0}return this._cached.lineHeight}},{key:"display",get:function(){return this.css("display")}},{key:"position",get:function(){return this.css("position")}},{key:"positionStatic",set:function(e){this._cached.positionStatic=e,this.unsetCache("pageFlow")},get:function(){if(void 0===this._cached.positionStatic)switch(this.position){case"fixed":case"absolute":this._cached.positionStatic=!1;break;case"sticky":case"relative":this._cached.positionStatic=0===this.toInt("top")&&0===this.toInt("right")&&0===this.toInt("bottom")&&0===this.toInt("left");break;case"inherit":var e=this._element?ue.getParentAttribute(this._element.parentElement,"position"):"";this._cached.positionStatic=""!==e&&!("absolute"===e||"fixed"===e);break;default:this._cached.positionStatic=!0}return this._cached.positionStatic}},{key:"positionRelative",get:function(){if(void 0===this._cached.positionRelative){var e=this.position;this._cached.positionRelative="relative"===e||"sticky"===e}return this._cached.positionRelative}},{key:"positionAuto",get:function(){if(void 0===this._cached.positionAuto){var e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap;this._cached.positionAuto=!(this.pageFlow||"auto"!==e.top&&e.top||"auto"!==e.right&&e.right||"auto"!==e.bottom&&e.bottom||"auto"!==e.left&&e.left)}return this._cached.positionAuto}},{key:"top",get:function(){return void 0===this._cached.top&&(this._cached.top=this.convertPosition("top")),this._cached.top}},{key:"right",get:function(){return void 0===this._cached.right&&(this._cached.right=this.convertPosition("right")),this._cached.right}},{key:"bottom",get:function(){return void 0===this._cached.bottom&&(this._cached.bottom=this.convertPosition("bottom")),this._cached.bottom}},{key:"left",get:function(){return void 0===this._cached.left&&(this._cached.left=this.convertPosition("left")),this._cached.left}},{key:"marginTop",get:function(){return void 0===this._cached.marginTop&&(this._cached.marginTop=this.inlineStatic&&!this.baselineActive?0:this.convertBox("margin","Top")),this._cached.marginTop}},{key:"marginRight",get:function(){return void 0===this._cached.marginRight&&(this._cached.marginRight=this.convertBox("margin","Right")),this._cached.marginRight}},{key:"marginBottom",get:function(){return void 0===this._cached.marginBottom&&(this._cached.marginBottom=this.inlineStatic&&!this.baselineActive?0:this.convertBox("margin","Bottom")),this._cached.marginBottom}},{key:"marginLeft",get:function(){return void 0===this._cached.marginLeft&&(this._cached.marginLeft=this.convertBox("margin","Left")),this._cached.marginLeft}},{key:"borderTopWidth",get:function(){return void 0===this._cached.borderTopWidth&&(this._cached.borderTopWidth=this.styleElement&&"none"!==this.css("borderTopStyle")?ge.convertInt(this.css("borderTopWidth")):0),this._cached.borderTopWidth}},{key:"borderRightWidth",get:function(){return void 0===this._cached.borderRightWidth&&(this._cached.borderRightWidth=this.styleElement&&"none"!==this.css("borderRightStyle")?ge.convertInt(this.css("borderRightWidth")):0),this._cached.borderRightWidth}},{key:"borderBottomWidth",get:function(){return void 0===this._cached.borderBottomWidth&&(this._cached.borderBottomWidth=this.styleElement&&"none"!==this.css("borderBottomStyle")?ge.convertInt(this.css("borderBottomWidth")):0),this._cached.borderBottomWidth}},{key:"borderLeftWidth",get:function(){return void 0===this._cached.borderLeftWidth&&(this._cached.borderLeftWidth=this.styleElement&&"none"!==this.css("borderLeftStyle")?ge.convertInt(this.css("borderLeftWidth")):0),this._cached.borderLeftWidth}},{key:"paddingTop",get:function(){if(void 0===this._cached.paddingTop){for(var e=0,t=Array.isArray(n=this.children),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(!a.inline){e=0;break}e=Math.max(e,a.paddingTop)}this._cached.paddingTop=Math.max(0,this.convertBox("padding","Top")-e)}return this._cached.paddingTop}},{key:"paddingRight",get:function(){return void 0===this._cached.paddingRight&&(this._cached.paddingRight=this.convertBox("padding","Right")),this._cached.paddingRight}},{key:"paddingBottom",get:function(){if(void 0===this._cached.paddingBottom){for(var e=0,t=Array.isArray(n=this.children),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(!a.inline){e=0;break}e=Math.max(e,a.paddingBottom)}this._cached.paddingBottom=Math.max(0,this.convertBox("padding","Bottom")-e)}return this._cached.paddingBottom}},{key:"paddingLeft",get:function(){return void 0===this._cached.paddingLeft&&(this._cached.paddingLeft=this.convertBox("padding","Left")),this._cached.paddingLeft}},{key:"contentBoxWidth",get:function(){return this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth}},{key:"contentBoxHeight",get:function(){return this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth}},{key:"inline",get:function(){if(void 0===this._cached.inline){var e=this.display;this._cached.inline="inline"===e||("initial"===e||"unset"===e)&&fe.ELEMENT_INLINE.includes(this.tagName)}return this._cached.inline}},{key:"inlineStatic",get:function(){return void 0===this._cached.inlineStatic&&(this._cached.inlineStatic=this.inline&&!this.floating&&!this.imageElement),this._cached.inlineStatic}},{key:"inlineVertical",get:function(){if(void 0===this._cached.inlineVertical){var e=this.display;this._cached.inlineVertical=(e.startsWith("inline")||"table-cell"===e)&&!this.floating&&!this.plainText}return this._cached.inlineVertical}},{key:"inlineText",set:function(e){this._cached.inlineText=e},get:function(){if(void 0===this._cached.inlineText){var e=!1;if(this.htmlElement&&!this.svgElement){var t=this._element;switch(t.tagName){case"INPUT":case"BUTTON":case"IMG":case"SELECT":case"TEXTAREA":case"HR":break;default:if(fe.hasFreeFormText(t)){e=!0;for(var i=0;i<t.children.length;i++){var n=de.getElementAsNode(t.children[i]);if(void 0!==n&&!n.excluded&&!n.dataset.target){e=!1;break}}}else 0!==t.children.length||t.textContent||(e=!0)}}this._cached.inlineText=e}return this._cached.inlineText}},{key:"block",get:function(){if(void 0===this._cached.block){var e=this.display;this._cached.block="block"===e||"list-item"===e||"initial"===e&&fe.ELEMENT_BLOCK.includes(this.tagName)}return this._cached.block}},{key:"blockStatic",get:function(){return void 0===this._cached.blockStatic&&(this._cached.blockStatic=(this.block||this.gridElement||"flex"===this.display)&&this.pageFlow&&(!this.floating||"100%"===this.cssInitial("width"))),this._cached.blockStatic}},{key:"blockDimension",get:function(){if(void 0===this._cached.blockDimension){var e=this.display;this._cached.blockDimension=this.block||"inline-block"===e||"table-cell"===e||"inline-flex"===e}return this._cached.blockDimension}},{key:"pageFlow",get:function(){return void 0===this._cached.pageFlow&&(this._cached.pageFlow=this.positionStatic||this.positionRelative),this._cached.pageFlow}},{key:"inlineFlow",get:function(){if(void 0===this._cached.inlineFlow){var e=this.display;this._cached.inlineFlow=this.inline||e.startsWith("inline")||"table-cell"===e||this.imageElement||this.floating}return this._cached.inlineFlow}},{key:"rightAligned",get:function(){return void 0===this._cached.rightAligned&&(this._cached.rightAligned="right"===this.float||this.autoMargin.left||!this.pageFlow&&this.has("right")),this._cached.rightAligned||this.hasAlign(512)}},{key:"bottomAligned",get:function(){return void 0===this._cached.bottomAligned&&(this._cached.bottomAligned=!this.pageFlow&&this.has("bottom")&&this.bottom>=0),this._cached.bottomAligned}},{key:"autoMargin",get:function(){if(void 0===this._cached.autoMargin)if(!this.pageFlow||this.blockStatic||"table"===this.display){var e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap,t="auto"===e.marginLeft&&(this.pageFlow||this.has("right")),i="auto"===e.marginRight&&(this.pageFlow||this.has("left")),n="auto"===e.marginTop&&(this.pageFlow||this.has("bottom")),r="auto"===e.marginBottom&&(this.pageFlow||this.has("top"));this._cached.autoMargin={horizontal:t||i,left:t&&!i,right:!t&&i,leftRight:t&&i,vertical:n||r,top:n&&!r,bottom:!n&&r,topBottom:n&&r}}else this._cached.autoMargin={horizontal:!1,left:!1,right:!1,leftRight:!1,top:!1,bottom:!1,vertical:!1,topBottom:!1};return this._cached.autoMargin}},{key:"floating",get:function(){if(void 0===this._cached.floating)if(this.pageFlow){var e=this.css("cssFloat");this._cached.floating="left"===e||"right"===e}else this._cached.floating=!1;return this._cached.floating}},{key:"float",get:function(){return void 0===this._cached.float&&(this._cached.float=this.floating?this.css("cssFloat"):"none"),this._cached.float}},{key:"zIndex",get:function(){return this.toInt("zIndex")}},{key:"textContent",get:function(){if(void 0===this._cached.textContent){var e=this._element,t="";this.htmlElement?t=e.textContent||e.innerText:this.plainText&&(t=e.textContent||""),this._cached.textContent=t}return this._cached.textContent}},{key:"overflow",set:function(e){0!==e&&16!==e&&8!==e&&24!==e||(this._cached.overflow=e)},get:function(){if(void 0===this._cached.overflow){var e=this._element,t=this.css("overflow"),i=this.css("overflowX"),n=this.css("overflowY"),r=0;this.hasWidth&&("scroll"===t||"scroll"===i||"auto"===i&&e&&e.clientWidth!==e.scrollWidth)&&(r|=8),this.hasHeight&&("scroll"===t||"scroll"===n||"auto"===n&&e&&e.clientHeight!==e.scrollHeight)&&(r|=16),this._cached.overflow=r}return this._cached.overflow}},{key:"overflowX",get:function(){return ge.hasBit(this.overflow,8)}},{key:"overflowY",get:function(){return ge.hasBit(this.overflow,16)}},{key:"baseline",set:function(e){this._cached.baseline=e},get:function(){if(void 0===this._cached.baseline){var e=this.verticalAlign,t=this.cssInitial("verticalAlign");this._cached.baseline=this.pageFlow&&!this.floating&&!this.svgElement&&("baseline"===e||"initial"===e||ge.isLength(t)&&0===parseInt(t))}return this._cached.baseline}},{key:"verticalAlign",get:function(){return this.css("verticalAlign")}},{key:"multiline",set:function(e){this._cached.multiline=e},get:function(){return void 0===this._cached.multiline&&(this._cached.multiline=!!(this.plainText||this.inlineText&&(this.inlineFlow||0===this.length))&&de.getRangeClientRect(this._element).multiline>0),this._cached.multiline}},{key:"visibleStyle",get:function(){if(void 0===this._cached.visibleStyle){var e=this.borderTopWidth>0||this.borderRightWidth>0||this.borderBottomWidth>0||this.borderLeftWidth>0,t=ge.REGEXP_COMPILED.URL.test(this.css("backgroundImage"))||ge.REGEXP_COMPILED.URL.test(this.css("background")),i=this.has("backgroundColor"),n=this.css("backgroundRepeat"),r=this.paddingLeft+this.paddingRight>0,a=this.paddingTop+this.paddingBottom>0;this._cached.visibleStyle={padding:r||a,paddingHorizontal:r,paddingVertical:a,background:e||t||i,borderWidth:e,backgroundImage:t,backgroundColor:i,backgroundRepeat:"no-repeat"!==n,backgroundRepeatX:"repeat"===n||"repeat-x"===n||n.startsWith("repeat "),backgroundRepeatY:"repeat"===n||"repeat-y"===n||n.endsWith(" repeat")}}return this._cached.visibleStyle}},{key:"preserveWhiteSpace",get:function(){if(void 0===this._cached.preserveWhiteSpace){var e=this.css("whiteSpace");this._cached.preserveWhiteSpace="pre"===e||"pre-wrap"===e}return this._cached.preserveWhiteSpace}},{key:"layoutHorizontal",get:function(){return this.hasAlign(8)}},{key:"layoutVertical",get:function(){return this.hasAlign(16)}},{key:"controlName",set:function(e){this.rendered&&void 0!==this._controlName||(this._controlName=e)},get:function(){return this._controlName||""}},{key:"documentParent",set:function(e){this._documentParent=e},get:function(){return this._documentParent||this.actualParent||this.parent||this}},{key:"absoluteParent",get:function(){var e=this.actualParent;if(!this.pageFlow)for(;e&&0!==e.id;){var t=e.cssInitial("position",!1,!0);if(e.documentBody||"static"!==t&&"initial"!==t&&"unset"!==t)return e;e=e.actualParent}return e}},{key:"actualParent",get:function(){return this._element&&this._element.parentElement?de.getElementAsNode(this._element.parentElement):void 0}},{key:"actualChildren",set:function(e){this._cached.actualChildren=e},get:function(){if(void 0===this._cached.actualChildren)if(this.htmlElement&&this.naturalElement){var e=[];this._element.childNodes.forEach(function(t){var i=de.getElementAsNode(t);i&&i.naturalElement&&e.push(i)}),this._cached.actualChildren=e}else this._cached.actualChildren=this.groupParent?this._initial.children:this.children;return this._cached.actualChildren}},{key:"actualWidth",get:function(){return this.has("width",2)&&"table-cell"!==this.display?this.toFloat("width"):this.bounds.width}},{key:"actualHeight",get:function(){return this.has("height",2)&&"table-cell"!==this.display?this.toFloat("height"):this.plainText?this.bounds.bottom-this.bounds.top:this.bounds.height}},{key:"actualDimension",get:function(){return{width:this.actualWidth,height:this.actualHeight}}},{key:"firstChild",get:function(){return this.htmlElement&&this.naturalElement&&this.actualChildren.length?this.actualChildren[0]:this.length?this.nodes[0]:void 0}},{key:"lastChild",get:function(){return this.htmlElement&&this.naturalElement&&this.actualChildren.length?this.actualChildren[this.actualChildren.length-1]:this.length?this.nodes[this.nodes.length-1]:void 0}},{key:"dir",get:function(){if(void 0===this._cached.dir)switch(this._cached.dir=this.css("direction"),this._cached.dir){case"unset":case"inherit":for(var e=this.actualParent;e&&0!==e.id;){var t=e.dir;if(""!==t){this._cached.dir=t;break}e=e.actualParent}this._cached.dir=document.body.dir}return this._cached.dir}},{key:"nodes",get:function(){return this.rendered?this.renderChildren:this.children}},{key:"center",get:function(){return{x:this.bounds.left+Math.floor(this.bounds.width/2),y:this.bounds.top+Math.floor(this.actualHeight/2)}}}]),i}(),ye=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,me),o(t,[{key:"init",value:function(){if(this.length){for(var e=1/0,t=Array.isArray(n=this.children),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;e=Math.min(e,a.siblingIndex),a.parent=this}this.siblingIndex===1/0&&(this.siblingIndex=e),this.parent&&this.parent.sort(x.siblingIndex),this.setBounds(),this.saveAsInitial();var o=this.actualParent;o&&this.css("direction",o.dir)}}},{key:"setBounds",value:function(){if(this.length){var e=x.outerRegion(this);this._bounds=Object.assign({},e,{width:e.right-e.left,height:e.bottom-e.top})}}},{key:"previousSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.item(0);return n?n.previousSiblings(e,t,i):[]}},{key:"nextSiblings",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.item();return n?n.nextSiblings(e,t,i):[]}},{key:"actualParent",get:function(){return x.actualParent(this._initial.children)}},{key:"firstChild",get:function(){var e=this.actualParent;if(e)for(var t=this.nodes,i=Array.isArray(r=e.actualChildren),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a;if(t.includes(o))return o}if(this._initial.children.length)return this._initial.children[0]}},{key:"lastChild",get:function(){var e=this.actualParent;if(e)for(var t=this.nodes,i=e.actualChildren,n=i.length-1;n>=0;n--){var r=i[n];if(t.includes(r))return r}if(this._initial.children.length)return this._initial.children[this._initial.children.length-1]}},{key:"inline",get:function(){return this.every(function(e){return e.inline})}},{key:"pageFlow",get:function(){return this.every(function(e){return e.pageFlow})}},{key:"inlineFlow",get:function(){return this.inlineStatic||this.hasAlign(128)}},{key:"inlineStatic",get:function(){return this.every(function(e){return e.inlineStatic})}},{key:"inlineVertical",get:function(){return this.every(function(e){return e.inlineVertical})}},{key:"block",get:function(){return this.some(function(e){return e.block})}},{key:"blockStatic",get:function(){return this.some(function(e){return e.blockStatic})}},{key:"blockDimension",get:function(){return this.some(function(e){return e.blockDimension})}},{key:"floating",get:function(){return this.every(function(e){return e.floating})}},{key:"float",get:function(){return this.floating?this.hasAlign(512)?"right":"left":"none"}},{key:"baseline",get:function(){var e=this.cssInitial("verticalAlign",!0);return""!==e?"baseline"===e:this.every(function(e){return e.baseline})}},{key:"multiline",get:function(){return this.some(function(e){return e.multiline})}},{key:"display",get:function(){return this.css("display")||this.some(function(e){return e.block})?"block":this.some(function(e){return e.blockDimension||e.inlineVertical})?"inline-block":"inline"}},{key:"groupParent",get:function(){return!0}}]),t}(),be=squared.lib.dom,ke=squared.lib.util,xe=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"afterInit",value:function(){for(var e=this,t=function(){if(i){if(n>=r.length)return"break";a=r[n++]}else{if((n=r.next()).done)return"break";a=n.value}var t=a;if(t.hasProcedure(b.ACCESSIBILITY)){var o=t.element;switch(o.tagName){case"INPUT":switch(o.type){case"image":t.extracted=[t];break;case"radio":case"checkbox":[be.getNextElementSibling(o),be.getPreviousElementSibling(o)].some(function(i){if(i){var n=be.getElementAsNode(i),r=i.parentElement&&"LABEL"===i.parentElement.tagName?be.getElementAsNode(i.parentElement):void 0;if(n&&n.visible&&n.pageFlow&&(ke.hasValue(i.htmlFor)&&i.htmlFor===o.id?t.companion=n:n.textElement&&r?(t.companion=n,r.renderAs=t):n.plainText&&(t.companion=n),t.companion))return e.options.showLabel||n.hide(),!0}return!1})}break;case"BUTTON":if(t.length){var s=t.filter(function(e){return!e.textElement});s.length&&(t.extracted=s),t.clear()}}}},i=Array.isArray(r=this.application.processing.cache),n=0,r=i?r:r[Symbol.iterator]();;){var a;if("break"===t())break}}}]),t}(),Ae=squared.lib.util,Se="[\\d.]+[a-z%]+|auto|max-content|min-content",_e="minmax\\(([^,]+), ([^)]+)\\)",we={UNIT:RegExp("^(".concat(Se,")$")),NAMED:"\\s*(repeat\\((auto-fit|auto-fill|[0-9]+), (.+)\\)|\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|".concat(Se,")\\s*"),REPEAT:"\\s*(\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|".concat(Se,")\\s*")};function Ee(e,t){for(var i=[],n=[],r=0;r<t.length;r++)e.repeat[r]?n.push(t[r]):i.push(t[r]);for(var a=e.count-i.length,o=[],s=0;s<e.count;s++){if(e.repeat[s]){for(var l=0,c=0;l<a;s++,l++,c++)c===n.length&&(c=0),o[s]=n[c];break}i.length&&(o[s]=i.shift())}return o}function Te(e,t){return Ae.isLength(t)?e.convertPX(t):t}function Ie(e){for(var t=0,i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}a&&t++}return t}var Be=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"condition",value:function(e){return e.gridElement&&e.length>0}},{key:"processNode",value:function(e){var i=Object.assign({},t.createDataAttribute(),{alignItems:e.css("alignItems"),alignContent:e.css("alignContent"),justifyItems:e.css("justifyItems"),justifyContent:e.css("justifyContent")}),n=e.css("gridAutoFlow"),r=-1!==n.indexOf("row"),a=-1!==n.indexOf("dense"),o=[],s=[],l=[],c={};if(i.row.gap=e.parseUnit(e.css("rowGap"),!1,!1),i.column.gap=e.parseUnit(e.css("columnGap"),!0,!1),[e.cssInitial("gridTemplateRows",!0),e.cssInitial("gridTemplateColumns",!0),e.css("gridAutoRows"),e.css("gridAutoColumns")].forEach(function(t,n){if(t&&"none"!==t&&"auto"!==t)for(var r,a=RegExp(we.NAMED,"g"),o=1;null!==(r=a.exec(t));)if(n<2){var s=i[0===n?"row":"column"];if(r[1].startsWith("repeat")){var l=1;switch(r[2]){case"auto-fit":s.autoFit=!0;break;case"auto-fill":s.autoFill=!0;break;default:l=Ae.convertInt(r[3])}if(l>0){for(var c=[],h=RegExp(we.REPEAT,"g"),u=void 0;null!==(u=h.exec(r[3]));){var d=void 0;null!==(d=/\[([\w\-\s]+)\]/.exec(u[1]))?(void 0===s.name[d[1]]&&(s.name[d[1]]=[]),c.push({name:d[1]})):null!==(d=RegExp(_e).exec(u[1]))?c.push({unit:Te(e,d[2]),unitMin:Te(e,d[1])}):null!==(d=/fit-content\(([\d.]+[a-z%]+)\)/.exec(u[1]))?c.push({unit:Te(e,d[1]),unitMin:"0px"}):null!==(d=RegExp(Se).exec(u[1]))&&c.push({unit:Te(e,d[0])})}if(c.length)for(var f=0;f<l;f++)for(var g=c,v=0;v<g.length;v++){var p=g[v];p.name?s.name[p.name].push(o):p.unit&&(s.unit.push(p.unit),s.unitMin.push(p.unitMin||""),s.repeat.push(!0),o++)}}}else"["===r[1].charAt(0)?(void 0===s.name[r[4]]&&(s.name[r[4]]=[]),s.name[r[4]].push(o)):r[1].startsWith("minmax")?(s.unit.push(Te(e,r[6])),s.unitMin.push(Te(e,r[5])),s.repeat.push(!1),o++):r[1].startsWith("fit-content")?(s.unit.push(Te(e,r[7])),s.unitMin.push("0px"),s.repeat.push(!1),o++):we.UNIT.test(r[1])&&(s.unit.push(Te(e,r[1])),s.unitMin.push(""),s.repeat.push(!1),o++)}else i[2===n?"row":"column"].auto.push(e.convertPX(r[1]))}),e.cssSort("order"),!e.has("gridTemplateAreas")&&e.every(function(e){return"auto"===e.css("gridRowStart")&&"auto"===e.css("gridColumnStart")})){var h,u=r?["top","bottom"]:["left","right"],d=0,f=0,g=0;e.each(function(e,t){(void 0===h||e.linear[u[0]]>=h.linear[u[1]]||f>0&&f===g)&&(g=Math.max(f,g),d++,f=1);var n=e.css("gridRowEnd"),a=e.css("gridColumnEnd"),o=1,s=1;if(n.startsWith("span")?o=parseInt(n.split(" ")[1]):Ae.isNumber(n)&&(o=parseInt(n)-d),a.startsWith("span")?s=parseInt(a.split(" ")[1]):Ae.isNumber(a)&&(s=parseInt(a)-f),1===f&&g>0){var c=r?[2,1,3]:[3,0,2],v=!1;do{for(var p=[].fill(1),m=l,y=0;y<m.length;y++){var b=m[y].placement;if(b[c[0]]>d)for(var k=b[c[1]];k<b[c[2]];k++)p[k-1]=0}for(var x=0,A=0,S=0;x<p.length;x++)if(p[x]){if(0===A&&(S=x),++A===s){f=S+1,v=!0;break}}else A=0;v||(i.emptyRows[d-1]=p,d++)}while(!v)}l[t]={placement:r?[d,f,d+o,f+s]:[f,d,f+s,d+o],rowSpan:o,columnSpan:s},f+=s,h=e})}else e.css("gridTemplateAreas").split(/"[\s\n]+"/).forEach(function(e,t){Ae.trimString(e.trim(),'"').split(" ").forEach(function(e,n){"."!==e&&(void 0===i.templateAreas[e]?i.templateAreas[e]={rowStart:t,rowSpan:1,columnStart:n,columnSpan:1}:(i.templateAreas[e].rowSpan=t-i.templateAreas[e].rowStart+1,i.templateAreas[e].columnSpan++))})}),e.each(function(e,t){for(var n=[e.css("gridRowStart"),e.css("gridColumnStart"),e.css("gridRowEnd"),e.css("gridColumnEnd")],r=[],a=1,o=1,s=0;s<n.length;s++){var c=n[s],h=i.templateAreas[c];if(h)switch(s){case 0:r[s]=h.rowStart+1;break;case 1:r[s]=h.columnStart+1;break;case 2:r[s]=h.rowStart+h.rowSpan+1;break;case 3:r[s]=h.columnStart+h.columnSpan+1}else{var u=/^([\w\-]+)-(start|end)$/.exec(c);if(u&&(h=i.templateAreas[u[1]]))if("start"===u[2])switch(s){case 0:case 2:r[s]=h.rowStart+1;break;case 1:case 3:r[s]=h.columnStart+1}else switch(s){case 0:case 2:r[s]=h.rowStart+h.rowSpan+1;break;case 1:case 3:r[s]=h.columnStart+h.columnSpan+1}}}if(!(r[0]&&r[1]&&r[2]&&r[3]))for(var d=function(e,t){if(Ae.isNumber(e))return r[t]=parseInt(e),!0;if(e.startsWith("span")){var i=parseInt(e.split(" ")[1]);return r[t-2]?r[t]=r[t-2]+i:t%2==0?a=i:o=i,!0}return!1},f=0;f<n.length;f++){var g=n[f];if("auto"!==g&&!r[f]&&!d(g,f)){var v=i[f%2==0?"row":"column"],p=g.split(" ");1===p.length&&(p[1]=p[0],p[0]="1");var m=parseInt(p[0]);if(v.name[p[1]]){var y=v.name[p[1]].length;m<=y?r[f]=v.name[p[1]][m-1]+(p[1]===n[f-2]?1:0):v.autoFill&&m>y&&(r[f]=m+(p[1]===n[f-2]?1:0))}}r[f]||d(g,f)}l[t]={placement:r,rowSpan:a,columnSpan:o}});var v=i[r?"column":"row"];v.count=Math.max(v.unit.length,1);for(var p=0;p<l.length;p++){var m=l[p];m&&(v.count=Math.max(v.count,r?m.columnSpan:m.rowSpan,m.placement[r?1:0]||0,(m.placement[r?3:2]||0)-1))}if((v.autoFill||v.autoFit)&&(0===v.unit.length&&(v.unit.push("auto"),v.unitMin.push(""),v.repeat.push(!0)),v.unit=Ee(v,v.unit),v.unitMin=Ee(v,v.unitMin)),e.each(function(e,t){for(var n=l[t],h=n.placement,u=r?n.rowSpan:n.columnSpan,d=r?n.columnSpan:n.rowSpan,f=r?i.column.count:i.row.count,g=r?0:1,v=r?1:0,p=r?2:3,m=r?3:2;!h[0]||!h[1];){var y=h.slice(0);if(!y[g])for(var b=o.length,k=0,x=0,A=-1;k<b;k++)if(!c[k])if(void 0===s[k]||s[k]<f){if(0===x&&(A=k,b=Math.max(b,k+u)),++x===u){y[g]=A+1;break}}else x=0,A=-1,b=o.length;if(y[g]){if(!y[v]){y[p]||(y[p]=y[g]+u);for(var S=[],_=y[g]-1;_<y[p]-1;_++)if(void 0===o[_])S.push([[0,-1]]);else{if(!(Ie(o[_])+d<=f))break;for(var w=[],E=0,T=0,I=-1;T<f;T++)void 0===o[_][T]&&(-1===I&&(I=T),E++),(o[_][T]||T===f-1)&&(E>=d&&w.push([I,I+E]),I=-1,E=0);if(!w.length)break;S.push(w)}if(d===S.length)if(S.length>1)e:for(var B=Array.isArray(R=S[0]),C=0,R=B?R:R[Symbol.iterator]();;){var P;if(B){if(C>=R.length)break;P=R[C++]}else{if((C=R.next()).done)break;P=C.value}for(var M=P,L=M[0];L<M[1];L++)for(var N=1;N<S.length;N++)for(var O=0;O<S[N].length;O++){var D=S[N][O];if(L>=D[0]&&(-1===D[1]||L+d<=D[1])){y[v]=L+1;break e}}}else y[v]=S[0][0][0]+1}}else h[g]=o.length+1,h[v]||(h[v]=1);y[g]&&y[v]?(h[g]=y[g],h[v]=y[v]):y[g]&&(c[y[g]-1]=!0)}h[p]||(h[p]=h[g]+u),h[m]||(h[m]=h[v]+d),function(e,t){if(t.every(function(e){return e>0})){for(var i=t[r?0:1]-1;i<t[r?2:3]-1;i++){void 0===o[i]&&(o[i]=[]);for(var n=t[r?1:0]-1;n<t[r?3:2]-1;n++)void 0===s[i]&&(s[i]=0),void 0===o[i][n]&&(o[i][n]=[],s[i]++),o[i][n].push(e)}return!0}return!1}(e,h)&&(e.data(ce.CSS_GRID,"cellData",{rowStart:h[0]-1,rowSpan:h[2]-h[0],columnStart:h[1]-1,columnSpan:h[3]-h[1]}),a&&(c={}))}),r)i.rowData=o;else for(var y=0;y<o.length;y++)for(var b=0;b<o[y].length;b++)void 0===i.rowData[b]&&(i.rowData[b]=[]),i.rowData[b][y]=o[y][b];if(i.rowData.length){for(var k=Array.isArray(A=i.rowData),x=0,A=k?A:A[Symbol.iterator]();;){var S;if(k){if(x>=A.length)break;S=A[x++]}else{if((x=A.next()).done)break;S=x.value}var _=S;i.column.count=Math.max(_.length,i.column.count);for(var w=Array.isArray(T=_),E=0,T=w?T:T[Symbol.iterator]();;){var I;if(w){if(E>=T.length)break;I=T[E++]}else{if((E=T.next()).done)break;I=E.value}if(I)for(var B=Array.isArray(R=I),C=0,R=B?R:R[Symbol.iterator]();;){var P;if(B){if(C>=R.length)break;P=R[C++]}else{if((C=R.next()).done)break;P=C.value}var M=P;M.positioned=!0,i.children.add(M)}}}if(i.children.size===e.length){i.row.count=i.rowData.length;for(var L=new Set,N=0;N<i.row.count;N++)for(var O=0;O<i.column.count;O++){var D=i.rowData[N][O];if(D)for(var W=Array.isArray(H=D),F=0,H=W?H:H[Symbol.iterator]();;){var z;if(W){if(F>=H.length)break;z=H[F++]}else{if((F=H.next()).done)break;z=F.value}var G=z;if(!L.has(G)){var X=G.data(ce.CSS_GRID,"cellData"),q=N+(X?X.rowSpan-1:0);O+(X?X.columnSpan-1:0)<i.column.count-1&&G.modifyBox(4,i.column.gap),q<i.row.count-1&&G.modifyBox(8,i.row.gap),L.add(G)}}}e.retain(Array.from(i.children)),e.cssSort("zIndex"),e.data(ce.CSS_GRID,"mainData",i)}}}}],[{key:"createDataAttribute",value:function(){return{children:new Set,rowData:[],templateAreas:{},row:t.createDataRowAttribute(),column:t.createDataRowAttribute(),emptyRows:[],alignItems:"",alignContent:"",justifyItems:"",justifyContent:""}}},{key:"createDataRowAttribute",value:function(){return{count:0,gap:0,unit:[],unitMin:[],repeat:[],auto:[],autoFill:!1,autoFit:!1,name:{},normal:!0}}}]),t}(),Ce=squared.lib.util,Re=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"condition",value:function(e){return e.flexElement&&e.length>0}},{key:"processNode",value:function(e){var i=this.application.controllerHandler,n=e.filter(function(e){return e.pageFlow}),r=t.createDataAttribute(e,n);if(e.cssTry("display","block")){for(var a=Array.isArray(s=n),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}var c=l;if(c.element){var h=c.element.getBoundingClientRect(),u=c.unsafe("initial");Object.assign(u.bounds,{width:h.width,height:h.height})}}e.cssFinally("display")}if(r.wrap){var d=function(t,a,o){var s=new Map;n.sort(function(e,i){return Ce.withinRange(e.linear[t],i.linear[t])?e.linear[a]>=i.linear[a]?1:-1:e.linear[t]>=i.linear[t]?1:-1});for(var l=Array.isArray(h=n),c=0,h=l?h:h[Symbol.iterator]();;){var u;if(l){if(c>=h.length)break;u=h[c++]}else{if((c=h.next()).done)break;u=c.value}var d=u,f=Math.round(d.linear[t]),g=s.get(f)||[];g.push(d),s.set(f,g)}var v=0,p=0;e.clear();var m=s.values(),y=Array.isArray(m),b=0;for(m=y?m:m[Symbol.iterator]();;){var k;if(y){if(b>=m.length)break;k=m[b++]}else{if((b=m.next()).done)break;k=b.value}var A=k,S=i.createNodeGroup(A[0],A,e);S.siblingIndex=p++;var _=S.unsafe("box");_&&(_[o]=e.box[o]),S.alignmentType|=128,v=Math.max(A.length,v)}e.sort(x.siblingIndex),r.rowDirection?(r.rowCount=s.size,r.columnCount=v):(r.rowCount=v,r.columnCount=s.size)};r.rowDirection?d(r.wrapReverse?"bottom":"top","left","right"):d("left","top","bottom")}else n.some(function(e){return 0!==e.flexbox.order})&&e.sort(r.directionReverse?function(e,t){return e.flexbox.order<=t.flexbox.order?1:-1}:function(e,t){return e.flexbox.order>=t.flexbox.order?1:-1}),r.rowDirection?(r.rowCount=1,r.columnCount=e.length):(r.rowCount=e.length,r.columnCount=1);e.data(ce.FLEXBOX,"mainData",r)}}],[{key:"createDataAttribute",value:function(e,t){var i=e.flexbox;return{wrap:i.wrap.startsWith("wrap"),wrapReverse:"wrap-reverse"===i.wrap,directionReverse:i.direction.endsWith("reverse"),justifyContent:i.justifyContent,rowDirection:i.direction.startsWith("row"),rowCount:0,columnDirection:i.direction.startsWith("column"),columnCount:0,children:t}}}]),t}(),Pe=squared.lib.css,Me=squared.lib.dom,Le=squared.lib.util;function Ne(e,t){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a.findIndex(function(e){return Le.withinRange(t.linear.top,e.linear.top)||t.linear.top>e.linear.top&&t.linear.top<e.linear.bottom});if(-1!==o)return o}return-1}var Oe=squared.lib.util;function De(e){return e.visibleStyle.backgroundImage&&!e.visibleStyle.backgroundRepeat}var We=squared.lib.util,Fe=squared.lib.css,He=squared.lib.util,ze=squared.lib.css,Ge=squared.lib.css,Xe=squared.lib.math,qe=squared.lib.util,Ve=squared.lib.util,Ue=squared.lib.util,je=!!document.doctype&&"html"===document.doctype.name;function Ye(e,t){var i=e.has("minHeight",2)?e.toFloat("minHeight"):0;e.css("minHeight",Ue.formatPX(Math.max(t,i)))}function Ze(e){return!!e&&(e.blockStatic&&!e.lineBreak&&!e.positioned)}function Ke(e){return e.visible||e.excluded?e:e.renderAs||e.outerParent||e.innerChild||e}function Qe(e,t){e.modifyBox(t,null),e.companion&&e.companion.modifyBox(t,null)}function $e(e,t,i,n){if(Ze(i))if(n){if(0===e.borderTopWidth&&0===e.paddingTop){var r=!1;if(0===i.marginTop&&0===i.borderTopWidth&&0===i.paddingTop){var a=i.firstChild;Ze(a)&&(i.has("marginTop",64)?je&&0!==a.marginTop&&a.modifyBox(2,null):(i=a,r=!0))}if(!je&&0===e.marginTop&&e.has("marginTop",64))Qe(i,2);else if(je&&e.marginTop<i.marginTop)""===e.elementId&&t.modifyBox(2,null),r||e.documentBody||(i.marginTop>e.marginTop&&(""!==e.elementId&&t.modifyBox(2,null),t.modifyBox(2,i.marginTop)),Qe(i,2));else if(e.naturalElement&&e.marginTop>0){var o,s=!1;if(e.visible&&i.visible)i.modifyBox(2,null),s=!0;else i.outerParent?o=i.outerParent:i.innerChild&&(o=i.innerChild),o&&(o.modifyBox(2,-i.marginTop,!1),i=o,s=!0);s&&i.companion&&i.companion.modifyBox(2,null)}}}else if(0===e.paddingBottom&&0===e.borderBottomWidth){var l=!1;if(0===i.paddingBottom&&0===i.borderBottomWidth&&0===i.marginBottom){var c=i.lastChild;Ze(c)&&(i.has("marginBottom",64)?je&&0!==c.marginBottom&&c.modifyBox(8,null):(i=c,l=!0))}if(!je&&0===e.marginBottom&&e.has("marginBottom",64))Qe(i,8);else if(je&&e.marginBottom<i.marginBottom)""===e.elementId&&t.modifyBox(8,null),l||e.documentBody||(i.marginBottom>e.marginBottom&&(""!==e.elementId&&t.modifyBox(8,null),t.modifyBox(8,i.marginBottom)),Qe(i,8));else if(e.naturalElement&&e.marginBottom>0){var h,u=!1;if(e.visible&&i.visible)i.modifyBox(8,null),u=!0;else i.outerParent?h=i.outerParent:i.innerChild&&(h=i.innerChild),h&&(h.modifyBox(8,-i.marginBottom,!1),i=h,u=!0);u&&i.companion&&i.companion.modifyBox(8,null)}}}var Je={Accessibility:xe,CssGrid:Be,External:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"beforeInit",value:function(e){if((arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.included(e))&&!Me.getElementCache(e,"squaredExternalDisplay")){for(var t=[],i=e;i;)t.push(Pe.getStyle(i).display),i.style.display="block",i=i.parentElement;Me.setElementCache(e,"squaredExternalDisplay",t)}}},{key:"init",value:function(e){return this.included(e)&&this.application.parseElements.add(e),!1}},{key:"afterInit",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.included(e)){var t=Me.getElementCache(e,"squaredExternalDisplay");if(t){for(var i=t,n=e,r=0;n;)n.style.display=i[r],n=n.parentElement,r++;Me.deleteElementCache(e,"squaredExternalDisplay")}}}}]),t}(),Flexbox:Re,Grid:function(e){function t(){var e;return r(this,t),(e=u(this,c(t).apply(this,arguments))).options={columnBalanceEqual:!1},e}return l(t,ne),o(t,[{key:"condition",value:function(e){if(e.length>1&&!e.flexElement&&!e.gridElement&&!e.has("listStyle")){if("table"===e.display)return e.every(function(e){return"table-row"===e.display&&e.every(function(e){return"table-cell"===e.display})});for(var t=0,i=0,n=Array.isArray(a=e),r=0,a=n?a:a[Symbol.iterator]();;){var o;if(n){if(r>=a.length)break;o=a[r++]}else{if((r=a.next()).done)break;o=r.value}if(!o.pageFlow||o.visibleStyle.background||!o.blockStatic)return!1;o.length>1&&t++,"list-item"!==o.display||o.has("listStyleType")||i++}if(i===e.length)return!0;if(t>0)return e.every(function(e){return e.length>0&&x.linearData(e.children).linearX})}return!1}},{key:"processNode",value:function(e){var i=[],n=this.options.columnBalanceEqual,r=[];if(n){var a=[];e.each(function(e,t){a[t]=[],e.each(function(e){return a[t].push(e.actualWidth)}),r.push(e.duplicate())});var o=r[a.findIndex(function(e){return e===a.reduce(function(e,t){return e.length===t.length?e.reduce(function(e,t){return e+t},0)<t.reduce(function(e,t){return e+t},0)?e:t:e.length<t.length?e:t})})];if(o&&o.length>1)for(var s=[],l=!1,c=function(e){var t=o[e].bounds,i=[];if(e<o.length-1)for(var n=function(n){if(r[n]===o)i.push(e);else{var a=r[n].findIndex(function(i,a){return a>=e&&Math.floor(i.bounds.width)===Math.floor(t.width)&&a<r[n].length-1});if(-1===a)return i.length=0,"break";i.push(a)}},a=0;a<r.length;a++){if("break"===n(a))break}else for(a=0;a<r.length;a++)if(r[a].length>o.length){var c=r[a].splice(s[a]+(l?2:1),r[a].length-o.length);r[a][s[a]+(l?1:0)].data(ce.GRID,"cellData",{siblings:c})}if(i.length===r.length){var h=i.reduce(function(e,t){return Math.min(e,t)});if(i.reduce(function(e,t){return Math.max(e,t)})>h)for(var u=0;u<r.length;u++)if(i[u]>h){var d=r[u].splice(h,i[u]-h);r[u][s[u]+(l?1:0)].data(ce.GRID,"cellData",{siblings:d})}s=i,l=!0}else s=[].fill(e),l=!1},h=0;h<o.length;h++)c(h);else r.length=0}else{for(var u={},d=Array.isArray(g=e),f=0,g=d?g:g[Symbol.iterator]();;){var v;if(d){if(f>=g.length)break;v=g[f++]}else{if((f=g.next()).done)break;v=f.value}for(var p=Array.isArray(y=v),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b,x=Math.floor(k.linear.left);void 0===u[x]&&(u[x]=[]),u[x].push(k)}}var A=Object.keys(u);if(A.length){for(var S=[],_=0;_<A.length;_++){var w=u[A[_]];if(0===_&&0===w.length)return;S[_]=0===_?0:S[_-1];for(var E=0;E<w.length;E++){var T=w[E];if(0===_||T.linear.left>=S[_-1])if(void 0===r[_]&&(r[_]=[]),0===_||r[0].length===w.length)r[_][E]=T;else{var I=Ne(r,T);if(-1===I)return;r[_][I]=T}else{var B=r.length-1;if(r[B]){for(var C=r[B][0].linear.left,R=r[B][0].linear.right,P=1;P<r[B].length;P++)C=Math.min(C,r[B][P].linear.left),R=Math.max(R,r[B][P].linear.right);if(T.linear.left>C&&T.linear.right>R){var M=Ne(r,T);if(-1!==M)for(var L=r.length-1;L>=0;L--)if(r[L]){void 0===r[L][M]&&(r[B].length=0);break}}}}S[_]=Math.max(T.linear.right,S[_])}}for(var N=0,O=-1;N<S.length;N++)void 0===r[N]?-1===O?O=N-1:N===S.length-1&&(S[O]=S[N]):-1!==O&&(S[O]=S[N-1],O=-1);for(var D=0;D<r.length;D++)r[D]&&r[D].length?i.push(S[D]):r.splice(D--,1);var W=r.reduce(function(e,t){return Math.max(e,t.length)},0);for(h=0;h<W;h++)for(var F=0;F<r.length;F++)void 0===r[F][h]&&(r[F][h]={spacer:1})}i.push(e.box.right)}if(r.length>1&&r[0].length===e.length){for(var H=Array.isArray(G=e),z=0,G=H?G:G[Symbol.iterator]();;){var X;if(H){if(z>=G.length)break;X=G[z++]}else{if((z=G.next()).done)break;X=z.value}X.hide()}e.clear();for(var q=Object.assign({},t.createDataAttribute(),{columnCount:n?r[0].length:r.length}),V=0,U=0;V<r.length;V++)for(var j=0,Y=0,Z=0;Y<r[V].length;Y++){var K=r[V][Y];if(K.spacer)1===K.spacer&&j++;else{K.parent=e;var Q=Object.assign(t.createDataCellAttribute(),K.data(ce.GRID,"cellData"));if(n)Q.rowStart=0===Y,Q.rowEnd=Y===r[V].length-1,Q.cellStart=0===V&&0===Y,Q.cellEnd=V===r.length-1&&Q.rowEnd,Q.index=Y;else{for(var $=1,J=1+j,ee=V+1;ee<r.length&&1===r[ee][Y].spacer;ee++)J++,r[ee][Y].spacer=2;if(1===J)for(var te=Y+1;te<r[V].length&&1===r[V][te].spacer;te++)$++,r[V][te].spacer=2;for(var ie=Math.min(V+(J-1),i.length-1),ne=Array.isArray(ae=K.documentParent.actualChildren),re=0,ae=ne?ae:ae[Symbol.iterator]();;){var oe;if(ne){if(re>=ae.length)break;oe=ae[re++]}else{if((re=ae.next()).done)break;oe=re.value}oe.visible&&!oe.rendered&&oe.linear.left>=K.linear.right&&oe.linear.right<=i[ie]&&Q.siblings.push(oe)}Q.rowSpan=$,Q.columnSpan=J,Q.rowStart=0==Z++,Q.rowEnd=J+V===r.length,Q.cellStart=0==U++,Q.cellEnd=Q.rowEnd&&Y===r[V].length-1,Q.index=V,j=0}K.data(ce.GRID,"cellData",Q)}}Le.sortArray(e.children,!0,"documentParent.siblingIndex","siblingIndex"),e.each(function(e,t){return e.siblingIndex=t}),e.tableElement&&"collapse"===e.css("borderCollapse")&&(e.modifyBox(32,null),e.modifyBox(64,null),e.modifyBox(128,null),e.modifyBox(256,null)),e.data(ce.GRID,"mainData",q)}}}],[{key:"createDataAttribute",value:function(){return{paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,columnCount:0}}},{key:"createDataCellAttribute",value:function(){return{rowSpan:0,columnSpan:0,index:-1,cellStart:!1,cellEnd:!1,rowEnd:!1,rowStart:!1,siblings:[]}}}]),t}(),List:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"condition",value:function(e){var i=e.length;if(i&&f(c(t.prototype),"condition",this).call(this,e)){for(var n=new Set,r=0,a=0,o=0,s=0,l=0,h=0,u=0;u<i;u++){var d=e.children[u],g="none"!==d.css("listStyleType"),v=De(d);"LI"!==d.tagName&&!g&&v&&l++,"list-item"===d.display&&(g||v)&&h++,d.blockStatic&&r++,d.inlineVertical&&a++,d.floating?(n.add(d.float),o++):(0===u||u===i-1||d.blockStatic||e.children[u-1].blockStatic&&e.children[u+1].blockStatic)&&s++}return(l===i||h>0)&&(r===i||a===i||o===i&&1===n.size||s===i)}return!1}},{key:"processNode",value:function(e){var i=0;e.each(function(e){var n=t.createDataAttribute();if("list-item"===e.display||e.has("listStyleType")||De(e)){var r=e.css("listStyleImage");if(""!==r&&"none"!==r)n.imageSrc=r;else switch(e.css("listStyleType")){case"disc":n.ordinal="";break;case"square":n.ordinal="";break;case"decimal":n.ordinal="".concat(""+(i+1),".");break;case"decimal-leading-zero":n.ordinal="".concat((i<9?"0":"")+(i+1),".");break;case"lower-alpha":case"lower-latin":n.ordinal="".concat(Oe.convertAlpha(i).toLowerCase(),".");break;case"upper-alpha":case"upper-latin":n.ordinal="".concat(Oe.convertAlpha(i),".");break;case"lower-roman":n.ordinal="".concat(Oe.convertRoman(i+1).toLowerCase(),".");break;case"upper-roman":n.ordinal="".concat(Oe.convertRoman(i+1),".");break;case"none":r="";var a="";e.visibleStyle.backgroundRepeat||(r=e.css("backgroundImage"),a=e.css("backgroundPosition")),""!==r&&"none"!==r&&(n.imageSrc=r,n.imagePosition=a,e.exclude({resource:y.IMAGE_SOURCE}));break;default:n.ordinal=""}i++}e.data(ce.LIST,"mainData",n)})}},{key:"postBaseLayout",value:function(e){e.modifyBox(16,null),e.modifyBox(256,null)}}],[{key:"createDataAttribute",value:function(){return{ordinal:"",imageSrc:"",imagePosition:""}}}]),t}(),Relative:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"condition",value:function(e){return e.positionRelative&&!e.positionStatic||0!==We.convertInt(e.cssInitial("verticalAlign"))}},{key:"processNode",value:function(){return{include:!0}}},{key:"postProcedure",value:function(e){var t=e.renderParent;if(t){var i=We.convertFloat(e.verticalAlign),n=e;if(t.support.container.positionRelative&&0===e.length&&(0!==e.top||0!==e.bottom||0!==i)){n=e.clone(this.application.nextId,!0,!0),e.hide(!0),this.application.session.cache.append(n,!1);var r=new S(t,n,n.containerType,n.alignmentType),a=t.renderChildren.findIndex(function(t){return t===e});-1!==a&&(r.renderIndex=a+1),this.application.addRenderLayout(r),t.hasAlign(16)||t.renderEach(function(t){t.alignSibling("topBottom")===e.documentId?t.alignSibling("topBottom",n.documentId):t.alignSibling("bottomTop")===e.documentId&&t.alignSibling("bottomTop",n.documentId)})}0!==e.top?n.modifyBox(2,e.top):0!==e.bottom&&n.modifyBox(2,-1*e.bottom),0!==i&&n.modifyBox(2,-1*i),0!==e.left?n.autoMargin.left?n.modifyBox(4,-1*e.left):n.modifyBox(16,e.left):0!==e.right&&n.modifyBox(16,-1*e.right)}}}]),t}(),Sprite:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"condition",value:function(e){var t=!1;if(e.hasWidth&&e.hasHeight&&0===e.length){var i=e.css("backgroundImage");if(""===i||"none"===i){var n=He.REGEXP_COMPILED.URL.exec(e.css("background"));i=n?n[0]:""}if(""!==i){i=Fe.resolveURL(i);var r=this.application.session.image.get(i);if(r){var a=e.actualDimension,o=e.fontSize,s=Fe.getBackgroundPosition("".concat(e.css("backgroundPositionX")," ").concat(e.css("backgroundPositionY")),a,o);s.left<=0&&s.top<=0&&r.width>a.width&&r.height>a.height&&(r.position={x:s.left,y:s.top},e.data(ce.SPRITE,"mainData",r),t=!0)}}}return t&&(!e.dataset.use||this.included(e.element))}}]),t}(),Substitute:function(e){function t(e,i,n,a){var o;return r(this,t),(o=u(this,c(t).call(this,e,i,n,a))).require(ce.EXTERNAL,!0),o}return l(t,ne),o(t,[{key:"processNode",value:function(e,t){var i=this,n=ze.getDataSet(e.element,this.name);if(n.tagChild&&e.each(function(e){e.styleElement&&(e.dataset.use=i.name,e.dataset.squaredSubstituteTag=n.tagChild)}),n.tag)return e.setControlType(n.tag),e.render(t),{output:{type:1,node:e,controlName:n.tag}}}}]),t}(),Table:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"processNode",value:function(e){var i=t.createDataAttribute(),n=[];function r(t){t.data(ce.TABLE,"percent","".concat(Math.round(t.bounds.width/e.bounds.width*100),"%")),t.data(ce.TABLE,"expand",!0)}function a(e){e.css("width",qe.formatPX(e.bounds.width),!0)}function o(e){if(e.length){var t=e[0].cascade(),i=Array.isArray(t),r=0;for(t=i?t:t[Symbol.iterator]();;){var a;if(i){if(r>=t.length)break;a=t[r++]}else{if((r=t.next()).done)break;a=r.value}var o=a;"TH"!==o.tagName&&"TD"!==o.tagName||(o.inherit(e[0],"styleMap"),o.unsetCache("visibleStyle"))}qe.concatArray(n,e[0].children);for(var s=Array.isArray(c=e),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}h.hide()}}}var s=[],l=[],c=[];e.each(function(e){switch(e.tagName){case"THEAD":s.push(e);break;case"TBODY":l.push(e);break;case"TFOOT":c.push(e)}}),o(s);for(var h=l,u=0;u<h.length;u++){var d=h[u];qe.concatArray(n,d.children),d.hide()}o(c);var f="fixed"===e.css("tableLayout"),v="collapse"===e.css("borderCollapse"),p=g(v?[0,0]:qe.replaceMap(e.css("borderSpacing").split(" "),function(e){return parseInt(e)}),2),m=p[0],y=p[1];m>0?(e.modifyBox(256,m),e.modifyBox(64,m)):(e.modifyBox(256,null),e.modifyBox(64,null)),y>0?(e.modifyBox(32,y),e.modifyBox(128,y)):(e.modifyBox(32,null),e.modifyBox(128,null));for(var b=qe.formatPX(m>1?Math.round(m/2):m),k=qe.formatPX(y>1?Math.round(y/2):y),x=e.element&&e.element.querySelector("COLGROUP"),A=[],S=[],_=[],w=[],E=n.length,T=[].fill(0),I=0,B=!1,C=function(e){var t=n[e];A[e]=m,_[e]=[],t.each(function(i,r){for(var a=i.element,o=0;o<a.rowSpan-1;o++){var s=e+1+o;void 0!==T[s]&&(T[s]+=a.colSpan)}if(!i.hasWidth){var l=qe.convertInt(Ge.getNamedItem(a,"width"));l>0&&i.css("width",qe.formatPX(l))}if(!i.hasHeight){var c=qe.convertInt(Ge.getNamedItem(a,"height"));c>0&&i.css("height",qe.formatPX(c))}if(!i.visibleStyle.backgroundImage&&!i.visibleStyle.backgroundColor)if(x){var h=Ge.getStyle(x.children[T[e]]);h.background?a.style.background=h.background:h.backgroundColor&&(a.style.backgroundColor=h.backgroundColor)}else{var u=/rgba\(0, 0, 0, 0\)|transparent/,d=Ge.getInheritedStyle(a,"background",u,"TABLE");""!==d?a.style.background=d:""!==(d=Ge.getInheritedStyle(a,"backgroundColor",u,"TABLE"))&&(a.style.backgroundColor=d)}switch(i.tagName){case"TH":i.cssInitial("textAlign")||i.css("textAlign",i.css("textAlign"));case"TD":i.cssInitial("verticalAlign")||i.css("verticalAlign","middle")}var g=i.cssInitial("width"),v=T[e],p=void 0===w[v]||"auto"===w[v];if(0===e||p||!f)if(""===g||"auto"===g)void 0===w[v]?(w[v]=g||"0px",S[v]=0):e===n.length-1&&p&&0===S[v]&&(S[v]=i.bounds.width);else{var y=qe.isLength(w[v]),_=qe.isPercent(g);(p||i.bounds.width<S[v]||i.bounds.width===S[v]&&(y&&_||_&&qe.isPercent(w[v])&&qe.convertFloat(g)>qe.convertFloat(w[v])||y&&qe.isLength(g)&&qe.convertFloat(g)>qe.convertFloat(w[v])))&&(w[v]=g),(p||1===a.colSpan)&&(S[v]=i.bounds.width)}B||(B=i.multiline),(i.length||i.inlineText)&&(A[e]+=i.bounds.width+m),i.cssApply({marginTop:0===e?"0px":k,marginRight:r<t.length-1?b:"0px",marginBottom:e+a.rowSpan-1>=n.length-1?"0px":k,marginLeft:0===T[e]?"0px":b},!0),T[e]+=a.colSpan}),I=Math.max(I,T[e])},R=0;R<E;R++)C(R);if(e.has("width",2)&&w.some(function(e){return qe.isPercent(e)})&&qe.replaceMap(w,function(e,t){return"auto"===e&&S[t]>0?qe.formatPX(S[t]):e}),w.every(function(e){return qe.isPercent(e)})&&w.reduce(function(e,t){return e+parseFloat(t)},0)>1){var P=100;qe.replaceMap(w,function(e){var t=parseFloat(e);return P<=0?e="0px":P-t<0&&(e=qe.formatPercent(P)),P-=t,e})}else if(w.every(function(e){return qe.isLength(e)})){var M=w.reduce(function(e,t){return e+parseInt(t)},0);if(M<e.width)qe.replaceMap(w,function(e){return"0px"!==e?"".concat(parseInt(e)/M*100,"%"):e});else if(M>e.width&&(e.css("width","auto",!0),!f)){var L=e.cascade(),N=Array.isArray(L),O=0;for(L=N?L:L[Symbol.iterator]();;){var D;if(N){if(O>=L.length)break;D=L[O++]}else{if((O=L.next()).done)break;D=O.value}D.css("width","auto",!0)}}}var W=w.reduce(function(e,t){return e+(qe.isPercent(t)?parseFloat(t):0)},0);i.layoutType=function(){if(w.some(function(e){return qe.isPercent(e)})||w.every(function(e){return qe.isLength(e)&&"0px"!==e}))return 3;if(w.every(function(e){return e===w[0]})){if(B)return e.some(function(e){return e.has("height")})?2:3;if("auto"===w[0])return e.has("width")?3:0;if(e.hasWidth)return 2}return w.every(function(e){return"auto"===e||qe.isLength(e)&&"0px"!==e})?1:0}(),(B||1===i.layoutType&&!e.hasWidth)&&(i.expand=!0);var F=e.find(function(e){return"CAPTION"===e.tagName});e.clear(),F&&(F.hasWidth||qe.isUserAgent(16)||(F.textElement?F.has("maxWidth")||F.css("maxWidth",qe.formatPX(F.bounds.width)):F.bounds.width>Xe.maxArray(A)&&a(F)),F.cssInitial("textAlign")||F.css("textAlign","center"),E++,F.data(ce.TABLE,"colSpan",I),F.parent=e),T=[].fill(0);var H=e.hasWidth;for(R=0;R<n.length;R++){for(var z=n[R],G=z.duplicate(),X=0;X<G.length;X++){for(var q=G[X],V=q.element,U=V.rowSpan,j=V.colSpan,Y=0;Y<U-1;Y++){var Z=R+1+Y;void 0!==T[Z]&&(T[Z]+=j)}U>1&&q.data(ce.TABLE,"rowSpan",U),j>1&&q.data(ce.TABLE,"colSpan",j),q.has("verticalAlign")||q.css("verticalAlign","middle");var K=w[T[R]];if("undefined"!==K)switch(i.layoutType){case 3:"auto"===K?W>=1?(a(q),q.data(ce.TABLE,"exceed",!H),q.data(ce.TABLE,"downsized",!0)):r(q):qe.isPercent(K)?(q.data(ce.TABLE,"percent",K),q.data(ce.TABLE,"expand",!0)):qe.isLength(K)&&parseInt(K)>0?q.bounds.width>=parseInt(K)?(a(q),q.data(ce.TABLE,"expand",!1),q.data(ce.TABLE,"downsized",!1)):f?(r(q),q.data(ce.TABLE,"downsized",!0)):(a(q),q.data(ce.TABLE,"expand",!1)):(q.has("width")&&!q.has("width",32)||a(q),q.data(ce.TABLE,"expand",!1));break;case 2:q.css("width","0px");break;case 1:"auto"===K?q.css("width","0px"):(f?q.data(ce.TABLE,"downsized",!0):a(q),q.data(ce.TABLE,"expand",!1))}T[R]+=j;for(var Q=0;Q<U;Q++)for(var $=0;$<j;$++)_[R+Q].push(q);q.parent=e}if(T[R]<I)G[G.length-1].data(ce.TABLE,"spaceSpan",I-T[R]);z.hide()}if(v){for(var J=e.css("borderTopColor"),ee=e.css("borderTopStyle"),te=e.css("borderTopWidth"),ie=e.css("borderRightColor"),ne=e.css("borderRightStyle"),re=e.css("borderRightWidth"),ae=e.css("borderBottomColor"),oe=e.css("borderBottomStyle"),se=e.css("borderBottomWidth"),le=e.css("borderLeftColor"),he=e.css("borderLeftStyle"),ue=e.css("borderLeftWidth"),de=!1,fe=!1,ge=!1,ve=!1,pe=0;pe<E;pe++)for(var me=0;me<I;me++){var ye=_[pe][me];if(ye&&"visible"===ye.css("visibility")){if(0===pe&&(ye.borderTopWidth<parseInt(te)?ye.cssApply({borderTopColor:J,borderTopStyle:ee,borderTopWidth:te}):de=!0),pe>=0&&pe<E-1){var be=_[pe+1][me];be&&be!==ye&&"visible"===be.css("visibility")&&(ye.borderBottomWidth>=be.borderTopWidth?be.css("borderTopWidth","0px",!0):ye.css("borderBottomWidth","0px",!0))}if(pe===E-1&&(ye.borderBottomWidth<parseInt(se)?ye.cssApply({borderBottomColor:ae,borderBottomStyle:oe,borderBottomWidth:se}):ge=!0),0===me&&(ye.borderLeftWidth<parseInt(ue)?ye.cssApply({borderLeftColor:le,borderLeftStyle:he,borderLeftWidth:ue}):ve=!0),me>=0&&me<I-1){var ke=_[pe][me+1];ke&&ke!==ye&&"visible"===ke.css("visibility")&&(ye.borderRightWidth>=ke.borderLeftWidth?ke.css("borderLeftWidth","0px",!0):ye.css("borderRightWidth","0px",!0))}me===I-1&&(ye.borderRightWidth<parseInt(re)?ye.cssApply({borderRightColor:ie,borderRightStyle:ne,borderRightWidth:re}):fe=!0)}}(de||fe||ge||ve)&&e.cssApply({borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px",borderLeftWidth:"0px"},!0)}i.rowCount=E,i.columnCount=I,e.data(ce.TABLE,"mainData",i)}}],[{key:"createDataAttribute",value:function(){return{layoutType:0,rowCount:0,columnCount:0,expand:!1}}}]),t}(),VerticalAlign:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"condition",value:function(e){for(var t=!1,i=0,n=Array.isArray(a=e),r=0,a=n?a:a[Symbol.iterator]();;){var o;if(n){if(r>=a.length)break;o=a[r++]}else{if((r=a.next()).done)break;o=r.value}o.inlineVertical&&(i++,0!==Ve.convertInt(o.verticalAlign)&&(t=!0))}return t&&i>1&&x.linearData(e.children).linearX}},{key:"processNode",value:function(e){var t=[],i=[],n=1/0;e.each(function(e){e.inlineVertical&&e.linear.top<=n&&(e.linear.top<n&&(i.length=0),i.push(e),n=e.linear.top)}),e.every(function(e){return e.positionStatic||e.positionRelative&&e.length>0})?i.length!==e.length&&e.each(function(e){var n;i.includes(e)?n=!0:e.inlineVertical&&!e.baseline&&Ve.isLength(e.verticalAlign)?(e.modifyBox(2,e.linear.top-i[0].linear.top),t.push(e),n=!0):n=!1,n&&e.css("verticalAlign","0px",!0)}):Ve.spliceArray(i,function(e){return!(Ve.isLength(e.verticalAlign)&&Ve.convertInt(e.verticalAlign)>0)}),i.length&&e.data(ce.VERTICAL_ALIGN,"mainData",{aboveBaseline:i,belowBaseline:t})}},{key:"postProcedure",value:function(e){var t=e.data(ce.VERTICAL_ALIGN,"mainData");if(t){var i=e.find(function(e){return e.baselineActive});i?i.modifyBox(2,i.linear.top-t.aboveBaseline[0].linear.top):[].concat(t.belowBaseline,t.aboveBaseline).some(function(e){var t=Ve.convertInt(e.cssInitial("verticalAlign"));return t>0&&(e.modifyBox(8,t),!0)})}}}]),t}(),WhiteSpace:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ne),o(t,[{key:"afterBaseLayout",value:function(){for(var e=new Set,t=Array.isArray(n=this.application.processing.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(a.naturalElement){for(var o=a.actualChildren,s=void 0,l=void 0,c=0;c<o.length;c++){var h=o[c];if(a.blockStatic&&(void 0===s&&(s=h),l=h),0!==c&&Ze(h)){var u=h.previousSiblings(!0,!0,!0);if(u.length){var d=u.find(function(e){return!e.floating}),f=Ke(h);if(Ze(d)){var g=Ke(d),v=Ue.convertFloat(d.cssInitial("marginBottom",!1,!0)),p=Ue.convertFloat(h.cssInitial("marginTop",!1,!0));if(d.excluded&&!h.excluded){var m=Math.min(v,Ue.convertFloat(d.cssInitial("marginTop",!1,!0)));if(m<0){var y=Math.abs(m)>=p?null:m;f.modifyBox(2,y),f.companion&&f.companion.modifyBox(2,y),e.add(d)}}else if(!d.excluded&&h.excluded){var b=Math.min(p,Ue.convertFloat(h.cssInitial("marginBottom",!1,!0)));b<0&&(g.modifyBox(8,Math.abs(b)>=v?null:b),e.add(h))}else{if(0===d.paddingBottom&&0===d.borderBottomWidth){var k=d.lastChild;if(Ze(k)&&""===k.elementId){var x=Ue.convertFloat(k.cssInitial("marginBottom",!1,!0));x>v&&d.css("marginBottom",Ue.formatPX(v=x),!0),d.visible&&(k.modifyBox(8,null),k.companion&&k.companion.modifyBox(8,null))}}if(0===h.borderTopWidth&&0===h.paddingTop){var A=h.firstChild;if(Ze(A)&&""===A.elementId){var S=Ue.convertFloat(A.cssInitial("marginTop",!1,!0));S>p&&h.css("marginTop",Ue.formatPX(p=S),!0),h.visible&&(A.modifyBox(2,null),A.companion&&A.companion.modifyBox(2,null))}}v>0&&p>0&&(p<=v?(f.modifyBox(2,null),f.companion&&f.companion.modifyBox(2,null)):(g.modifyBox(8,null),g.companion&&g.companion.modifyBox(8,null)))}}else if(d&&"IMG"===d.tagName){var _=h.linear.top-d.linear.bottom;_>0&&!h.ascend(!0).some(function(e){return e.has("height")})&&f.modifyBox(2,_)}}}}var w=Ke(a);s&&$e(a,w,s,!0),l&&$e(a,w,l,!1)}}for(var E=Array.isArray(I=this.application.processing.excluded),T=0,I=E?I:I[Symbol.iterator]();;){var B;if(E){if(T>=I.length)break;B=I[T++]}else{if((T=I.next()).done)break;B=T.value}var C=B;if(!e.has(C))if(C.lineBreak){var R=C.actualParent,P=C.previousSiblings(!0,!0,!0),M=C.nextSiblings(!0,!0,!0),L=!1;if(P.length&&M.length){if(M[0].lineBreak)continue;var N=P.pop(),O=M.pop();if(N.inlineStatic&&O.inlineStatic){if(0===P.length){e.add(C);continue}var D=P.pop();D.lineBreak&&(D.setBounds(),0!==D.bounds.bottom&&(N=D))}L=!0;var W=void 0;if(O.lineHeight>0&&O.element&&O.cssTry("lineHeight","0px")?(W=O.element.getBoundingClientRect().top-O.marginTop,O.cssFinally("lineHeight")):W=O.linear.top,N.lineHeight>0&&N.element&&N.cssTry("lineHeight","0px")?(W-=N.element.getBoundingClientRect().bottom+N.marginBottom,N.cssFinally("lineHeight")):W-=N.linear.bottom,0!==W){var F=N.visible&&N.renderParent,H=O.visible&&O.renderParent;H&&H.groupParent&&H.firstChild===O?H.modifyBox(2,W):F&&F.groupParent&&F.lastChild===N?F.modifyBox(8,W):H&&H.layoutVertical&&(O.visible||O.renderAs)?(O.renderAs||O).modifyBox(2,W):F&&F.layoutVertical&&(N.visible||N.renderAs)?(N.renderAs||N).modifyBox(8,W):!H&&!F&&R&&R.visible?O.lineBreak||O.excluded?R.modifyBox(128,W):N.lineBreak||N.excluded?R.modifyBox(32,W):L=!1:L=!1}}else if(R&&R.visible){if(!R.documentRoot&&P.length){var z=P[P.length-1],G=R.box.bottom-z.linear[z.lineBreak||z.excluded?"top":"bottom"];0!==G&&(z.rendered||R.visibleStyle.background?R.modifyBox(128,G):R.hasHeight||Ye(R,G))}else if(M.length){var X=M[M.length-1],q=X.linear[X.lineBreak||X.excluded?"bottom":"top"]-R.box.top;0!==q&&(X.rendered||R.visibleStyle.background?R.modifyBox(32,q):R.hasHeight||Ye(R,q))}L=!0}if(L){for(var V=Array.isArray(j=P),U=0,j=V?j:j[Symbol.iterator]();;){var Y;if(V){if(U>=j.length)break;Y=j[U++]}else{if((U=j.next()).done)break;Y=U.value}e.add(Y)}for(var Z=Array.isArray(Q=M),K=0,Q=Z?Q:Q[Symbol.iterator]();;){var $;if(Z){if(K>=Q.length)break;$=Q[K++]}else{if((K=Q.next()).done)break;$=K.value}e.add($)}}}else{var J=C.nextSiblings(!0,!0,!0).pop();if(J&&J.visible){var ee=C.previousSiblings(!1,!1),te=J.linear.top;if(ee.length)te-=ee.pop().linear.bottom;else te-=C.linear.top;te>0&&J.modifyBox(2,te)}}}}},{key:"afterConstraints",value:function(){for(var e=[],t=Array.isArray(n=this.application.processing.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r,o=a.renderAs?a.renderAs.renderParent:a.renderParent;if(o&&!o.hasAlign(4)&&a.pageFlow&&a.styleElement&&a.inlineVertical&&!a.alignParent("left")&&!e.includes(a.id))for(var s=[],l=a;;){if(Ue.concatArray(s,l.previousSiblings()),s.length&&!s.some(function(e){return e.lineBreak||e.excluded&&e.blockStatic})){var c=s[s.length-1];if(c.inlineVertical){var h=a.linear.left-c.actualRight();if(h>0){var u=Ke(a.outerParent||a);u.modifyBox(16,h),e.push(u.id)}}else if(c.floating){s.length=0,l=c;continue}}break}}}}]),t}()},et={constant:he,enumeration:_};e.Application=Y,e.Controller=ee,e.Extension=ne,e.ExtensionManager=ae,e.File=se,e.Layout=S,e.Node=me,e.NodeGroup=ye,e.NodeList=x,e.Resource=z,e.extensions=Je,e.lib=et,Object.defineProperty(e,"__esModule",{value:!0})});
