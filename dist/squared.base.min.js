!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e=e||self).squared=e.squared||{},e.squared.base={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){this.wrapped=e}function n(e){var t,n;function r(t,n){try{var o=e[t](n),s=o.value,l=s instanceof i;Promise.resolve(l?s.wrapped:s).then(function(e){l?r("next",e):a(o.done?"return":"normal",e)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(a,o){var s={key:e,arg:i,resolve:a,reject:o,next:null};n?n=n.next=s:(t=n=s,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function f(e,t,i){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=d(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};function g(e,t){return p(e)||function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(e,t)||y()}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,i=[];t<e.length;t++)i[t]=e[t];return i}}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){if(Array.isArray(e))return e}function m(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var b,k,x,S=squared.lib.css,A=squared.lib.util,_=function(e){function t(e){var i;return r(this,t),(i=u(this,c(t).call(this,e)))._currentId=0,i}return l(t,squared.lib.base.Container),o(t,[{key:"append",value:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f(c(t.prototype),"append",this).call(this,e),i&&this.afterAppend&&this.afterAppend.call(this,e),this}},{key:"reset",value:function(){return this._currentId=0,this.clear(),this}},{key:"nextId",get:function(){return++this._currentId}}],[{key:"outerRegion",value:function(e){var t=e.duplicate(),i=t[0],n=i,r=i,a=i;e.each(function(e){return e.companion&&!e.companion.visible&&t.push(e.companion)});for(var o=1;o<t.length;o++){var s=t[o];s.linear.top<i.linear.top&&(i=s),s.linear.right>n.linear.right&&(n=s),s.linear.bottom>r.linear.bottom&&(r=s),s.linear.left<a.linear.left&&(a=s)}return{top:i.linear.top,right:n.linear.right,bottom:r.linear.bottom,left:a.linear.left}}},{key:"actualParent",value:function(e){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}if(a.naturalElement){if(a.actualParent)return a.actualParent}else if(a.groupParent){var o=t.actualParent(a.children);if(o)return o}}return null}},{key:"baseline",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=A.filterArray(e,function(e){return!e.baselineAltered&&(e.baseline||S.isLength(e.verticalAlign))&&!e.floating&&(0===e.length||e.every(function(e){return e.baseline}))});if(!i.length)return i;if(e=i,t&&(A.spliceArray(e,function(e){return!(e.textElement&&e.naturalElement)}),0===e.length))return e;if(e.length>1){for(var n=0,r=0,a=0;a<e.length;a++){var o=e[a];if(o.layoutVertical&&o.length>1||o.plainText&&o.multiline)e.splice(a--,1);else{n=Math.max(n,o.lineHeight);var s=void 0;o.multiline&&o.cssTry("whiteSpace","nowrap")?(s=o.element.getBoundingClientRect().height,o.cssFinally("whiteSpace")):s=o.bounds.height,r=Math.max(r,s)}}A.spliceArray(e,function(e){return n>r?e.lineHeight!==n:e.bounds.height<r})}return e.sort(function(e,t){if(e.groupParent||e.length||!e.baseline&&t.baseline)return 1;if(t.groupParent||t.length||e.baseline&&!t.baseline)return-1;if(!e.imageElement||!t.imageElement){if(e.textElement&&t.textElement)return e.fontSize===t.fontSize?e.htmlElement&&!t.htmlElement?-1:!e.htmlElement&&t.htmlElement?1:e.siblingIndex<t.siblingIndex?-1:1:e.fontSize>t.fontSize?-1:1;if(e.containerType!==t.containerType)return e.textElement?-1:t.textElement?1:e.imageElement?-1:t.imageElement?1:e.containerType<t.containerType?-1:1}var i=Math.max(e.actualHeight,e.lineHeight),n=Math.max(t.actualHeight,t.lineHeight);return i!==n?i>n?-1:1:0})}},{key:"linearData",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[],n=new Set,r={},a=new Set,o=new Map,s=!1,l=!1,c=Array.isArray(u=e),h=0,u=c?u:u[Symbol.iterator]();;){var d;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}var f=d;if(f.pageFlow){if(n.size){var g=[],v=f.css("clear");switch(v){case"left":g.push(r.left);break;case"right":g.push(r.right);break;case"both":g.push(r.left,r.right)}for(var p=0,m=g;p<m.length;p++){var y=m[p];y&&n.has(y.float)&&!f.floating&&f.linear.top>=y.linear.bottom&&(n.delete(y.float),r[y.float]=void 0)}"both"===v?(o.set(f,2===n.size?"both":n.values().next().value),n.clear(),r.left=void 0,r.right=void 0):n.has(v)&&(o.set(f,v),n.delete(v),r[v]=void 0)}f.floating&&(n.add(f.float),a.add(f.float),r[f.float]=f),i.push(f)}}if(i.length&&!t){for(var b=[i[0]],k=1,x=1,S=1;S<i.length;S++)i[S].alignedVertically(i[S].previousSiblings(),b,o)?x++:k++,b.push(i[S]);if(l=x===i.length,(s=k===i.length)&&a.size){for(var _=1/0,w=-1/0,E=-1/0,T=1/0,I=0,C=i;I<C.length;I++){var R=C[I];_=Math.min(_,R.linear.left),w=Math.max(w,R.linear.right),R.floating&&("left"===R.float?E=Math.max(E,R.linear.right):T=Math.min(T,R.linear.left))}for(var B=0,P=0,M=0,L=0,N=0;B<i.length;B++){var O=i[B];if(Math.floor(O.linear.left)<=_&&P++,Math.ceil(O.linear.right)>=w&&M++,O.floating||(O.linear.left===E&&L++,O.linear.right===T&&N++),0!==B){if(2===P||2===M||2===L||2===N){s=!1;break}var W=i[B-1];if(W.floating&&O.linear.top>=W.linear.bottom||A.withinRange(O.linear.left,W.linear.left)){s=!1;break}}}}}return{linearX:s,linearY:l,cleared:o,floated:a}}},{key:"partitionRows",value:function(e){for(var t=this.actualParent(e),i=t?t.actualChildren:e,n=this.linearData(e,!0).cleared,r=A.filterArray(e,function(e){return e.groupParent}),a=[],o=[],s=0;s<i.length;s++){for(var l=i[s],c=!1,h=0;h<r.length;h++){var u=r[h];if(u.contains(l)||u===l){o.length&&a.push(o),a.push([u]),o=[],r.splice(h,1),c=!0;break}}if(!c){var d=l.previousSiblings();0===s||0===d.length?e.includes(l)&&o.push(l):l.alignedVertically(d,o,n)?(o.length&&a.push(o),o=e.includes(l)?[l]:[]):e.includes(l)&&o.push(l),s===i.length-1&&o.length&&a.push(o)}}return a}},{key:"siblingIndex",value:function(e,t){return e.siblingIndex<t.siblingIndex?-1:1}}]),t}(),w=squared.lib.util,E=function(e){function t(e,i){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0;return r(this,t),(n=u(this,c(t).call(this,s))).parent=e,n.node=i,n.containerType=a,n.alignmentType=o,n.rowCount=0,n.columnCount=0,n.renderType=0,n.renderIndex=-1,n.itemCount=0,s&&n.init(),n}return l(t,squared.lib.base.Container),o(t,[{key:"init",value:function(){var e=_.linearData(this.children);this._floated=e.floated,this._cleared=e.cleared,this._linearX=e.linearX,this._linearY=e.linearY,e.floated.size&&(this.add(512),this.some(function(e){return e.blockStatic})&&this.add(64)),this.every(function(e){return e.rightAligned})&&this.add(1024),this.itemCount=this.children.length}},{key:"reset",value:function(e,t){this.containerType=0,this.alignmentType=0,this.rowCount=0,this.columnCount=0,this.renderType=0,this.renderIndex=-1,this.itemCount=0,this._floated=void 0,this._cleared=void 0,this._linearX=void 0,this._linearY=void 0,e&&(this.parent=e),t&&(this.node=t),this.clear()}},{key:"setType",value:function(e){this.containerType=e;for(var t=arguments.length,i=[],n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0,a=i;r<a.length;r++){this.add(a[r])}}},{key:"add",value:function(e){return w.hasBit(this.alignmentType,e)||(this.alignmentType|=e),this.alignmentType}},{key:"delete",value:function(e){return w.hasBit(this.alignmentType,e)&&(this.alignmentType^=e),this.alignmentType}},{key:"retain",value:function(e){return f(c(t.prototype),"retain",this).call(this,e),this.init(),this}},{key:"floated",get:function(){return this._floated||new Set}},{key:"cleared",get:function(){return this._cleared||new Map}},{key:"linearX",get:function(){return void 0===this._linearX||this._linearX}},{key:"linearY",get:function(){return void 0!==this._linearY&&this._linearY}},{key:"singleRowAligned",get:function(){if(void 0===this._singleRow){for(var e=1/0,t=Array.isArray(n=this),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(!a.inlineVertical&&!a.plainText||a.multiline)return!1;var o=w.convertFloat(a.verticalAlign);if(a.linear.top-o>=e)return!1;e=a.linear.bottom+o}this._singleRow=!0}return this._singleRow}},{key:"visible",get:function(){return this.filter(function(e){return e.visible})}}]),t}();!function(e){e[e.DOM_TRAVERSE=2]="DOM_TRAVERSE",e[e.EXTENSION=4]="EXTENSION",e[e.RENDER=8]="RENDER",e[e.ALL=14]="ALL"}(b||(b={})),function(e){e[e.BOX_STYLE=2]="BOX_STYLE",e[e.BOX_SPACING=4]="BOX_SPACING",e[e.FONT_STYLE=8]="FONT_STYLE",e[e.VALUE_STRING=16]="VALUE_STRING",e[e.IMAGE_SOURCE=32]="IMAGE_SOURCE",e[e.ASSET=56]="ASSET",e[e.ALL=126]="ALL"}(k||(k={})),function(e){e[e.CONSTRAINT=2]="CONSTRAINT",e[e.LAYOUT=4]="LAYOUT",e[e.ALIGNMENT=8]="ALIGNMENT",e[e.AUTOFIT=16]="AUTOFIT",e[e.OPTIMIZATION=32]="OPTIMIZATION",e[e.CUSTOMIZATION=64]="CUSTOMIZATION",e[e.ACCESSIBILITY=128]="ACCESSIBILITY",e[e.LOCALIZATION=256]="LOCALIZATION",e[e.POSITIONAL=46]="POSITIONAL",e[e.NONPOSITIONAL=464]="NONPOSITIONAL",e[e.ALL=510]="ALL"}(x||(x={}));var T=Object.freeze({get APP_SECTION(){return b},get NODE_RESOURCE(){return k},get NODE_PROCEDURE(){return x}}),I=squared.lib.color,C=squared.lib.client,R=squared.lib.css,B=squared.lib.math,P=squared.lib.regex,M=squared.lib.session,L=squared.lib.util,N="(rgba?\\(\\d+, \\d+, \\d+(?:, [\\d.]+)?\\)|#[a-zA-Z\\d]{3,}|[a-z]+)\\s*(".concat(P.STRING.LENGTH_PERCENTAGE,"|").concat(P.STRING.CSS_ANGLE,"|(?:").concat(P.STRING.CSS_CALC,"(?=,)|").concat(P.STRING.CSS_CALC,"))?,?\\s*"),O=RegExp('(?:initial|url\\("?.+?"?\\)|(repeating)?-?(linear|radial|conic)-gradient\\(((?:to [a-z ]+|(?:from )?-?[\\d.]+(?:deg|rad|turn|grad)|(?:circle|ellipse)?\\s*(?:closest-side|closest-corner|farthest-side|farthest-corner)?)?(?:\\s*at [\\w %]+)?),?\\s*((?:'.concat(N,")+)\\))"),"g"),W=/\s*<br[^>]*>\s*/g;function D(e,t,i){for(var n=t[i],r=Array.isArray(o=e.actualChildren),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}var l=s;(l.excluded||l.pseudoElement||l.dataset.target)&&L.isString(l[i])&&(n=n.replace(l[i],""))}return"innerHTML"===i&&(n=n.replace(P.ESCAPE.ENTITY,function(e,t){return String.fromCharCode(parseInt(t))})),n}function F(e,t,i,n){for(var r,a=t,o=!0===a.repeating,s=o&&"radial"===t.type?a.radiusExtent/a.radius:1,l=[],c=RegExp(N,"g");null!==(r=c.exec(i));){var h=I.parseColor(r[1],n,!0);if(h){var u={color:h,offset:-1};if("conic"===t.type)r[3]&&r[4]&&(u.offset=R.convertAngle(r[3],r[4])/360);else if(r[2]){if(R.isPercent(r[2]))u.offset=parseFloat(r[2])/100;else if(o){var d=a.horizontal,f="radial"===t.type?a.radius:t.dimension[d?"width":"height"];R.isLength(r[2])?u.offset=e.parseUnit(r[2],d,!1)/f:R.isCalc(r[2])&&(u.offset=R.calculate(r[6],f,e.fontSize)/f)}o&&-1!==u.offset&&(u.offset*=s)}0===l.length&&(-1===u.offset?u.offset=0:u.offset>0&&l.push({color:h,offset:0})),l.push(u)}}var g=l[l.length-1];-1===g.offset&&(g.offset=1);for(var v=0,p=0;p<l.length;p++){var m=l[p];if(-1===m.offset)if(0===p)m.offset=0;else{for(var y=p+1,b=2;y<l.length-1;y++,b++)if(-1!==l[y].offset){m.offset=(v+l[y].offset)/b;break}-1===m.offset&&(m.offset=v+g.offset/(l.length-1))}v=m.offset}if(o){if(v<100){var k=l.slice(0);e:for(var x=v;v<100;){for(var S=0;S<k.length;S++)if(l.push(Object.assign({},k[S],{offset:v=Math.min(x+k[S].offset,1)})),1===v)break e;x=v}}}else v<1&&l.push(Object.assign({},l[l.length-1],{offset:1}));return l}function H(e){if(e){var t=R.parseAngle(e.trim());return t<0&&(t+=360),t}return 0}function z(e,t,i,n){switch(n=n.replace(P.ESCAPE.U00A0,"&#160;"),t.css("whiteSpace")){case"nowrap":n=n.replace(/\n/g," ");break;case"pre":case"pre-wrap":e.layoutVertical||(n=n.replace(/^\s*?\n/,"")),n=n.replace(/\n/g,"\\n").replace(/\s/g,"&#160;");break;case"pre-line":n=n.replace(/\n/g,"\\n").replace(/\s+/g," ");break;default:return i.previousSibling&&M.causesLineBreak(i.previousSibling,t.sessionId)&&(n=n.replace(P.CHAR.LEADINGSPACE,"")),i.nextSibling&&M.causesLineBreak(i.nextSibling,t.sessionId)&&(n=n.replace(P.CHAR.TRAILINGSPACE,"")),[n,!1]}return[n,!0]}function V(e,t,i){if(i){var n=i.split(P.XML.SEPARATOR);return U.getBackgroundSize(e,n[t%n.length])}}function q(e,t){if("none"===e||"initial"===e)return t;var i=t.split(P.XML.BREAKWORD);switch(e){case"uppercase":for(var n=Array.isArray(a=i),r=0,a=n?a:a[Symbol.iterator]();;){var o;if(n){if(r>=a.length)break;o=a[r++]}else{if((r=a.next()).done)break;o=r.value}var s=o;P.XML.ENTITY.test(s)||(t=t.replace(s,s.toUpperCase()))}break;case"lowercase":for(var l=Array.isArray(h=i),c=0,h=l?h:h[Symbol.iterator]();;){var u;if(l){if(c>=h.length)break;u=h[c++]}else{if((c=h.next()).done)break;u=c.value}var d=u;P.XML.ENTITY.test(d)||(t=t.replace(d,d.toLowerCase()))}break;case"capitalize":for(var f=Array.isArray(v=i),g=0,v=f?v:v[Symbol.iterator]();;){var p;if(f){if(g>=v.length)break;p=v[g++]}else{if((g=v.next()).done)break;p=g.value}t=t.replace(p,L.capitalize(p))}}return t}var X=function(e){return e?/(.+?)?\s*at (.+?)$/.exec(e):null},U=function(){function e(t,i){r(this,e),this.application=t,this.cache=i}return o(e,[{key:"finalize",value:function(e){}},{key:"reset",value:function(){for(var t in e.ASSETS)e.ASSETS[t]=new Map;for(var i in e.STORED)e.STORED[i]=new Map;this.fileHandler&&this.fileHandler.reset()}},{key:"setBoxStyle",value:function(t){if(t.visible&&t.styleElement){var i={backgroundColor:"",backgroundSize:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundImage:void 0,borderRadius:void 0,backgroundClip:void 0};for(var n in t.css("border").startsWith("0px none")||(i.borderTop=void 0,i.borderRight=void 0,i.borderBottom=void 0,i.borderLeft=void 0),i){var r=t.css(n);switch(n){case"backgroundColor":if(!t.has("backgroundColor")&&(r===t.cssAscend("backgroundColor",!1,!0)||t.documentParent.visible&&e.isInheritedStyle(t,"backgroundColor")))continue;var a=I.parseColor(r,t.css("opacity"));a&&(i.backgroundColor=a.valueAsRGBA);break;case"backgroundSize":case"backgroundRepeat":case"backgroundPositionX":case"backgroundPositionY":i[n]=r;break;case"backgroundImage":if("none"!==r&&t.hasResource(k.IMAGE_SOURCE)){for(var o=[],s=t.css("opacity"),l=void 0,c=0;null!==(l=O.exec(r));){var h=g(l,5),u=h[0],d=h[1],f=h[2],v=h[3],p=h[4];if("initial"===u||u.startsWith("url"))o.push(u);else{var m=V(t,c,i.backgroundSize)||t.actualDimension,y=void 0;switch(f){case"conic":var b=X(v),x={type:f,dimension:m,angle:H(v)};x.center=R.getBackgroundPosition(b&&b[2]||"center",m,t.fontSize),x.colorStops=F(t,x,p,s),y=x;break;case"radial":var S=X(v),A={type:f,repeating:"repeating"===d,horizontal:t.actualWidth<=t.actualHeight,dimension:m,shape:S&&S[1]&&S[1].startsWith("circle")?"circle":"ellipse"};A.center=R.getBackgroundPosition(S&&S[2]||"center",m,t.fontSize),A.closestCorner=1/0,A.farthestCorner=-1/0;for(var _=0,w=[[0,0],[m.width,0],[m.width,m.height],[0,m.height]];_<w.length;_++){var E=w[_],T=Math.round(Math.sqrt(Math.pow(Math.abs(E[0]-A.center.left),2)+Math.pow(Math.abs(E[1]-A.center.top),2)));T<A.closestCorner&&(A.closestCorner=T),T>A.farthestCorner&&(A.farthestCorner=T)}A.closestSide=A.center.top,A.farthestSide=A.center.top;for(var C=0,P=[m.width-A.center.left,m.height-A.center.top,A.center.left];C<P.length;C++){var M=P[C];M<A.closestSide&&(A.closestSide=M),M>A.farthestSide&&(A.farthestSide=M)}A.radius=A.farthestCorner;var N=S&&S[1]?S[1].split(" ").pop():"";switch(N){case"closest-corner":case"closest-side":case"farthest-side":var W=A[L.convertCamelCase(N)];d?A.radiusExtent=W:A.radius=W;break;default:A.radiusExtent=A.farthestCorner}A.colorStops=F(t,A,p,s),y=A;break;default:var D=180;switch(v){case"to top":D=0;break;case"to right top":D=45;break;case"to right":D=90;break;case"to right bottom":D=135;break;case"to bottom":break;case"to left bottom":D=225;break;case"to left":D=270;break;case"to left top":D=315;break;default:v&&(D=H(v))}var z={type:f,repeating:"repeating"===d,horizontal:D>=45&&D<=135||D>=225&&D<=315,dimension:m,angle:D};z.colorStops=F(t,z,p,s);var q=m.width,U=m.height,G=B.truncateFraction(B.offsetAngleX(D,q)),j=B.truncateFraction(B.offsetAngleY(D,U));if(G!==q&&j!==U&&!B.isEqual(Math.abs(G),Math.abs(j))){var Y=void 0;Y=D<=90?B.offsetAngle({x:0,y:U},{x:q,y:0}):D<=180?B.offsetAngle({x:0,y:0},{x:q,y:U}):D<=270?B.offsetAngle({x:0,y:0},{x:-q,y:U}):B.offsetAngle({x:0,y:U},{x:-q,y:0});var K=Math.abs(Y-D),Z=90-K,$=B.triangulateASA(K,Z,Math.sqrt(Math.pow(q,2)+Math.pow(U,2)));G=B.truncateFraction(B.offsetAngleX(D,$[1]));var Q=B.triangulateASA(K=90,Z=90-D,G);j=B.truncateFraction(B.offsetAngleY(D,Q[0]))}z.angleExtent={x:G,y:j},y=z}o.push(y)}c++}c>0&&(i.backgroundImage=o)}break;case"backgroundClip":switch(r){case"content-box":i.backgroundClip={top:t.borderTopWidth+t.paddingTop,right:t.borderRightWidth+t.paddingRight,bottom:t.borderBottomWidth+t.paddingBottom,left:t.borderLeftWidth+t.paddingLeft};break;case"padding-box":i.backgroundClip={top:t.borderTopWidth,right:t.borderRightWidth,bottom:t.borderBottomWidth,left:t.borderLeftWidth}}break;case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":var J=t.css("".concat(n,"Style"))||"none",ee=t.convertPX(t.css("".concat(n,"Width")),"borderLeft"===n||"borderRight"===n,!1)||"0px",te=t.css("".concat(n,"Color"))||"initial";switch(te.toLowerCase()){case"initial":te="rgb(0, 0, 0)";break;case"inherit":case"currentcolor":te=R.getInheritedStyle(t.element,"".concat(n,"Color"))}if("none"!==J&&"0px"!==ee){var ie=I.parseColor(te,t.css("opacity"),!0);ie&&(i[n]={width:ee,style:J,color:ie.valueAsRGBA})}break;case"borderRadius":if("0px"!==r)if("continue"===function(){var e=t.actualWidth>=t.actualHeight,n=g(t.css("borderTopLeftRadius").split(" "),2),r=n[0],a=n[1],o=g(t.css("borderTopRightRadius").split(" "),2),s=o[0],l=o[1],c=g(t.css("borderBottomRightRadius").split(" "),2),h=c[0],u=c[1],d=g(t.css("borderBottomLeftRadius").split(" "),2),f=d[0],v=d[1],p=void 0;if((p=a||l||u||v?[r,a||r,s,l||s,h,u||h,f,v||f]:[r,s,h,f]).every(function(e){return e===p[0]})){if("0px"===p[0]||""===p[0])return"continue";p.length=1}for(var m=0;m<p.length;m++)p[m]=t.convertPX(p[m],e,!1);i.borderRadius=p}())continue}}if(i.borderTop&&i.borderRight&&i.borderBottom&&i.borderLeft){var ne=!0;for(var re in i.borderTop){var ae=i.borderTop[re];if(ae!==i.borderRight[re]||ae!==i.borderBottom[re]||ae!==i.borderLeft[re]){ne=!1;break}}ne&&(i.border=i.borderTop)}t.data(e.KEY_NAME,"boxStyle",i)}}},{key:"setFontStyle",value:function(t){if(!(null===t.element||t.renderChildren.length||t.imageElement||t.svgElement||"HR"===t.tagName||t.inlineText&&!t.preserveWhiteSpace&&""===t.element.innerHTML.trim()&&!e.isBackgroundVisible(t.data(e.KEY_NAME,"boxStyle")))){var i=t.css("opacity"),n=I.parseColor(t.css("color"),i),r=t.css("fontFamily").trim(),a=t.css("fontSize"),o=t.css("fontWeight");if(C.isUserAgent(16)&&!t.has("fontFamily"))switch(t.tagName){case"TT":case"CODE":case"KBD":case"SAMP":r="monospace"}if(0===L.convertInt(a))switch(a){case"xx-small":a="8px";break;case"x-small":a="10px";break;case"small":a="13px";break;case"medium":a="16px";break;case"large":a="18px";break;case"x-large":a="24px";break;case"xx-large":a="32px"}if(!L.isNumber(o))switch(o){case"lighter":o="200";break;case"bold":o="700";break;case"bolder":o="900";break;default:o="400"}var s={fontFamily:r,fontStyle:t.css("fontStyle"),fontSize:a,fontWeight:o,color:n?n.valueAsRGBA:""};t.data(e.KEY_NAME,"fontStyle",s)}}},{key:"setValueString",value:function(t){if(t.visible&&!t.svgElement){var i=t.element,n=t.renderParent;if(i&&n){var r="",a="",o=!1,s=!1,l=t.css("textTransform");switch(i.tagName){case"INPUT":switch(a=i.value,i.type){case"radio":case"checkbox":t.companion&&!t.companion.visible&&(a=t.companion.textContent);break;case"submit":""!==a||t.visibleStyle.backgroundImage||(a="Submit");break;case"time":""===a&&(a="--:-- --");break;case"date":case"datetime-local":if(""===a){switch((new Intl.DateTimeFormat).resolvedOptions().locale){case"en-US":a="mm/dd/yyyy";break;default:a="dd/mm/yyyy"}"datetime-local"===i.type&&(a+=" --:-- --")}break;case"week":""===a&&(a="Week: --, ----");break;case"month":""===a&&(a="--------- ----");break;case"url":case"email":case"search":case"number":case"tel":""===a&&(a=i.placeholder);break;case"file":a=C.isUserAgent(8)?"Browse...":"Choose File"}break;case"TEXTAREA":a=i.value;break;case"BUTTON":a=q(l,i.innerText);break;case"IFRAME":a=i.src;break;default:if(t.plainText)r=t.textContent.trim(),a=g(z(n,t,i,q(l,t.textContent.replace(P.ESCAPE.AMP,"&amp;"))),1)[0],s=!0,o=!0;else if(t.inlineText){r=t.textContent.trim();var c=g(z(n,t,i,a="CODE"===i.tagName?D(t,i,"innerHTML"):e.hasLineBreak(t,!0)?q(l,D(t,i,"innerHTML")).replace(W,"\\n").replace(P.XML.TAGNAME_G,""):q(l,D(t,i,"textContent"))),2);a=c[0],s=c[1],o=!0}else e.isBackgroundVisible(t.data(e.KEY_NAME,"boxStyle"))&&""===i.innerText.trim()&&(a=q(l,i.innerText))}if(""!==a){if(o){var h=t.previousSiblings().pop(),u=!1;if(a.length>1&&(void 0===h||h.multiline||h.lineBreak||h.plainText&&P.CHAR.TRAILINGSPACE.test(h.textContent)?a=a.replace(P.CHAR.LEADINGSPACE,""):h.element&&(u=P.CHAR.TRAILINGSPACE.test(h.element.innerHTML||h.element.innerText||h.textContent))),s){var d=a;a=a.trim(),!h||h.block||h.lineBreak||u||!P.CHAR.LEADINGSPACE.test(d)||(a="&#160;"+a),!t.lineBreakTrailing&&P.CHAR.TRAILINGSPACE.test(d)&&(a+="&#160;")}else if(""!==a.trim())a=(a=a.replace(P.CHAR.LEADINGSPACE,h&&(h.block||h.lineBreak||u&&h.htmlElement&&h.textContent.length>1||t.multiline&&e.hasLineBreak(t))?"":"&#160;")).replace(P.CHAR.TRAILINGSPACE,"table-cell"===t.display||t.lineBreakTrailing||t.blockStatic?"":"&#160;");else if(!t.inlineText)return}""!==a&&t.data(e.KEY_NAME,"valueString",{name:r,value:a})}}}}},{key:"stored",get:function(){return e.STORED}}],[{key:"generateId",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t,r=i;1===i&&(t+="_".concat(""+r));for(var a=this.ASSETS.ids.get(e)||[];;){if(!a.includes(t)){a.push(t);break}t="".concat(n,"_").concat(""+ ++r)}return this.ASSETS.ids.set(e,a),t}},{key:"insertStoredAsset",value:function(t,i,n){var r=e.STORED[t];if(r&&L.hasValue(n)){var a=this.getStoredName(t,n);if(""===a){L.isNumber(i)&&(i="__".concat(i));var o=0;do{a=i,o>0&&(a+="_".concat(o)),r.has(a)||r.set(a,n),o++}while(r.has(a)&&r.get(a)!==n)}return a}return""}},{key:"getOptionArray",value:function(e){for(var t=[],i=R.getStyle(e).getPropertyValue("text-transform"),n=[],r=-1;++r<e.children.length;){var a=e.children[r].text.trim();if(""!==a)if(n&&0===t.length&&L.isNumber(a))n.push(a);else{if(n&&n.length){r=-1,n=void 0;continue}""!==a&&t.push(q(i,a))}}return[t.length?t:void 0,n&&n.length?n:void 0]}},{key:"isBackgroundVisible",value:function(e){return void 0!==e&&(void 0!==e.backgroundImage||void 0!==e.borderTop||void 0!==e.borderRight||void 0!==e.borderBottom||void 0!==e.borderLeft)}},{key:"getBackgroundSize",value:function(e,t){var i=0,n=0;switch(t){case"":case"cover":case"contain":case"100% 100%":case"auto":case"auto auto":case"initial":return;default:var r=t.split(" ");1===r.length&&(r[1]=r[0]);for(var a=0;a<r.length;a++)"auto"===r[a]&&(r[a]="100%"),0===a?i=e.parseUnit(r[a],!0,!1):n=e.parseUnit(r[a],!1,!1)}return i>0&&n>0?{width:Math.round(i),height:Math.round(n)}:void 0}},{key:"isInheritedStyle",value:function(e,t){if(e.styleElement){var i=e.actualParent;if(i&&!e.cssInitial(t))return e.style[t]===i.style[t]}return!1}},{key:"causesLineBreak",value:function(e){return e.lineBreak||e.excluded&&e.blockStatic}},{key:"hasLineBreak",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.actualChildren.length)return e.actualChildren.some(function(e){return e.lineBreak});if(!t&&e.element&&e.element.textContent){var n=e.element.textContent;if(i&&(n=n.trim()),/\n/.test(n))return!(!e.plainText||!R.isParentStyle(e.element,"whiteSpace","pre","pre-wrap"))||e.css("whiteSpace").startsWith("pre")}return!1}},{key:"getStoredName",value:function(t,i){if(e.STORED[t]){var n=e.STORED[t].entries(),r=Array.isArray(n),a=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=g(o,2),l=s[0];if(L.isEqual(i,s[1]))return l}}return""}}]),e}();U.KEY_NAME="squared.resource",U.ASSETS={ids:new Map,images:new Map},U.STORED={strings:new Map,arrays:new Map,fonts:new Map,colors:new Map,images:new Map};var G,j=squared.lib.css,Y=squared.lib.dom,K=squared.lib.regex,Z=squared.lib.session,$=squared.lib.util,Q=squared.lib.xml;function J(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=[],r=e;r;){if(r.dataset.use){var a=r.dataset.use.split(K.XML.SEPARATOR),o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var l;if(o){if(s>=a.length)break;l=a[s++]}else{if((s=a.next()).done)break;l=s.value}n.push(l)}}if(null===i||r===i)break;r!==i&&(r=r.parentElement)}if(n.length){for(var c=[],h=[],u=Array.isArray(f=t),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}var v=g,p=n.indexOf(v.name);-1!==p?c[p]=v:h.push(v)}return $.concatArray($.spliceArray(c,function(e){return void 0===e}),h)}return t}var ee=function(){function e(t,i,n,a,o){r(this,e),this.framework=t,this.initialized=!1,this.closed=!1,this.builtInExtensions={},this.extensions=[],this.rootElements=new Set,this.session={cache:new _,documentRoot:[],image:new Map,targetQueue:new Map,excluded:new _,active:[],extensionMap:new Map},this.processing={cache:new _,node:void 0,excluded:new _,sessionId:""},this._views=[],this._includes=[],G=i,this.controllerHandler=new n(this,this.processing.cache),this.resourceHandler=new a(this,this.processing.cache),this.extensionManager=new o(this,this.processing.cache)}return o(e,[{key:"registerController",value:function(e){e.application=this,e.cache=this.processing.cache,this.controllerHandler=e}},{key:"registerResource",value:function(e){e.application=this,e.cache=this.processing.cache,this.resourceHandler=e}},{key:"finalize",value:function(){var e=this.controllerHandler,t=this.session.targetQueue.entries(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=g(r,2),o=a[1];if((f=a[0]).dataset.target){var s=this.resolveTarget(f.dataset.target);s?(f.render(s),this.addRenderTemplate(s,f,o)):void 0===f.renderParent&&this.session.cache.remove(f)}}for(var l=this.rendered,c=Array.isArray(u=l),h=0,u=c?u:u[Symbol.iterator]();;){var d,f;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}(f=d).hasProcedure(x.LAYOUT)&&f.setLayout(),f.hasProcedure(x.ALIGNMENT)&&f.setAlignment()}for(var v=Array.isArray(m=l),p=0,m=v?m:m[Symbol.iterator]();;){var y;if(v){if(p>=m.length)break;y=m[p++]}else{if((p=m.next()).done)break;y=p.value}var b=y;b.hasProcedure(x.OPTIMIZATION)&&b.applyOptimizations(),!this.userSettings.customizationsDisabled&&b.hasProcedure(x.CUSTOMIZATION)&&b.applyCustomizations(this.userSettings.customizationsOverwritePrivilege)}for(var S=Array.isArray(_=this.extensions),A=0,_=S?_:_[Symbol.iterator]();;){var w;if(S){if(A>=_.length)break;w=_[A++]}else{if((A=_.next()).done)break;w=A.value}for(var E=w,T=Array.isArray(C=E.subscribers),I=0,C=T?C:C[Symbol.iterator]();;){var R;if(T){if(I>=C.length)break;R=C[I++]}else{if((I=C.next()).done)break;R=I.value}E.postProcedure(R)}}for(var B=Array.isArray(M=this.rendered),P=0,M=B?M:M[Symbol.iterator]();;){var L;if(B){if(P>=M.length)break;L=M[P++]}else{if((P=M.next()).done)break;L=P.value}var N=L;N.hasResource(k.BOX_SPACING)&&N.setBoxSpacing()}for(var O=Array.isArray(D=this.extensions),W=0,D=O?D:D[Symbol.iterator]();;){var F;if(O){if(W>=D.length)break;F=D[W++]}else{if((W=D.next()).done)break;F=W.value}F.beforeCascadeDocument()}for(var H=Array.isArray(V=this.session.documentRoot),z=0,V=H?V:V[Symbol.iterator]();;){var q;if(H){if(z>=V.length)break;q=V[z++]}else{if((z=V.next()).done)break;q=z.value}var X=q.node,U=X.renderParent;U&&U.renderTemplates&&this.addLayoutFile(q.layoutName,e.localSettings.layout.baseTemplate+e.cascadeDocument(U.renderTemplates,0),X.dataset.pathname,!!X.renderExtension&&X.renderExtension.some(function(e){return e.documentBase}))}for(var G=Array.isArray(K=this.extensions),j=0,K=G?K:K[Symbol.iterator]();;){var Z;if(G){if(j>=K.length)break;Z=K[j++]}else{if((j=K.next()).done)break;Z=j.value}Z.beforeFinalize()}var $=this.viewData;this.resourceHandler.finalize($),e.finalize($);for(var Q=Array.isArray(ee=this.extensions),J=0,ee=Q?ee:ee[Symbol.iterator]();;){var te;if(Q){if(J>=ee.length)break;te=ee[J++]}else{if((J=ee.next()).done)break;te=J.value}te.afterFinalize()}Y.removeElementsByClassName("__squared.placeholder"),Y.removeElementsByClassName("__squared.pseudo"),this.closed=!0}},{key:"saveAllToDisk",value:function(){this.resourceHandler.fileHandler&&this.resourceHandler.fileHandler.saveAllToDisk(this.viewData)}},{key:"reset",value:function(){for(var e=this,t=function(){if(i){if(n>=r.length)return"break";a=r[n++]}else{if((n=r.next()).done)return"break";a=n.value}var t=a;e.session.cache.each(function(e){e.element&&e.naturalElement&&!e.pseudoElement&&(Z.deleteElementCache(e.element,"node",t),Z.deleteElementCache(e.element,"styleMap",t))})},i=Array.isArray(r=this.session.active),n=0,r=i?r:r[Symbol.iterator]();;){var a;if("break"===t())break}for(var o=Array.isArray(l=this.rootElements),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}c.dataset.iteration=""}this.session.documentRoot.length=0,this.session.active.length=0,this.session.targetQueue.clear(),this.session.image.clear(),this.session.cache.reset(),this.session.excluded.reset(),this.session.extensionMap.clear(),this.processing.cache.reset(),this.controllerHandler.reset(),this.resourceHandler.reset(),this._views.length=0,this._includes.length=0;for(var h=Array.isArray(d=this.extensions),u=0,d=h?d:d[Symbol.iterator]();;){var f;if(h){if(u>=d.length)break;f=d[u++]}else{if((u=d.next()).done)break;f=u.value}f.subscribers.clear()}this.closed=!1}},{key:"parseDocument",value:function(){var e,t=this;this.rootElements.clear(),this.initialized=!1,this.processing.sessionId=this.controllerHandler.generateSessionId,this.session.active.push(this.processing.sessionId),this.setStyleMap();for(var i=arguments.length,n=[],r=0;r<i;r++)n[r]=arguments[r];0===n.length&&n.push(document.body);for(var a=0,o=n;a<o.length;a++){var s=o[a],l="string"==typeof s?document.getElementById(s):s;j.hasComputedStyle(l)&&this.rootElements.add(l)}var c=this.rootElements.values().next().value,h=[],u=function(){t.initialized=!1;for(var i=0,n=h;i<n.length;i++){c.removeChild(n[i])}var r=t.session.image.entries(),a=Array.isArray(r),o=0;for(r=a?r:r[Symbol.iterator]();;){var s;if(a){if(o>=r.length)break;s=r[o++]}else{if((o=r.next()).done)break;s=o.value}var l=g(s,2);U.ASSETS.images.set(l[0],l[1])}for(var u=Array.isArray(f=t.extensions),d=0,f=u?f:f[Symbol.iterator]();;){var v;if(u){if(d>=f.length)break;v=f[d++]}else{if((d=f.next()).done)break;v=d.value}v.beforeParseDocument()}for(var p=Array.isArray(y=t.rootElements),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b,x=(k.dataset.iteration?$.convertInt(k.dataset.iteration):-1)+1;if(k.dataset.iteration=""+x,t.createCache(k)){var S=k.dataset.filename&&k.dataset.filename.replace(RegExp(".".concat(t.controllerHandler.localSettings.layout.fileExtension,"$")),"")||k.id||"document_".concat(t.length);k.dataset.layoutName=$.convertWord(x>1?"".concat(S,"_").concat(x):S,!0),t.setBaseLayout(k.dataset.layoutName),t.setConstraints(),t.setResources()}}for(var A=Array.isArray(w=t.extensions),_=0,w=A?w:w[Symbol.iterator]();;){var E;if(A){if(_>=w.length)break;E=w[_++]}else{if((_=w.next()).done)break;E=_.value}for(var T=E,I=Array.isArray(R=T.subscribers),C=0,R=I?R:R[Symbol.iterator]();;){var B;if(I){if(C>=R.length)break;B=R[C++]}else{if((C=R.next()).done)break;B=C.value}T.postParseDocument(B)}T.afterParseDocument()}"function"==typeof e&&e.call(t)},d=[];if(this.userSettings.preloadImages){for(var f=Array.isArray(p=this.rootElements),v=0,p=f?p:p[Symbol.iterator]();;){var m;if(f){if(v>=p.length)break;m=p[v++]}else{if((v=p.next()).done)break;m=v.value}var y=m;y.querySelectorAll("input[type=image]").forEach(function(e){var i=e.src;""!==i&&t.session.image.set(i,{width:e.width,height:e.height,uri:i})}),y.querySelectorAll("svg image").forEach(function(e){var i=$.resolvePath(e.href.baseVal);""!==i&&t.session.image.set(i,{width:e.width.baseVal.value,height:e.height.baseVal.value,uri:i})})}var b=this.session.image.values(),k=Array.isArray(b),x=0;for(b=k?b:b[Symbol.iterator]();;){var S;if(k){if(x>=b.length)break;S=b[x++]}else{if((x=b.next()).done)break;S=x.value}var A=S;if(0===A.width&&0===A.height&&A.uri){var _=document.createElement("img");_.src=A.uri,_.complete&&_.naturalWidth>0&&_.naturalHeight>0?(A.width=_.naturalWidth,A.height=_.naturalHeight):(c.appendChild(_),h.push(_))}}for(var w=Array.isArray(T=this.rootElements),E=0,T=w?T:T[Symbol.iterator]();;){var I;if(w){if(E>=T.length)break;I=T[E++]}else{if((E=T.next()).done)break;I=E.value}I.querySelectorAll("IMG").forEach(function(e){"IMG"===e.tagName&&(e.complete?t.addImagePreload(e):d.push(e))})}}return 0===d.length?u():(this.initialized=!0,Promise.all($.objectMap(d,function(e){return new Promise(function(t,i){e.onload=function(){t(e)},e.onerror=function(){i(e)}})})).then(function(e){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}t.addImagePreload(a)}u()}).catch(function(e){var t=e.target?e.target.src:"";$.hasValue(t)&&!confirm("FAIL: ".concat(t))||u()})),{then:function(i){t.initialized?e=i:i()}}}},{key:"renderNode",value:function(e){return 0===e.itemCount?this.controllerHandler.renderNode(e):this.controllerHandler.renderNodeGroup(e)}},{key:"renderLayout",value:function(e,t){return $.hasBit(e.renderType,512)&&($.hasBit(e.renderType,8)?e=this.processFloatHorizontal(e):$.hasBit(e.renderType,16)&&(e=this.processFloatVertical(e,t))),0!==e.containerType?this.renderNode(e):void 0}},{key:"addLayoutFile",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(""!==t){var r={pathname:$.trimString(i||this.controllerHandler.localSettings.layout.pathName,"/"),filename:e,content:t};n?this._views.unshift(r):this._views.push(r)}}},{key:"addIncludeFile",value:function(e,t,i){this._includes.push({id:e,pathname:this.controllerHandler.localSettings.layout.pathName,filename:t,content:i})}},{key:"addRenderLayout",value:function(e,t){var i;return i=t?this.renderLayout(e,t):this.renderNode(e),this.addRenderTemplate(e.parent,e.node,i,e.renderIndex)}},{key:"addRenderTemplate",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;return!!i&&(t.renderExclude?(t.hide(),t.excluded=!0):void 0===t.renderParent?this.session.targetQueue.set(t,i):(void 0===e.renderTemplates&&(e.renderTemplates=[]),n>=0&&n<e.renderChildren.length?(e.renderChildren.splice(n,0,t),e.renderTemplates.splice(n,0,i)):(e.renderChildren.push(t),e.renderTemplates.push(i))),!0)}},{key:"addImagePreload",value:function(e){if(e&&e.complete){var t=e.src.trim();""!==t&&this.session.image.set(t,{width:e.naturalWidth,height:e.naturalHeight,uri:t})}}},{key:"createNode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=new G(this.nextId,this.processing.sessionId,e,this.controllerHandler.afterInsertNode);if(i&&(r.depth=i.depth+1),n)for(var a=Array.isArray(s=n),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}l.parent=r}return t&&this.processing.cache.append(r,void 0!==n),r}},{key:"resolveTarget",value:function(e){for(var t=Array.isArray(n=this.processing.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.elementId===e||r.controlId===e)return r}for(var a=Array.isArray(s=this.session.cache),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}if(l.elementId===e||l.controlId===e)return l}}},{key:"toString",value:function(){return this._views.length?this._views[0].content:""}},{key:"createCache",value:function(e){this.processing.cache.afterAppend=void 0,this.processing.cache.clear(),this.processing.excluded.clear(),this.processing.node=void 0;for(var t=Array.isArray(n=this.extensions),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}r.beforeInit(e)}var a=this.cascadeParentNode(e);if(!a)return!1;a.parent=new G(0,this.processing.sessionId,e.parentElement||document.body,this.controllerHandler.afterInsertNode),a.siblingIndex=0,a.documentRoot=!0,a.documentParent=a.parent,this.processing.node=a;var o={},s=new Set,l=!1;function c(e,t,i,n,r){void 0===o[t]&&(o[t]={}),o[t][i]=r,e.style[i]=n}for(var h=Array.isArray(d=this.processing.cache),u=0,d=h?d:d[Symbol.iterator]();;){var f;if(h){if(u>=d.length)break;f=d[u++]}else{if((u=d.next()).done)break;f=u.value}var g=f;if(g.styleElement){var p=g.element;if(g.length){var m=g.cssInitial("textAlign");switch(m){case"center":case"right":case"end":c(p,g.id,"textAlign","left",m)}}if(g.positionRelative&&!g.positionStatic)for(var y=Array.isArray(k=j.BOX_POSITION),b=0,k=y?k:k[Symbol.iterator]();;){var x;if(y){if(b>=k.length)break;x=k[b++]}else{if((b=k.next()).done)break;x=b.value}var S=x;g.has(S)&&(c(p,g.id,S,"auto",g.css(S)),l=!0)}"rtl"===g.dir&&(p.dir="ltr",s.add(p))}}var A=new Set;a.parent.setBounds();for(var _=Array.isArray(E=this.processing.cache),w=0,E=_?E:E[Symbol.iterator]();;){var T;if(_){if(w>=E.length)break;T=E[w++]}else{if((w=E.next()).done)break;T=w.value}var I=T;I.pseudoElement?A.add(I.parent):I.setBounds(!l&&void 0===o[I.id]&&0===s.size)}for(var C=function(){if(R){if(B>=P.length)return"break";M=P[B++]}else{if((B=P.next()).done)return"break";M=B.value}var e=M;[e.beforePseudoChild,e.afterPseudoChild].forEach(function(t,i){if(t){var n,r=e.element,a=r.id;t.pageFlow&&(r.id="id_"+Math.round(Math.random()*(new Date).getTime()),n=j.insertStyleSheetRule("#".concat(r.id,"::").concat(0===i?"before":"after"," { display: none !important; }"))),t.cssTry("display",t.display)&&(t.setBounds(!1),t.cssFinally("display")),n&&document.head.removeChild(n),r.id=a}})},R=Array.isArray(P=A),B=0,P=R?P:P[Symbol.iterator]();;){var M;if("break"===C())break}for(var L=Array.isArray(O=this.processing.excluded),N=0,O=L?O:O[Symbol.iterator]();;){var W;if(L){if(N>=O.length)break;W=O[N++]}else{if((N=O.next()).done)break;W=N.value}var D=W;D.lineBreak||(D.setBounds(),D.saveAsInitial())}for(var F=new Set,H=Array.isArray(V=this.processing.cache),z=0,V=H?V:V[Symbol.iterator]();;){var q;if(H){if(z>=V.length)break;q=V[z++]}else{if((z=V.next()).done)break;q=z.value}var X=q;if(X.styleElement){var U=X.element,Y=o[X.id];if(Y)for(var K in Y)U.style[K]=Y[K];s.has(U)&&(U.dir="rtl")}if(!X.documentRoot){var Z=void 0;switch(X.position){case"fixed":if(!X.positionAuto){Z=a;break}case"absolute":if(X.positionAuto&&!X.previousSiblings().some(function(e){return e.multiline||e.excluded&&!e.blockStatic})&&(X.nextSiblings().every(function(e){return e.blockStatic||e.lineBreak||e.excluded})||Z&&X.element===Z.getLastChildElement()))X.cssApply({display:"inline-block",verticalAlign:"top"},!0),X.positionStatic=!0,Z=X.parent;else if(this.userSettings.supportNegativeLeftTop){var Q=!1;for(Z=X.absoluteParent;Z&&Z!==a;){if(Q){if(Z.layoutElement){Z=X.absoluteParent;break}if(X.withinX(Z.box)&&X.withinY(Z.box))break}else{if("hidden"===Z.css("overflow")||"0px"===X.cssInitial("top")||"0px"===X.cssInitial("right")||"0px"===X.cssInitial("bottom")||"0px"===X.cssInitial("left"))break;if(X.outsideY(Z.box)&&(X.top<0||X.marginTop<0||!X.has("top")&&0!==X.bottom||!Z.pageFlow&&X.top>0))Q=!0;else if(X.outsideX(Z.box)&&(!X.has("left")&&X.right>0||!Z.pageFlow&&X.left>0))Q=!0;else{if(!(X.outsideX(Z.linear)&&(X.left<0||X.marginLeft<0)||!X.has("left")&&X.right<0&&X.linear.left>=Z.linear.right))break;Q=!0}}Z=Z.actualParent}}else Z=X.absoluteParent}if(void 0===Z&&(Z=X.pageFlow?X.parent:a),Z!==X.parent){for(var J=X.parent,ee=$.convertFloat(X.css("opacity"))||1;J&&J!==Z;)ee*=$.convertFloat(J.css("opacity"))||1,J=J.actualParent;X.css("opacity",""+ee),X.parent=Z,X.siblingIndex=1/0,F.add(Z)}X.documentParent=Z}}for(var te=function(){if(ie){if(ne>=re.length)return"break";ae=re[ne++]}else{if((ne=re.next()).done)return"break";ae=ne.value}var e=ae;if(F.has(e)){var t=[];if(e.each(function(i){if(i.siblingIndex===1/0)for(var n=Array.isArray(a=e.children),r=0,a=n?a:a[Symbol.iterator]();;){var o;if(n){if(r>=a.length)break;o=a[r++]}else{if((r=a.next()).done)break;o=r.value}var s=o,l=s.actualChildren.includes(i);if(l||function(){var e=s.cascade();l=i.ascend(!1,function(t){return e.includes(t)}).length>0}(),l){var c=s.siblingIndex+(i.zIndex>=0||s!==i.actualParent?1:0);void 0===t[c]&&(t[c]=[]),t[c].push(i);break}}}),t.length){for(var i=e.children,n=0,r=0;n<t.length;n++,r++){var a=t[n];if(a){a.sort(function(e,t){return e.parent===t.parent?e.zIndex===t.zIndex?e.id<t.id?-1:1:e.zIndex<t.zIndex?-1:1:0});for(var o=0;o<i.length;o++)a.includes(i[o])&&(i[o]=void 0);i.splice.apply(i,[r,0].concat(v(a))),r+=a.length}}e.retain($.flatArray(i))}}e.saveAsInitial()},ie=Array.isArray(re=this.processing.cache),ne=0,re=ie?re:re[Symbol.iterator]();;){var ae;if("break"===te())break}this.processing.cache.sort(function(e,t){return e.depth!==t.depth?e.depth<t.depth?-1:1:e.documentParent!==t.documentParent?e.documentParent.siblingIndex<t.documentParent.siblingIndex?-1:1:e.siblingIndex<t.siblingIndex?-1:1});for(var oe=Array.isArray(le=this.extensions),se=0,le=oe?le:le[Symbol.iterator]();;){var ce;if(oe){if(se>=le.length)break;ce=le[se++]}else{if((se=le.next()).done)break;ce=se.value}ce.afterInit(e)}return!0}},{key:"cascadeParentNode",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.insertNode(e);if(n){switch(n.depth=i,0===i&&this.processing.cache.append(n),n.tagName){case"SELECT":case"SVG":return n}for(var r=this.controllerHandler.localSettings,a=this.createPseduoElement(e,"before"),o=this.createPseduoElement(e,"after"),s=[],l=!1,c=function(c){var h=e.childNodes[c];if("#"===h.nodeName.charAt(0)){if("#text"===h.nodeName){var u=t.insertNode(h,n);u&&s.push(u)}}else if(h===a){var d=t.insertNode(a);d&&(n.beforePseudoChild=d,d.setInlineText(!0),s.push(d),l=!0)}else if(h===o){var f=t.insertNode(o);f&&(n.afterPseudoChild=f,f.setInlineText(!0),s.push(f),l=!0)}else if(!r.unsupported.tagName.has(h.tagName)||"INPUT"===h.tagName&&!r.unsupported.tagName.has("".concat(h.tagName,":").concat(h.type)))if(J(h,t.extensions).some(function(e){return e.init(h)}),t.rootElements.has(h))l=!0;else{var g=t.cascadeParentNode(h,i+1);g&&(s.push(g),g.excluded||(l=!0))}},h=0;h<e.childNodes.length;h++)c(h);for(h=0;h<s.length;h++){var u=s[h];u.lineBreak&&(h>0&&(s[h-1].lineBreakTrailing=!0),h<s.length-1&&(s[h+1].lineBreakLeading=!0)),u.excluded?this.processing.excluded.append(u):!l&&u.plainText||(u.parent=n,this.processing.cache.append(u)),u.siblingIndex=h}n.setInlineText(!l),n.actualChildren=s}return n}},{key:"setBaseLayout",value:function(e){for(var t=this,i=this.controllerHandler,n=[],r=Array.isArray(o=this.extensions),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}s.eventOnly||n.push(s)}var l=this.processing.node,c=new Map;function h(e,t,i){var n=c.get(e)||new Map;c.set(e,n.set(t,i))}function u(e){var t=c.values(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=r,o=a.values(),s=Array.isArray(o),l=0;for(o=s?o:o[Symbol.iterator]();;){var h;if(s){if(l>=o.length)break;h=o[l++]}else{if((l=o.next()).done)break;h=l.value}if(h.id===e)return void a.delete(h.id)}}}h(-1,0,l.parent);for(var d=0,f=Array.isArray(v=this.processing.cache),g=0,v=f?v:v[Symbol.iterator]();;){var p;if(f){if(g>=v.length)break;p=v[g++]}else{if((g=v.next()).done)break;p=g.value}var m=p;m.visible&&(h(m.depth,m.id,m),d=Math.max(m.depth,d))}for(var y=0;y<d;y++)c.set(-1*y-2,new Map);this.processing.cache.afterAppend=function(e){u(e.id),h(-1*e.depth-2,e.id,e);var t=e.cascade(),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var a=r;u(a.id),h(-1*a.depth-2,a.id,a)}};var k=c.values(),x=Array.isArray(k),S=0;for(k=x?k:k[Symbol.iterator]();;){var A;if(x){if(S>=k.length)break;A=k[S++]}else{if((S=k.next()).done)break;A=S.value}var w=function(){if(I){if(C>=T.length)return"break";R=T[C++]}else{if((C=T.next()).done)return"break";R=C.value}var e=R;if(0===e.length)return"continue";var r=e.duplicate(),a=r.some(function(e){return e.floating}),o=void 0;a&&(o=_.linearData(e.actualChildren,!0).cleared);for(var s=-1,c=function(){var c=r[s];if(!c.visible||c.rendered)return"continue";if(c.htmlElement){var h=c.element;if(t.rootElements.has(h)&&!c.documentRoot&&!c.documentBody)return"continue";if(0===c.length&&h.children.length){for(var u=!0,d=0;d<h.children.length;d++)if(!t.rootElements.has(h.children[d])){u=!1;break}u&&c.setInlineText(!1,!0)}}var f=c.parent,g=t.session.extensionMap.get(c.id),v=c.hasAlign(4096);if(r.length>1&&s<r.length-1&&c.pageFlow&&(0===f.alignmentType||v||f.hasAlign(2))&&!f.hasAlign(4)&&c.hasSection(b.DOM_TRAVERSE)&&function(){var e,n,l=function(e){return!d.length&&!g&&(u.push(e),!0)},h=function(e){if(f.layoutVertical&&d.length){var t=d[d.length-1];if(t.layoutVertical)return void(e.parent=t)}d.push(e)},u=[],d=[],g=!1,p=s,m=0;v&&f.layoutVertical&&(u.push(c),p++,m++);e:for(var y=new Set,b=new Set;p<r.length;p++,m++){var k=r[p];if(k.pageFlow){if(a){var x=o.get(k);x&&("both"===x?b.clear():b.delete(x)),k.floating&&(y.add(k.float),b.add(k.float))}if(0===m){var S=k.nextSiblings().shift();if(S){!k.horizontalAligned||S.alignedVertically([k],[k])?d.push(k):u.push(k);continue}}var A=k.previousSiblings(),_=A[A.length-1];if(!_)break e;if(a){if(k.alignedVertically(A,u.length?u:d,o,u.length>0)){if(u.length){if((!k.blockStatic||"right"===_.float||!$.withinRange(_.linear.right,f.box.right))&&b.size&&!_.autoMargin.horizontal&&"both"!==o.get(k)&&!A.some(function(e){return e.lineBreak&&!o.has(e)})){var w=function(){var e=-1/0;return $.captureMap(u,function(e){return e.floating},function(t){return e=Math.max(e,t.linear.bottom)}),e};if(!k.floating||k.linear.top<w()){if(o.has(k)){if(!k.floating&&b.size>0){k.alignmentType|=4096,u.push(k),g=!0;continue}break e}var T=w();if(1===y.size&&(!k.floating&&k.linear.top<T||b.has(k.float))){if(u.push(k),!k.floating&&k.linear.bottom>=T)break e;continue}}}break e}h(k)}else if(!l(k))break e}else if(k.alignedVertically(A))h(k);else if(!l(k))break e}}u.length>1?(e=i.processTraverseHorizontal(new E(f,c,0,0,u),r),n=u[u.length-1]):d.length>1&&(e=i.processTraverseVertical(new E(f,c,0,0,d),r),(n=d[d.length-1]).horizontalAligned&&n!==r[r.length-1]&&(n.alignmentType|=4096)),f.hasAlign(2)&&n===r[r.length-1]&&(f.alignmentType^=2),e&&t.addRenderLayout(e.layout,f)&&(f=c.parent)}(),c.hasAlign(4096)&&(c.alignmentType^=4096),s===r.length-1&&f.hasAlign(2)&&(f.alignmentType^=2),c.renderAs&&f.appendTry(c,c.renderAs,!1)&&(c.hide(),(c=c.renderAs).positioned&&(f=c.parent)),!c.rendered&&c.hasSection(b.EXTENSION)){var p=e.renderExtension?e.renderExtension.slice(0):void 0;if(g&&(p?$.concatArray(p,g):p=g.slice(0)),p){for(var m=!1,y=Array.isArray(x=p),k=0,x=y?x:x[Symbol.iterator]();;){var S;if(y){if(k>=x.length)break;S=x[k++]}else{if((k=x.next()).done)break;S=k.value}var A=S.processChild(c,f);if(A&&(A.output&&t.addRenderTemplate(A.parentAs||f,c,A.output),A.renderAs&&A.outputAs&&t.addRenderTemplate(f,A.renderAs,A.outputAs),A.parent&&(f=A.parent),m=!0===A.next,A.complete||m))break}if(m)return"continue"}if(c.styleElement){var _=!1;if(J(c.element,n,l.element).some(function(e){if(e.is(c)&&e.condition(c,f)&&(void 0===g||!g.includes(e))){var i=e.processNode(c,f);if(i&&(i.output&&t.addRenderTemplate(i.parentAs||f,c,i.output),i.renderAs&&i.outputAs&&t.addRenderTemplate(f,i.renderAs,i.outputAs),i.parent&&(f=i.parent),(i.output||!0===i.include)&&(void 0===c.renderExtension&&(c.renderExtension=[]),c.renderExtension.push(e),e.subscribers.add(c)),_=!0===i.next,i.complete||_))return!0}return!1}),_)return"continue"}}if(!c.rendered&&c.hasSection(b.RENDER)){var w=t.createLayoutControl(f,c),T=c.length?i.processUnknownParent(w):i.processUnknownChild(w);if(!0===T.next)return"continue";if(T.renderAs)return r[s]=T.renderAs,s--,"continue";t.addRenderLayout(T.layout,f)}};++s<r.length;)c()};var T=A.values(),I=Array.isArray(T),C=0;e:for(T=I?T:T[Symbol.iterator]();;){var R;switch(w()){case"break":break e;case"continue":continue}}}this.processing.cache.sort(function(e,t){return e.depth===t.depth&&e.length>0&&0===t.length?-1:0}),this.session.cache.concat(this.processing.cache.children),this.session.excluded.concat(this.processing.excluded.children);for(var B=Array.isArray(M=this.processing.cache),P=0,M=B?M:M[Symbol.iterator]();;){var L;if(B){if(P>=M.length)break;L=M[P++]}else{if((P=M.next()).done)break;L=P.value}L.documentRoot&&L.rendered&&this.session.documentRoot.push({node:L,layoutName:L===l?e:""})}for(var N=Array.isArray(W=this.extensions),O=0,W=N?W:W[Symbol.iterator]();;){var D;if(N){if(O>=W.length)break;D=W[O++]}else{if((O=W.next()).done)break;D=O.value}for(var F=D,H=Array.isArray(V=F.subscribers),z=0,V=H?V:V[Symbol.iterator]();;){var q;if(H){if(z>=V.length)break;q=V[z++]}else{if((z=V.next()).done)break;q=z.value}F.postBaseLayout(q)}F.afterBaseLayout()}}},{key:"setConstraints",value:function(){this.controllerHandler.setConstraints();for(var e=Array.isArray(i=this.extensions),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}for(var r=n,a=Array.isArray(s=r.subscribers),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}r.postConstraints(l)}r.afterConstraints()}}},{key:"setResources",value:function(){for(var e=Array.isArray(i=this.processing.cache),t=0,i=e?i:i[Symbol.iterator]();;){var n;if(e){if(t>=i.length)break;n=i[t++]}else{if((t=i.next()).done)break;n=t.value}var r=n;this.resourceHandler.setBoxStyle(r),this.resourceHandler.setFontStyle(r),this.resourceHandler.setValueString(r)}for(var a=Array.isArray(s=this.extensions),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}l.afterResources()}}},{key:"processFloatHorizontal",value:function(e){var t=this.controllerHandler,i=e.itemCount;if(0===e.cleared.size&&!e.some(function(e){return e.autoMargin.horizontal||e.multiline})){for(var n=[],r=[],a=[],o=Array.isArray(l=e),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}var h=c;switch(h.float){case"left":r.push(h);break;case"right":a.push(h);break;default:n.push(h)}}if(n.length===i||r.length===i||a.length===i||(0===r.length||0===a.length)&&!n.some(function(e){return e.blockStatic}))return t.processLayoutHorizontal(e),e}for(var u=[],d=[],f=[],g=[],v=[],p=[],m=[],y=[],b=[],k="",x=0,S=Array.isArray(w=e),A=0,w=S?w:w[Symbol.iterator]();;){var T;if(S){if(A>=w.length)break;T=w[A++]}else{if((A=w.next()).done)break;T=A.value}var I=T,C=e.cleared.get(I);if(C&&($.hasBit(x,"right"===C?4:2)||0!==x&&"both"===C))switch(C){case"left":$.hasBit(x,2)&&(x^=2),k="left";break;case"right":$.hasBit(x,4)&&(x^=4),k="right";break;case"both":switch(x){case 2:k="left";break;case 4:k="right";break;default:k="both"}x=0}if(I.autoMargin.horizontal)I.autoMargin.leftRight?m.length?v.push(I):g.push(I):I.autoMargin.left?v.push(I):g.push(I);else if(""===k)"right"===I.float?(v.push(I),$.hasBit(x,4)||(x|=4)):"left"===I.float?(g.push(I),$.hasBit(x,2)||(x|=2)):p.length||m.length?f.push(I):g.length||v.length?function(){var e=I.linear.top;if(I.textElement&&!I.plainText){var t=Z.getRangeClientRect(I.element,I.sessionId);t.top>e&&(e=t.top)}g.some(function(t){return e>=t.linear.bottom})||v.some(function(t){return e>=t.linear.bottom})?f.push(I):d.push(I)}():d.push(I);else if("right"===I.float)0!==m.length||$.hasBit(x,4)||(x|=4),"right"!==k&&v.length?v.push(I):m.push(I);else if("left"===I.float)0!==p.length||$.hasBit(x,2)||(x|=2),"left"!==k&&g.length?g.push(I):p.push(I);else switch(k){case"left":p.push(I);break;case"right":m.push(I);break;default:f.push(I)}}g.length&&p.length?y=[g,p]:g.length?y=g:p.length&&(y=p),v.length&&m.length?b=[v,m]:v.length?b=v:m.length&&(b=m);var R=t.containerTypeVertical,B=v.length+m.length===e.length?1024:0;if(f.length){f.length>1&&(f[0].alignmentType|=4096),f.unshift(e.node);var P=this.createNode(Y.createElement(e.node.actualParent&&e.node.actualParent.element),!0,e.parent,f);this.addRenderLayout(new E(e.parent,P,R.containerType,R.alignmentType|(e.parent.blockStatic?64:0),f)),e.reset(P)}e.add(B);var M,L=t.containerTypeVerticalMargin;d.length?m.length?u.push(y=[d,g],b):p.length?u.push(b=[d,v],y):u.push(d,y,b):(y===p&&b===v||y===g&&b===m?u.push(0===p.length?[g,m]:[v,p]):u.push(y,b),0!==y.length&&0!==b.length||(L=R)),$.spliceArray(u,function(e){return 0===e.length}),e.itemCount=u.length,e.setType(L.containerType,L.alignmentType);for(var N=0;N<u.length;N++){var O=u[N],W=void 0;if(Array.isArray(O[0])){for(var D=[],F=Array.isArray(z=W=O),H=0,z=F?z:z[Symbol.iterator]();;){var V;if(F){if(H>=z.length)break;V=z[H++]}else{if((H=z.next()).done)break;V=H.value}$.concatArray(D,V)}if(D.sort(_.siblingIndex),e.node.layoutVertical)M=e.node;else{M=t.createNodeGroup(D[0],D,e.node);var q=new E(e.node,M,R.containerType,R.alignmentType|(W.some(function(e){return e===b||e===v})?1024:0));q.itemCount=W.length,this.addRenderLayout(q)}}else W=[O],M=void 0;for(var X=Array.isArray(G=W),U=0,G=X?G:G[Symbol.iterator]();;){var j;if(X){if(U>=G.length)break;j=G[U++]}else{if((U=G.next()).done)break;j=U.value}var K=j,Q=!M||K!==d&&K!==g&&K!==p&&K!==v&&K!==m?e.node:M,J=t.createNodeGroup(K[0],K,Q),ee=new E(Q,J,0,K.length<i?128:0,K);if(K.some(function(e){return e.blockStatic||e.has("width",32)})&&ee.add(64),1===K.length||ee.linearY?(ee.setType(R.containerType,R.alignmentType),1===K.length&&(J.innerChild=K[0],K[0].outerParent=J)):t.processLayoutHorizontal(ee),this.addRenderLayout(ee),K===d){if(g.length){for(var te=-1/0,ie=0,ne=g;ie<ne.length;ie++){var re=ne[ie];te=Math.max(te,re.linear.right+(re.marginLeft<0?re.marginLeft:0))}var ae=te-Q.box.left;ae>0&&J.modifyBox(256,ae)}if(v.length){for(var oe=1/0,se=0,le=v;se<le.length;se++){var ce=le[se];oe=Math.min(oe,ce.linear.left+(ce.marginRight<0?ce.marginRight:0))}var he=Q.box.right-oe;he>0&&J.modifyBox(64,he)}}}}return e}},{key:"processFloatVertical",value:function(e,t){var i=this.controllerHandler,n=i.containerTypeVertical;if(0!==e.containerType){var r=i.createNodeGroup(e.node,[e.node],t);this.addRenderLayout(new E(r,e.node,n.containerType,n.alignmentType,r.children)),e.node=r}else e.containerType=n.containerType,e.add(n.alignmentType);for(var a=[],o=[],s=[],l=[],c=!1,h=!1,u=!0,d=Array.isArray(g=e),f=0,g=d?g:g[Symbol.iterator]();;){var v;if(d){if(f>=g.length)break;v=g[f++]}else{if((f=g.next()).done)break;v=f.value}var p=v;p.blockStatic&&0===l.length?(s.push(p),h=!0):(e.cleared.has(p)&&(p.floating?c=!0:(p.modifyBox(2,null),a.push(s.slice(0)),o.push(l.slice(0)),s.length=0,l.length=0)),p.floating?(h&&(a.push(s.slice(0)),o.push(null),s.length=0,l.length=0,h=!1),l.push(p)):(c&&!e.cleared.has(p)&&(u=!1),s.push(p)))}if(l.length&&o.push(l),s.length&&a.push(s),!u)for(var m=0;m<Math.max(o.length,a.length);m++){var y=a[m]||[];if(null===o[m]&&y.length){var b=i.containerTypeVertical;b.alignmentType|=192,this.addRenderLayout(new E(e.node,i.createNodeGroup(y[0],y,e.node),b.containerType,b.alignmentType,y))}else{var k=o[m]||[];if(y.length||k.length){var x=i.createNodeGroup(k[0]||y[0],[],e.node),S=i.containerTypeVerticalMargin,A=new E(e.node,x,S.containerType,S.alignmentType),_=[],w=void 0;k.length>1?(w=i.createNodeGroup(k[0],k,x),A.add(512),0===y.length&&k.every(function(e){return"right"===e.float})&&A.add(1024)):k.length&&((w=k[0]).parent=x),w&&(_.push(w),w=void 0),y.length>1?w=i.createNodeGroup(y[0],y,x):y.length&&((w=y[0]).parent=x),w&&_.push(w),x.init(),A.itemCount=_.length,this.addRenderLayout(A);for(var T=0,I=_;T<I.length;T++){var C=I[T];C.groupParent||(C=i.createNodeGroup(C,[C],x)),this.addRenderLayout(new E(x,C,n.containerType,192|n.alignmentType,C.children))}}}}return e}},{key:"insertNode",value:function(e,t){if("#text"!==e.nodeName){this.controllerHandler.applyDefaultStyles(e);var i=this.createNode(e,!1);return i.pseudoElement||(!this.controllerHandler.localSettings.unsupported.excluded.has(e.tagName)&&this.conditionElement(e)?this.userSettings.exclusionsDisabled||i.setExclusions():(i.visible=!1,i.excluded=!0)),i}if(Q.isPlainText(e.textContent)||j.isParentStyle(e,"whiteSpace","pre","pre-wrap")){this.controllerHandler.applyDefaultStyles(e);var n=this.createNode(e,!1);return t&&n.inherit(t,"textStyle"),n}}},{key:"conditionElement",value:function(e){var t=this;if(this.controllerHandler.includeElement(e)||e.dataset.use&&e.dataset.use.split(K.XML.SEPARATOR).some(function(e){return!!t.extensionManager.retrieve(e.trim())}))return!0;for(var i=e.parentElement,n=!0;i;){if("none"===j.getStyle(i).display){n=!1;break}i=i.parentElement}if(n)for(var r=0;r<e.children.length;r++)if(this.controllerHandler.includeElement(e.children[r]))return!0;return!1}},{key:"createPseduoElement",value:function(e,t){var i=this,n=Z.getElementCache(e,"styleMap::".concat(t),this.processing.sessionId);if(n&&n.content&&this.controllerHandler.includeElement(e,t)){var r=n.content;if("inherit"===r)for(var a=e.parentElement;a&&"inherit"===(r=j.getStyle(a,t).getPropertyValue("content"));)a=a.parentElement;var o=j.getStyle(e);void 0===n.fontFamily&&(n.fontFamily=o.getPropertyValue("font-family")),n.fontSize=n.fontSize?j.convertPX(n.fontSize,j.getFontSize(document.body)):o.getPropertyValue("font-size"),void 0===n.fontWeight&&(n.fontWeight=o.getPropertyValue("font-weight")),void 0===n.color&&(n.color=o.getPropertyValue("color")),void 0===n.display&&(n.display="inline");var s=n.display.startsWith("inline")?"span":"div",l="";switch(r){case"normal":case"none":case"initial":case"inherit":case"no-open-quote":case"no-close-quote":case'""':break;case"open-quote":l="before"===t?"&quot;":"",s="span";break;case"close-quote":l="after"===t?"&quot;":"",s="span";break;default:if(r.startsWith("url(")){l=j.resolveURL(r);var c=$.fromLastIndexOf(l,".").toLowerCase();this.controllerHandler.localSettings.supported.imageFormat.includes(c)?s="img":l=""}else{for(var h,u=/\s*(?:attr\(([^)]+)\)|(counter)\(([^,)]+)(?:, ([a-z\-]+))?\)|(counters)\(([^,]+), "([^"]*)"(?:, ([a-z\-]+))?\)|"([^"]+)")\s*/g,d=!1;null!==(h=u.exec(r));)h[1]?l+=Y.getNamedItem(e,h[1].trim()):h[2]||h[5]?function(){var n=function(e){if("none"!==e)for(var t,i=/\s*([^\-\d][^\-\d]?[^ ]*) (-?\d+)\s*/g;null!==(t=i.exec(e));)if(t[1]===c)return parseInt(t[2])},r=function(e){0===g.length?p+=e:(m||arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&(g[g.length-1]+=e)},a=function e(t){if(void 0===n(j.getStyle(t).getPropertyValue("counter-reset")))for(var i=0;i<t.children.length;i++){var a=t.children[i];if("__squared.pseudo"!==a.className){var o=d(a);o&&r(o,!0);var s=j.getStyle(a);if((o=n(s.getPropertyValue("counter-increment")))&&r(o),void 0!==(o=n(s.getPropertyValue("counter-reset"))))return;e(a)}}},s="counter"===h[2],c=void 0,u=void 0;s?(c=h[3],u=h[4]||"decimal"):(c=h[6],u=h[8]||"decimal");for(var d=function(e){var r=Z.getElementCache(e,"styleMap::".concat(t),i.processing.sessionId);if(r&&r.counterIncrement)return n(r.counterIncrement)},f=(d(e)||0)+(n(o.getPropertyValue("counter-reset"))||0),g=[],v=e,p=f,m=!1,y=void 0;;){if(m=!1,v.previousElementSibling)a(v=v.previousElementSibling);else{if(!v.parentElement)break;v=v.parentElement,m=!0}if("__squared.pseudo"!==v.className){var b=d(v);b&&r(b,!0);var k=j.getStyle(v),x=n(k.getPropertyValue("counter-increment"))||0;x&&r(x);var S=n(k.getPropertyValue("counter-reset"));if(void 0!==S){if(void 0===y&&(p+=S),y=v,s)break;m&&g.push((b||0)+S)}}}if(y){if(!s&&g.length>1){g.reverse(),g.splice(1,1);for(var A=0,_=g;A<_.length;A++){l+=j.convertListStyle(u,_[A],!0)+h[7]}}}else p=f;l+=j.convertListStyle(u,p,!0)}():h[9]&&(l+=h[9]),d=!0;d||(l=r)}}if(l||'""'===r){var f=Y.createElement(e,s,!1,"before"===t?0:-1);for(var g in"img"===s?f.src=l:'""'!==r&&(f.innerText=l),n)"display"!==g&&(f.style[g]=n[g]);return Z.setElementCache(f,"pseudoType",this.processing.sessionId,t),Z.setElementCache(f,"styleMap",this.processing.sessionId,n),f}}}},{key:"setStyleMap",value:function(){for(var e=this,t=!1,i=function(t){for(var i=t.cssRules,n=0;n<i.length;n++)e.applyStyleRule(i[n])},n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];try{if(r.cssRules)for(var a=0;a<r.cssRules.length;a++){var o=r.cssRules[a];switch(o.type){case CSSRule.STYLE_RULE:this.applyStyleRule(o);break;case CSSRule.MEDIA_RULE:j.validMediaRule(o.conditionText||j.parseConditionText("media",o.cssText))&&i(o);break;case CSSRule.SUPPORTS_RULE:CSS.supports&&CSS.supports(o.conditionText||j.parseConditionText("supports",o.cssText))&&i(o)}}}catch(e){t||(alert("CSS cannot be parsed inside <link> tags when loading files directly from your hard drive or from external websites. Either use a local web server, embed your CSS into a <style> tag, or you can also try using a different browser. See the README for more detailed instructions.\n\n"+"".concat(r.href,"\n\n").concat(e)),t=!0)}}}},{key:"applyStyleRule",value:function(e){for(var t=this,i=[],n=0,r=Array.from(e.style);n<r.length;n++){i.push($.convertCamelCase(r[n]))}var a=function(){if(s){if(l>=o.length)return"break";c=o[l++]}else{if((l=o.next()).done)return"break";c=l.value}var n=c,r=j.getSpecificity(n),a=g(n.split("::"),2),h=a[1],u=h?"::"+h:"";document.querySelectorAll(a[0]||"*").forEach(function(n){for(var a=j.getStyle(n,u),o=j.parseUnit(a.getPropertyValue("font-size")),s={},l=0,c=i;l<c.length;l++){var h=c[l],d=j.checkStyleValue(n,h,e.style[h],a,r,o);d&&(s[h]=d)}var f=s.backgroundImage&&"initial"!==s.backgroundImage;if(t.userSettings.preloadImages&&(f||s.content&&s.content.startsWith("url("))){var g=f?s.backgroundImage.split(K.XML.SEPARATOR):[s.content],v=Array.isArray(g),p=0;for(g=v?g:g[Symbol.iterator]();;){var m;if(v){if(p>=g.length)break;m=g[p++]}else{if((p=g.next()).done)break;m=p.value}var y=j.resolveURL(m.trim());""===y||t.session.image.has(y)||t.session.image.set(y,{width:0,height:0,uri:y})}}var b="styleMap".concat(u),k="styleSpecificity".concat(u),x=Z.getElementCache(n,b,t.processing.sessionId);if(x){var S=Z.getElementCache(n,k,t.processing.sessionId)||{};for(var A in s)(void 0===x[A]||r>=S[A]||void 0===S[A])&&(x[A]=s[A],S[A]=r)}else{var _={};for(var w in s)_[w]=r;Z.setElementCache(n,"style".concat(u),"0",a),Z.setElementCache(n,b,t.processing.sessionId,s),Z.setElementCache(n,k,t.processing.sessionId,_)}})},o=e.selectorText.split(K.XML.SEPARATOR),s=Array.isArray(o),l=0;for(o=s?o:o[Symbol.iterator]();;){var c;if("break"===a())break}}},{key:"createLayoutControl",value:function(e,t){return new E(e,t,t.containerType,t.alignmentType,t.children)}},{key:"userSettings",set:function(e){this._userSettings=e},get:function(){return this._userSettings||{}}},{key:"viewData",get:function(){return{views:this._views,includes:this._includes}}},{key:"rendered",get:function(){return this.session.cache.filter(function(e){return e.visible&&e.rendered})}},{key:"nextId",get:function(){return this.processing.cache.nextId}},{key:"length",get:function(){return this.session.documentRoot.length}}]),e}(),te=squared.lib.color,ie=squared.lib.client,ne=squared.lib.css,re=squared.lib.session,ae=squared.lib.xml,oe=function(){function e(t,i){r(this,e),this.application=t,this.cache=i,this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}return o(e,[{key:"reset",value:function(){this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}},{key:"applyDefaultStyles",value:function(e){var t,i=this;if("#text"===e.nodeName)t={position:"static",display:"inline",verticalAlign:"baseline",float:"none",clear:"none"};else{if(t=re.getElementCache(e,"styleMap",this.application.processing.sessionId)||{},ie.isUserAgent(8))switch(e.tagName){case"INPUT":case"SELECT":case"BUTTON":case"TEXTAREA":void 0===t.display&&(t.display="inline-block");break;case"FIELDSET":void 0===t.display&&(t.display="block")}switch(e.tagName){case"INPUT":switch(e.type){case"file":var n=ne.getStyle(e);if(void 0===te.parseColor(n.getPropertyValue("background-color"))&&(t.backgroundColor="#DDDDDD",n.getPropertyValue("border-style")))for(var r=0,a=["borderTop","borderRight","borderBottom","borderLeft"];r<a.length;r++){var o=a[r];t["".concat(o,"Style")]="solid",t["".concat(o,"Color")]="#DDDDDD",t["".concat(o,"Width")]="2px"}case"reset":case"submit":case"button":void 0===t.textAlign&&(t.textAlign="center")}break;case"BUTTON":void 0===t.textAlign&&(t.textAlign="center");break;case"TEXTAREA":case"SELECT":void 0===t.verticalAlign&&("SELECT"!==e.tagName||e.size>1)&&(t.verticalAlign="text-bottom");break;case"FORM":void 0===t.marginTop&&(t.marginTop="0px");break;case"LI":if(void 0===t.listStyleImage){var s=ne.getStyle(e);t.listStyleImage=s.getPropertyValue("list-style-image")}break;case"IFRAME":void 0===t.display&&(t.display="block");case"IMG":var l=function(n,r){if(void 0===t[n]||"auto"===t[n]){var a=RegExp("\\s+".concat(n,'="([^"]+)"')).exec(e.outerHTML);if(a)t[n]=ne.formatPX(ne.isPercent(a[1])?parseFloat(a[1])/100*re.getClientRect(e.parentElement||e,i.application.processing.sessionId)[n]:a[1]);else if("IFRAME"===e.tagName)"width"===n?t.width="300px":t.height="150px";else if(ne.isLength(t[r])&&!(t.maxWidth&&ne.isPercent(t.maxWidth)||t.maxHeight&&ne.isPercent(t.maxHeight))){var o=i.application.session.image.get(e.src);o&&o.width>0&&o.height>0&&(t[n]=ne.formatPX(o[n]*(t[r]&&ne.isLength(t[r])?parseFloat(t[r])/o[r]:1)))}}};l("width","height"),l("height","width")}}re.setElementCache(e,"styleMap",this.application.processing.sessionId,t)}},{key:"addBeforeOutsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._beforeOutside[e]&&(this._beforeOutside[e]=[]),-1!==i&&i<this._beforeOutside[e].length?this._beforeOutside[e].splice(i,0,t):this._beforeOutside[e].push(t)}},{key:"addBeforeInsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._beforeInside[e]&&(this._beforeInside[e]=[]),-1!==i&&i<this._beforeInside[e].length?this._beforeInside[e].splice(i,0,t):this._beforeInside[e].push(t)}},{key:"addAfterInsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._afterInside[e]&&(this._afterInside[e]=[]),-1!==i&&i<this._afterInside[e].length?this._afterInside[e].splice(i,0,t):this._afterInside[e].push(t)}},{key:"addAfterOutsideTemplate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;void 0===this._afterOutside[e]&&(this._afterOutside[e]=[]),-1!==i&&i<this._afterOutside[e].length?this._afterOutside[e].splice(i,0,t):this._afterOutside[e].push(t)}},{key:"getBeforeOutsideTemplate",value:function(e){return this._beforeOutside[e]?ae.pushIndentArray(this._beforeOutside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"getBeforeInsideTemplate",value:function(e){return this._beforeInside[e]?ae.pushIndentArray(this._beforeInside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"getAfterInsideTemplate",value:function(e){return this._afterInside[e]?ae.pushIndentArray(this._afterInside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"getAfterOutsideTemplate",value:function(e){return this._afterOutside[e]?ae.pushIndentArray(this._afterOutside[e],arguments.length>1&&void 0!==arguments[1]?arguments[1]:0):""}},{key:"hasAppendProcessing",value:function(e){return void 0!==this._beforeOutside[e]||void 0!==this._beforeInside[e]||void 0!==this._afterInside[e]||void 0!==this._afterOutside[e]}},{key:"includeElement",value:function(e,t){var i=re.getClientRect(e,this.application.processing.sessionId);if(function(e){return!(e.left<0&&e.top<0&&Math.abs(e.left)>=e.width&&Math.abs(e.top)>=e.height)}(i)){if(i.width>0&&i.height>0)return!0;var n=ne.getStyle(e,t);return i.width>0&&"none"!==n.getPropertyValue("float")||"block"===n.getPropertyValue("display")&&(0!==parseInt(n.getPropertyValue("margin-top"))||0!==parseInt(n.getPropertyValue("margin-bottom")))||"none"!==n.getPropertyValue("clear")}return!1}},{key:"cascadeDocument",value:function(e,t){for(var i=t>0?"\t".repeat(t):"",n="",r=0;r<e.length;r++){var a=e[r];if(a){var o=a.node;switch(a.type){case 1:var s=a.controlName,l=a.attributes,c=t+1,h=this.getBeforeInsideTemplate(o.id,c),u=this.getAfterInsideTemplate(o.id,c),d=i+"<".concat(s+(0===t?"{#0}":"")+(this.userSettings.showAttributes?l?ae.pushIndent(l,c):o.extractAttributes(c):""));d+=o.renderTemplates||""!==h||""!==u?">\n"+h+(o.renderTemplates?this.cascadeDocument(this.sortRenderPosition(o,o.renderTemplates),c):"")+u+i+"</".concat(s,">\n"):" />\n",n+=this.getBeforeOutsideTemplate(o.id,t)+d+this.getAfterOutsideTemplate(o.id,t);break;case 2:var f=a.content;f&&(n+=ae.pushIndent(f,t))}}}return n}},{key:"getEnclosingTag",value:function(e,t){switch(e){case 1:var i=t.controlName,n=t.content;return"<"+i+(t.attributes||"")+(n?">\n"+n+"</"+i+">\n":" />\n")}return""}},{key:"generateSessionId",get:function(){return""+(new Date).getTime()}}]),e}(),se=squared.lib.css,le=squared.lib.util,ce=function(){function e(t,i,n,a){r(this,e),this.name=t,this.framework=i,this.eventOnly=!1,this.preloaded=!1,this.documentBase=!1,this.options={},this.dependencies=[],this.subscribers=new Set,this.tagNames=Array.isArray(n)?le.replaceMap(n,function(e){return e.trim().toUpperCase()}):[],a&&Object.assign(this.options,a)}return o(e,[{key:"is",value:function(e){return!!e.styleElement&&(0===this.tagNames.length||this.tagNames.includes(e.element.tagName))}},{key:"require",value:function(e){this.dependencies.push({name:e,preload:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}},{key:"included",value:function(e){return le.includes(e.dataset.use,this.name)}},{key:"beforeInit",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.included(e))for(var t=Array.isArray(n=this.dependencies),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.preload){var a=this.application.extensionManager.retrieve(r.name);a&&!a.preloaded&&(a.beforeInit(e,!0),a.preloaded=!0)}}}},{key:"init",value:function(e){return!1}},{key:"afterInit",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.included(e))for(var t=Array.isArray(n=this.dependencies),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.preload){var a=this.application.extensionManager.retrieve(r.name);a&&a.preloaded&&(a.afterInit(e,!0),a.preloaded=!1)}}}},{key:"condition",value:function(e,t){return!!se.hasComputedStyle(e.element)&&(e.dataset.use?this.included(e.element):this.tagNames.length>0)}},{key:"processNode",value:function(e,t){}},{key:"processChild",value:function(e,t){}},{key:"addDescendant",value:function(e){var t=this.application.session.extensionMap.get(e.id)||[];t.includes(this)||t.push(this),this.application.session.extensionMap.set(e.id,t)}},{key:"postBaseLayout",value:function(e){}},{key:"postConstraints",value:function(e){}},{key:"postParseDocument",value:function(e){}},{key:"postProcedure",value:function(e){}},{key:"beforeParseDocument",value:function(){}},{key:"afterBaseLayout",value:function(){}},{key:"afterConstraints",value:function(){}},{key:"afterResources",value:function(){}},{key:"afterParseDocument",value:function(){}},{key:"beforeCascadeDocument",value:function(){}},{key:"beforeFinalize",value:function(){}},{key:"afterFinalize",value:function(){}},{key:"installed",get:function(){return!!this.application&&this.application.extensions.includes(this)}}],[{key:"findNestedElement",value:function(e,t){if(se.hasComputedStyle(e))for(var i=0;i<e.children.length;i++){var n=e.children[i];if(le.includes(n.dataset.use,t))return n}return null}}]),e}(),he=squared.lib.util,ue=function(){function e(t){r(this,e),this.application=t}return o(e,[{key:"include",value:function(e){var t=this,i=this.retrieve(e.name);return i?(Array.isArray(e.tagNames)&&(i.tagNames=e.tagNames),Object.assign(i.options,e.options),!0):!(0!==e.framework&&!he.hasBit(e.framework,this.application.framework)||!e.dependencies.every(function(e){return!!t.retrieve(e.name)}))&&(e.application=this.application,this.application.extensions.includes(e)||this.application.extensions.push(e),!0)}},{key:"exclude",value:function(e){for(var t=0;t<this.application.extensions.length;t++)if(this.application.extensions[t]===e)return this.application.extensions.splice(t,1),!0;return!1}},{key:"retrieve",value:function(e){for(var t=Array.isArray(n=this.application.extensions),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}if(r.name===e)return r}return null}},{key:"optionValue",value:function(e,i){var n=this.retrieve(e);if(n&&"object"===t(n.options))return n.options[i]}},{key:"optionValueAsObject",value:function(e,i){var n=this.optionValue(e,i);return"object"===t(n)?n:null}},{key:"optionValueAsString",value:function(e,t){var i=this.optionValue(e,t);return"string"==typeof i?i:""}},{key:"optionValueAsNumber",value:function(e,t){var i=this.optionValue(e,t);return"number"==typeof i?i:0}},{key:"optionValueAsBoolean",value:function(e,t){var i=this.optionValue(e,t);return"boolean"==typeof i&&i}}]),e}(),de=squared.lib.util,fe=function(){function e(t){r(this,e),this.resource=t,this.appName="",this.assets=[],t.fileHandler=this}return o(e,[{key:"addAsset",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(i||n){var r=this.assets.findIndex(function(i){return i.pathname===e&&i.filename===t});-1!==r?(this.assets[r].content=i,this.assets[r].uri=n):this.assets.push({pathname:e,filename:t,content:i,uri:n})}}},{key:"reset",value:function(){this.assets.length=0}},{key:"saveToDisk",value:function(t,i){if(location.protocol.startsWith("http")){if(t.length){var n=this.userSettings;de.concatArray(t,this.assets),fetch("/api/savetodisk"+"?directory=".concat(encodeURIComponent(de.trimString(n.outputDirectory,"/")))+(i?"&appname=".concat(encodeURIComponent(i.trim())):"")+"&filetype=".concat(n.outputArchiveFileType.toLowerCase())+"&processingtime=".concat((""+n.outputMaxProcessingTime).trim()),{method:"POST",headers:new Headers({Accept:"application/json, text/plain, */*","Content-Type":"application/json"}),body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(t){t&&(t.zipname?fetch("/api/downloadtobrowser?filename=".concat(encodeURIComponent(t.zipname))).then(function(e){return e.blob()}).then(function(i){return e.downloadToDisk(i,de.fromLastIndexOf(t.zipname,"/"))}):t.system&&alert("".concat(t.application,"\n\n").concat(t.system)))}).catch(function(e){return alert("ERROR: ".concat(e))})}}else alert("SERVER (required): See README for instructions")}},{key:"stored",get:function(){return this.resource.stored}}],[{key:"downloadToDisk",value:function(e,t){var i=new Blob([e],{type:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")||"application/octet-stream"}),n=window.URL.createObjectURL(i),r=document.createElement("a");r.style.setProperty("display","none"),r.setAttribute("href",n),r.setAttribute("download",t),void 0===r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(function(){return window.URL.revokeObjectURL(n)},1)}}]),e}(),ge=new Map([[2,"marginTop"],[4,"marginRight"],[8,"marginBottom"],[16,"marginLeft"],[32,"paddingTop"],[64,"paddingRight"],[128,"paddingBottom"],[256,"paddingLeft"]]),ve={ACCESSIBILITY:"squared.accessibility",CSS_GRID:"squared.css-grid",EXTERNAL:"squared.external",FLEXBOX:"squared.flexbox",GRID:"squared.grid",LIST:"squared.list",RELATIVE:"squared.relative",SPRITE:"squared.sprite",SUBSTITUTE:"squared.substitute",TABLE:"squared.table",VERTICAL_ALIGN:"squared.verticalalign",WHITESPACE:"squared.whitespace"},pe=Object.freeze({CSS_SPACING:ge,EXT_NAME:ve}),me=squared.lib.css,ye=squared.lib.dom,be=squared.lib.regex,ke=squared.lib.session,xe=squared.lib.util,Se=["position","display","verticalAlign","float","clear","zIndex"],Ae=Array.from(ge.keys()),_e=function(e){function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",a=arguments.length>2?arguments[2]:void 0;return r(this,i),(t=u(this,c(i).call(this))).id=e,t.sessionId=n,t.alignmentType=0,t.depth=-1,t.siblingIndex=1/0,t.documentRoot=!1,t.visible=!0,t.excluded=!1,t.rendered=!1,t.baselineActive=!1,t.baselineAltered=!1,t.lineBreakLeading=!1,t.lineBreakTrailing=!1,t.positioned=!1,t.controlId="",t._cached={},t._initial={iteration:-1,children:[],styleMap:{}},t._data={},t._excludeSection=0,t._excludeProcedure=0,t._excludeResource=0,t._inlineText=!1,t._element=null,a?(t._element=a,t.init()):(t.style={},t._styleMap={}),t}return l(i,squared.lib.base.Container),o(i,[{key:"init",value:function(){var e=this._element;if(e&&("0"!==this.sessionId&&ke.setElementCache(e,"node",this.sessionId,this),this.style=ke.getElementCache(e,"style","0")||me.getStyle(e,void 0,!1),this._styleMap=Object.assign({},ke.getElementCache(e,"styleMap",this.sessionId)),this.styleElement&&!this.pseudoElement&&"0"!==this.sessionId))for(var t=parseFloat(this.style.getPropertyValue("font-size")),i=0,n=Array.from(e.style);i<n.length;i++){var r=n[i],a=e.style.getPropertyValue(r);r=xe.convertCamelCase(r),(a=me.checkStyleValue(e,r,a,this.style,1e3,t))&&(this._styleMap[r]=a)}}},{key:"saveAsInitial",value:function(){(-1===this._initial.iteration||arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&(this._initial.children=this.duplicate(),this._initial.styleMap=Object.assign({},this._styleMap)),this._bounds&&(this._initial.bounds=ye.assignRect(this._bounds),this._initial.linear=ye.assignRect(this.linear),this._initial.box=ye.assignRect(this.box)),this._initial.iteration++}},{key:"is",value:function(){for(var e=this,t=arguments.length,i=[],n=0;n<t;n++)i[n]=arguments[n];return i.some(function(t){return e.containerType===t})}},{key:"of",value:function(e){for(var t=this,i=arguments.length,n=[],r=1;r<i;r++)n[r-1]=arguments[r];return this.containerType===e&&n.some(function(e){return t.hasAlign(e)})}},{key:"unsafe",value:function(e){return this["_".concat(e)]||void 0}},{key:"attr",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this["__".concat(e)];return i?(void 0===r&&(this._namespaces.includes(e)||this._namespaces.push(e),r={},this["__".concat(e)]=r),!n&&r[t]?"":(r[t]=""+i,r[t])):r&&r[t]||""}},{key:"namespace",value:function(e){return this["__".concat(e)]||{}}},{key:"delete",value:function(e){var t=this["__".concat(e)];if(t){for(var i=arguments.length,n=[],r=1;r<i;r++)n[r-1]=arguments[r];for(var a=0,o=n;a<o.length;a++){var s=o[a];if(-1!==s.indexOf("*")){var l=xe.searchObject(t,s),c=Array.isArray(l),h=0;for(l=c?l:l[Symbol.iterator]();;){var u;if(c){if(h>=l.length)break;u=l[h++]}else{if((h=l.next()).done)break;u=h.value}delete t[g(u,1)[0]]}}else delete t[s]}}}},{key:"apply",value:function(e){for(var i in e){var n=e[i];if("object"===t(n)){for(var r in n)this.attr(i,r,n[r]);delete e[i]}}}},{key:"render",value:function(e){this.renderParent=e,this.rendered=!0}},{key:"renderEach",value:function(e){for(var t=0;t<this.renderChildren.length;t++)this.renderChildren[t].visible&&e(this.renderChildren[t],t,this.renderChildren);return this}},{key:"renderFilter",value:function(e){return xe.filterArray(this.renderChildren,e)}},{key:"hide",value:function(e){this.rendered=!0,this.visible=!1}},{key:"data",value:function(e,i,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return xe.hasValue(n)?("object"!==t(this._data[e])&&(this._data[e]={}),(r||void 0===this._data[e][i])&&(this._data[e][i]=n)):null===n&&delete this._data[e],void 0===this._data[e]||void 0===this._data[e][i]?void 0:this._data[e][i]}},{key:"unsetCache",value:function(){for(var e=arguments.length,t=[],i=0;i<e;i++)t[i]=arguments[i];if(t.length)for(var n=0,r=t;n<r.length;n++){var a=r[n];switch(a){case"position":return void(this._cached={});case"width":this._cached.actualWidth=void 0;case"minWidth":this._cached.hasWidth=void 0;break;case"height":this._cached.actualHeight=void 0;case"minHeight":this._cached.hasHeight=void 0;break;case"verticalAlign":this._cached.baseline=void 0;break;case"display":this._cached.inline=void 0,this._cached.inlineVertical=void 0,this._cached.inlineFlow=void 0,this._cached.block=void 0,this._cached.blockDimension=void 0,this._cached.blockStatic=void 0,this._cached.autoMargin=void 0;break;case"pageFlow":this._cached.positionAuto=void 0,this._cached.blockStatic=void 0,this._cached.baseline=void 0,this._cached.floating=void 0,this._cached.autoMargin=void 0,this._cached.rightAligned=void 0,this._cached.bottomAligned=void 0;break;case"float":this._cached.floating=void 0;break;default:a.startsWith("margin")&&(this._cached.autoMargin=void 0),(a.startsWith("padding")||a.startsWith("border"))&&(this._cached.contentBoxWidth=void 0,this._cached.contentBoxHeight=void 0)}this._cached[a]=void 0}else this._cached={}}},{key:"ascend",value:function(){for(var e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,i=[],n=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.renderParent?"renderParent":"parent":"actualParent",r=this[n];r&&0!==r.id&&!i.includes(r);){if(e){if(e(r))return[r]}else i.push(r);if(r===t)break;r=r[n]}return i}},{key:"cascade",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=f(c(i.prototype),"cascade",this).call(this,e);return t?xe.spliceArray(n,function(e){return null===e.element}):n}},{key:"inherit",value:function(e){for(var t=e.unsafe("initial"),i=arguments.length,n=[],r=1;r<i;r++)n[r-1]=arguments[r];for(var a=0,o=n;a<o.length;a++){switch(o[a]){case"initial":xe.cloneObject(t,this._initial);break;case"base":this._documentParent=e.documentParent,this._bounds=ye.assignRect(e.bounds),this._linear=ye.assignRect(e.linear),this._box=ye.assignRect(e.box);var s=e.actualParent;s&&(this.dir=s.dir);break;case"alignment":for(var l=0,c=Se;l<c.length;l++){var h=c[l];this._styleMap[h]=e.css(h),this._initial.styleMap[h]=t.styleMap[h]}if(!this.positionStatic)for(var u=Array.isArray(f=me.BOX_POSITION),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}var v=g;this._styleMap[v]=e.css(v),this._initial.styleMap[v]=t.styleMap[v]}if(e.autoMargin.horizontal||e.autoMargin.vertical)for(var p=Array.isArray(y=me.BOX_MARGIN),m=0,y=p?y:y[Symbol.iterator]();;){var b;if(p){if(m>=y.length)break;b=y[m++]}else{if((m=y.next()).done)break;b=m.value}var k=b;"auto"===e.cssInitial(k,!0)&&(this._styleMap[k]="auto"),"auto"===e.cssInitial(k)&&(this._initial.styleMap[k]="auto")}break;case"styleMap":xe.assignEmptyProperty(this._styleMap,e.unsafe("styleMap"));break;case"textStyle":this.cssApply({fontFamily:e.css("fontFamily"),fontSize:e.css("fontSize"),fontWeight:e.css("fontWeight"),color:e.css("color"),whiteSpace:e.css("whiteSpace"),textTransform:e.css("textTransform"),opacity:e.css("opacity")})}}}},{key:"alignedVertically",value:function(e,t,i,n){var r=this.actualParent;if(this.lineBreak||!r)return!0;if(this.pageFlow&&e.length){if(xe.isArray(t)&&this!==t[0]){var a=t[t.length-1];if(i&&i.has(this))return!0;if(this.floating&&a.floating){if(this.linear.top>=Math.floor(a.linear.bottom))return!0}else if(n&&this.blockStatic){var o=t.find(function(e){return e.floating});if(o){var s=this.linear,l=s.top,c=s.bottom;if(this.textElement&&!this.plainText){var h=ke.getRangeClientRect(this._element,this.sessionId);h.top>l&&(l=h.top),h.bottom>c&&(c=h.bottom)}return!xe.withinRange(l,o.linear.top)&&(this.multiline?c>o.linear.bottom:l>=o.linear.bottom)}}}for(var u=Array.isArray(f=e),d=0,f=u?f:f[Symbol.iterator]();;){var g;if(u){if(d>=f.length)break;g=f[d++]}else{if((d=f.next()).done)break;g=d.value}var v=g;if((this.blockStatic||"table"===this.display)&&(!v.floating||"right"!==v.float&&xe.withinRange(v.linear.right,r.box.right)||i&&i.has(v))||v.blockStatic||v.lineBreak||v.autoMargin.leftRight||"left"===v.float&&this.autoMargin.right||"right"===v.float&&this.autoMargin.left||i&&"both"===i.get(v)&&(!xe.isArray(t)||t[0]!==v))return!0;if(this.blockDimension)if(xe.isArray(t)&&this.linear.top>=Math.floor(t[t.length-1].linear.bottom)&&(!v.floating||this.has("width",32))||"100%"===this.css("width")&&!this.has("maxWidth"))return!0}}return!1}},{key:"intersectX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return e.left>=t.left&&e.left<t.right||e.right>t.left&&e.right<=t.right||t.left>=e.left&&t.right<=e.right||e.left>=t.left&&e.right<=t.right}},{key:"intersectY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return e.top>=t.top&&e.top<t.bottom||e.bottom>t.top&&e.bottom<=t.bottom||t.top>=e.top&&t.bottom<=e.bottom||e.top>=t.top&&e.bottom<=t.bottom}},{key:"withinX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.left)>=Math.floor(e.left)&&Math.floor(t.right)<=Math.ceil(e.right)}},{key:"withinY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.top)>=Math.floor(e.top)&&Math.floor(t.bottom)<=Math.ceil(e.bottom)}},{key:"outsideX",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.left)<Math.floor(e.left)||Math.floor(t.right)>Math.ceil(e.right)}},{key:"outsideY",value:function(e){var t=this[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear"];return Math.ceil(t.top)<Math.floor(e.top)||Math.floor(t.bottom)>Math.ceil(e.bottom)}},{key:"css",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return arguments.length>=2&&(t?this._styleMap[e]=t:delete this._styleMap[e],i&&this.unsetCache(e)),this._styleMap[e]||this.style[e]||""}},{key:"cssApply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object.assign(this._styleMap,e),t)for(var i in e)this.unsetCache(i);return this}},{key:"cssInitial",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];-1!==this._initial.iteration||t||(i=!0);var n=t?this._styleMap[e]:this._initial.styleMap[e];return i&&!n&&(n=this.style[e]),n||""}},{key:"cssAny",value:function(e){for(var t=arguments.length,i=[],n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0,a=i;r<a.length;r++){var o=a[r];if(this.css(e)===o)return!0}return!1}},{key:"cssInitialAny",value:function(e){for(var t=arguments.length,i=[],n=1;n<t;n++)i[n-1]=arguments[n];for(var r=0,a=i;r<a.length;r++){var o=a[r];if(this.cssInitial(e)===o)return!0}return!1}},{key:"cssAscend",value:function(e){for(var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this:this.actualParent;n;){if(""!==(i=n.cssInitial(e))){if(!t||n.visible)break;i=""}if(n.documentBody)break;n=n.actualParent}return i}},{key:"cssSort",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.duplicate():this.children;return i.sort(function(i,n){var r=i.toFloat(e),a=n.toFloat(e);return r===a?0:t?r<a?-1:1:r>a?-1:1}),i}},{key:"cssPX",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this._styleMap[e];if(r&&me.isLength(r)){t+=me.parseUnit(r,this.fontSize),!i&&t<0&&(t=0);var a=me.formatPX(t);return this.css(e,a),n&&this.unsetCache(e),a}return""}},{key:"cssSpecificity",value:function(e){if(this.styleElement){var t=this._element,i=this.pseudoElement?ke.getElementCache(t,"pseudoType",this.sessionId):"",n=ke.getElementCache(t,"styleSpecificity".concat(i?"::"+i:""),this.sessionId);if(n)return n[e]||0}return 0}},{key:"cssTry",value:function(e,t){if(this.styleElement){var i=this._element,n=this.css(e);if(t===n&&(n=i.style[e]),i.style[e]=t,i.style[e]===t)return ke.setElementCache(i,e,this.sessionId,n),!0}return!1}},{key:"cssFinally",value:function(e){if(this.styleElement){var t=this._element,i=ke.getElementCache(t,e,this.sessionId);if(i)return t.style[e]=i,ke.deleteElementCache(t,e,this.sessionId),!0}return!1}},{key:"toInt",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=parseInt((arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._initial.styleMap:this._styleMap)[e]);return isNaN(i)?t:i}},{key:"toFloat",value:function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=parseFloat((arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._initial.styleMap:this._styleMap)[e]);return isNaN(i)?t:i}},{key:"parseUnit",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(""!==e){if(me.isPercent(e)){var n=t?"width":"height",r=parseFloat(e)/100;if(i){var a=this.absoluteParent;if(a)return a.has(n,2)?r*=a.toFloat(t?"width":"height"):r*=a.box[n],r}return r*(this.has(n,2)?this.toFloat(n):this.bounds[n])}return me.parseUnit(e,this.fontSize)}return 0}},{key:"convertPX",value:function(e){return"".concat(Math.round(this.parseUnit(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2])),"px")}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=(i&&"initial"===i.map?this._initial.styleMap:this._styleMap)[e];if(n)switch(n){case"0px":if(xe.hasBit(t,64))return!0;switch(e){case"top":case"right":case"bottom":case"left":return!0}case"left":if(xe.hasBit(t,8))return!0;case"baseline":if(xe.hasBit(t,16))return!0;case"auto":if(xe.hasBit(t,4))return!0;case"none":case"initial":case"unset":case"normal":case"transparent":case"rgba(0, 0, 0, 0)":return!1;default:if(i){if(i.not){if(n===i.not)return!1;if(Array.isArray(i.not))for(var r=Array.isArray(o=i.not),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}if(n===s)return!1}}if(i.all)return!0}if(t>0){if(xe.hasBit(t,2)&&me.isLength(n))return!0;if(xe.hasBit(t,32)&&me.isPercent(n))return!0}return 0===t}return!1}},{key:"hasAlign",value:function(e){return xe.hasBit(this.alignmentType,e)}},{key:"hasProcedure",value:function(e){return!xe.hasBit(this.excludeProcedure,e)}},{key:"hasResource",value:function(e){return!xe.hasBit(this.excludeResource,e)}},{key:"hasSection",value:function(e){return!xe.hasBit(this.excludeSection,e)}},{key:"exclude",value:function(e){var t=e.section,i=void 0===t?0:t,n=e.procedure,r=void 0===n?0:n,a=e.resource,o=void 0===a?0:a;i>0&&!xe.hasBit(this._excludeSection,i)&&(this._excludeSection|=i),r>0&&!xe.hasBit(this._excludeProcedure,r)&&(this._excludeProcedure|=r),o>0&&!xe.hasBit(this._excludeResource,o)&&(this._excludeResource|=o)}},{key:"setExclusions",value:function(){var e=this;if(this.styleElement){var t=this.actualParent;if(t){var i=function(i,n){var r=e.dataset["exclude".concat(i)]||"";if(t.dataset["exclude".concat(i,"Child")]&&(r+=(""!==r?"|":"")+t.dataset["exclude".concat(i,"Child")]),""!==r){var a=0,o=r.split("|"),l=Array.isArray(o),c=0;for(o=l?o:o[Symbol.iterator]();;){var h;if(l){if(c>=o.length)break;h=o[c++]}else{if((c=o.next()).done)break;h=c.value}var u=h;n[u=u.trim().toUpperCase()]&&!xe.hasBit(a,n[u])&&(a|=n[u])}a>0&&e.exclude(s({},i.toLowerCase(),a))}};i("Section",b),i("Procedure",x),i("Resource",k)}}}},{key:"setBounds",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.styleElement){if(this._bounds=ye.assignRect(ke.getClientRect(this._element,this.sessionId,e)),this.documentBody){var t=this.marginTop;if(t>0){var i=this.firstChild;i&&i.blockStatic&&!i.lineBreak&&i.marginTop>=t&&(t=0)}this._bounds.top=t}}else if(this.plainText){var n=ke.getRangeClientRect(this._element,this.sessionId,e);this._bounds=ye.assignRect(n),this._cached.multiline=n.multiline>0}}},{key:"setInlineText",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])this._inlineText=e;else if(this.htmlElement&&!this.svgElement){switch(this._element.tagName){case"INPUT":case"IMG":case"SELECT":case"TEXTAREA":case"HR":case"SVG":break;default:this._inlineText=e}}}},{key:"appendTry",value:function(e,t){for(var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!1,r=0;r<this.length;r++)if(this.children[r]===e){this.children[r]=t,t.parent=this,t.innerChild=e,n=!0;break}return i&&(t.parent=this,n=!0),n}},{key:"modifyBox",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0!==t){var n=ge.get(e);n&&(null===t?this._boxReset[n]=1:i?this._boxAdjustment[n]+=t:this[n]+this._boxAdjustment[n]+t<=0?(this._boxReset[n]=1,this._boxAdjustment[n]=0):this._boxAdjustment[n]+=t)}}},{key:"valueBox",value:function(e){var t=ge.get(e);return t?[this._boxReset[t],this._boxAdjustment[t]]:[0,0]}},{key:"resetBox",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,r){for(var a=0;a<e.length;a++)if(1!==i._boxReset[e[a]]){i._boxReset[e[a]]=1;var o=ge.get(Ae[a+r]),s=i[o];t&&0!==s&&(t.naturalElement||0!==t[o]?t.modifyBox(Ae[a+(n?0:4)],s):t.css(o,me.formatPX(s),!0))}};xe.hasBit(e,30)&&r(me.BOX_MARGIN,0),xe.hasBit(e,480)&&r(me.BOX_PADDING,4)}},{key:"inheritBox",value:function(e,t){var i=this,n=function(e,n){for(var r=0;r<e.length;r++){var a=i._boxAdjustment[e[r]];a>0&&(t.modifyBox(Ae[r+n],a,!1),i._boxAdjustment[e[r]]=0)}};xe.hasBit(e,30)&&n(me.BOX_MARGIN,0),xe.hasBit(e,480)&&n(me.BOX_PADDING,4)}},{key:"previousSiblings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.floating,i=e.pageFlow,n=e.lineBreak,r=e.excluded,a=[],o=null;if(this._element)o=this._element.previousSibling;else if(this.actualChildren.length){var s=xe.filterArray(this.actualChildren,function(e){return e.pageFlow});o=s.length&&s[0].element?s[0].element.previousSibling:null}for(;o;){var l=ke.getElementAsNode(o,this.sessionId);if(l&&l.naturalElement)if(!1!==n&&l.lineBreak||!1!==r&&l.excluded)a.push(l);else if(!l.excluded&&l.pageFlow){if(!1===i)break;if(a.push(l),!1!==t||!l.floating&&(l.visible||l.rendered))break}o=o.previousSibling}return a}},{key:"nextSiblings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.floating,i=e.pageFlow,n=e.lineBreak,r=e.excluded,a=[],o=null;if(this._element)o=this._element.nextSibling;else if(this.actualChildren.length){var s=xe.filterArray(this.actualChildren,function(e){return e.pageFlow});if(s.length){var l=s[s.length-1];o=l.element&&l.element.nextSibling}}for(;o;){var c=ke.getElementAsNode(o,this.sessionId);if(c&&c.naturalElement)if(!1!==n&&c.lineBreak||!1!==r&&c.excluded)a.push(c);else if(!c.excluded&&c.pageFlow){if(!1===i)break;if(a.push(c),!1!==t||!c.floating&&(c.visible||c.rendered))break}o=o.nextSibling}return a}},{key:"getFirstChildElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.lineBreak,i=e.excluded;if(this.htmlElement)for(var n=Array.isArray(a=this.actualChildren),r=0,a=n?a:a[Symbol.iterator]();;){var o;if(n){if(r>=a.length)break;o=a[r++]}else{if((r=a.next()).done)break;o=r.value}if(!o.pseudoElement&&(!o.excluded||!1!==t&&o.lineBreak||!1!==i&&o.excluded))return o.element}return null}},{key:"getLastChildElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.lineBreak,i=e.excluded;if(this.htmlElement)for(var n=this.actualChildren,r=n.length-1;r>=0;r--){var a=n[r];if(!a.pseudoElement&&(!a.excluded||!1!==t&&a.lineBreak||!1!==i&&a.excluded))return a.element}return null}},{key:"actualRect",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"linear";switch(e){case"top":case"left":t=this.companion&&!this.companion.visible&&this.companion[i][e]<this[i][e]?this.companion:this;break;case"right":case"bottom":t=this.companion&&!this.companion.visible&&this.companion[i][e]>this[i][e]?this.companion:this;break;default:return NaN}return t[i][e]}},{key:"setDimensions",value:function(e){var t=this.unsafe(e);if(t){if(t.width=this.bounds.width,t.height=t.bottom-t.top,this.styleElement)switch(e){case"linear":t.width+=(this.marginLeft>0?this.marginLeft:0)+this.marginRight;break;case"box":t.width-=this.contentBoxWidth}void 0===this._initial[e]&&(this._initial[e]=ye.assignRect(t))}}},{key:"getDimension",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return me.isLength(e)||me.isPercent(e)?this.parseUnit(e,t):0}},{key:"convertPosition",value:function(e){var t=0;if(!this.positionStatic){var i=this.cssInitial(e,!0);(me.isLength(i)||me.isPercent(i))&&(t=xe.convertFloat(this.convertLength(e,i,"left"===e||"right"===e)))}return t}},{key:"convertBox",value:function(e,t){var i=e+t;return xe.convertFloat(this.convertLength(i,this.css(i),"Left"===t||"Right"===t))}},{key:"convertLength",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return me.isPercent(t)?me.isLength(this.style[e])?this.style[e]:this.convertPX(t,i,n):t}},{key:"parent",set:function(e){e&&(e!==this._parent&&(this._parent&&this._parent.remove(this),this._parent=e),e.contains(this)||e.append(this),-1===this.depth&&(this.depth=e.depth+1))},get:function(){return this._parent}},{key:"tagName",set:function(e){this._cached.tagName=e.toUpperCase()},get:function(){if(void 0===this._cached.tagName){var e=this._element,t="";e&&(t="#text"===e.nodeName?"PLAINTEXT":"INPUT"===e.tagName?e.type:e.tagName),this._cached.tagName=t.toUpperCase()}return this._cached.tagName}},{key:"element",get:function(){if(!this.naturalElement&&this.innerChild){var e=this.innerChild.unsafe("element");if(e)return e}return this._element}},{key:"elementId",get:function(){return this._element?this._element.id:""}},{key:"htmlElement",get:function(){return void 0===this._cached.htmlElement&&(this._cached.htmlElement=null!==this._element&&!this.plainText&&!this.svgElement),this._cached.htmlElement}},{key:"svgElement",get:function(){return null!==this._element&&"svg"===this._element.tagName}},{key:"styleElement",get:function(){return this.htmlElement||this.svgElement}},{key:"naturalElement",get:function(){return null!==this._element&&"__squared.placeholder"!==this._element.className}},{key:"pseudoElement",get:function(){return null!==this._element&&"__squared.pseudo"===this._element.className}},{key:"imageElement",get:function(){return"IMG"===this.tagName}},{key:"flexElement",get:function(){return"flex"===this.display||"inline-flex"===this.display}},{key:"gridElement",get:function(){return"grid"===this.display}},{key:"textElement",get:function(){return this.plainText||this.inlineText&&!this.inputElement}},{key:"tableElement",get:function(){return"TABLE"===this.tagName||"table"===this.display}},{key:"inputElement",get:function(){return null!==this._element&&"INPUT"===this._element.tagName||"BUTTON"===this.tagName}},{key:"layoutElement",get:function(){return this.flexElement||this.gridElement}},{key:"groupParent",get:function(){return!1}},{key:"plainText",get:function(){return"PLAINTEXT"===this.tagName}},{key:"lineBreak",get:function(){return"BR"===this.tagName}},{key:"documentBody",get:function(){return this._element===document.body}},{key:"initial",get:function(){return this._initial}},{key:"bounds",get:function(){return this._bounds||ye.newRectDimension()}},{key:"linear",get:function(){if(void 0===this._linear&&this._bounds){if(this._element){var e=this._bounds;this._linear={top:e.top-(this.marginTop>0?this.marginTop:0),right:e.right+this.marginRight,bottom:e.bottom+this.marginBottom,left:e.left-(this.marginLeft>0?this.marginLeft:0),width:0,height:0}}else this._linear=ye.assignRect(this._bounds);this.setDimensions("linear")}return this._linear||ye.newRectDimension()}},{key:"box",get:function(){if(void 0===this._box&&this._bounds){if(this._element){var e=this._bounds;this._box={top:e.top+(this.paddingTop+this.borderTopWidth),right:e.right-(this.paddingRight+this.borderRightWidth),bottom:e.bottom-(this.paddingBottom+this.borderBottomWidth),left:e.left+(this.paddingLeft+this.borderLeftWidth),width:0,height:0}}else this._box=ye.assignRect(this._bounds);this.setDimensions("box")}return this._box||ye.newRectDimension()}},{key:"renderAs",set:function(e){this.rendered||!e||e.rendered||(this._renderAs=e)},get:function(){return this._renderAs}},{key:"dataset",get:function(){return this.htmlElement?this._element.dataset:{}}},{key:"excludeSection",get:function(){return this._excludeSection}},{key:"excludeProcedure",get:function(){return this._excludeProcedure}},{key:"excludeResource",get:function(){return this._excludeResource}},{key:"extensions",get:function(){return void 0===this._cached.extensions&&(this._cached.extensions=this.dataset.use?xe.spliceArray(this.dataset.use.split(/\s*,\s*/),function(e){return""===e}):[]),this._cached.extensions}},{key:"flexbox",set:function(e){this._cached.flexbox=e},get:function(){var e=this;if(void 0===this._cached.flexbox){var t=this.actualParent,i=function i(n,r,a){var o=(a||e).css(n);return xe.isNumber(o)?parseFloat(o):"inherit"===o&&t&&void 0===a?i(n,r,t):r},n=this.css("alignSelf"),r=this.css("justifySelf");this._cached.flexbox={alignSelf:"auto"===n&&t&&t.has("alignItems",16,{all:!0})?t.css("alignItems"):n,justifySelf:"auto"===r&&t&&t.has("justifyItems")?t.css("justifyItems"):r,basis:this.css("flexBasis"),grow:i("flexGrow",0),shrink:i("flexShrink",1),order:this.toInt("order")}}return this._cached.flexbox}},{key:"width",get:function(){return void 0===this._cached.width&&(this._cached.width=Math.max(this.getDimension(this._styleMap.width),this.getDimension(this._styleMap.minWidth))),this._cached.width}},{key:"height",get:function(){return void 0===this._cached.height&&(this._cached.height=Math.max(this.getDimension(this._styleMap.height,!1),this.getDimension(this._styleMap.minHeight,!1))),this._cached.height}},{key:"hasWidth",get:function(){if(void 0===this._cached.hasWidth){var e=this.cssInitial("width",!0);this._cached.hasWidth=!this.inlineStatic&&(me.isPercent(e)?parseFloat(e)>0:me.isLength(e)&&"0px"!==e||this.toInt("minWidth")>0)}return this._cached.hasWidth}},{key:"hasHeight",get:function(){var e=this;if(void 0===this._cached.hasHeight){var t=this.cssInitial("height",!0);this._cached.hasHeight=function(){if(e.inlineStatic)return!1;if(me.isPercent(t)){var i=e.actualParent;if(i&&i.hasHeight)return parseFloat(t)>0}else if(me.isLength(t)&&"0px"!==t||e.toFloat("minHeight")>0)return!0;return!1}()}return this._cached.hasHeight}},{key:"lineHeight",get:function(){if(void 0===this._cached.lineHeight)if(this.imageElement||this.svgElement)this._cached.lineHeight=0;else{var e=this.has("lineHeight"),t=0;if(e)t=this.toFloat("lineHeight");else if(this.naturalElement&&(t=xe.convertFloat(this.cssAscend("lineHeight",!0)),!this.plainText)){var i=ke.getElementCache(this.styleElement?this._element:this.documentParent.element,"fontSize",""+this.cssSpecificity("fontSize"));if(i&&i.endsWith("em")){var n=parseFloat(i);n<1&&(this.css("lineHeight",me.formatPX(t*=n)),e=!0)}}this._cached.lineHeight=e||t>this.actualHeight||this.multiline||this.block&&this.actualChildren.some(function(e){return e.textElement})?t:0}return this._cached.lineHeight}},{key:"display",get:function(){return this.css("display")}},{key:"position",get:function(){return this.css("position")}},{key:"positionStatic",set:function(e){this._cached.positionStatic=e,this.unsetCache("pageFlow")},get:function(){if(void 0===this._cached.positionStatic)switch(this.position){case"fixed":case"absolute":this._cached.positionStatic=!1;break;case"sticky":case"relative":this._cached.positionStatic=0===this.toInt("top")&&0===this.toInt("right")&&0===this.toInt("bottom")&&0===this.toInt("left");break;case"inherit":var e=this._element?me.getInheritedStyle(this._element.parentElement,"position"):"";this._cached.positionStatic=""!==e&&!("absolute"===e||"fixed"===e);break;default:this._cached.positionStatic=!0}return this._cached.positionStatic}},{key:"positionRelative",get:function(){if(void 0===this._cached.positionRelative){var e=this.position;this._cached.positionRelative="relative"===e||"sticky"===e}return this._cached.positionRelative}},{key:"positionAuto",get:function(){if(void 0===this._cached.positionAuto){var e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap;this._cached.positionAuto=!(this.pageFlow||"auto"!==e.top&&e.top||"auto"!==e.right&&e.right||"auto"!==e.bottom&&e.bottom||"auto"!==e.left&&e.left)}return this._cached.positionAuto}},{key:"top",get:function(){return void 0===this._cached.top&&(this._cached.top=this.convertPosition("top")),this._cached.top}},{key:"right",get:function(){return void 0===this._cached.right&&(this._cached.right=this.convertPosition("right")),this._cached.right}},{key:"bottom",get:function(){return void 0===this._cached.bottom&&(this._cached.bottom=this.convertPosition("bottom")),this._cached.bottom}},{key:"left",get:function(){return void 0===this._cached.left&&(this._cached.left=this.convertPosition("left")),this._cached.left}},{key:"marginTop",get:function(){return void 0===this._cached.marginTop&&(this._cached.marginTop=this.inlineStatic?0:this.convertBox("margin","Top")),this._cached.marginTop}},{key:"marginRight",get:function(){return void 0===this._cached.marginRight&&(this._cached.marginRight=this.convertBox("margin","Right")),this._cached.marginRight}},{key:"marginBottom",get:function(){return void 0===this._cached.marginBottom&&(this._cached.marginBottom=this.inlineStatic||0===this.bounds.height&&this.every(function(e){return!e.pageFlow||e.floating&&"none"===e.css("clear")})&&"hidden"!==this.css("overflow")?0:this.convertBox("margin","Bottom")),this._cached.marginBottom}},{key:"marginLeft",get:function(){return void 0===this._cached.marginLeft&&(this._cached.marginLeft=this.convertBox("margin","Left")),this._cached.marginLeft}},{key:"borderTopWidth",get:function(){return void 0===this._cached.borderTopWidth&&(this._cached.borderTopWidth=this.styleElement&&"none"!==this.css("borderTopStyle")?xe.convertFloat(this.css("borderTopWidth")):0),this._cached.borderTopWidth}},{key:"borderRightWidth",get:function(){return void 0===this._cached.borderRightWidth&&(this._cached.borderRightWidth=this.styleElement&&"none"!==this.css("borderRightStyle")?xe.convertFloat(this.css("borderRightWidth")):0),this._cached.borderRightWidth}},{key:"borderBottomWidth",get:function(){return void 0===this._cached.borderBottomWidth&&(this._cached.borderBottomWidth=this.styleElement&&"none"!==this.css("borderBottomStyle")?xe.convertFloat(this.css("borderBottomWidth")):0),this._cached.borderBottomWidth}},{key:"borderLeftWidth",get:function(){return void 0===this._cached.borderLeftWidth&&(this._cached.borderLeftWidth=this.styleElement&&"none"!==this.css("borderLeftStyle")?xe.convertFloat(this.css("borderLeftWidth")):0),this._cached.borderLeftWidth}},{key:"paddingTop",get:function(){if(void 0===this._cached.paddingTop){var e=this.convertBox("padding","Top");if(this.length&&e>0&&!this.layoutElement){for(var t=0,i=Array.isArray(r=this),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a;if(!o.inline){t=0;break}t=Math.max(t,o.paddingTop)}this._cached.paddingTop=Math.max(0,e-t)}else this._cached.paddingTop=e}return this._cached.paddingTop}},{key:"paddingRight",get:function(){return void 0===this._cached.paddingRight&&(this._cached.paddingRight=this.convertBox("padding","Right")),this._cached.paddingRight}},{key:"paddingBottom",get:function(){if(void 0===this._cached.paddingBottom){var e=this.convertBox("padding","Bottom");if(this.length&&e>0&&!this.layoutElement){for(var t=0,i=Array.isArray(r=this),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a;if(!o.inline){t=0;break}t=Math.max(t,o.paddingBottom)}this._cached.paddingBottom=Math.max(0,e-t)}else this._cached.paddingBottom=e}return this._cached.paddingBottom}},{key:"paddingLeft",get:function(){return void 0===this._cached.paddingLeft&&(this._cached.paddingLeft=this.convertBox("padding","Left")),this._cached.paddingLeft}},{key:"contentBox",get:function(){return"border-box"!==this.css("boxSizing")}},{key:"contentBoxWidth",get:function(){return void 0===this._cached.contentBoxWidth&&(this._cached.contentBoxWidth=this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth),this._cached.contentBoxWidth}},{key:"contentBoxHeight",get:function(){return void 0===this._cached.contentBoxHeight&&(this._cached.contentBoxHeight=this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth),this._cached.contentBoxHeight}},{key:"inline",get:function(){if(void 0===this._cached.inline){var e=this.display;this._cached.inline="inline"===e||("initial"===e||"unset"===e)&&!ye.ELEMENT_BLOCK.includes(this.tagName)}return this._cached.inline}},{key:"inlineStatic",get:function(){return void 0===this._cached.inlineStatic&&(this._cached.inlineStatic=this.inline&&!this.floating&&!this.imageElement),this._cached.inlineStatic}},{key:"inlineVertical",get:function(){if(void 0===this._cached.inlineVertical){var e=this.display;this._cached.inlineVertical=(e.startsWith("inline")||"table-cell"===e)&&!this.floating&&!this.plainText}return this._cached.inlineVertical}},{key:"inlineText",get:function(){return this._inlineText}},{key:"block",get:function(){if(void 0===this._cached.block)switch(this.display){case"block":case"flex":case"grid":case"list-item":this._cached.block=!0;break;case"initial":this._cached.block=ye.ELEMENT_BLOCK.includes(this.tagName);break;default:this._cached.block=!1}return this._cached.block}},{key:"blockStatic",get:function(){return void 0===this._cached.blockStatic&&(this._cached.blockStatic=this.pageFlow&&this.block&&(!this.floating||"100%"===this.cssInitial("width")&&!this.has("maxWidth"))||this.hasAlign(64)),this._cached.blockStatic}},{key:"blockDimension",get:function(){if(void 0===this._cached.blockDimension){var e=this.display;this._cached.blockDimension=this.block||e.startsWith("inline-")||"table"===e||this.imageElement}return this._cached.blockDimension}},{key:"pageFlow",get:function(){return void 0===this._cached.pageFlow&&(this._cached.pageFlow=this.positionStatic||this.positionRelative),this._cached.pageFlow}},{key:"inlineFlow",get:function(){if(void 0===this._cached.inlineFlow){var e=this.display;this._cached.inlineFlow=this.inline||e.startsWith("inline")||"table-cell"===e||this.imageElement||this.floating}return this._cached.inlineFlow}},{key:"centerAligned",get:function(){return void 0===this._cached.centerAligned&&(this._cached.centerAligned=this.autoMargin.leftRight||this.textElement&&this.blockStatic&&"center"===this.cssInitial("textAlign")),this._cached.centerAligned}},{key:"rightAligned",get:function(){return void 0===this._cached.rightAligned&&(this._cached.rightAligned="right"===this.float||this.autoMargin.left||!this.pageFlow&&this.has("right")||this.textElement&&this.blockStatic&&"right"===this.cssInitial("textAlign")),this._cached.rightAligned||this.hasAlign(1024)}},{key:"bottomAligned",get:function(){return void 0===this._cached.bottomAligned&&(this._cached.bottomAligned=!this.pageFlow&&this.has("bottom")&&this.bottom>=0),this._cached.bottomAligned}},{key:"horizontalAligned",get:function(){return void 0===this._cached.horizontalAligned&&(this._cached.horizontalAligned=!(this.blockStatic||this.autoMargin.horizontal||this.blockDimension&&"100%"===this.css("width"))),this._cached.horizontalAligned}},{key:"autoMargin",get:function(){if(void 0===this._cached.autoMargin)if(!this.pageFlow||this.blockStatic||"table"===this.display){var e=-1===this._initial.iteration?this._styleMap:this._initial.styleMap,t="auto"===e.marginLeft&&(this.pageFlow||this.has("right")),i="auto"===e.marginRight&&(this.pageFlow||this.has("left")),n="auto"===e.marginTop&&(this.pageFlow||this.has("bottom")),r="auto"===e.marginBottom&&(this.pageFlow||this.has("top"));this._cached.autoMargin={horizontal:t||i,left:t&&!i,right:!t&&i,leftRight:t&&i,vertical:n||r,top:n&&!r,bottom:!n&&r,topBottom:n&&r}}else this._cached.autoMargin={horizontal:!1,left:!1,right:!1,leftRight:!1,top:!1,bottom:!1,vertical:!1,topBottom:!1};return this._cached.autoMargin}},{key:"floating",get:function(){if(void 0===this._cached.floating)if(this.pageFlow){var e=this.css("float");this._cached.floating="left"===e||"right"===e}else this._cached.floating=!1;return this._cached.floating}},{key:"float",get:function(){return void 0===this._cached.float&&(this._cached.float=this.floating?this.css("float"):"none"),this._cached.float}},{key:"zIndex",get:function(){return this.toInt("zIndex")}},{key:"textContent",set:function(e){this._cached.textContent=e},get:function(){return void 0===this._cached.textContent&&(this._cached.textContent=(this.htmlElement||this.plainText)&&this._element.textContent||""),this._cached.textContent}},{key:"textEmpty",get:function(){return this.inlineText&&(""===this.textContent||!this.preserveWhiteSpace&&""===this.textContent.trim())}},{key:"src",get:function(){var e=this._element;return e&&(this.imageElement||"image"===e.type)?e.src:""}},{key:"overflow",set:function(e){0!==e&&16!==e&&8!==e&&24!==e||(this._cached.overflow=e)},get:function(){if(void 0===this._cached.overflow){var e=this._element,t=this.css("overflow"),i=this.css("overflowX"),n=this.css("overflowY"),r=0;this.hasWidth&&("scroll"===t||"scroll"===i||"auto"===i&&e&&e.clientWidth!==e.scrollWidth)&&(r|=8),this.hasHeight&&("scroll"===t||"scroll"===n||"auto"===n&&e&&e.clientHeight!==e.scrollHeight)&&(r|=16),this._cached.overflow=r}return this._cached.overflow}},{key:"overflowX",get:function(){return xe.hasBit(this.overflow,8)}},{key:"overflowY",get:function(){return xe.hasBit(this.overflow,16)}},{key:"baseline",set:function(e){this._cached.baseline=e},get:function(){if(void 0===this._cached.baseline){var e=this.verticalAlign,t=this.cssInitial("verticalAlign");this._cached.baseline=this.pageFlow&&!this.floating&&!this.svgElement&&("baseline"===e||"initial"===e||me.isLength(t)&&0===parseInt(t))}return this._cached.baseline}},{key:"verticalAlign",get:function(){if(void 0===this._cached.verticalAlign){var e=this.css("verticalAlign");me.isPercent(e)&&(e=me.formatPX(parseInt(e)/100*this.bounds.height)),this._cached.verticalAlign=e}return this._cached.verticalAlign}},{key:"multiline",set:function(e){this._cached.multiline=e},get:function(){return void 0===this._cached.multiline&&(this._cached.multiline=!!(this.plainText||this.inlineText&&(this.inlineFlow||0===this.length))&&ke.getRangeClientRect(this._element,this.sessionId).multiline>0),this._cached.multiline}},{key:"positiveAxis",get:function(){return void 0===this._cached.positiveAxis&&(this._cached.positiveAxis=(!this.positionRelative||this.positionRelative&&this.top>=0&&this.left>=0&&(this.right<=0||this.has("left"))&&(this.bottom<=0||this.has("top")))&&this.marginTop>=0&&this.marginLeft>=0&&this.marginRight>=0),this._cached.positiveAxis}},{key:"leftTopAxis",get:function(){return this.absoluteParent===this.documentParent||"fixed"===this.position}},{key:"renderExclude",set:function(e){this._cached.renderExclude=e},get:function(){return void 0===this._cached.renderExclude&&(this._cached.renderExclude=this.pseudoElement&&'""'===this.css("content")&&0===this.contentBoxWidth&&0===this.contentBoxHeight||0===this.bounds.height&&(this.marginTop<0||this.marginBottom<0)),this._cached.renderExclude}},{key:"visibleStyle",get:function(){if(void 0===this._cached.visibleStyle){var e=this.borderTopWidth>0||this.borderRightWidth>0||this.borderBottomWidth>0||this.borderLeftWidth>0,t=be.CSS.URL.test(this.css("backgroundImage"))||be.CSS.URL.test(this.css("background")),i=this.has("backgroundColor");this._cached.visibleStyle={padding:this.paddingTop>0||this.paddingRight>0||this.paddingBottom>0||this.paddingLeft>0,background:e||t||i,borderWidth:e,backgroundImage:t,backgroundColor:i,backgroundRepeat:"no-repeat"!==this.css("backgroundRepeat")}}return this._cached.visibleStyle}},{key:"preserveWhiteSpace",get:function(){if(void 0===this._cached.preserveWhiteSpace){var e=this.css("whiteSpace");this._cached.preserveWhiteSpace="pre"===e||"pre-wrap"===e}return this._cached.preserveWhiteSpace}},{key:"layoutHorizontal",get:function(){return this.hasAlign(8)}},{key:"layoutVertical",get:function(){return this.hasAlign(16)}},{key:"controlName",set:function(e){this.rendered&&void 0!==this._controlName||(this._controlName=e)},get:function(){return this._controlName||""}},{key:"documentParent",set:function(e){this._documentParent=e},get:function(){return this._documentParent||this.actualParent||this.parent||this}},{key:"absoluteParent",get:function(){if(void 0===this._cached.absoluteParent){var e=this.actualParent;if(!this.pageFlow)for(;e&&0!==e.id;){var t=e.cssInitial("position",!1,!0);if(e.documentBody||"static"!==t&&"initial"!==t&&"unset"!==t)break;e=e.actualParent}this._cached.absoluteParent=e||null}return this._cached.absoluteParent}},{key:"actualParent",get:function(){return void 0===this._cached.actualParent&&(this._cached.actualParent=this._element&&this._element.parentElement&&ke.getElementAsNode(this._element.parentElement,this.sessionId)||null),this._cached.actualParent}},{key:"actualChildren",set:function(e){this._cached.actualChildren=e},get:function(){var e=this;if(void 0===this._cached.actualChildren)if(this.htmlElement&&this.naturalElement){var t=[];this._element.childNodes.forEach(function(i){var n=ke.getElementAsNode(i,e.sessionId);n&&n.naturalElement&&t.push(n)}),this._cached.actualChildren=t}else this._cached.actualChildren=this._initial.children;return this._cached.actualChildren}},{key:"actualWidth",get:function(){if(void 0===this._cached.actualWidth){if(this.plainText)this._cached.actualWidth=this.bounds.right-this.bounds.left;else if(!this.documentParent.flexElement&&"table-cell"!==this.display){var e=this.parseUnit(this.cssInitial("width",!0));if(e>0){var t=this.parseUnit(this.css("maxWidth"));return t>0&&(e=Math.min(e,t)),!this.contentBox||this.documentParent.gridElement||this.tableElement||(e+=this.contentBoxWidth),this._cached.actualWidth=e,e}}this._cached.actualWidth=this.bounds.width}return this._cached.actualWidth}},{key:"actualHeight",get:function(){if(void 0===this._cached.actualHeight){if(this.plainText)this._cached.actualHeight=this.bounds.bottom-this.bounds.top;else if(!this.documentParent.flexElement&&"table-cell"!==this.display){var e=this.parseUnit(this.cssInitial("height",!0),!1);if(e>0){var t=this.parseUnit(this.css("maxHeight"));return t>0&&(e=Math.min(e,t)),!this.contentBox||this.documentParent.gridElement||this.tableElement||(e+=this.contentBoxHeight),this._cached.actualHeight=e,e}}this._cached.actualHeight=this.bounds.height}return this._cached.actualHeight}},{key:"actualDimension",get:function(){return{width:this.actualWidth,height:this.actualHeight}}},{key:"firstChild",get:function(){return this.actualChildren.length?this.actualChildren[0]:null}},{key:"lastChild",get:function(){return this.actualChildren.length?this.actualChildren[this.actualChildren.length-1]:null}},{key:"singleChild",get:function(){return this.renderParent?1===this.renderParent.length:!(!this.parent||0===this.parent.id)&&1===this.parent.length}},{key:"previousSibling",get:function(){if(void 0===this._cached.previousSibling){if(this.naturalElement)for(var e=this._element.previousSibling;e;){var t=ke.getElementAsNode(e,this.sessionId);if(t&&t.naturalElement&&!t.pseudoElement&&(!t.excluded||t.lineBreak))return this._cached.previousSibling=t,t;e=e.previousSibling}this._cached.previousSibling=null}return this._cached.previousSibling}},{key:"nextSibling",get:function(){if(void 0===this._cached.nextSibling){if(this.naturalElement)for(var e=this._element.nextSibling;e;){var t=ke.getElementAsNode(e,this.sessionId);if(t&&t.naturalElement&&!t.pseudoElement&&(!t.excluded||t.lineBreak))return this._cached.nextSibling=t,t;e=e.nextSibling}this._cached.nextSibling=null}return this._cached.nextSibling}},{key:"dir",set:function(e){this._cached.dir=e},get:function(){if(void 0===this._cached.dir){var e=this.naturalElement&&this.styleElement&&!this.pseudoElement?this._element.dir:"";switch(e){case"ltr":case"rtl":break;default:for(var t=this.actualParent;t;){if(e=t.dir){this._cached.dir=e;break}t=t.actualParent}}this._cached.dir=e||document.body.dir}return this._cached.dir}},{key:"nodes",get:function(){return this.rendered?this.renderChildren:this.children}},{key:"center",get:function(){return{x:this.bounds.left+Math.floor(this.bounds.width/2),y:this.bounds.top+Math.floor(this.actualHeight/2)}}}]),i}(),we=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,_e),o(t,[{key:"init",value:function(){if(this.length){for(var e=1/0,t=Array.isArray(n=this),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;e=Math.min(e,a.siblingIndex),a.parent=this}this.siblingIndex===1/0&&(this.siblingIndex=e),this.parent&&this.parent.sort(_.siblingIndex),this.setBounds(),this.saveAsInitial(),this.actualParent&&(this.dir=this.actualParent.dir)}}},{key:"setBounds",value:function(){if(this.length){var e=_.outerRegion(this);this._bounds=Object.assign({},e,{width:e.right-e.left,height:e.bottom-e.top})}}},{key:"previousSiblings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.item(0);return t?t.previousSiblings(e):[]}},{key:"nextSiblings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.item();return t?t.nextSiblings(e):[]}},{key:"block",get:function(){return void 0===this._cached.block&&(this._cached.block=this.some(function(e){return e.block})),this._cached.block}},{key:"blockStatic",get:function(){if(void 0===this._cached.blockStatic){var e=this.actualChildren.length&&this.actualChildren[0].blockStatic||this.actualWidth===this.documentParent.actualWidth||this.hasAlign(64)||this.layoutVertical&&this.some(function(e){return e.blockStatic})||this.documentParent.blockStatic&&this.hasAlign(256);if(!e&&0===this.containerType)return!1;this._cached.blockStatic=e}return this._cached.blockStatic}},{key:"blockDimension",get:function(){return void 0===this._cached.blockDimension&&(this._cached.blockDimension=this.some(function(e){return e.blockDimension})),this._cached.blockDimension}},{key:"inline",get:function(){return void 0===this._cached.inline&&(this._cached.inline=this.every(function(e){return e.inline})),this._cached.inline}},{key:"inlineStatic",get:function(){return void 0===this._cached.inlineStatic&&(this._cached.inlineStatic=this.every(function(e){return e.inlineStatic})),this._cached.inlineStatic}},{key:"inlineVertical",get:function(){return void 0===this._cached.inlineVertical&&(this._cached.inlineVertical=this.every(function(e){return e.inlineVertical})),this._cached.inlineVertical}},{key:"inlineFlow",get:function(){return void 0===this._cached.inlineStatic&&(this._cached.inlineStatic=this.hasAlign(128)||this.inlineStatic),this._cached.inlineStatic}},{key:"pageFlow",get:function(){return void 0===this._cached.pageFlow&&(this._cached.pageFlow=this.every(function(e){return e.pageFlow})),this._cached.pageFlow}},{key:"baseline",get:function(){if(void 0===this._cached.baseline){var e=this.cssInitial("verticalAlign",!0);this._cached.baseline=""!==e?"baseline"===e:this.every(function(e){return e.baseline})}return this._cached.baseline}},{key:"float",get:function(){return void 0===this._cached.float&&(this._cached.float=this.floating?this.hasAlign(1024)?"right":"left":"none"),this._cached.float}},{key:"floating",get:function(){return void 0===this._cached.floating&&(this._cached.floating=this.every(function(e){return e.floating})),this._cached.floating}},{key:"display",get:function(){return this.css("display")||this.some(function(e){return e.blockStatic})?"block":this.some(function(e){return e.blockDimension||e.inlineVertical})?"inline-block":"inline"}},{key:"actualParent",get:function(){return void 0===this._cached.actualParent&&(this._cached.actualParent=_.actualParent(this._initial.children)),this._cached.actualParent}},{key:"groupParent",get:function(){return!0}},{key:"multiline",get:function(){return!1}}]),t}(),Ee=function(e){function t(){var e;return r(this,t),(e=u(this,c(t).apply(this,arguments))).options={showLabel:!0},e}return l(t,ce),o(t,[{key:"afterInit",value:function(){for(var e=this,t=function(){if(i){if(n>=r.length)return"break";a=r[n++]}else{if((n=r.next()).done)return"break";a=n.value}var t=a;if(t.hasProcedure(x.ACCESSIBILITY))switch(t.tagName){case"IMAGE":t.extracted=[t];break;case"RADIO":case"CHECKBOX":var o=t.element;[t.nextSibling,t.previousSibling].some(function(i){if(i&&i.visible&&i.pageFlow&&!i.visibleStyle.backgroundImage){var n="LABEL"===i.documentParent.tagName?i.documentParent:void 0;if(o.id&&o.id===i.element.htmlFor?t.companion=i:i.textElement&&n?(t.companion=i,n.renderAs=t):i.plainText&&(t.companion=i),t.companion)return e.options.showLabel||i.hide(),!0}return!1});break;case"BUTTON":if(t.length){var s=t.filter(function(e){return!e.textElement});s.length&&(t.extracted=s),t.clear()}}},i=Array.isArray(r=this.application.processing.cache),n=0,r=i?r:r[Symbol.iterator]();;){var a;if("break"===t())break}}}]),t}(),Te=squared.lib.css,Ie=squared.lib.util,Ce="[\\d.]+[a-z%]+|auto|max-content|min-content",Re="minmax\\(([^,]+), ([^)]+)\\)",Be={UNIT:RegExp("^(".concat(Ce,")$")),NAMED:"\\s*(repeat\\((auto-fit|auto-fill|[0-9]+), (.+)\\)|\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|".concat(Ce,")\\s*"),REPEAT:"\\s*(\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|".concat(Ce,")\\s*"),STARTEND:/^([\w\-]+)-(start|end)$/};function Pe(e,t){for(var i=[],n=[],r=0;r<t.length;r++)e.repeat[r]?n.push(t[r]):i.push(t[r]);for(var a=e.count-i.length,o=[],s=0;s<e.count;s++){if(e.repeat[s]){for(var l=0,c=0;l<a;s++,l++,c++)c===n.length&&(c=0),o[s]=n[c];break}i.length&&(o[s]=i.shift())}return o}function Me(e){for(var t=0,i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}a&&t++}return t}var Le=function(e,t){return Te.isLength(t)?e.convertPX(t):t},Ne=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){return e.gridElement&&e.length>0}},{key:"processNode",value:function(e){var i=Object.assign({},t.createDataAttribute(),{alignItems:e.css("alignItems"),alignContent:e.css("alignContent"),justifyItems:e.css("justifyItems"),justifyContent:e.css("justifyContent")}),n=e.css("gridAutoFlow"),r=-1===n.indexOf("column"),a=-1!==n.indexOf("dense"),o=[],s=[],l=[],c={};if(i.row.gap=e.parseUnit(e.css("rowGap"),!1,!1),i.column.gap=e.parseUnit(e.css("columnGap"),!0,!1),[e.cssInitial("gridTemplateRows",!0),e.cssInitial("gridTemplateColumns",!0),e.css("gridAutoRows"),e.css("gridAutoColumns")].forEach(function(t,n){if(t&&"none"!==t&&"auto"!==t)for(var r,a=RegExp(Be.NAMED,"g"),o=1;null!==(r=a.exec(t));)if(n<2){var s=i[0===n?"row":"column"];if(r[1].startsWith("repeat")){var l=1;switch(r[2]){case"auto-fit":s.autoFit=!0;break;case"auto-fill":s.autoFill=!0;break;default:l=Ie.convertInt(r[2])}if(l>0){for(var c=[],h=RegExp(Be.REPEAT,"g"),u=void 0;null!==(u=h.exec(r[3]));){var d=void 0;null!==(d=/\[([\w\-\s]+)\]/.exec(u[1]))?(void 0===s.name[d[1]]&&(s.name[d[1]]=[]),c.push({name:d[1]})):null!==(d=RegExp(Re).exec(u[1]))?c.push({unit:Le(e,d[2]),unitMin:Le(e,d[1])}):null!==(d=/fit-content\(([\d.]+[a-z%]+)\)/.exec(u[1]))?c.push({unit:Le(e,d[1]),unitMin:"0px"}):null!==(d=RegExp(Ce).exec(u[1]))&&c.push({unit:Le(e,d[0])})}if(c.length)for(var f=0;f<l;f++)for(var g=0,v=c;g<v.length;g++){var p=v[g];p.name?s.name[p.name].push(o):p.unit&&(s.unit.push(p.unit),s.unitMin.push(p.unitMin||""),s.repeat.push(!0),o++)}}}else"["===r[1].charAt(0)?(void 0===s.name[r[4]]&&(s.name[r[4]]=[]),s.name[r[4]].push(o)):r[1].startsWith("minmax")?(s.unit.push(Le(e,r[6])),s.unitMin.push(Le(e,r[5])),s.repeat.push(!1),o++):r[1].startsWith("fit-content")?(s.unit.push(Le(e,r[7])),s.unitMin.push("0px"),s.repeat.push(!1),o++):Be.UNIT.test(r[1])&&(s.unit.push("auto"===r[1]?"auto":Le(e,r[1])),s.unitMin.push(""),s.repeat.push(!1),o++)}else i[2===n?"row":"column"].auto.push(e.convertPX(r[1]))}),e.sort(r?function(e,t){return Ie.withinRange(e.linear.top,t.linear.top)?Ie.withinRange(e.linear.left,t.linear.left)?0:e.linear.left<t.linear.left?-1:1:e.linear.top<t.linear.top?-1:1}:function(e,t){return Ie.withinRange(e.linear.left,t.linear.left)?Ie.withinRange(e.linear.top,t.linear.top)?0:e.linear.top<t.linear.top?-1:1:e.linear.left<t.linear.left?-1:1}),!e.has("gridTemplateAreas")&&e.every(function(e){return"auto"===e.css("gridRowStart")&&"auto"===e.css("gridColumnStart")})){var h,u,d,f,g;r?(h="top",u="bottom",d=2,f=1,g=3):(h="left",u="right",d=3,f=0,g=2);var v,p=0,m=0,y=0;e.each(function(e,t){(void 0===v||e.linear[h]>=v.linear[u]||m>0&&m===y)&&(y=Math.max(m,y),p++,m=1);var n=e.css("gridRowEnd"),a=e.css("gridColumnEnd"),o=1,s=1;if(n.startsWith("span")?o=parseInt(n.split(" ")[1]):Ie.isNumber(n)&&(o=parseInt(n)-p),a.startsWith("span")?s=parseInt(a.split(" ")[1]):Ie.isNumber(a)&&(s=parseInt(a)-m),1===m&&y>0){var c=!1;do{for(var b=[].fill(1),k=0,x=l;k<x.length;k++){var S=x[k].placement;if(S[d]>p)for(var A=S[f];A<S[g];A++)b[A-1]=0}for(var _=0,w=0,E=0;_<b.length;_++)if(b[_]){if(0===w&&(E=_),++w===s){m=E+1,c=!0;break}}else w=0;c||(i.emptyRows[p-1]=b,p++)}while(!c)}l[t]={placement:r?[p,m,p+o,m+s]:[m,p,m+s,p+o],rowSpan:o,columnSpan:s},m+=s,v=e})}else e.css("gridTemplateAreas").split(/"[\s\n]+"/).forEach(function(e,t){if("none"!==e){var n=i.templateAreas;Ie.trimString(e.trim(),'"').split(" ").forEach(function(e,i){"."!==e&&(void 0===n[e]?n[e]={rowStart:t,rowSpan:1,columnStart:i,columnSpan:1}:(n[e].rowSpan=t-n[e].rowStart+1,n[e].columnSpan=i-n[e].columnStart+1))})}}),e.each(function(e,t){var n=[e.css("gridRowStart"),e.css("gridColumnStart"),e.css("gridRowEnd"),e.css("gridColumnEnd")],r=[],a=1,o=1;if(Object.keys(i.templateAreas).length)for(var s=0;s<n.length;s++){var c=n[s],h=i.templateAreas[c];if(h)switch(s){case 0:r[0]=h.rowStart+1;break;case 1:r[1]=h.columnStart+1;break;case 2:r[2]=h.rowStart+h.rowSpan+1;break;case 3:r[3]=h.columnStart+h.columnSpan+1}else{var u=Be.STARTEND.exec(c);if(u&&(h=i.templateAreas[u[1]]))if("start"===u[2])switch(s){case 0:case 2:r[s]=h.rowStart+1;break;case 1:case 3:r[s]=h.columnStart+1}else switch(s){case 0:case 2:r[s]=h.rowStart+h.rowSpan+1;break;case 1:case 3:r[s]=h.columnStart+h.columnSpan+1}}}if(!(r[0]&&r[1]&&r[2]&&r[3]))for(var d,f,g=function(e,t){if(Ie.isNumber(e))return r[t]=parseInt(e),!0;if(e.startsWith("span")){var i=parseInt(e.split(" ")[1]);return r[t-2]?r[t]=r[t-2]+i:t%2==0?a=i:o=i,!0}return!1},v=0;v<n.length;v++){var p=n[v];if("auto"!==p&&!r[v]&&!g(p,v)){var m=i[v%2==0?"row":"column"],y=p.split(" ");1===y.length?(y[1]=y[0],y[0]="1"):Ie.isNumber(y[0])&&(v%2==0?void 0===d?d=y:a=parseInt(y[0])-parseInt(d[0]):void 0===f?f=y:o=parseInt(y[0])-parseInt(f[0]));var b=m.name[y[1]];if(b){var k=parseInt(y[0]);k<=b.length&&(r[v]=b[k-1]+(y[1]===n[v-2]?1:0))}}r[v]||g(p,v)}l[t]={placement:r,rowSpan:a,columnSpan:o}});var b=i[r?"column":"row"];b.count=Math.max(1,b.unit.length);for(var k=0,x=l;k<x.length;k++){var S=x[k];S&&(b.count=Math.max(b.count,r?S.columnSpan:S.rowSpan,S.placement[r?1:0]||0,(S.placement[r?3:2]||0)-1))}(b.autoFill||b.autoFit)&&(0===b.unit.length&&(b.unit.push("auto"),b.unitMin.push(""),b.repeat.push(!0)),b.unit=Pe(b,b.unit),b.unitMin=Pe(b,b.unitMin));for(var A=1,_=0,w=Array.isArray(T=b.unit),E=0,T=w?T:T[Symbol.iterator]();;){var I;if(w){if(E>=T.length)break;I=T[E++]}else{if((E=T.next()).done)break;I=E.value}var C=I;Te.isPercent(C)?A-=parseFloat(C)/100:C.endsWith("fr")&&(_+=parseFloat(C))}if(A>0&&_>0)for(var R=0;R<b.unit.length;R++)b.unit[R].endsWith("fr")&&(b.unit[R]=A*(parseFloat(b.unit[R])/_)+"fr");for(var B=i.row.unit.length+1,P=i.column.unit.length+1,M=0,L=l;M<L.length;M++){var N=L[M].placement;N[2]<0&&(B>1?N[2]+=B+1:N[2]=void 0),N[3]<0&&(P>1?N[3]+=P+1:N[3]=void 0)}if(e.each(function(e,t){var n,h,u,d,f,g,v,p=l[t],m=p.placement;for(r?(n=p.rowSpan,h=p.columnSpan,u=i.column.count,d=0,f=1,g=2,v=3):(n=p.columnSpan,h=p.rowSpan,u=i.row.count,d=1,f=0,g=3,v=2);!m[0]||!m[1];){var y=m.slice(0);if(!y[d])for(var b=o.length,k=0,x=0,S=-1;k<b;k++)if(!c[k])if(void 0===s[k]||s[k]<u){if(0===x&&(S=k,b=Math.max(b,k+n)),++x===n){y[d]=S+1;break}}else x=0,S=-1,b=o.length;if(y[d]){if(!y[f]){y[g]||(y[g]=y[d]+n);for(var A=[],_=y[d]-1,w=y[g]-1,E=_;E<w;E++)if(void 0===o[E])A.push([[0,-1]]);else{if(!(Me(o[E])+h<=u))break;for(var T=[],I=0,C=0,R=-1;C<u;C++)void 0===o[E][C]&&(-1===R&&(R=C),I++),(o[E][C]||C===u-1)&&(I>=h&&T.push([R,R+I]),R=-1,I=0);if(!T.length)break;A.push(T)}if(A.length)if(-1===A[0][0][1])y[f]=1;else if(A.length===w-_)if(A.length>1)e:for(var B=Array.isArray(M=A[0]),P=0,M=B?M:M[Symbol.iterator]();;){var L;if(B){if(P>=M.length)break;L=M[P++]}else{if((P=M.next()).done)break;L=P.value}for(var N=L,O=N[0];O<N[1];O++)for(var W=1;W<A.length;W++)for(var D=0;D<A[W].length;D++){var F=A[W][D];if(O>=F[0]&&(-1===F[1]||O+h<=F[1])){y[f]=O+1;break e}}}else y[f]=A[0][0][0]+1}}else m[d]=o.length+1,m[f]||(m[f]=1);y[d]&&y[f]?(m[d]=y[d],m[f]=y[f]):y[d]&&(c[y[d]-1]=!0)}if(m[g]||(m[g]=m[d]+n),m[v]||(m[v]=m[f]+h),function(e,t){if(t.every(function(e){return e>0})){for(var i=t[r?0:1]-1;i<t[r?2:3]-1;i++){void 0===o[i]&&(o[i]=[]);for(var n=t[r?1:0]-1;n<t[r?3:2]-1;n++)void 0===s[i]&&(s[i]=0),void 0===o[i][n]&&(o[i][n]=[],s[i]++),o[i][n].push(e)}return!0}return!1}(e,m)){var H=m[0]-1,z=m[2]-m[0];if(z>1)for(var V=H;V<z;V++)i.rowSpanMultiple[V]=!0;e.data(ve.CSS_GRID,"cellData",{rowStart:H,rowSpan:z,columnStart:m[1]-1,columnSpan:m[3]-m[1]}),a&&(c={})}}),o.length){if(r)i.rowData=o;else for(var O=0;O<o.length;O++)for(var W=0;W<o[O].length;W++)void 0===i.rowData[W]&&(i.rowData[W]=[]),i.rowData[W][O]=o[O][W];for(var D=i[r?"row":"column"].unitTotal,F=0,H=Array.isArray(V=i.rowData),z=0,V=H?V:V[Symbol.iterator]();;){var q;if(H){if(z>=V.length)break;q=V[z++]}else{if((z=V.next()).done)break;q=z.value}var X=q;F=Math.max(X.length,F);for(var U=0;U<X.length;U++){var G=X[U];if(void 0===D[U]&&(D[U]=0),G){for(var j=0,Y=0;Y<G.length;Y++){var K=G[Y];K.positioned=!0,i.children.has(K)||(j=Math.max(j,r?K.bounds.height:K.bounds.width)),i.children.add(K)}D[U]+=j}}}if(i.children.size===e.length){i.row.count=i.rowData.length,i.column.count=F;for(var Z=new Set,$=0;$<i.row.count;$++){i.rowHeight.push(0),i.rowHeightCount.push(0);for(var Q=0;Q<F;Q++){var J=i.rowData[$][Q];if(J)for(var ee=Array.isArray(ie=J),te=0,ie=ee?ie:ie[Symbol.iterator]();;){var ne;if(ee){if(te>=ie.length)break;ne=ie[te++]}else{if((te=ie.next()).done)break;ne=te.value}var re=ne;if(!Z.has(re)){var ae=re.data(ve.CSS_GRID,"cellData"),oe=$+ae.rowSpan-1;Q+ae.columnSpan-1<F-1&&re.modifyBox(4,i.column.gap),oe<i.row.count-1&&re.modifyBox(8,i.row.gap),1===ae.rowSpan&&(i.rowHeight[$]=Math.max(i.rowHeight[$],re.bounds.height),i.rowHeightCount[$]++),Z.add(re)}}}}for(var se=0;se<i.rowHeight.length;se++)i.rowWeight[se]=i.rowHeight[se]/e.actualHeight;e.retain(Array.from(i.children)),e.cssSort("zIndex"),e.data(ve.CSS_GRID,"mainData",i)}}}}],[{key:"createDataAttribute",value:function(){return{children:new Set,rowData:[],rowHeight:[],rowHeightCount:[],rowWeight:[],rowSpanMultiple:[],templateAreas:{},row:t.createDataRowAttribute(),column:t.createDataRowAttribute(),emptyRows:[],alignItems:"",alignContent:"",justifyItems:"",justifyContent:""}}},{key:"createDataRowAttribute",value:function(){return{count:0,gap:0,unit:[],unitMin:[],unitTotal:[],repeat:[],auto:[],autoFill:!1,autoFit:!1,name:{},normal:!0}}}]),t}(),Oe=squared.lib.util,We=function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){return e.flexElement&&e.length>0}},{key:"processNode",value:function(e){var i=this.application.controllerHandler,n=e.filter(function(e){return e.pageFlow&&e.pseudoElement&&'""'===e.css("content")&&0===e.contentBoxWidth?(e.hide(),!1):e.pageFlow}),r=t.createDataAttribute(e,n);if(e.cssTry("alignItems","start")){if(e.cssTry("justifyItems","start")){for(var a=Array.isArray(s=n),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}var c=l,h=c.initial.bounds;if(h&&c.cssTry("alignSelf","start")){if(c.cssTry("justifySelf","start")){if(c.cssTry("flexGrow","0")){if(c.cssTry("flexShrink","1")){var u=c.element.getBoundingClientRect();h.width=u.width,h.height=u.height,c.cssFinally("flexShrink")}c.cssFinally("flexGrow")}c.cssFinally("justifySelf")}c.cssFinally("alignSelf")}}e.cssFinally("justifyItems")}e.cssFinally("alignItems")}if(r.wrap){var d,f,g,v;r.directionRow?(d="top",f="left",g="right",v="intersectY"):(d="left",f="top",g="bottom",v="intersectX"),n.sort(function(e,t){return e[v](t.bounds,"bounds")?Oe.withinRange(e.linear[f],t.linear[f])?0:e.linear[f]<t.linear[f]?-1:1:e.linear[d]<t.linear[d]?-1:1});for(var p=[n[0]],m=n[0],y=[p],b=1;b<n.length;b++){var k=n[b];m[v](k.bounds,"bounds")?p.push(k):(m=k,y.push(p=[k]))}e.clear();for(var x=0,S=0;S<y.length;S++){var A=y[S],w=i.createNodeGroup(A[0],A,e);w.siblingIndex=S,e.sort(_.siblingIndex);var E=w.unsafe("box");E&&(E[g]=e.box[g]),w.alignmentType|=128,x=Math.max(A.length,x)}r.directionRow?(r.rowCount=y.length,r.columnCount=x):(r.rowCount=x,r.columnCount=y.length)}else{if(n.some(function(e){return 0!==e.flexbox.order})){var T=r.directionReverse?-1:1,I=r.directionReverse?1:-1;n.sort(function(e,t){return e.flexbox.order===t.flexbox.order?0:e.flexbox.order>t.flexbox.order?T:I})}r.directionRow?(r.rowCount=1,r.columnCount=e.length):(r.rowCount=e.length,r.columnCount=1)}e.data(ve.FLEXBOX,"mainData",r)}}],[{key:"createDataAttribute",value:function(e,t){var i=e.css("flexWrap"),n=e.css("flexDirection");return{directionRow:n.startsWith("row"),directionColumn:n.startsWith("column"),directionReverse:n.endsWith("reverse"),wrap:i.startsWith("wrap"),wrapReverse:"wrap-reverse"===i,alignContent:e.css("alignContent"),justifyContent:e.css("justifyContent"),rowCount:0,columnCount:0,children:t}}}]),t}(),De=squared.lib.css,Fe=squared.lib.session,He=squared.lib.util;function ze(e,t){for(var i=Array.isArray(r=e),n=0,r=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if((n=r.next()).done)break;a=n.value}var o=a.findIndex(function(e){return He.withinRange(t.linear.top,e.linear.top)||t.linear.top>e.linear.top&&t.linear.top<e.linear.bottom});if(-1!==o)return o}return-1}var Ve=squared.lib.css,qe=function(e){return e.visibleStyle.backgroundImage&&!e.visibleStyle.backgroundRepeat},Xe=squared.lib.util,Ue=squared.lib.css,Ge=squared.lib.regex,je=squared.lib.css,Ye=squared.lib.client,Ke=squared.lib.css,Ze=squared.lib.dom,$e=squared.lib.math,Qe=squared.lib.util,Je=/rgba\(0, 0, 0, 0\)|transparent/,et=/none|\s0px|rgba\(0, 0, 0, 0\)|transparent/,tt=squared.lib.css,it=squared.lib.util,nt=squared.lib.session,rt=squared.lib.css,at=squared.lib.util,ot=!!document.doctype&&"html"===document.doctype.name;function st(e,t){var i=e.has("minHeight",2)?e.toFloat("minHeight"):0;e.css("minHeight",rt.formatPX(Math.max(t,i)))}function lt(e){return!!e&&((e.blockStatic||"table"===e.display)&&!e.lineBreak&&!e.positioned)}function ct(e){if(e.visible){var t=e.innerChild;return t&&!t.naturalElement?t:e}return e.excluded?e:e.renderAs||e.outerParent||e.innerChild||e}function ht(e,t){e.modifyBox(t,null),e.companion&&e.companion.modifyBox(t,null)}function ut(e,t,i){var n,r,a,o;if(lt(t)&&(i?(n="marginTop",r="borderTopWidth",a="paddingTop",o=2):(a="paddingBottom",r="borderBottomWidth",n="marginBottom",o=8),0===e[r]&&0===e[a])){for(;0===t[n]&&0===t[r]&&0===t[a];){var s=i?t.firstChild:t.lastChild;if(!lt(s))break;t=s}if(1!==t.valueBox(o)[0]){if(ot&&e[n]<t[n]){var l=ct(e);l.modifyBox(o,null),l.modifyBox(o,t[n])}ht(t,o),0===t.bounds.height&&ht(t,i?8:2)}}}var dt={Accessibility:Ee,CssGrid:Ne,External:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"beforeInit",value:function(e){if((arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.included(e))&&!Fe.getElementCache(e,"squaredExternalDisplay",this.application.processing.sessionId)){for(var t=[],i=e;i;)t.push(De.getStyle(i).getPropertyValue("display")),i.style.setProperty("display","block"),i=i.parentElement;Fe.setElementCache(e,"squaredExternalDisplay",this.application.processing.sessionId,t)}}},{key:"init",value:function(e){return this.included(e)&&this.application.rootElements.add(e),!1}},{key:"afterInit",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.included(e)){var t=Fe.getElementCache(e,"squaredExternalDisplay",this.application.processing.sessionId);if(Array.isArray(t)){for(var i=e,n=0;i;)i.style.setProperty("display",t[n]),i=i.parentElement,n++;Fe.deleteElementCache(e,"squaredExternalDisplay",this.application.processing.sessionId)}}}}]),t}(),Flexbox:We,Grid:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){if(e.length>1&&!e.layoutElement&&!e.has("listStyle")){if("table"===e.display)return e.every(function(e){return"table-row"===e.display&&e.every(function(e){return"table-cell"===e.display})});for(var t=0,i=0,n=Array.isArray(a=e),r=0,a=n?a:a[Symbol.iterator]();;){var o;if(n){if(r>=a.length)break;o=a[r++]}else{if((r=a.next()).done)break;o=r.value}if(!o.pageFlow||o.visibleStyle.background||!o.blockStatic||o.autoMargin.leftRight||o.autoMargin.left)return!1;o.length>1&&t++,"list-item"!==o.display||o.has("listStyleType")||i++}if(i===e.length)return!0;if(t>0)return e.every(function(e){return e.length>0&&_.linearData(e.children).linearX})}return!1}},{key:"processNode",value:function(e){for(var i=[],n=[],r={},a=Array.isArray(s=e),o=0,s=a?s:s[Symbol.iterator]();;){var l;if(a){if(o>=s.length)break;l=s[o++]}else{if((o=s.next()).done)break;l=o.value}for(var c=Array.isArray(u=l),h=0,u=c?u:u[Symbol.iterator]();;){var d;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}var f=d,g=Math.floor(f.linear.left);void 0===r[g]&&(r[g]=[]),r[g].push(f)}}var v=Object.keys(r);if(v.length){for(var p=[],m=0;m<v.length;m++){var y=r[v[m]];if(0===m&&0===y.length)return;p[m]=0===m?0:p[m-1];for(var b=0;b<y.length;b++){var k=y[b];if(0===m||k.linear.left>=p[m-1])if(void 0===n[m]&&(n[m]=[]),0===m||n[0].length===y.length)n[m][b]=k;else{var x=ze(n,k);if(-1===x)return;n[m][x]=k}else{var S=n.length-1;n[S]&&function(){var e=1/0,t=-1/0;if(n[S].forEach(function(i){e=Math.min(e,i.linear.left),t=Math.max(t,i.linear.right)}),k.linear.left>Math.ceil(e)&&k.linear.right>Math.ceil(t)){var i=ze(n,k);if(-1!==i)for(var r=n.length-1;r>=0;r--)if(n[r]){void 0===n[r][i]&&(n[S].length=0);break}}}()}p[m]=Math.max(k.linear.right,p[m])}}for(var A=0,_=-1;A<p.length;A++)void 0===n[A]?-1===_?_=A-1:A===p.length-1&&(p[_]=p[A]):-1!==_&&(p[_]=p[A-1],_=-1);for(var w=0;w<n.length;w++)n[w]&&n[w].length?i.push(p[w]):n.splice(w--,1);for(var E=n.reduce(function(e,t){return Math.max(e,t.length)},0),T=0;T<E;T++)for(var I=0;I<n.length;I++)void 0===n[I][T]&&(n[I][T]={spacer:1})}if(i.push(e.box.right),n.length>1&&n[0].length===e.length){for(var C=Object.assign({},t.createDataAttribute(),{columnCount:n.length}),R=[],B=0;B<n.length;B++)for(var P=0,M=0,L=0;M<n[B].length;M++){var N=n[B][M];if(void 0===R[M]&&(R[M]=[]),N.spacer)1===N.spacer&&P++;else{for(var O=Object.assign(t.createDataCellAttribute(),N.data(ve.GRID,"cellData")),W=1,D=1+P,F=B+1;F<n.length&&1===n[F][M].spacer;F++)D++,n[F][M].spacer=2;if(1===D)for(var H=M+1;H<n[B].length&&1===n[B][H].spacer;H++)W++,n[B][H].spacer=2;for(var z=Math.min(B+(D-1),i.length-1),V=Array.isArray(X=N.documentParent.actualChildren),q=0,X=V?X:X[Symbol.iterator]();;){var U;if(V){if(q>=X.length)break;U=X[q++]}else{if((q=X.next()).done)break;U=q.value}U.visible&&!U.rendered&&U.linear.left>=N.linear.right&&U.linear.right<=i[z]&&O.siblings.push(U)}O.rowSpan=W,O.columnSpan=D,O.rowStart=0==L++,O.rowEnd=D+B===n.length,O.cellStart=!0,O.cellEnd=O.rowEnd&&M===n[B].length-1,O.index=B,P=0,N.data(ve.GRID,"cellData",O),R[M].push(N)}}for(var G=Array.isArray(Y=e),j=0,Y=G?Y:Y[Symbol.iterator]();;){var K;if(G){if(j>=Y.length)break;K=Y[j++]}else{if((j=Y.next()).done)break;K=j.value}K.hide()}e.clear();for(var Z=0,$=R;Z<$.length;Z++)for(var Q=Array.isArray(ee=$[Z]),J=0,ee=Q?ee:ee[Symbol.iterator]();;){var te;if(Q){if(J>=ee.length)break;te=ee[J++]}else{if((J=ee.next()).done)break;te=J.value}te.parent=e}e.tableElement&&"collapse"===e.css("borderCollapse")&&(e.modifyBox(32,null),e.modifyBox(64,null),e.modifyBox(128,null),e.modifyBox(256,null)),e.data(ve.GRID,"mainData",C)}}}],[{key:"createDataAttribute",value:function(){return{paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,columnCount:0}}},{key:"createDataCellAttribute",value:function(){return{rowSpan:0,columnSpan:0,index:-1,cellStart:!1,cellEnd:!1,rowEnd:!1,rowStart:!1,siblings:[]}}}]),t}(),List:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){if(f(c(t.prototype),"condition",this).call(this,e)){var i=e.length;if(i){for(var n=new Set,r=0,a=0,o=0,s=0,l=0,h=0,u=0;u<i;u++){var d=e.children[u],g="none"!==d.css("listStyleType");"list-item"===d.display?(g||d.beforePseudoChild||qe(d))&&h++:qe(d)&&!g&&d.marginLeft<0&&l++,d.blockStatic&&r++,d.inlineVertical&&a++,d.floating?(n.add(d.float),o++):(0===u||u===i-1||d.blockStatic||e.children[u-1].blockStatic&&e.children[u+1].blockStatic)&&s++}return(l>0||h>0)&&(r===i||a===i||o===i&&1===n.size||s===i)}}return!1}},{key:"processNode",value:function(e){var i=1;e.each(function(e){var n=t.createDataAttribute(),r=e.css("listStyleType");if("list-item"===e.display||r&&"none"!==r||qe(e)){if(e.has("listStyleImage"))n.imageSrc=e.css("listStyleImage");else if(n.ordinal=Ve.convertListStyle(r,i),""===n.ordinal)switch(r){case"disc":n.ordinal="";break;case"square":n.ordinal="";break;case"none":var a="",o="";e.visibleStyle.backgroundRepeat||(a=e.css("backgroundImage"),o=e.css("backgroundPosition")),a&&"none"!==a&&(n.imageSrc=a,n.imagePosition=o,e.exclude({resource:k.IMAGE_SOURCE}));break;default:n.ordinal=""}else n.ordinal+=".";i++}e.data(ve.LIST,"mainData",n)})}}],[{key:"createDataAttribute",value:function(){return{ordinal:"",imageSrc:"",imagePosition:""}}}]),t}(),Relative:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){return e.positionRelative&&!e.positionStatic||0!==e.toFloat("verticalAlign",!0)}},{key:"processNode",value:function(){return{include:!0}}},{key:"postProcedure",value:function(e){var t=e.renderParent;if(t){var i,n=Xe.convertFloat(e.verticalAlign);if(!t.support.container.positionRelative||0!==e.length||0===e.top&&0===e.bottom&&0===n)i=e;else{i=e.clone(this.application.nextId,!0,!0),e.hide(!0),this.application.session.cache.append(i,!1);var r=new E(t,i,i.containerType,i.alignmentType),a=t.renderChildren.findIndex(function(t){return t===e});if(-1!==a&&(r.renderIndex=a+1),this.application.addRenderLayout(r),t.layoutHorizontal&&e.documentParent.toInt("textIndent")<0&&t.renderEach(function(t){t.alignSibling("topBottom")===e.documentId?t.alignSibling("topBottom",i.documentId):t.alignSibling("bottomTop")===e.documentId&&t.alignSibling("bottomTop",i.documentId)}),e.baselineActive&&!e.baselineAltered)for(var o=Array.isArray(l=t.horizontalRows||[t.renderChildren]),s=0,l=o?l:l[Symbol.iterator]();;){var c;if(o){if(s>=l.length)break;c=l[s++]}else{if((s=l.next()).done)break;c=s.value}var h=c;if(h.includes(e)){var u=Xe.filterArray(h,function(t){return t.positionRelative&&t.length>0&&0!==Xe.convertFloat(e.verticalAlign)});if(u.length){u.sort(function(e,t){return Xe.withinRange(e.linear.top,t.linear.top)?0:e.linear.top<t.linear.top?-1:1});for(var d=0;d<u.length;d++){var f=u[d];0===d?e.modifyBox(2,Xe.convertFloat(f.verticalAlign)):f.modifyBox(2,f.linear.top-u[0].linear.top),f.css("verticalAlign","0px",!0)}}break}}}0!==e.top?i.modifyBox(2,e.top):0!==e.bottom&&i.modifyBox(2,-1*e.bottom),0!==n&&i.modifyBox(2,-1*n),0!==e.left?i.autoMargin.left?i.modifyBox(4,-1*e.left):i.modifyBox(16,e.left):0!==e.right&&i.modifyBox(16,-1*e.right)}}}]),t}(),Sprite:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){var t=!1;if(e.hasWidth&&e.hasHeight&&0===e.length&&(this.included(e.element)||!e.dataset.use)){var i=e.css("backgroundImage");if(""===i||"none"===i){var n=Ge.CSS.URL.exec(e.css("background"));i=n?n[0]:""}if(""!==i){var r=this.application.session.image.get(Ue.resolveURL(i));if(r){var a=e.actualDimension,o=Ue.getBackgroundPosition("".concat(e.css("backgroundPositionX")," ").concat(e.css("backgroundPositionY")),a,e.fontSize);o.left<=0&&o.top<=0&&r.width>a.width&&r.height>a.height&&(r.position={x:o.left,y:o.top},e.data(ve.SPRITE,"mainData",r),t=!0)}}}return t}}]),t}(),Substitute:function(e){function t(e,i,n,a){var o;return r(this,t),(o=u(this,c(t).call(this,e,i,n,a))).require(ve.EXTERNAL,!0),o}return l(t,ce),o(t,[{key:"processNode",value:function(e,t){var i=this,n=je.getDataSet(e.element,this.name);if(n.tagChild&&e.each(function(e){e.styleElement&&(e.dataset.use=i.name,e.dataset.squaredSubstituteTag=n.tagChild)}),n.tag)return e.setControlType(n.tag),e.render(t),{output:{type:1,node:e,controlName:n.tag}}}}]),t}(),Table:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"processNode",value:function(e){var i=t.createDataAttribute(),n=[];function r(t){t.data(ve.TABLE,"percent","".concat(Math.round(t.bounds.width/e.box.width*100),"%")),t.data(ve.TABLE,"expand",!0)}function a(e){e.css("width",Ke.formatPX(e.bounds.width),!0)}function o(e){if(e.length){var t=e[0].cascade(),i=Array.isArray(t),r=0;for(t=i?t:t[Symbol.iterator]();;){var a;if(i){if(r>=t.length)break;a=t[r++]}else{if((r=t.next()).done)break;a=r.value}var o=a;"TH"!==o.tagName&&"TD"!==o.tagName||(o.inherit(e[0],"styleMap"),o.unsetCache("visibleStyle"))}Qe.concatArray(n,e[0].children);for(var s=Array.isArray(c=e),l=0,c=s?c:c[Symbol.iterator]();;){var h;if(s){if(l>=c.length)break;h=c[l++]}else{if((l=c.next()).done)break;h=l.value}h.hide()}}}var s=[],l=[],c=[];e.each(function(e){switch(e.tagName){case"THEAD":s.push(e);break;case"TBODY":l.push(e);break;case"TFOOT":c.push(e)}}),o(s);for(var h=0,u=l;h<u.length;h++){var d=u[h];Qe.concatArray(n,d.children),d.hide()}o(c);for(var f="fixed"===e.css("tableLayout"),v="collapse"===e.css("borderCollapse"),p=g(v?[0,0]:Qe.replaceMap(e.css("borderSpacing").split(" "),function(e){return parseInt(e)}),2),m=p[0],y=p[1],b=Ke.formatPX(m>1?Math.round(m/2):m),k=Ke.formatPX(y>1?Math.round(y/2):y),x=e.element&&e.element.querySelector("COLGROUP"),S=[],A=[],_=[],w=[],E=n.length,T=[].fill(0),I=0,C=0,R=function(e){var t=n[e];S[e]=m,_[e]=[],t.each(function(i,r){for(var a=i.element,o=0;o<a.rowSpan-1;o++){var s=e+1+o;void 0!==T[s]&&(T[s]+=a.colSpan)}if(!i.hasWidth){var l=Qe.convertInt(Ze.getNamedItem(a,"width"));l>0&&i.css("width",Ke.formatPX(l))}if(!i.hasHeight){var c=Qe.convertInt(Ze.getNamedItem(a,"height"));c>0&&i.css("height",Ke.formatPX(c))}if(!i.visibleStyle.backgroundImage&&!i.visibleStyle.backgroundColor)if(x){var h=Ke.getStyle(x.children[T[e]]);h.background?a.style.setProperty("background",h.background):h.backgroundColor&&a.style.setProperty("background-color",h.backgroundColor)}else{var u=Ke.getInheritedStyle(a,"background",Je,"TABLE");""!==u?a.style.setProperty("background",u):""!==(u=Ke.getInheritedStyle(a,"backgroundColor",Je,"TABLE"))&&a.style.setProperty("background-color",u)}switch(i.tagName){case"TH":var d=function(e){var t=Ke.getInheritedStyle(a,e,et,"TABLE");if(""!==t){var n=/^(\d+[a-z]+) ([a-z]+) (.+)$/.exec(t);n&&(i.css("".concat(e,"Style"),n[2]),i.css("".concat(e,"Color"),n[3]),i.css("".concat(e,"Width"),n[1],!0),i.has("border")||i.css("border","inherit"))}};i.cssInitial("textAlign")||i.css("textAlign",i.css("textAlign")),0===i.borderTopWidth&&d("borderTop"),0===i.borderRightWidth&&d("borderRight"),0===i.borderBottomWidth&&d("borderBottom"),0===i.borderLeftWidth&&d("borderLeft");case"TD":i.cssInitial("verticalAlign")||i.css("verticalAlign","middle",!0)}var g=i.cssInitial("width"),v=T[e],p=void 0===w[v]||"auto"===w[v];if(0===e||p||!f)if(""===g||"auto"===g)void 0===w[v]?(w[v]=g||"0px",A[v]=0):e===n.length-1&&p&&0===A[v]&&(A[v]=i.bounds.width);else{var y=Ke.isLength(w[v]),_=Ke.isPercent(g);(p||i.bounds.width<A[v]||i.bounds.width===A[v]&&(y&&_||_&&Ke.isPercent(w[v])&&Qe.convertFloat(g)>Qe.convertFloat(w[v])||y&&Ke.isLength(g)&&Qe.convertFloat(g)>Qe.convertFloat(w[v])))&&(w[v]=g),(p||1===a.colSpan)&&(A[v]=i.bounds.width)}(i.length||i.inlineText)&&(S[e]+=i.bounds.width+m),i.cssApply({marginTop:0===e?"0px":k,marginRight:r<t.length-1?b:"0px",marginBottom:e+a.rowSpan-1>=n.length-1?"0px":k,marginLeft:0===T[e]?"0px":b},!0),T[e]+=a.colSpan,C++}),I=Math.max(I,T[e])},B=0;B<E;B++)R(B);if(0===m?(e.modifyBox(256,null),e.modifyBox(64,null)):(e.modifyBox(16,m),e.modifyBox(4,m),C>1&&(e.modifyBox(256,m),e.modifyBox(64,m))),0===y?(e.modifyBox(32,null),e.modifyBox(128,null)):(e.modifyBox(2,y),e.modifyBox(8,y),C>1&&(e.modifyBox(32,y),e.modifyBox(128,y))),e.has("width",2)&&w.some(function(e){return Ke.isPercent(e)})&&Qe.replaceMap(w,function(e,t){return"auto"===e&&A[t]>0?Ke.formatPX(A[t]):e}),w.every(function(e){return Ke.isPercent(e)})&&w.reduce(function(e,t){return e+parseFloat(t)},0)>1){var P=100;Qe.replaceMap(w,function(e){var t=parseFloat(e);return P<=0?e="0px":P-t<0&&(e=Ke.formatPercent(P)),P-=t,e})}else if(w.every(function(e){return Ke.isLength(e)})){var M=w.reduce(function(e,t){return e+parseFloat(t)},0);if(e.width>0)if(M<e.width)Qe.replaceMap(w,function(e){return"0px"!==e?"".concat(parseFloat(e)/M*100,"%"):e});else if(M>e.width&&(e.css("width","auto",!0),!f)){var L=e.cascade(),N=Array.isArray(L),O=0;for(L=N?L:L[Symbol.iterator]();;){var W;if(N){if(O>=L.length)break;W=L[O++]}else{if((O=L.next()).done)break;W=O.value}W.css("width","auto",!0)}}f&&!e.has("width")&&e.css("width",Ke.formatPX(e.bounds.width),!0)}var D=w.reduce(function(e,t){return e+(Ke.isPercent(t)?parseFloat(t):0)},0);i.layoutType=function(){if(w.some(function(e){return Ke.isPercent(e)})||w.every(function(e){return Ke.isLength(e)&&"0px"!==e}))return 3;if(w.every(function(e){return e===w[0]})){if(e.cascadeSome(function(e){return e.hasHeight}))return i.expand=!0,3;if("auto"===w[0]){if(e.hasWidth)return 3;var t=e.cascade(function(e){return"TD"===e.tagName});return t.length&&t.every(function(e){return Qe.withinRange(e.bounds.width,t[0].bounds.width)})?0:3}if(e.hasWidth)return 2}return w.every(function(e){return"auto"===e||Ke.isLength(e)&&"0px"!==e})?(e.hasWidth||(i.expand=!0),1):0}();var F=e.find(function(e){return"CAPTION"===e.tagName});e.clear(),F&&(F.hasWidth||Ye.isUserAgent(16)||(F.textElement?F.has("maxWidth")||F.css("maxWidth",Ke.formatPX(F.bounds.width)):F.bounds.width>$e.maxArray(S)&&a(F)),F.cssInitial("textAlign")||F.css("textAlign","center"),F.data(ve.TABLE,"colSpan",I),F.parent=e),T=[].fill(0);var H=e.hasWidth;for(B=0;B<n.length;B++){for(var z=n[B],V=z.duplicate(),q=0;q<V.length;q++){for(var X=V[q],U=X.element,G=U.rowSpan,j=U.colSpan,Y=0;Y<G-1;Y++){var K=B+1+Y;void 0!==T[K]&&(T[K]+=j)}G>1&&X.data(ve.TABLE,"rowSpan",G),j>1&&X.data(ve.TABLE,"colSpan",j),X.has("verticalAlign")||X.css("verticalAlign","middle");var Z=w[T[B]];if(void 0!==Z)switch(i.layoutType){case 3:"auto"===Z?D>=1?(a(X),X.data(ve.TABLE,"exceed",!H),X.data(ve.TABLE,"downsized",!0)):r(X):Ke.isPercent(Z)?(X.data(ve.TABLE,"percent",Z),X.data(ve.TABLE,"expand",!0)):Ke.isLength(Z)&&parseInt(Z)>0?X.bounds.width>=parseInt(Z)?(a(X),X.data(ve.TABLE,"expand",!1),X.data(ve.TABLE,"downsized",!1)):f?(r(X),X.data(ve.TABLE,"downsized",!0)):(a(X),X.data(ve.TABLE,"expand",!1)):(X.has("width")&&!X.has("width",32)||a(X),X.data(ve.TABLE,"expand",!1));break;case 2:X.css("width","0px");break;case 1:"auto"===Z?X.css("width","0px"):(f?X.data(ve.TABLE,"downsized",!0):a(X),X.data(ve.TABLE,"expand",!1))}T[B]+=j;for(var $=0;$<G;$++)for(var Q=0;Q<j;Q++)_[B+$].push(X);X.parent=e}if(T[B]<I)V[V.length-1].data(ve.TABLE,"spaceSpan",I-T[B]);z.hide()}if(v){for(var J=e.css("borderTopColor"),ee=e.css("borderTopStyle"),te=e.css("borderTopWidth"),ie=e.css("borderRightColor"),ne=e.css("borderRightStyle"),re=e.css("borderRightWidth"),ae=e.css("borderBottomColor"),oe=e.css("borderBottomStyle"),se=e.css("borderBottomWidth"),le=e.css("borderLeftColor"),ce=e.css("borderLeftStyle"),he=e.css("borderLeftWidth"),ue=!1,de=!1,fe=!1,ge=!1,pe=0;pe<E;pe++)for(var me=0;me<I;me++){var ye=_[pe][me];if(ye&&"visible"===ye.css("visibility")){if(0===pe&&(ye.borderTopWidth<parseInt(te)?ye.cssApply({borderTopColor:J,borderTopStyle:ee,borderTopWidth:te}):ue=!0),pe>=0&&pe<E-1){var be=_[pe+1][me];be&&be!==ye&&"visible"===be.css("visibility")&&(ye.borderBottomWidth>=be.borderTopWidth?be.css("borderTopWidth","0px",!0):ye.css("borderBottomWidth","0px",!0))}if(pe===E-1&&(ye.borderBottomWidth<parseInt(se)?ye.cssApply({borderBottomColor:ae,borderBottomStyle:oe,borderBottomWidth:se}):fe=!0),0===me&&(ye.borderLeftWidth<parseInt(he)?ye.cssApply({borderLeftColor:le,borderLeftStyle:ce,borderLeftWidth:he}):ge=!0),me>=0&&me<I-1){var ke=_[pe][me+1];ke&&ke!==ye&&"visible"===ke.css("visibility")&&(ye.borderRightWidth>=ke.borderLeftWidth?ke.css("borderLeftWidth","0px",!0):ye.css("borderRightWidth","0px",!0))}me===I-1&&(ye.borderRightWidth<parseInt(re)?ye.cssApply({borderRightColor:ie,borderRightStyle:ne,borderRightWidth:re}):de=!0)}}(ue||de||fe||ge)&&e.cssApply({borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px",borderLeftWidth:"0px"},!0)}i.rowCount=E,i.columnCount=I,e.data(ve.TABLE,"mainData",i)}}],[{key:"createDataAttribute",value:function(){return{layoutType:0,rowCount:0,columnCount:0,expand:!1}}}]),t}(),VerticalAlign:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"condition",value:function(e){for(var t=!1,i=0,n=0,r=Array.isArray(o=e),a=0,o=r?o:o[Symbol.iterator]();;){var s;if(r){if(a>=o.length)break;s=o[a++]}else{if((a=o.next()).done)break;s=a.value}var l=s;l.inlineVertical&&(n++,0!==it.convertInt(l.verticalAlign)&&(t=!0)),(l.positionStatic||l.positionRelative&&l.length)&&i++}return t&&n>1&&i===e.length&&_.linearData(e.children).linearX}},{key:"processNode",value:function(e){return e.each(function(e){(e.inlineVertical&&!e.baseline||e.imageElement)&&(e.baselineAltered=!0)}),{include:!0}}},{key:"postConstraints",value:function(e){if(e.layoutHorizontal)for(var t=Array.isArray(n=e.horizontalRows||[e.renderChildren]),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}for(var a=r,o=[],s=1/0,l=void 0,c=Array.isArray(u=a),h=0,u=c?u:u[Symbol.iterator]();;){var d;if(c){if(h>=u.length)break;d=u[h++]}else{if((h=u.next()).done)break;d=h.value}var f=d;f.inlineVertical&&f.linear.top<=s&&(f.linear.top<s&&(o.length=0),o.push(f),s=f.linear.top),f.baselineActive&&(l=f)}if(o.length){for(var g=o[0].linear.top,v=Array.isArray(m=a),p=0,m=v?m:m[Symbol.iterator]();;){var y;if(v){if(p>=m.length)break;y=m[p++]}else{if((p=m.next()).done)break;y=p.value}var b=y;if(b!==l){if(b.inlineVertical&&!b.baseline&&!o.includes(b)){var k=!1;switch(b.verticalAlign){case"super":case"sub":k=!0;break;default:(tt.isLength(b.verticalAlign)||void 0===l)&&(k=!0)}k&&b.modifyBox(2,b.linear.top-g)}b.baselineAltered&&b.css("verticalAlign","0px",!0)}}l&&(l.modifyBox(2,l.linear.top-g),l.baselineAltered=!0)}}else e.each(function(e){return e.baselineAltered=!1})}}]),t}(),WhiteSpace:function(e){function t(){return r(this,t),u(this,c(t).apply(this,arguments))}return l(t,ce),o(t,[{key:"afterBaseLayout",value:function(){for(var e=new Set,t=Array.isArray(n=this.application.processing.cache),i=0,n=t?n:n[Symbol.iterator]();;){var r;if(t){if(i>=n.length)break;r=n[i++]}else{if((i=n.next()).done)break;r=i.value}var a=r;if(a.naturalElement&&!a.layoutElement&&a.actualChildren.length){for(var o=a.actualChildren,s=void 0,l=void 0,c=0;c<o.length;c++){var h=o[c];if(h.pageFlow&&(a.blockStatic&&(void 0===s&&(s=h),l=h),0!==c&&lt(h))){var u=h.previousSiblings({floating:!1});if(u.length){var d=u.find(function(e){return!e.floating});if(d){var f=ct(h);if(lt(d)){var g=ct(d),v=at.convertFloat(d.cssInitial("marginBottom",!1,!0)),p=at.convertFloat(h.cssInitial("marginTop",!1,!0));if(d.excluded&&!h.excluded){var m=Math.min(v,at.convertFloat(d.cssInitial("marginTop",!1,!0)));if(m<0){var y=Math.abs(m)>=p?null:m;f.modifyBox(2,y),f.companion&&f.companion.modifyBox(2,y),e.add(d)}}else if(!d.excluded&&h.excluded){var b=Math.min(p,at.convertFloat(h.cssInitial("marginBottom",!1,!0)));b<0&&(g.modifyBox(8,Math.abs(b)>=v?null:b),e.add(h))}else{if(0===d.paddingBottom&&0===d.borderBottomWidth){var k=d.lastChild;if(lt(k)&&1!==k.valueBox(8)[0]){var x=at.convertFloat(k.cssInitial("marginBottom",!1,!0));x>v&&g.css("marginBottom",rt.formatPX(v=x),!0),ht(ct(k),8)}}if(0===h.borderTopWidth&&0===h.paddingTop){var S=h.firstChild;if(lt(S)&&1!==S.valueBox(2)[0]){var A=at.convertFloat(S.cssInitial("marginTop",!1,!0));A>p&&f.css("marginTop",rt.formatPX(p=A),!0),ht(ct(S),2)}}v>0&&(p>0?p<=v?ht(f,2):ht(g,8):0===d.bounds.height&&ht(g,8))}}else if(d.blockDimension&&!d.block&&0===h.length){var _=h.linear.top-d.linear.bottom;Math.floor(_)>0&&0===h.ascend(!1,function(e){return e.has("height")}).length&&f.modifyBox(2,_)}}}}}if(s&&ut(a,s,!0),l&&(ut(a,l,!1),l.marginTop<0)){var w=l.bounds.height+l.marginBottom+l.marginTop;w<0&&a.modifyBox(128,w,!1)}}}for(var E=Array.isArray(I=this.application.processing.excluded),T=0,I=E?I:I[Symbol.iterator]();;){var C;if(E){if(T>=I.length)break;C=I[T++]}else{if((T=I.next()).done)break;C=T.value}var R=C;if(!e.has(R)&&R.lineBreak&&!R.lineBreakTrailing){var B=R.previousSiblings({floating:!1}),P=R.nextSiblings({floating:!1}),M=!1;if(B.length&&P.length){var L=B.pop(),N=P.pop();if(L.inlineStatic&&N.inlineStatic){if(0===B.length){e.add(R);continue}var O=B.pop();O.lineBreak&&(O.setBounds(),0!==O.bounds.bottom&&(L=O))}M=!0;var W=void 0;if(N.lineHeight>0&&N.element&&N.cssTry("lineHeight","0px")?(W=nt.getClientRect(N.element,N.sessionId).top-N.marginTop,N.cssFinally("lineHeight")):W=N.linear.top,L.lineHeight>0&&L.element&&L.cssTry("lineHeight","0px")?(W-=nt.getClientRect(L.element,L.sessionId).bottom+L.marginBottom,L.cssFinally("lineHeight")):W-=L.linear.bottom,0!==W){L=ct(L),N=ct(N);var D=L.visible&&L.renderParent,F=N.visible&&N.renderParent;if(F&&F.groupParent&&F.firstChild===N)F.modifyBox(2,W);else if(D&&D.groupParent&&D.lastChild===L)D.modifyBox(8,W);else if(F&&F.layoutVertical&&N.visible)N.modifyBox(2,W);else if(D&&D.layoutVertical&&L.visible)L.modifyBox(8,W);else{var H=R.actualParent;!F&&!D&&H&&H.visible?N.lineBreak||N.excluded?H.modifyBox(128,W):L.lineBreak||L.excluded?H.modifyBox(32,W):M=!1:M=!1}}}else{var z=R.actualParent;if(z&&z.visible){if(!z.documentRoot&&B.length){var V=B[B.length-1],q=z.box.bottom-V.linear[V.lineBreak||V.excluded?"top":"bottom"];0!==q&&(V.rendered||z.visibleStyle.background?z.modifyBox(128,q):z.hasHeight||st(z,q))}else if(P.length){var X=P[P.length-1],U=X.linear[X.lineBreak||X.excluded?"bottom":"top"]-z.box.top;0!==U&&(X.rendered||z.visibleStyle.background?z.modifyBox(32,U):z.hasHeight||st(z,U))}M=!0}}if(M){for(var G=Array.isArray(Y=B),j=0,Y=G?Y:Y[Symbol.iterator]();;){var K;if(G){if(j>=Y.length)break;K=Y[j++]}else{if((j=Y.next()).done)break;K=j.value}e.add(K)}for(var Z=Array.isArray(Q=P),$=0,Q=Z?Q:Q[Symbol.iterator]();;){var J;if(Z){if($>=Q.length)break;J=Q[$++]}else{if(($=Q.next()).done)break;J=$.value}e.add(J)}}}}}},{key:"afterConstraints",value:function(){for(var e=[],t=function(){if(i){if(n>=r.length)return"break";a=r[n++]}else{if((n=r.next()).done)return"break";a=n.value}var t=a,o=t.renderAs?t.renderAs.renderParent:t.renderParent;if(o&&t.pageFlow&&t.styleElement&&t.inlineVertical&&!t.documentParent.layoutElement&&!o.tableElement&&!e.includes(t.id)){var s=function(i,n){var r=t.actualRect(16===i?"left":"top")-n;r>0&&((t=ct(t.outerParent||t)).modifyBox(i,r),e.push(t.id))};if(o.layoutVertical){if(t.blockDimension&&!t.lineBreakLeading){var l=o.renderChildren.findIndex(function(e){return e===t});l>0&&s(2,o.renderChildren[l-1].linear.bottom)}}else if(t.alignParent("left")){if(o.horizontalRows&&t.blockDimension&&!t.floating)e:for(var c=0,h=0;h<o.horizontalRows.length;h++){for(var u=o.horizontalRows[h],d=0;d<u.length;d++)if(t===u[d]){h>0&&s(2,c);break e}for(var f=!1,g=Array.isArray(p=u),v=0,p=g?p:p[Symbol.iterator]();;){var m;if(g){if(v>=p.length)break;m=p[v++]}else{if((v=p.next()).done)break;m=v.value}m.blockDimension&&!m.floating&&m.linear.bottom>c&&(c=m.linear.bottom,f=!0)}if(!f)break}}else for(var y=t;;){var b=y.previousSiblings();if(b.length&&!b.some(function(e){return e.lineBreak||e.excluded&&e.blockStatic})){var k=b.pop();if(k.inlineVertical)s(16,k.actualRect("right"));else if(k.floating){y=k;continue}}break}}},i=Array.isArray(r=this.application.processing.cache),n=0,r=i?r:r[Symbol.iterator]();;){var a;if("break"===t())break}}}]),t}()},ft={constant:pe,enumeration:T};e.Application=ee,e.Controller=oe,e.Extension=ce,e.ExtensionManager=ue,e.File=fe,e.Layout=E,e.Node=_e,e.NodeGroup=we,e.NodeList=_,e.Resource=U,e.extensions=dt,e.lib=ft,Object.defineProperty(e,"__esModule",{value:!0})});
