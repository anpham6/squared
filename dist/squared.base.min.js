!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t=t||self).squared=t.squared||{},t.squared.base={}))}(this,(function(t){"use strict";class e extends squared.lib.base.Container{constructor(t){super(t),this._currentId=0}append(t,e=!0){var i;return super.append(t),e&&(null===(i=this.afterAppend)||void 0===i||i.call(this,t)),this}reset(){return this._currentId=0,this.clear(),this}get nextId(){return++this._currentId}}const i=squared.lib,{CSS:n,STRING:s,XML:o}=i.regex,{buildAlphaString:r,fromLastIndexOf:a}=i.util,l=()=>r(5).toLowerCase()+"_"+(new Date).getTime();class c{reset(){var t;const e=c.ASSETS;for(const t in e)e[t].clear();null===(t=this.fileHandler)||void 0===t||t.reset()}addImage(t){var e,i;if(null===(e=t)||void 0===e?void 0:e.complete){const e=t.src;if(/^data:image\//.test(e)){const n=RegExp(`^${s.DATAURI}$`).exec(e);if(n){const s=n[1].split(o.DELIMITER);this.addRawData(e,s[0].trim(),(null===(i=s[1])||void 0===i?void 0:i.trim())||"base64",n[2],t.naturalWidth,t.naturalHeight)}}""!==e&&c.ASSETS.images.set(e,{width:t.naturalWidth,height:t.naturalHeight,uri:e})}}getImage(t){return c.ASSETS.images.get(t)}addFont(t){const e=c.ASSETS.fonts,i=t.fontFamily.trim().toLowerCase();t.fontFamily=i;const n=e.get(i)||[];n.push(t),e.set(i,n)}getFont(t,e="normal",i){const n=c.ASSETS.fonts.get(t.trim().toLowerCase());if(n){const t=this.controllerSettings.supported.fontFormat;return n.find(n=>n.fontStyle===e&&(void 0===i||n.fontWeight===parseInt(i))&&("*"===t||t.includes(n.srcFormat)))}}addRawData(t,e,i,n,s=0,o=0){let r;e=e.toLowerCase(),"base64"===(i=i.toLowerCase())?(r=n,"image/svg+xml"===e&&(n=window.atob(n))):n=n.replace(/\\(["'])/g,(t,...e)=>e[0]);const h=this.controllerSettings.supported.imageFormat,d=location.origin,u=t.startsWith(d),f=u?t.substring(d.length+1,t.lastIndexOf("/")):"";let g;if("*"===h)if(u)g=a(t,"/");else{let t=e.split("/").pop();"svg+xml"===t&&(t="svg"),g=l()+"."+t}else for(const i of h)if(e.includes(i)){g=t.endsWith("."+i)?a(t,"/"):l()+"."+i;break}return g?(c.ASSETS.rawData.set(t,{pathname:f,filename:g,content:n,base64:r,mimeType:e,width:s,height:o}),g):""}getRawData(t){if(/^url\(/.test(t)){const e=n.URL.exec(t);if(!e)return;t=e[1]}return c.ASSETS.rawData.get(t)}setFileHandler(t){t.resource=this,this.fileHandler=t}}c.ASSETS={ids:new Map,images:new Map,fonts:new Map,rawData:new Map};var h=function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((n=n.apply(t,e||[])).next())}))};const d=squared.lib,{getSpecificity:u,getStyle:f,hasComputedStyle:g,insertStyleSheetRule:p,parseSelectorText:m,validMediaRule:b}=d.css,{isTextNode:v}=d.dom,{convertCamelCase:x,isString:y,objectMap:S,resolvePath:E}=d.util,{CHAR:_,FILE:k,STRING:w,XML:T}=d.regex,{getElementCache:C,setElementCache:A}=d.session,{images:I,rawData:R}=c.ASSETS,B=/all|screen/,P=/^background/,N=/\s*([a-z-]+):.*?!important;/g,M=/\s*@font-face\s*{([^}]+)}\s*/,L=/\s*font-family:[^\w]*([^'";]+)/,W=/\s*src:\s*([^;]+);/,F=/\s*font-style:\s*(\w+)\s*;/,O=/\s*font-weight:\s*(\d+)\s*;/,D=/\s*(url|local)\((?:['""]([^'")]+)['"]|([^)]+))\)(?:\s*format\(['"]?([\w-]+)['"]?\))?\s*/,H=RegExp(`(url\\("(${w.DATAURI})"\\)),?\\s*`,"g");function X(t,e=0,i=0){const n=I.get(t);(void 0===n||e>0&&i>0||0===n.width||0===n.height)&&I.set(t,{width:e,height:i,uri:t})}function z(t){if(""!==t)for(const e of t.split(T.SEPARATOR))""!==e&&X(E(e.split(_.SPACE)[0].trim()))}const U=t=>k.SVG.test(t),V=(t,e)=>{var i;return(null===(i=RegExp(`\\s*@${t}([^{]+)`).exec(e))||void 0===i?void 0:i[1].trim())||e};class q{constructor(t,i,n,s,o){this.framework=t,this.initializing=!1,this.closed=!1,this.rootElements=new Set,this.session={active:[]},this.processing={cache:new e,excluded:new e,sessionId:""},this._cascadeAll=!1,this.Node=i;const r=this.processing.cache;this._cache=r;const a=new n(this,r);this._controllerHandler=a,this._resourceHandler=new s(this,r),this._extensionManager=new o(this,r),this._nodeAfterInsert=a.afterInsertNode}copyToDisk(t,e,i){var n;null===(n=this.fileHandler)||void 0===n||n.copyToDisk(t,i,e)}appendToArchive(t,e){var i;null===(i=this.fileHandler)||void 0===i||i.appendToArchive(t,e)}saveToArchive(t,e){var i;null===(i=this.fileHandler)||void 0===i||i.saveToArchive(t||this.userSettings.outputArchiveName,e)}reset(){const t=this.processing;t.cache.reset(),t.excluded.clear(),t.sessionId="",this.session.active.length=0,this.controllerHandler.reset();for(const t of this.extensions)t.subscribers.clear();this.closed=!1}parseDocument(...t){const{controllerHandler:e,resourceHandler:i}=this;this.initializing=!1,this.rootElements.clear();const n=e.generateSessionId;this.processing.sessionId=n,this.session.active.push(n),e.sessionId=n,e.init(),this.setStyleMap();const s=[],o=this.userSettings.preloadImages,r=[],a=p("html > body { overflow: hidden !important; }");let l;const c=()=>{this.initializing=!1;for(const t of s)t.parentElement&&d.removeChild(t);s.length=0;for(const t of this.extensions)t.beforeParseDocument();for(const t of this.rootElements)this.createCache(t)&&this.afterCreateCache(t);for(const t of this.extensions)t.afterParseDocument();try{document.head.removeChild(a)}catch(t){}"function"==typeof l&&l.call(this)};0===t.length&&t.push(document.body);for(const e of t){let t;if("string"==typeof e)t=document.getElementById(e);else{if(!g(e))continue;t=e}t&&this.rootElements.add(t)}const d=this.rootElements.values().next().value;if(o){for(const t of this.rootElements)t.querySelectorAll("picture > source").forEach(t=>z(t.srcset)),t.querySelectorAll("input[type=image]").forEach(t=>X(t.src,t.width,t.height));for(const t of I.values()){const e=t.uri;if(U(e))r.push(e);else if(0===t.width||0===t.height){const i=document.createElement("img");i.src=e,i.naturalWidth>0&&i.naturalHeight>0?(t.width=i.naturalWidth,t.height=i.naturalHeight):(d.appendChild(i),s.push(i))}}}for(const[t,e]of R.entries()){const i=e.mimeType;if(y(i)&&/^image\//.test(i)&&!/svg\+xml$/.test(i)){const n=document.createElement("img");n.src="data:"+i+";"+(e.base64?"base64,"+e.base64:e.content);const{naturalWidth:o,naturalHeight:r}=n;o>0&&r>0?(e.width=o,e.height=r,I.set(t,{width:o,height:r,uri:e.filename})):(document.body.appendChild(n),s.push(n))}}for(const t of this.rootElements)t.querySelectorAll("img").forEach(t=>{U(t.src)?o&&r.push(t.src):(o&&z(t.srcset),t.complete?i.addImage(t):o&&r.push(t))});r.length?(this.initializing=!0,Promise.all(S(r,t=>new Promise((e,i)=>{"string"==typeof t?e(function(t){return h(this,void 0,void 0,(function*(){return(yield fetch(t,{method:"GET",headers:new Headers({Accept:"application/xhtml+xml, image/svg+xml","Content-Type":"image/svg+xml"})})).text()}))}(t)):(t.addEventListener("load",()=>e(t)),t.addEventListener("error",()=>i(t)))}))).then(t=>{const e=t.length;for(let n=0;n<e;n++){const e=t[n];if("string"==typeof e){const t=r[n];"string"==typeof t&&i.addRawData(t,"image/svg+xml","utf8",e)}else i.addImage(e)}c()}).catch(t=>{t instanceof Event&&(t=t.target);const e=t instanceof HTMLImageElement?t.src:"";this.userSettings.showErrorMessages&&y(e)&&!confirm("FAIL: "+e)||c()})):c();return new class{then(t){r.length?l=t:t()}}}createCache(t){const e=this.createRootNode(t);if(e){e.parent.setBounds();for(const t of this._cache)t.setBounds();return this.controllerHandler.sortInitialCache(),!0}return!1}toString(){return""}createRootNode(t){const e=this.processing,i=e.cache;i.clear(),e.excluded.clear(),this._cascadeAll=!1;const n=this.extensionsCascade,s=this.cascadeParentNode(t,0,n.length?n:void 0);if(s){const i=new this.Node(0,e.sessionId,t.parentElement||document.body,this._nodeAfterInsert);s.parent=i,s.actualParent=i,s.childIndex=0,s.documentRoot=!0}return e.node=s,i.afterAppend=void 0,s}cascadeParentNode(t,e,i){const n=this.insertNode(t);if(n){const{controllerHandler:s,processing:o}=this,r=o.cache;if(n.depth=e,0===e&&r.append(n),s.preventNodeCascade(t))return n;const{childElementCount:a,childNodes:l}=t,c=l.length,h=Array(c),d=Array(a);let u=!0,f=0,g=0;for(let t=0;t<c;t++){const a=l[t];let c;"#"===a.nodeName.charAt(0)?v(a)&&(c=this.insertNode(a,n)):s.includeElement(a)?(c=this.cascadeParentNode(a,e+1,i),c&&(d[g++]=c,r.append(c),u=!1)):(c=this.insertNode(a),c&&(o.excluded.append(c),u=!1)),c&&(c.parent=n,c.actualParent=n,c.childIndex=f,h[f++]=c)}h.length=f,d.length=g,n.naturalChildren=h,n.naturalElements=d,n.inlineText=u,this.userSettings.createQuerySelectorMap&&g>0&&(n.queryMap=this.createQueryMap(d))}return n}createQueryMap(t){var e;const i=[t];for(const n of t){const t=n.queryMap;if(t){const n=t.length;for(let s=0;s<n;s++){const n=s+1;i[n]=(null===(e=i[n])||void 0===e?void 0:e.concat(t[s]))||t[s]}}}return i}setStyleMap(){let t=!1;const e=i=>{try{const t=i.cssRules;if(t){const i=t.length;for(let n=0;n<i;n++){const i=t[n];switch(i.type){case CSSRule.STYLE_RULE:case CSSRule.FONT_FACE_RULE:this.applyStyleRule(i);break;case CSSRule.IMPORT_RULE:e(i.styleSheet);break;case CSSRule.MEDIA_RULE:b(i.conditionText||V("media",i.cssText))&&this.applyCSSRuleList(i.cssRules);break;case CSSRule.SUPPORTS_RULE:CSS.supports&&CSS.supports(i.conditionText||V("supports",i.cssText))&&this.applyCSSRuleList(i.cssRules)}}}}catch(e){this.userSettings.showErrorMessages&&!t&&(alert("CSS cannot be parsed inside <link> tags when loading files directly from your hard drive or from external websites. Either use a local web server, embed your CSS into a <style> tag, or you can also try using a different browser. See the README for more detailed instructions.\n\n"+i.href+"\n\n"+e),t=!0)}},i=document.styleSheets,n=i.length;for(let t=0;t<n;t++){const n=i[t];let s;try{s=n.media.mediaText}catch(t){}y(s)&&!B.test(s)||e(n)}}applyCSSRuleList(t){const e=t.length;for(let i=0;i<e;i++)this.applyStyleRule(t[i])}applyStyleRule(t){var e,i,n,s,o,r,a;const l=this.resourceHandler,c=this.processing.sessionId,h=(null===(e=t.parentStyleSheet)||void 0===e?void 0:e.href)||void 0,d=t.cssText;switch(t.type){case CSSRule.SUPPORTS_RULE:this.applyCSSRuleList(t.cssRules);break;case CSSRule.STYLE_RULE:{const e=t.style,i={},n=(t,e)=>{var i;const n=t[e];if(n&&"initial"!==n){let s,o=n;for(;null!==(s=H.exec(n));)if(s[3]){const t=s[3].split(T.DELIMITER);l.addRawData(s[2],t[0].trim(),(null===(i=t[1])||void 0===i?void 0:i.trim())||"utf8",s[4])}else if(this.userSettings.preloadImages){const t=E(s[4],h);""!==t&&(void 0===l.getImage(t)&&X(t),o=o.replace(s[1],`url("${t}")`))}t[e]=o,H.lastIndex=0}},s={};for(const t of Array.from(e))s[x(t)]=e[t];if(n(s,"backgroundImage"),n(s,"listStyleImage"),n(s,"content"),d.includes("!important")){let t;for(;null!==(t=N.exec(d));){const e=x(t[1]);switch(e){case"margin":i.marginTop=!0,i.marginRight=!0,i.marginBottom=!0,i.marginLeft=!0;break;case"padding":i.paddingTop=!0,i.paddingRight=!0,i.paddingBottom=!0,i.paddingLeft=!0;break;case"background":i.backgroundColor=!0,i.backgroundImage=!0,i.backgroundSize=!0,i.backgroundRepeat=!0,i.backgroundPositionX=!0,i.backgroundPositionY=!0;break;case"backgroundPosition":i.backgroundPositionX=!0,i.backgroundPositionY=!0;break;case"border":i.borderTopStyle=!0,i.borderRightStyle=!0,i.borderBottomStyle=!0,i.borderLeftStyle=!0,i.borderTopWidth=!0,i.borderRightWidth=!0,i.borderBottomWidth=!0,i.borderLeftWidth=!0,i.borderTopColor=!0,i.borderRightColor=!0,i.borderBottomColor=!0,i.borderLeftColor=!0;break;case"borderStyle":i.borderTopStyle=!0,i.borderRightStyle=!0,i.borderBottomStyle=!0,i.borderLeftStyle=!0;break;case"borderWidth":i.borderTopWidth=!0,i.borderRightWidth=!0,i.borderBottomWidth=!0,i.borderLeftWidth=!0;break;case"borderColor":i.borderTopColor=!0,i.borderRightColor=!0,i.borderBottomColor=!0,i.borderLeftColor=!0;break;case"font":i.fontFamily=!0,i.fontStyle=!0,i.fontSize=!0,i.fontWeight=!0,i.lineHeight=!0}i[e]=!0}N.lastIndex=0}for(const n of m(t.selectorText)){const t=u(n),[o,r]=n.split("::"),a=r?"::"+r:"";document.querySelectorAll(o||"*").forEach(n=>{const o="styleMap"+a,r="styleSpecificity"+a,l=C(n,o,c);if(l){const o=C(n,r,c)||{};for(const n in s){const r=o[n],a=t+(i[n]?1e3:0);if(void 0===r||a>=r){const t=s[n];"initial"===t&&P.test(n)?"none"===e.background&&delete l[n]:l[n]=t,o[n]=a}}}else{const e=Object.assign({},s),l={};for(const n in e)l[n]=t+(i[n]?1e3:0);A(n,"style"+a,"0",f(n,a)),A(n,"sessionId","0",c),A(n,o,c,e),A(n,r,c,l)}})}break}case CSSRule.FONT_FACE_RULE:{const t=null===(i=M.exec(d))||void 0===i?void 0:i[1];if(t){const e=((null===(n=L.exec(t))||void 0===n?void 0:n[1])||"").trim(),i=((null===(s=W.exec(t))||void 0===s?void 0:s[1])||"").split(T.SEPARATOR);if(""!==e&&i.length){const n=(null===(o=F.exec(t))||void 0===o?void 0:o[1].toLowerCase())||"normal",s=parseInt((null===(r=O.exec(t))||void 0===r?void 0:r[1])||"400");for(const t of i){const i=D.exec(t);if(i){let t,o;const r=(i[2]||i[3]).trim();"url"===i[1]?t=E(r,h):o=r,l.addFont({fontFamily:e,fontWeight:s,fontStyle:n,srcUrl:t,srcLocal:o,srcFormat:(null===(a=i[4])||void 0===a?void 0:a.toLowerCase().trim())||"truetype"})}}}}break}}}get controllerHandler(){return this._controllerHandler}get resourceHandler(){return this._resourceHandler}get extensionManager(){return this._extensionManager}get fileHandler(){return this._resourceHandler.fileHandler}get extensionsCascade(){return[]}get nextId(){return this._cache.nextId}get length(){return 0}}class G{preventNodeCascade(t){return!1}get generateSessionId(){return""+(new Date).getTime()}}class j{constructor(t,e,i){this.name=t,this.framework=e,this.options={},this.dependencies=[],this.subscribers=new Set,i&&Object.assign(this.options,i)}require(t,e=!1){this.dependencies.push({name:t,preload:e})}beforeParseDocument(){}afterParseDocument(){}set application(t){this._application=t,this._controller=t.controllerHandler}get application(){return this._application}get controller(){return this._controller}}const{hasBit:Y,isObject:$}=squared.lib.util;const{fromLastIndexOf:Q,trimString:K}=squared.lib.util,J=()=>/^http/.test(location.protocol);class Z{constructor(){this.assets=[]}static getMimeType(t){switch(t.toLowerCase()){case"aac":return"audio/aac";case"abw":return"application/x-abiword";case"arc":return"application/x-freearc";case"avi":return"video/x-msvideo";case"azw":return"application/vnd.amazon.ebook";case"bin":return"application/octet-stream";case"bmp":return"image/bmp";case"bz":return"application/x-bzip";case"bz2":return"application/x-bzip2";case"csh":return"application/x-csh";case"css":return"text/css";case"csv":return"text/csv";case"doc":return"application/msword";case"docx":return"application/vnd.openxmlformats-officedocument.wordprocessingml.document";case"eot":return"application/vnd.ms-fontobject";case"epub":return"application/epub+zip";case"gif":return"image/gif";case"htm":case"html":return"text/html";case"ico":return"image/vnd.microsoft.icon";case"ics":return"text/calendar";case"jar":return"application/java-archive";case"jpeg":case"jpg":return"image/jpeg";case"js":case"mjs":return"text/javascript";case"json":return"application/json";case"jsonld":return"application/ld+json";case"mid":case"midi":return"audio/midi";case"mp3":return"audio/mpeg";case"mpeg":return"video/mpeg";case"mpkg":return"application/vnd.apple.installer+xml";case"odp":return"application/vnd.oasis.opendocument.presentation";case"ods":return"application/vnd.oasis.opendocument.spreadsheet";case"odt":return"application/vnd.oasis.opendocument.text";case"oga":return"audio/ogg";case"ogv":return"video/ogg";case"ogx":return"application/ogg";case"otf":return"font/otf";case"png":return"image/png";case"pdf":return"application/pdf";case"ppt":return"application/vnd.ms-powerpoint";case"pptx":return"application/vnd.openxmlformats-officedocument.presentationml.presentation";case"rar":return"application/x-rar-compressed";case"rtf":return"application/rtf";case"sh":return"application/x-sh";case"svg":return"image/svg+xml";case"swf":return"application/x-shockwave-flash";case"tar":return"application/x-tar";case"tif":case"tiff":return"image/tiff";case"ts":return"video/mp2t";case"ttf":return"font/ttf";case"txt":return"text/plain";case"vsd":return"application/vnd.visio";case"wav":return"audio/wav";case"weba":return"audio/webm";case"webm":return"video/webm";case"webp":return"image/webp";case"woff":return"font/woff";case"woff2":return"font/woff2";case"xhtml":return"application/xhtml+xml";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xml":return"text/xml";case"xul":return"application/vnd.mozilla.xul+xml";case"zip":return"application/zip";case"3gp":return"video/3gpp";case".3g2":return"video/3gpp2";case".7z":return"application/x-7z-compressed";default:return""}}static downloadFile(t,e,i){const n=new Blob([t],{type:i||"application/octet-stream"}),s=window.URL.createObjectURL(n),o=document.createElement("a");o.style.setProperty("display","none"),o.setAttribute("href",s),o.setAttribute("download",e),o.download||o.setAttribute("target","_blank");const r=document.body;r.appendChild(o),o.click(),r.removeChild(o),setTimeout(()=>window.URL.revokeObjectURL(s),1)}addAsset(t){if(t.content||t.uri||t.base64){const e=this.assets,{pathname:i,filename:n}=t,s=e.find(t=>t.pathname===i&&t.filename===n);s?Object.assign(s,t):e.push(t)}}reset(){this.assets.length=0}copying(t,e,i){if(J()){if((e=e.concat(this.assets)).length){const{outputDirectory:n,outputArchiveTimeout:s}=this.userSettings;fetch("/api/assets/copy?to="+encodeURIComponent(t.trim())+"&directory="+encodeURIComponent(K(n,"/"))+"&timeout="+s,{method:"POST",headers:new Headers({Accept:"application/json, text/plain, */*","Content-Type":"application/json"}),body:JSON.stringify(e)}).then(t=>t.json()).then(t=>{if(t&&("function"==typeof i&&i(t),this.userSettings.showErrorMessages)){const{application:e,system:i}=t;i&&alert(e+"\n\n"+i)}}).catch(t=>{this.userSettings.showErrorMessages&&alert("ERROR: "+t)})}}else this.userSettings.showErrorMessages&&alert("SERVER (required): See README for instructions")}archiving(t,e,i=""){if(J()){if((e=e.concat(this.assets)).length){const{outputDirectory:n,outputArchiveFormat:s,outputArchiveTimeout:o}=this.userSettings;fetch("/api/assets/archive?filename="+encodeURIComponent(t.trim())+"&directory="+encodeURIComponent(K(n,"/"))+"&format="+s+"&append_to="+encodeURIComponent(i.trim())+"&timeout="+o,{method:"POST",headers:new Headers({Accept:"application/json, text/plain, */*","Content-Type":"application/json"}),body:JSON.stringify(e)}).then(t=>t.json()).then(t=>{if(t){const e=t.zipname;if(e)fetch("/api/browser/download?filename="+encodeURIComponent(e)).then(t=>t.blob()).then(t=>Z.downloadFile(t,Q(e,"/")));else if(this.userSettings.showErrorMessages){const{application:e,system:i}=t;i&&alert(e+"\n\n"+i)}}}).catch(t=>{this.userSettings.showErrorMessages&&alert("ERROR: "+t)})}}else this.userSettings.showErrorMessages&&alert("SERVER (required): See README for instructions")}}const tt=new Map([[2,"marginTop"],[4,"marginRight"],[8,"marginBottom"],[16,"marginLeft"],[32,"paddingTop"],[64,"paddingRight"],[128,"paddingBottom"],[256,"paddingLeft"]]),et={ACCESSIBILITY:"squared.accessibility",CSS_GRID:"squared.css-grid",FLEXBOX:"squared.flexbox",GRID:"squared.grid",LIST:"squared.list",RELATIVE:"squared.relative",SPRITE:"squared.sprite",TABLE:"squared.table",VERTICAL_ALIGN:"squared.verticalalign",WHITESPACE:"squared.whitespace"};var it=Object.freeze({__proto__:null,CSS_SPACING:tt,EXT_NAME:et});const nt=squared.lib,{isUserAgent:st}=nt.client,{BOX_BORDER:ot,checkStyleValue:rt,formatPX:at,getInheritedStyle:lt,getStyle:ct,hasComputedStyle:ht,isLength:dt,isPercent:ut,parseSelectorText:ft,parseUnit:gt}=nt.css,{ELEMENT_BLOCK:pt,assignRect:mt,getNamedItem:bt,getRangeClientRect:vt,newBoxRectDimension:xt}=nt.dom,{CHAR:yt,CSS:St,FILE:Et,XML:_t}=nt.regex,{actualClientRect:kt,actualTextRangeRect:wt,deleteElementCache:Tt,getElementAsNode:Ct,getElementCache:At,getPseudoElt:It,setElementCache:Rt}=nt.session,{aboveRange:Bt,belowRange:Pt,convertCamelCase:Nt,convertFloat:Mt,convertInt:Lt,filterArray:Wt,hasBit:Ft,hasValue:Ot,isNumber:Dt,isObject:Ht,isString:Xt,spliceString:zt}=nt.util,{PX:Ut,SELECTOR_ATTR:Vt,SELECTOR_G:qt,SELECTOR_LABEL:Gt,SELECTOR_PSEUDO_CLASS:jt}=St,Yt=/^inline/,$t=/^inline-/,Qt=/^margin/,Kt=/^padding/,Jt=/^border/,Zt=/\s*(url\(.+?\))\s*/,te=/^:lang\(\s*(.+)\s*\)$/,ee=/^:nth(-last)?-(child|of-type)\((.+)\)$/,ie=/^(-)?(\d+)?n\s*([+-]\d+)?$/,ne=/em$/,se=/grid$/,oe=/flex$/;function re(t,e,i,n){const s=(n||t).css(e);return Dt(s)?parseFloat(s):"inherit"===s&&void 0===n?re(t,e,i,t.actualParent):i}function ae(t,e,i,n,s){var o;if(e.all)return!0;let r=e.tagName;if(r&&r!==t.tagName.toUpperCase())return!1;const a=e.id;if(a&&a!==t.elementId)return!1;const{attrList:l,classList:c,notList:h,pseudoList:d}=e;if(d){const e=t.actualParent;r=t.tagName;for(const a of d)switch(a){case":first-child":case":nth-child(1)":if(t!==e.firstChild)return!1;break;case":last-child":case":nth-last-child(1)":if(t!==e.lastChild)return!1;break;case":only-child":if(e.naturalElements.length>1)return!1;break;case":only-of-type":{let t=0;for(const i of e.naturalElements)if(i.tagName===r&&++t>1)return!1;break}case":first-of-type":for(const i of e.naturalElements)if(i.tagName===r){if(i!==t)return!1;break}break;case":nth-child(n)":case":nth-last-child(n)":break;case":empty":if(t.element.childNodes.length)return!1;break;case":checked":if("INPUT"===r){if(!t.toElementBoolean("checked"))return!1}else{if("OPTION"!==r)return!1;if(!t.toElementBoolean("selected"))return!1}break;case":enabled":if(!t.inputElement||t.toElementBoolean("disabled"))return!1;break;case":disabled":if(!t.inputElement||!t.toElementBoolean("disabled"))return!1;break;case":read-only":{const e=t.element;if(e.isContentEditable||("INPUT"===r||"TEXTAREA"===r)&&!e.readOnly)return!1;break}case":read-write":{const e=t.element;if(!e.isContentEditable||("INPUT"===r||"TEXTAREA"===r)&&e.readOnly)return!1;break}case":required":if(!t.inputElement||"BUTTON"===r||!t.toElementBoolean("required"))return!1;break;case":optional":if(!t.inputElement||"BUTTON"===r||t.toElementBoolean("required"))return!1;break;case":placeholder-shown":if("INPUT"!==r&&"TEXTAREA"!==r||""===t.toElementString("placeholder"))return!1;break;case":default":switch(r){case"INPUT":{const e=t.element;switch(e.type){case"radio":case"checkbox":if(!e.checked)return!1;break;default:return!1}break}case"OPTION":if(void 0===t.element.attributes.selected)return!1;break;case"BUTTON":{const e=t.ascend({condition:t=>"FORM"===t.tagName})[0];if(e){const n=t.element;let s=!1;const o=e.element.querySelectorAll("*"),r=o.length;for(let t=0;t<r;t++){const t=o[i];if("BUTTON"===t.tagName){s=n===t;break}if("INPUT"===t.tagName){const e=t.type;if("submit"===e||"image"===e){s=n===t;break}}}if(!s)return!1}break}default:return!1}break;case":in-range":case":out-of-range":if("INPUT"!==r)return!1;{const e=t.element,i=parseFloat(e.value);if(isNaN(i)){if(":in-range"===a)return!1}else{const t=parseFloat(e.min),n=parseFloat(e.max);if(i>=t&&i<=n){if(":out-of-range"===a)return!1}else if(":in-range"===a)return!1}}break;case":indeterminate":if("INPUT"===r){const e=t.element;switch(e.type){case"checkbox":if(!e.indeterminate)return!1;break;case"radio":if(e.checked)return!1;if(e.name){const i=((null===(o=t.ascend({condition:t=>"FORM"===t.tagName})[0])||void 0===o?void 0:o.element)||document).querySelectorAll(`input[type=radio][name="${e.name}"`),n=i.length;for(let t=0;t<n;t++)if(i[t].checked)return!1}break;default:return!1}}else{if("PROGRESS"!==r)return!1;if(-1!==t.toElementInt("value",-1))return!1}break;case":target":if(""===location.hash)return!1;{const e=t.element;if(location.hash!=="#"+e.id&&("A"!==r||location.hash!=="#"+e.name))return!1}break;case":scope":if(!n||">"===s&&t!==this)return!1;break;case":root":if(!n||s)return!1;break;case":link":case":visited":case":any-link":case":hover":case":focus":case":focus-within":case":valid":case":invalid":{const n=t.element,s=e.element.querySelectorAll(":scope > "+a);let o=!1;const r=s.length;for(let t=0;t<r;t++)if(s.item(i)===n){o=!0;break}if(!o)return!1;break}default:{let i=ee.exec(a);if(i){const n=i[3].trim();let s=e.naturalElements;i[1]&&(s=s.slice(0).reverse());const o=("child"===i[2]?s.indexOf(t):Wt(s,t=>t.tagName===r).indexOf(t))+1;if(o>0){if(Dt(n)){if(parseInt(n)!==o)return!1}else switch(n){case"even":if(o%2!=0)return!1;break;case"odd":if(o%2==0)return!1;break;default:{const t=ie.exec(n);if(t){const e=Lt(t[3]);if(t[2]){if(t[1])return!1;const i=parseInt(t[2]);if(0!==i){if(o!==e)for(let t=i;;t+=i){const t=i+e;if(t===o)break;if(t>o)return!1}}else if(o!==e)return!1}else if(t[3]){if(!(e>0))return!1;if(t[1]){if(o>e)return!1}else if(o<e)return!1}}break}}continue}}else if(i=te.exec(a),i){const e=t.attributes;if(e.lang&&i[1].toLowerCase()===e.lang.toLowerCase())continue}return!1}}}if(h)for(const e of h){const s={all:!1};switch(e.charAt(0)){case".":s.classList=[e];break;case"#":s.id=e.substring(1);break;case":":s.pseudoList=[e];break;case"[":{Vt.lastIndex=0;const t=Vt.exec(e);if(!t)continue;{const e="i"===t[6];let i=t[3]||t[4]||t[5]||"";e&&(i=i.toLowerCase()),s.attrList=[{key:t[1],symbol:t[2],value:i,caseInsensitive:e}]}break}default:if(!yt.WORDDASH.test(e))return!1;s.tagName=e}if(ae.call(this,t,s,i,n))return!1}if(c){const e=t.element.classList;for(const t of c)if(!e.contains(t))return!1}if(l){const e=t.attributes;for(const t of l){let i=e[t.key];if(void 0===i)return!1;{const e=t.value;if(e)if(t.caseInsensitive&&(i=i.toLowerCase()),t.symbol)switch(t.symbol){case"~":if(!i.split(yt.SPACE).includes(e))return!1;break;case"^":if(!i.startsWith(e))return!1;break;case"$":if(!i.endsWith(e))return!1;break;case"*":if(!i.includes(e))return!1;break;case"|":if(i!==e&&!i.startsWith(e+"-"))return!1}else if(i!==e)return!1}}}return!0}const le=(t,e)=>t===e||dt(t,!0)&&Ut.test(e);class ce extends squared.lib.base.Container{constructor(t,e="0",i){super(),this.id=t,this.sessionId=e,this.documentRoot=!1,this.depth=-1,this.childIndex=1/0,this._element=null,this._data={},this._inlineText=!1,i?this._element=i:(this.style={},this._styleMap={},this._cssStyle={})}static isFlexDirection(t,e){var i;const n=t.actualParent;if((null===(i=n)||void 0===i?void 0:i.flexElement)&&n.css("flexDirection").startsWith(e)){if("column"===e&&!n.hasHeight){const t=n.actualParent;if(!t)return!1;if(t.flexElement&&!t.css("flexDirection").includes("column")){let e=0,i=0;for(const s of t){const t=(s.data(et.FLEXBOX,"boundsData")||s.bounds).height;if(t>e&&(e=t),s===n&&(i=t,i<e))break}if(i>=e)return!1}else if(!t.gridElement)return!1}const{grow:i,shrink:s}=t.flexbox;return i>0||1!==s}return!1}init(){const t=this._element;if(t){const e=this.sessionId,i=At(t,"styleMap",e)||{};let n;if(this.pseudoElement)n=ct(t.parentElement,It(t,e));else if(n=ct(t),this.styleElement){const e=Array.from(t.style);if(e.length){const n=t.style;for(const t of e)i[Nt(t)]=n.getPropertyValue(t)}}if(this.styleElement){const e={};for(const s in i){const o=rt(t,s,i[s],n);""!==o&&(e[s]=o)}this._styleMap=e}else this._styleMap=i;this.style=n,this._cssStyle=i,"0"!==e&&Rt(t,"node",e,this)}}saveAsInitial(t=!1){(void 0===this._initial||t)&&(this._initial={children:this.duplicate(),styleMap:Object.assign({},this._styleMap)})}data(t,e,i,n=!0){const s=this._data;if(Ot(i)){let o=s[t];Ht(o)||(o={},s[t]=o),(n||void 0===o[e])&&(o[e]=i)}else if(null===i)return void delete s[t];const o=s[t];return Ht(o)?o[e]:void 0}unsetCache(...t){if(t.length){const e=this._cached;for(const i of t){switch(i){case"position":case"display":return void(this._cached={});case"width":e.actualWidth=void 0;case"minWidth":e.width=void 0;case"maxWidth":e.overflow=void 0;break;case"height":e.actualHeight=void 0;case"minHeight":e.height=void 0;case"maxHeight":e.overflow=void 0;break;case"verticalAlign":e.baseline=void 0;break;case"textAlign":e.rightAligned=void 0,e.centerAligned=void 0;break;case"top":case"bottom":e.bottomAligned=void 0;break;case"backgroundColor":case"backgroundImage":e.visibleStyle=void 0;break;case"float":e.floating=void 0;break;case"overflowX":case"overflowY":e.overflow=void 0;break;default:Qt.test(i)?(e.autoMargin=void 0,e.rightAligned=void 0,e.centerAligned=void 0,e.horizontalAligned=void 0):Kt.test(i)?(e.contentBoxWidth=void 0,e.contentBoxHeight=void 0):Jt.test(i)&&(e.visibleStyle=void 0,e.contentBoxWidth=void 0,e.contentBoxHeight=void 0)}e[i]=void 0}}else this._cached={},this._textStyle=void 0}ascend(t={}){const{condition:e,including:i,error:n,every:s,excluding:o}=t;let r=t.attr;Xt(r)||(r="actualParent");const a=[];let l=t.startSelf?this:this[r];for(;l&&l!==o&&(!n||!n(l));){if(e){if(e(l)&&(a.push(l),!s))break}else a.push(l);if(l===i)break;l=l[r]}return a}intersectX(t,e="linear"){if(t.width>0){const{left:i,right:n}=this[e],{left:s,right:o}=t;return Bt(s,i)&&Math.ceil(s)<n||o>Math.ceil(i)&&Pt(o,n)||Bt(i,s)&&Pt(n,o)||Bt(s,i)&&Pt(o,n)}return!1}intersectY(t,e="linear"){if(t.height>0){const{top:i,bottom:n}=this[e],{top:s,bottom:o}=t;return Bt(s,i)&&Math.ceil(s)<n||o>Math.ceil(i)&&Pt(o,n)||Bt(i,s)&&Pt(n,o)||Bt(s,i)&&Pt(o,n)}return!1}withinX(t,e="linear"){if(this.pageFlow||t.width>0){const i=this[e];return Bt(i.left,t.left)&&Pt(i.right,t.right)}return!0}withinY(t,e="linear"){if(this.pageFlow||t.height>0){const i=this[e];return Bt(i.top,t.top)&&Pt(i.bottom,t.bottom)}return!0}outsideX(t,e="linear"){if(this.pageFlow||t.width>0){const i=this[e];return i.left<Math.floor(t.left)||Math.floor(i.right)>t.right}return!1}outsideY(t,e="linear"){if(this.pageFlow||t.height>0){const i=this[e];return i.top<Math.floor(t.top)||Math.floor(i.bottom)>t.bottom}return!1}css(t,e,i=!0){return e&&this.styleElement&&(this.style[t]=e,le(e,this.style[t]))?(this._styleMap[t]=e,i&&this.unsetCache(t),e):this._styleMap[t]||this.styleElement&&this.style[t]||""}cssApply(t,e=!0){for(const i in t){const n=t[i];this.css(i,n,e)===n&&e&&this.unsetCache(i)}return this}cssInitial(t,e=!1,i=!1){var n;void 0!==this._initial||e||(i=!0);let s=(!e&&(null===(n=this._initial)||void 0===n?void 0:n.styleMap)||this._styleMap)[t];return i&&!s&&(s=this.style[t]),s||""}cssAny(t,...e){const i=this.css(t);for(const t of e)if(i===t)return!0;return!1}cssInitialAny(t,...e){for(const i of e)if(this.cssInitial(t)===i)return!0;return!1}cssAscend(t,e=!1){let i,n=e?this:this.actualParent;for(;n;){if(i=n.cssInitial(t),""!==i)return i;if(n.documentBody)break;n=n.actualParent}return""}cssSort(t,e=!0,i=!1){return(i?this.duplicate():this.children).sort((i,n)=>{const s=i.toFloat(t,i.childIndex),o=n.toFloat(t,n.childIndex);return s===o?0:e?s<o?-1:1:s>o?-1:1})}cssPX(t,e,i=!1,n=!1){const s=this._styleMap[t];if(s&&dt(s)){e+=gt(s,this.fontSize),!i&&e<0&&(e=0);const o=at(e);return this.css(t,o),n&&this.unsetCache(t),o}return""}cssSpecificity(t){var e,i;let n;if(this.styleElement)if(this.pseudoElement){const i=this._element,s=this.sessionId;n=null===(e=At(i.parentElement,"styleSpecificity"+It(i,s),s))||void 0===e?void 0:e[t]}else n=null===(i=At(this._element,"styleSpecificity",this.sessionId))||void 0===i?void 0:i[t];return n||0}cssTry(t,e){if(this.styleElement){const i=this._element,n=ct(i).getPropertyValue(t);if(n===e)return!0;{const s=i.style;if(s.setProperty(t,e),le(e,s.getPropertyValue(t)))return Rt(i,t,this.sessionId,n),!0}}return!1}cssFinally(t){if(this.styleElement){const e=this.sessionId,i=this._element,n=At(i,t,e);if(n)return i.style.setProperty(t,n),Tt(i,t,e),!0}return!1}cssParent(t,e,i=!1){return this.naturalChild?this.actualParent.css(t,e,i):""}toInt(t,e=NaN,i=!1){var n;const s=parseInt((i&&(null===(n=this._initial)||void 0===n?void 0:n.styleMap)||this._styleMap)[t]);return isNaN(s)?e:s}toFloat(t,e=NaN,i=!1){var n;const s=parseFloat((i&&(null===(n=this._initial)||void 0===n?void 0:n.styleMap)||this._styleMap)[t]);return isNaN(s)?e:s}toElementInt(t,e=NaN){var i;const n=parseInt(null===(i=this._element)||void 0===i?void 0:i[t]);return isNaN(n)?e:n}toElementFloat(t,e=NaN){var i;const n=parseFloat(null===(i=this._element)||void 0===i?void 0:i[t]);return isNaN(n)?e:n}toElementBoolean(t,e=!1){var i;const n=null===(i=this._element)||void 0===i?void 0:i[t];return"boolean"==typeof n?n:e}toElementString(t,e=""){var i;return((null===(i=this._element)||void 0===i?void 0:i[t])||e).toString()}parseUnit(t,e="width",i=!0,n){if(t){if(ut(t)){const n=i&&this.absoluteParent||this;let s=parseFloat(t)/100;switch(e){case"width":s*=n.bounds.width;break;case"height":s*=n.bounds.height}return s}return gt(t,this.fontSize,n)}return 0}has(t,e=0,i){var n,s,o;const r=("initial"===(null===(n=i)||void 0===n?void 0:n.map)&&(null===(s=this._initial)||void 0===s?void 0:s.styleMap)||this._styleMap)[t];if(r)switch(r){case"auto":case"none":case"initial":case"normal":case"transparent":case"rgba(0, 0, 0, 0)":return!1;case"baseline":case"left":case"start":return!!(this.flexElement||(null===(o=this.actualParent)||void 0===o?void 0:o.flexElement))&&/^(align|justify|place)-/.test(t);default:if(i&&i.not){if(r===i.not)return!1;if(Array.isArray(i.not))for(const t of i.not)if(r===t)return!1}if(e>0){if(Ft(e,2)&&dt(r))return!0;if(Ft(e,4)&&ut(r))return!0}return 0===e}return!1}hasPX(t,e=!0,i=!1){var n;const s=(i&&(null===(n=this._initial)||void 0===n?void 0:n.styleMap)||this._styleMap)[t];return!!s&&dt(s,e)}setBounds(t=!0){if(this.styleElement)this._bounds=mt(kt(this._element,this.sessionId,t)),this.documentBody&&0===this.marginTop&&(this._bounds.top=0);else if(this.plainText){const t=vt(this._element),e=mt(t),i=t.numberOfLines;e.numberOfLines=i,this._bounds=e,this._textBounds=e,this._cached.multiline=i>1}t||(this._box=void 0,this._linear=void 0)}querySelector(t){return this.querySelectorAll(t,1)[0]||null}querySelectorAll(t,e=-1){let i=[];const n=this.queryMap;if(n){const s=ft(t);for(let t=0;t<s.length;t++){const o=s[t],r=[];let a=-1;t:{let t,e;for(;null!==(e=qt.exec(o));){let i,n,s,o,l,c,h=e[1],d=!1;if(1===h.length){const e=h.charAt(0);switch(e){case"+":case"~":a--;case">":if(t||0===r.length){r.length=0;break t}t=e;continue;case"*":d=!0}}else if(/\|\*$/.test(h))d="*|*"===h;else if("*"===h.charAt(0))h=h.substring(1);else if(/^::/.test(h)){r.length=0;break t}if(!d){let t;for(;null!==(t=Vt.exec(h));){void 0===o&&(o=[]);const e="i"===t[6];let i=t[3]||t[4]||t[5]||"";e&&(i=i.toLowerCase()),o.push({key:t[1],symbol:t[2],value:i,caseInsensitive:e}),h=zt(h,t.index,t[0].length)}if(h.includes("::")){r.length=0;break t}for(;null!==(t=jt.exec(h));)/^:not\(/.test(t[0])?t[1]&&(void 0===c&&(c=[]),c.push(t[1])):(void 0===l&&(l=[]),l.push(t[0])),h=zt(h,t.index,t[0].length);for(;null!==(t=Gt.exec(h));){const e=t[0];switch(e.charAt(0)){case"#":n=e.substring(1);break;case".":void 0===s&&(s=[]),s.push(e.substring(1));break;default:i=e.toUpperCase()}h=zt(h,t.index,t[0].length)}}r.push({all:d,tagName:i,id:n,adjacent:t,classList:s,pseudoList:l,notList:c,attrList:o}),a++,t=void 0}qt.lastIndex=0}let l=n.length;if(r.length&&-1!==a&&a<l){const o=r.pop(),c=0===r.length;let h=[];for(let e=a;e<l;e++){const i=n[e];if(o.all)h=h.concat(i);else for(const e of i)ae.call(this,e,o,t,c)&&h.push(e)}if(r.length){const n=this.depth;r.reverse(),l=r.length;const s=(e,i,o)=>{const a=r[e],c=e===l-1,h=[];for(const s of o)if(i){const e=s.actualParent;if(">"===i)ae.call(this,e,a,t,c,i)&&h.push(e);else{const n=e.naturalElements;switch(i){case"+":{const e=n.indexOf(s);if(e>0){const s=n[e-1];s&&ae.call(this,s,a,t,c,i)&&h.push(s)}break}case"~":{const e=n.length;for(let o=0;o<e;o++){const e=n[o];if(e===s)break;ae.call(this,e,a,t,c,i)&&h.push(e)}break}}}}else if(s.depth-n>=l-e){let e=s.actualParent;do{ae.call(this,e,a,t,c)&&h.push(e),e=e.actualParent}while(e)}return!!h.length&&(++e===l||s(e,a.adjacent,h))};for(const t of h)if(s(0,o.adjacent,[t])&&(i.push(t),i.length===e))return i}else{if(0===i.length&&(t===s.length-1||e>=0&&e<=h.length))return e>=0&&h.length>e&&(h.length=e),h;if(i=i.concat(h),e>=0&&i.length>=e)return i.length=e,i}}}}return i}setDimension(t,e,i){const n=this._styleMap,s=n[t],o=this.parseUnit(s,t);let r=Math.max(o,this.parseUnit(n[e],t));if(0===r&&this.styleElement){const e=this._element;switch(e.tagName){case"IMG":case"INPUT":if("image"!==e.type)break;case"TD":case"TH":case"SVG":case"IFRAME":case"VIDEO":case"CANVAS":case"OBJECT":case"EMBED":{const i=bt(e,t);""!==i&&(r=Dt(i)?parseFloat(i):this.parseUnit(i,t),r>0&&this.css(t,ut(i)?i:i+"px"));break}}}let a=0;if(o>0&&!this.imageElement){const e=n[i];s===e?delete n[i]:(a=this.parseUnit(e,t),a>0&&a<=o&&dt(s)&&(a=0,n[t]=e,delete n[i]))}return a>0?Math.min(r,a):r}convertPosition(t){if(!this.positionStatic){const e=this.cssInitial(t,!0);if(dt(e))return this.parseUnit(e,"left"===t||"right"===t?"width":"height");if(ut(e)&&this.styleElement)return Mt(this.style[t])}return 0}convertBorderWidth(t){if(!this.plainText){const e=ot[t];if("none"!==this.css(e[0])){const i=e[1],n=this.css(i);let s;switch(n){case"thin":case"medium":case"thick":s=Mt(this.style[i]);break;default:s=this.parseUnit(n,1===t||3===t?"width":"height")}if(s>0)return Math.max(Math.round(s),1)}}return 0}convertBox(t,e){var i,n;switch(this.display){case"table":if(!e&&"collapse"===this.css("borderCollapse"))return 0;break;case"table-row":return 0;case"table-cell":if(e){switch(this.tagName){case"TD":case"TH":return 0;default:{const e=this.ascend({condition:t=>"TABLE"===t.tagName})[0];if(e){const[n,s]=e.css("borderSpacing").split(" ");switch(t){case"marginTop":case"marginBottom":return s?this.parseUnit(s,"height",!1):this.parseUnit(n,"width",!1);case"marginRight":if((null===(i=this.actualParent)||void 0===i?void 0:i.lastChild)!==this)return this.parseUnit(n,"width",!1);case"marginLeft":return 0}}break}}return 0}}const s=this.parseUnit(this.css(t),"width",!0!==(null===(n=this.actualParent)||void 0===n?void 0:n.gridElement));if(!e){let e=this.toFloat("paddingInlineStart",0),i=this.toFloat("paddingInlineEnd",0);if(e>0||i>0)return"vertical-rl"===this.css("writingMode")?"rtl"===this.dir?("paddingBottom"!==t&&(e=0),"paddingTop"!==t&&(i=0)):("paddingTop"!==t&&(e=0),"paddingBottom"!==t&&(i=0)):"rtl"===this.dir?("paddingRight"!==t&&(e=0),"paddingLeft"!==t&&(i=0)):("paddingLeft"!==t&&(e=0),"paddingRight"!==t&&(i=0)),e+s+i}return s}set parent(t){var e;if(t){const i=this._parent;t!==i&&(null===(e=i)||void 0===e||e.remove(this),this._parent=t),t.contains(this)||t.append(this),-1===this.depth&&(this.depth=t.depth+1)}}get parent(){return this._parent}get tagName(){let t=this._cached.tagName;if(void 0===t){const e=this._element;if(e){const i=e.nodeName;t="#"===i.charAt(0)?i:e.tagName}else t="";this._cached.tagName=t}return t}get element(){return this._element}get elementId(){var t;return(null===(t=this._element)||void 0===t?void 0:t.id)||""}get htmlElement(){let t=this._cached.htmlElement;return void 0===t&&(t=!this.plainText&&this._element instanceof HTMLElement,this._cached.htmlElement=t),t}get svgElement(){let t=this._cached.svgElement;return void 0===t&&(t=!this.htmlElement&&!this.plainText&&this._element instanceof SVGElement||this.imageElement&&Et.SVG.test(this.src),this._cached.svgElement=t),t}get styleElement(){return this.htmlElement||this.svgElement}get naturalChild(){return!0}get naturalElement(){let t=this._cached.naturalElement;return void 0===t&&(t=this.naturalChild&&this.styleElement&&!this.pseudoElement,this._cached.naturalElement=t),t}get pseudoElement(){return!1}get imageElement(){return"IMG"===this.tagName}get flexElement(){let t=this._cached.flexElement;return void 0===t&&(t=oe.test(this.display),this._cached.flexElement=t),t}get gridElement(){let t=this._cached.gridElement;return void 0===t&&(t=se.test(this.display),this._cached.gridElement=t),t}get textElement(){let t=this._cached.textElement;return void 0===t&&(t=this.plainText||this.inlineText,this._cached.textElement=t),t}get tableElement(){let t=this._cached.tableElement;return void 0===t&&(t="TABLE"===this.tagName||"table"===this.display,this._cached.tableElement=t),t}get inputElement(){let t=this._cached.inputElement;if(void 0===t){switch(this.tagName){case"INPUT":case"BUTTON":case"SELECT":case"TEXTAREA":t=!0;break;default:t=!1}this._cached.inputElement=t}return t}get layoutElement(){let t=this._cached.layoutElement;return void 0===t&&(t=this.flexElement||this.gridElement,this._cached.layoutElement=t),t}get plainText(){return"#text"===this.tagName}get styleText(){return this.naturalElement&&this.inlineText}get lineBreak(){return"BR"===this.tagName}get documentBody(){return this._element===document.body}get initial(){return this._initial}get bounds(){return this._bounds||mt(this.boundingClientRect)}get linear(){return this._linear||(()=>{const t=this._bounds;if(t){if(this.styleElement){const{marginTop:e,marginBottom:i,marginLeft:n,marginRight:s}=this;this._linear={top:t.top-(e>0?e:0),right:t.right+s,bottom:t.bottom+i,left:t.left-(n>0?n:0),width:t.width+Math.max(n,0)+s,height:t.height+Math.max(e,0)+i}}else this._linear=t;return this._linear}return xt()})()}get box(){return this._box||(()=>{const t=this._bounds;return t?(this._box=this.styleElement?{top:t.top+(this.paddingTop+this.borderTopWidth),right:t.right-(this.paddingRight+this.borderRightWidth),bottom:t.bottom-(this.paddingBottom+this.borderBottomWidth),left:t.left+(this.paddingLeft+this.borderLeftWidth),width:t.width-this.contentBoxWidth,height:t.height-this.contentBoxHeight}:t,this._box):xt()})()}get dataset(){if(this.styleElement)return this._element.dataset;{let t=this._dataset;return void 0===t&&(t={},this._dataset=t),t}}get flexbox(){let t=this._cached.flexbox;if(void 0===t){if(this.styleElement){const e=this.css("alignSelf"),i=this.css("justifySelf");t={alignSelf:"auto"===e?this.cssParent("alignItems"):e,justifySelf:"auto"===i?this.cssParent("justifyItems"):i,basis:this.css("flexBasis"),grow:re(this,"flexGrow",0),shrink:re(this,"flexShrink",1),order:this.toInt("order",0)}}else t={alignSelf:"auto",justifySelf:"auto",basis:"auto",grow:0,shrink:1,order:0};this._cached.flexbox=t}return t}get width(){let t=this._cached.width;return void 0===t&&(t=this.setDimension("width","minWidth","maxWidth"),this._cached.width=t),t}get height(){let t=this._cached.height;return void 0===t&&(t=this.setDimension("height","minHeight","maxHeight"),this._cached.height=t),t}get hasWidth(){let t=this._cached.hasWidth;return void 0===t&&(t=this.width>0,this._cached.hasWidth=t),t}get hasHeight(){var t;let e=this._cached.hasHeight;if(void 0===e){const i=this.css("height");e=ut(i)?!(!this.pageFlow||!((null===(t=this.actualParent)||void 0===t?void 0:t.hasHeight)||this.documentBody))&&parseFloat(i)>0:this.height>0,this._cached.hasHeight=e}return e}get lineHeight(){let t=this._cached.lineHeight;if(void 0===t){if(t=0,!this.imageElement&&!this.svgElement){let e=this.has("lineHeight"),i=0;if(e){const t=this.css("lineHeight");if(ut(t))i=Mt(this.style.lineHeight);else if(i=gt(t,this.fontSize),Ut.test(t)&&"inherit"!==this._cssStyle.lineHeight){const t=this.cssInitial("fontSize");ne.test(t)&&(i*=parseFloat(t))}}else if(this.naturalChild){const t=this.ascend({condition:t=>t.lineHeight>0})[0];if(t&&(i=t.lineHeight),this.styleElement){const t=this.cssInitial("fontSize");if(ne.test(t)){const n=parseFloat(t);1!==n&&(i*=n,this.css("lineHeight",at(i)),e=!0)}}}(e||i>this.actualHeight||this.multiline||this.block&&this.naturalChildren.some(t=>t.textElement))&&(t=i)}this._cached.lineHeight=t}return t}get display(){return this.css("display")}get positionStatic(){var t;let e=this._cached.positionStatic;if(void 0===e){switch(this.css("position")){case"fixed":case"absolute":e=!1;break;case"relative":this.documentBody?e=!1:(e=!(this.hasPX("top")||this.hasPX("right")||this.hasPX("bottom")||this.hasPX("left")),e&&(this._cached.positionRelative=!1));break;case"inherit":{const i=this._element,n=(null===(t=i)||void 0===t?void 0:t.parentElement)?lt(i.parentElement,"position"):"";e=""!==n&&!("absolute"===n||"fixed"===n);break}default:e=!0}this._cached.positionStatic=e}return e}get positionRelative(){let t=this._cached.positionRelative;return void 0===t&&(t="relative"===this.css("position"),this._cached.positionRelative=t),t}get top(){let t=this._cached.top;return void 0===t&&(t=this.convertPosition("top"),this._cached.top=t),t}get right(){let t=this._cached.right;return void 0===t&&(t=this.convertPosition("right"),this._cached.right=t),t}get bottom(){let t=this._cached.bottom;return void 0===t&&(t=this.convertPosition("bottom"),this._cached.bottom=t),t}get left(){let t=this._cached.left;return void 0===t&&(t=this.convertPosition("left"),this._cached.left=t),t}get marginTop(){let t=this._cached.marginTop;return void 0===t&&(t=this.inlineStatic?0:this.convertBox("marginTop",!0),this._cached.marginTop=t),t}get marginRight(){let t=this._cached.marginRight;return void 0===t&&(t=this.convertBox("marginRight",!0),this._cached.marginRight=t),t}get marginBottom(){let t=this._cached.marginBottom;return void 0===t&&(t=this.inlineStatic?0:this.convertBox("marginBottom",!0),this._cached.marginBottom=t),t}get marginLeft(){let t=this._cached.marginLeft;return void 0===t&&(t=this.convertBox("marginLeft",!0),this._cached.marginLeft=t),t}get borderTopWidth(){let t=this._cached.borderTopWidth;return void 0===t&&(t=this.convertBorderWidth(0),this._cached.borderTopWidth=t),t}get borderRightWidth(){let t=this._cached.borderRightWidth;return void 0===t&&(t=this.convertBorderWidth(1),this._cached.borderRightWidth=t),t}get borderBottomWidth(){let t=this._cached.borderBottomWidth;return void 0===t&&(t=this.convertBorderWidth(2),this._cached.borderBottomWidth=t),t}get borderLeftWidth(){let t=this._cached.borderLeftWidth;return void 0===t&&(t=this.convertBorderWidth(3),this._cached.borderLeftWidth=t),t}get paddingTop(){let t=this._cached.paddingTop;return void 0===t&&(t=this.convertBox("paddingTop",!1),this._cached.paddingTop=t),t}get paddingRight(){let t=this._cached.paddingRight;return void 0===t&&(t=this.convertBox("paddingRight",!1),this._cached.paddingRight=t),t}get paddingBottom(){let t=this._cached.paddingBottom;return void 0===t&&(t=this.convertBox("paddingBottom",!1),this._cached.paddingBottom=t),t}get paddingLeft(){let t=this._cached.paddingLeft;return void 0===t&&(t=this.convertBox("paddingLeft",!1),this._cached.paddingLeft=t),t}get contentBox(){return"border-box"!==this.css("boxSizing")||this.tableElement&&st(8)}get contentBoxWidth(){let t=this._cached.contentBoxWidth;return void 0===t&&(t=this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderLeftWidth+this.paddingLeft+this.paddingRight+this.borderRightWidth,this._cached.contentBoxWidth=t),t}get contentBoxHeight(){let t=this._cached.contentBoxHeight;return void 0===t&&(t=this.tableElement&&"collapse"===this.css("borderCollapse")?0:this.borderTopWidth+this.paddingTop+this.paddingBottom+this.borderBottomWidth,this._cached.contentBoxHeight=t),t}get inline(){let t=this._cached.inline;if(void 0===t){const e=this.display;t="inline"===e||"initial"===e&&!pt.includes(this.tagName),this._cached.inline=t}return t}get inlineStatic(){let t=this._cached.inlineStatic;return void 0===t&&(t=this.inline&&this.pageFlow&&!this.floating&&!this.imageElement,this._cached.inlineStatic=t),t}get inlineVertical(){let t=this._cached.inlineVertical;if(void 0===t){if(!this.naturalElement||this.plainText||this.floating)t=!1;else{const e=this.display;t=Yt.test(e)||"table-cell"===e}this._cached.inlineVertical=t}return t}set inlineText(t){switch(this.tagName){case"INPUT":case"IMG":case"SELECT":case"SVG":case"BR":case"HR":case"TEXTAREA":case"PROGRESS":case"METER":this._inlineText=!1;break;case"BUTTON":this._inlineText=""!==this.textContent.trim();break;default:this._inlineText=t}}get inlineText(){return this._inlineText}get block(){var t;let e=this._cached.block;if(void 0===e){switch(this.display){case"block":case"flex":case"grid":case"list-item":e=!0;break;case"initial":e=pt.includes(this.tagName);break;case"inline":if("svg"===this.tagName&&(null===(t=this.actualParent)||void 0===t?void 0:t.htmlElement)){e=!this.hasPX("width")&&0===Mt(bt(this._element,"width"));break}default:e=!1}this._cached.block=e}return e}get blockStatic(){let t=this._cached.blockStatic;return void 0===t&&(t=this.pageFlow&&(this.block&&!this.floating||this.blockDimension&&"100%"===this.cssInitial("width")&&!this.hasPX("maxWidth")),this._cached.blockStatic=t),t}get blockDimension(){let t=this._cached.blockDimension;if(void 0===t){if(this.block||this.imageElement||this.svgElement)t=!0;else{const e=this.display;t=$t.test(e)||"table"===e}this._cached.blockDimension=t}return t}get blockVertical(){let t=this._cached.blockVertical;return void 0===t&&(t=this.blockDimension&&this.hasPX("height"),this._cached.blockVertical=t),t}get pageFlow(){let t=this._cached.pageFlow;return void 0===t&&(t=this.positionStatic||this.positionRelative,this._cached.pageFlow=t),t}get inlineFlow(){let t=this._cached.inlineFlow;if(void 0===t){if(this.inline||this.imageElement||this.floating)t=!0;else{const e=this.display;t=Yt.test(e)||"table-cell"===e}this._cached.inlineFlow=t}return t}get centerAligned(){let t=this._cached.centerAligned;return void 0===t&&(t=this.autoMargin.leftRight||this.textElement&&this.blockStatic&&"center"===this.cssInitial("textAlign")||this.inlineStatic&&"center"===this.cssAscend("textAlign",!0),this._cached.centerAligned=t),t}get rightAligned(){var t;let e=this._cached.rightAligned;if(void 0===e){const i=this.actualParent;e=(null===(t=i)||void 0===t?void 0:t.flexElement)?/(right|end)$/.test(i.css("justifyContent")):"right"===this.float||this.autoMargin.left||!this.pageFlow&&this.hasPX("right")||this.textElement&&this.blockStatic&&"right"===this.cssInitial("textAlign"),this._cached.rightAligned=e}return e}get bottomAligned(){let t=this._cached.bottomAligned;return void 0===t&&(t=!this.pageFlow&&this.hasPX("bottom")&&this.bottom>=0&&!this.hasPX("top"),this._cached.bottomAligned=t),t}get horizontalAligned(){let t=this._cached.horizontalAligned;return void 0===t&&(t=!this.blockStatic&&!this.autoMargin.horizontal&&!(this.blockDimension&&"100%"===this.css("width"))&&(!this.multiline||this.floating),this._cached.horizontalAligned=t),t}get autoMargin(){var t;let e=this._cached.autoMargin;if(void 0===e){if(!this.pageFlow||this.blockStatic||"table"===this.display){const i=(null===(t=this._initial)||void 0===t?void 0:t.styleMap)||this._styleMap,n="auto"===i.marginLeft&&(this.pageFlow||this.hasPX("right")),s="auto"===i.marginRight&&(this.pageFlow||this.hasPX("left")),o="auto"===i.marginTop&&(this.pageFlow||this.hasPX("bottom")),r="auto"===i.marginBottom&&(this.pageFlow||this.hasPX("top"));e={horizontal:n||s,left:n&&!s,right:!n&&s,leftRight:n&&s,vertical:o||r,top:o&&!r,bottom:!o&&r,topBottom:o&&r}}else e={};this._cached.autoMargin=e}return e}get floating(){let t=this._cached.floating;return void 0===t&&(t="none"!==this.float,this._cached.floating=t),t}get float(){let t=this._cached.float;return void 0===t&&(t=this.pageFlow&&this.css("float")||"none",this._cached.float=t),t}get zIndex(){return this.toInt("zIndex",0)}get textContent(){let t=this._cached.textContent;return void 0===t&&(t=this.svgElement?"":this._element.textContent,this._cached.textContent=t),t}get src(){return this.htmlElement&&this._element.src||""}get overflow(){let t=this._cached.overflow;if(void 0===t){if(t=0,this.htmlElement&&!this.inputElement&&!this.imageElement&&"HR"!==this.tagName&&!this.documentBody){const e=this._element,i=this.css("overflowX"),n=this.css("overflowY");this.hasHeight&&(this.hasPX("height")||this.hasPX("maxHeight"))&&("scroll"===n||"auto"===n&&e.clientHeight!==e.scrollHeight)&&(t|=16),(this.hasPX("width")||this.hasPX("maxWidth"))&&("scroll"===i||"auto"===i&&e.clientWidth!==e.scrollWidth)&&(t|=8),"auto"!==i&&"hidden"!==i&&"overlay"!==i&&"auto"!==n&&"hidden"!==n&&"overlay"!==n||(t|=64)}this._cached.overflow=t}return t}get overflowX(){return Ft(this.overflow,8)}get overflowY(){return Ft(this.overflow,16)}get baseline(){let t=this._cached.baseline;if(void 0===t){if(this.pageFlow&&!this.floating){const e=this.cssInitial("verticalAlign",!1,!0);t="baseline"===e||"initial"===e||0===this.naturalElements.length&&dt(e,!0)}else t=!1;this._cached.baseline=t}return t}get verticalAlign(){let t=this._cached.verticalAlign;return void 0===t&&(t=this.css("verticalAlign"),dt(t,!0)&&(t=this.parseUnit(t,"height")+"px"),this._cached.verticalAlign=t),t}set textBounds(t){this._textBounds=t}get textBounds(){let t=this._textBounds;if(this.naturalChild&&void 0===t){if(this.textElement)t=wt(this._element,this.sessionId);else if(this.length){const e=this.cascade(t=>0===t.length);if(e.length&&e.every(t=>t.textElement)){let i=1/0,n=-1/0,s=1/0,o=-1/0,r=0;for(const t of e){const e=wt(t.element,t.sessionId);i=Math.min(e.top,i),n=Math.max(e.right,n),s=Math.min(e.left,s),o=Math.max(e.bottom,o),r+=e.numberOfLines||0}t={top:i,right:n,left:s,bottom:o,width:n-s,height:o-i,numberOfLines:r}}}this._textBounds=t}return t}get multiline(){var t;let e=this._cached.multiline;return void 0===e&&(e=this.plainText?vt(this._element).numberOfLines>1:!(!this.styleText||!this.inlineFlow&&0!==this.naturalElements.length)&&(null===(t=this.textBounds)||void 0===t?void 0:t.numberOfLines)>1,this._cached.multiline=e),e}get backgroundColor(){let t=this._cached.backgroundColor;if(void 0===t){switch(t=this.css("backgroundColor"),t){case"initial":case"transparent":case"rgba(0, 0, 0, 0)":t="";break;default:if(""!==t&&this.pageFlow&&!this.plainText&&!this.inputElement&&(void 0===this._initial||this.cssInitial("backgroundColor")===t)){let e=this.actualParent;for(;e;){const i=e.cssInitial("backgroundColor",!0);if(""!==i){i===t&&""===e.backgroundColor&&(t="");break}e=e.actualParent}}}this._cached.backgroundColor=t}return t}get backgroundImage(){var t;let e=this._cached.backgroundImage;if(void 0===e){const i=this.css("backgroundImage");e=""!==i&&"none"!==i&&"initial"!==i?i:(null===(t=Zt.exec(this.css("background")))||void 0===t?void 0:t[1])||"",this._cached.backgroundImage=e}return e}get visibleStyle(){let t=this._cached.visibleStyle;if(void 0===t){if(this.plainText)t={background:!1,borderWidth:!1,backgroundImage:!1,backgroundColor:!1,backgroundRepeat:!1,backgroundRepeatX:!1,backgroundRepeatY:!1};else{const e=this.borderTopWidth>0||this.borderRightWidth>0||this.borderBottomWidth>0||this.borderLeftWidth>0,i=""!==this.backgroundColor,n=""!==this.backgroundImage;let s=!1,o=!1;if(n)for(const t of this.css("backgroundRepeat").split(_t.SEPARATOR)){const[e,i]=t.split(" ");s||(s="repeat"===e||"repeat-x"===e),o||(o="repeat"===e||"repeat-y"===e||"repeat"===i)}t={background:e||n||i,borderWidth:e,backgroundImage:n,backgroundColor:i,backgroundRepeat:s||o,backgroundRepeatX:s,backgroundRepeatY:o}}this._cached.visibleStyle=t}return t}get absoluteParent(){let t=this._cached.absoluteParent;if(void 0===t){if(t=this.actualParent,!this.pageFlow&&!this.documentBody)for(;t;){const e=t.cssInitial("position",!1,!0);if(t.documentBody||"static"!==e&&"initial"!==e)break;t=t.actualParent}this._cached.absoluteParent=t}return t}set actualParent(t){this._cached.actualParent=t}get actualParent(){var t;let e=this._cached.actualParent;if(void 0===e){const i=null===(t=this._element)||void 0===t?void 0:t.parentElement;e=i&&Ct(i,this.sessionId)||null,this._cached.actualParent=e}return e}get actualWidth(){let t=this._cached.actualWidth;if(void 0===t){if(this.plainText){const{left:e,right:i}=this.bounds;t=i-e}else"table-cell"===this.display||ce.isFlexDirection(this,"row")?t=this.bounds.width:(t=this.width,t>0?this.contentBox&&!this.tableElement&&(t+=this.contentBoxWidth):t=this.bounds.width);this._cached.actualWidth=t}return t}get actualHeight(){let t=this._cached.actualHeight;return void 0===t&&(this.plainText||"table-cell"===this.display||ce.isFlexDirection(this,"column")?t=this.bounds.height:(t=this.height,t>0?this.contentBox&&!this.tableElement&&(t+=this.contentBoxHeight):t=this.bounds.height),this._cached.actualHeight=t),t}get actualDimension(){return{width:this.actualWidth,height:this.actualHeight}}set naturalChildren(t){this._naturalChildren=t}get naturalChildren(){return this._naturalChildren||function(t){var e;let i;if(t.naturalElement){const e=t.sessionId;let n=0;i=[],t.element.childNodes.forEach(t=>{const s=Ct(t,e);s&&(s.childIndex=n++,i.push(s))})}else i=((null===(e=t.initial)||void 0===e?void 0:e.children)||t.children).slice(0);return t.naturalChildren=i,i}(this)}set naturalElements(t){this._naturalElements=t}get naturalElements(){return this._naturalElements||function(t){const e=Wt(t.naturalChildren,t=>t.naturalElement);return t.naturalElements=e,e}(this)}get firstChild(){return this.naturalElements[0]||null}get lastChild(){const t=this.naturalElements,e=t.length;return e>0?t[e-1]:null}get firstStaticChild(){for(const t of this.naturalChildren)if(t.pageFlow)return t;return null}get lastStaticChild(){const t=this.naturalChildren;for(let e=t.length-1;e>=0;e--){const i=t[e];if(i.pageFlow)return i}return null}get previousSibling(){var t;return(null===(t=this.actualParent)||void 0===t?void 0:t.naturalChildren[this.childIndex-1])||null}get nextSibling(){var t;return(null===(t=this.actualParent)||void 0===t?void 0:t.naturalChildren[this.childIndex+1])||null}get previousElementSibling(){var t;const e=null===(t=this.actualParent)||void 0===t?void 0:t.naturalElements;if(e){const t=e.indexOf(this);if(t>0)return e[t-1]}return null}get nextElementSibling(){var t;const e=null===(t=this.actualParent)||void 0===t?void 0:t.naturalElements;if(e){const t=e.indexOf(this);if(-1!==t)return e[t+1]||null}return null}get attributes(){let t=this._cached.attributes;if(void 0===t){if(t={},this.styleElement){const e=this._element.attributes,i=e.length;for(let n=0;n<i;n++){const{name:i,value:s}=e.item(n);t[i]=s}}this._cached.attributes=t}return t}get boundingClientRect(){var t;return this.naturalElement&&(null===(t=this._element)||void 0===t?void 0:t.getBoundingClientRect())||this._bounds||xt()}get fontSize(){let t=this._fontSize;if(void 0===t){const e=t=>parseFloat(t.getPropertyValue("font-size"));if(t=this.naturalElement?e(this.style):gt(this.css("fontSize")),0===t&&!this.naturalChild){const i=this.element;t=i&&ht(i)?e(ct(i)):NaN}for(;isNaN(t);){const i=this.actualParent;if(!i){t=e(ct(document.body));break}t=e(i.style)}this._fontSize=t}return t}get cssStyle(){return this._cssStyle}get textStyle(){let t=this._textStyle;return void 0===t&&(t={fontFamily:this.css("fontFamily"),fontSize:this.css("fontSize"),fontWeight:this.css("fontWeight"),fontStyle:this.css("fontStyle"),color:this.css("color"),whiteSpace:this.css("whiteSpace"),textDecoration:this.css("textDecoration"),textTransform:this.css("textTransform"),letterSpacing:this.css("letterSpacing"),wordSpacing:this.css("wordSpacing")},this._textStyle=t),t}set dir(t){this._cached.dir=t}get dir(){let t=this._cached.dir;if(void 0===t){if(t=this.naturalElement?this._element.dir:"",""===t){let e=this.actualParent;for(;e&&(t=e.dir,""===t);)e=e.actualParent}this._cached.dir=t}return t}get center(){const t=this.bounds;return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}}var he,de,ue;!function(t){t[t.DOM_TRAVERSE=2]="DOM_TRAVERSE",t[t.EXTENSION=4]="EXTENSION",t[t.RENDER=8]="RENDER",t[t.ALL=14]="ALL"}(he||(he={})),function(t){t[t.BOX_STYLE=2]="BOX_STYLE",t[t.BOX_SPACING=4]="BOX_SPACING",t[t.FONT_STYLE=8]="FONT_STYLE",t[t.VALUE_STRING=16]="VALUE_STRING",t[t.IMAGE_SOURCE=32]="IMAGE_SOURCE",t[t.ASSET=56]="ASSET",t[t.ALL=126]="ALL"}(de||(de={})),function(t){t[t.CONSTRAINT=2]="CONSTRAINT",t[t.LAYOUT=4]="LAYOUT",t[t.ALIGNMENT=8]="ALIGNMENT",t[t.ACCESSIBILITY=16]="ACCESSIBILITY",t[t.LOCALIZATION=32]="LOCALIZATION",t[t.CUSTOMIZATION=64]="CUSTOMIZATION",t[t.ALL=126]="ALL"}(ue||(ue={}));var fe=Object.freeze({__proto__:null,get APP_SECTION(){return he},get NODE_RESOURCE(){return de},get NODE_PROCEDURE(){return ue}});const ge=squared.lib,{BOX_MARGIN:pe,BOX_PADDING:me,BOX_POSITION:be,isPercent:ve}=ge.css,{isTextNode:xe,newBoxModel:ye}=ge.dom,{equal:Se}=ge.math,{XML:Ee}=ge.regex,{getElementAsNode:_e}=ge.session,{aboveRange:ke,assignEmptyProperty:we,cloneObject:Te,convertWord:Ce,filterArray:Ae,hasBit:Ie,isArray:Re,searchObject:Be,spliceArray:Pe,withinRange:Ne}=ge.util,Me=Array.from(tt.keys()),Le=["position","display","verticalAlign","float","clear","zIndex"];function We(t={},e,i,n){const{floating:s,pageFlow:o,lineBreak:r,excluded:a}=t,l=[];for(;e;){const t=_e(e,n);if(t)if(!1!==r&&t.lineBreak||!1!==a&&t.excluded&&!t.lineBreak)l.push(t);else if(t.pageFlow&&!t.excluded){if(!1===o)break;if(l.push(t),!1!==s||!t.floating&&(t.visible||t.rendered)&&"none"!==t.display)break}e=e[i]}return l}const Fe=t=>t.naturalElements.length>0&&!t.layoutElement&&!t.tableElement,Oe=t=>t.blockVertical||t.percentWidth,De=(t,e)=>t.blockDimension&&ke(t.linear.top,e.linear.bottom)&&(Oe(t)||Oe(e)||t.float!==e.float);class He extends ce{constructor(){super(...arguments),this.alignmentType=0,this.baselineActive=!1,this.baselineAltered=!1,this.positioned=!1,this.rendered=!1,this.excluded=!1,this.floatContainer=!1,this.lineBreakLeading=!1,this.lineBreakTrailing=!1,this._boxRegister={},this._excludeSection=0,this._excludeProcedure=0,this._excludeResource=0,this._childIndex=1/0,this._containerIndex=1/0,this._visible=!0,this._locked={}}static outerRegion(t){let e,i,n,s,o=1/0,r=-1/0,a=-1/0,l=1/0,c=-1/0,h=-1/0;return t.each(t=>{if(t.companion)e=t.actualRect("top"),i=t.actualRect("right"),n=t.actualRect("bottom"),s=t.actualRect("left");else{if(({top:e,right:i,bottom:n,left:s}=t.linear),t.marginRight<0){const e=i+Math.abs(t.marginRight);e>c&&(c=e)}if(t.marginBottom<0){const e=n+Math.abs(t.marginBottom);e>h&&(h=e)}}e<o&&(o=e),i>r&&(r=i),n>a&&(a=n),s<l&&(l=s)}),{top:o,right:r,bottom:a,left:l,width:Math.max(r,c)-l,height:Math.max(a,h)-o}}static baseline(t,e=!1){const i=[];for(const n of t)!n.baseline||e&&!n.textElement||n.baselineAltered||(n.naturalChildren.length?n.baselineElement&&i.push(n):i.push(n));return i.length>1&&i.sort((t,e)=>{if(t.length&&0===e.length)return 1;if(e.length&&0===t.length)return-1;const i=t.baselineHeight+t.marginBottom,n=e.baselineHeight+e.marginBottom;if(!Se(i,n))return i>n?-1:1;if(t.textElement&&e.textElement){if(!t.plainText&&e.plainText)return-1;if(t.plainText&&!e.plainText)return 1}else{if(t.inputElement&&e.inputElement&&t.containerType!==e.containerType)return t.containerType>e.containerType?-1:1;if(e.textElement&&t.inputElement&&e.childIndex<t.childIndex)return 1;if(t.textElement&&e.inputElement&&t.childIndex<e.childIndex)return-1}const s=t.bounds.bottom,o=e.bounds.bottom;return s>o?-1:s<o?1:0}),i[0]||null}static linearData(t,e=!1){const i=new Set,n=new Map;let s=!1,o=!1;if(t.length>1){const r=[],a=new Set,l={};for(const e of t)if(e.pageFlow){if(a.size){const t=[],i=e.css("clear");switch(i){case"left":t.push(l.left);break;case"right":t.push(l.right);break;case"both":t.push(l.left,l.right)}if(!e.floating)for(const i of t)if(i){const t=i.float;a.has(t)&&ke(e.linear.top,i.linear.bottom)&&(a.delete(t),l[t]=void 0)}"both"===i?(n.set(e,2===a.size?"both":a.values().next().value),a.clear(),l.left=void 0,l.right=void 0):a.has(i)&&(n.set(e,i),a.delete(i),l[i]=void 0)}if(e.floating){const t=e.float;a.add(t),i.add(t),l[t]=e}r.push(e)}else e.positionAuto&&r.push(e);const c=r.length;if(c&&!e){const t=[r[0]];let e=1,a=1;for(let i=1;i<c;i++){const s=r[i];if(s.alignedVertically(t,n)>0?a++:e++,e>1&&a>1)break;t.push(s)}if(s=e===c,o=a===c,s&&i.size){let t=1/0,e=-1/0,i=-1/0,n=1/0;for(const s of r){const{left:o,right:r}=s.linear;t=Math.min(t,o),e=Math.max(e,r),"left"===s.float?i=Math.max(i,r):"right"===s.float&&(n=Math.min(n,o))}for(let o=0,a=0,l=0,h=0,d=0;o<c;o++){const c=r[o],{left:u,right:f}=c.linear;if(Math.floor(u)<=t&&a++,Math.ceil(f)>=e&&l++,c.floating||(u===i&&h++,f===n&&d++),0===o)continue;if(2===a||2===l||2===h||2===d){s=!1;break}const g=r[o-1];if(Ne(u,g.linear.left)||g.floating&&ke(c.linear.top,g.linear.bottom)){s=!1;break}}}}}else t.length&&(o=t[0].blockStatic,s=!o);return{linearX:s,linearY:o,cleared:n,floated:i}}static partitionRows(t){var e;const i=t[0].actualParent,n=(null===(e=i)||void 0===e?void 0:e.floatContainer)?He.linearData(i.naturalChildren,!0).cleared:void 0,s=[];let o=[],r=[];const a=t.length;for(let e=0;e<a;e++){const i=t[e];let a=i;if(!i.naturalChild){if(i.nodeGroup){o.length&&s.push(o),s.push([i]),o=[],r.length=0;continue}const t=i.innerMostWrapped;t!==i&&(a=t)}0===o.length?(o.push(i),r.push(a)):a.alignedVertically(r,n)>0?(o.length&&s.push(o),o=[i],r=[a]):(o.push(i),r.push(a))}return o.length&&s.push(o),s}is(t){return this.containerType===t}of(t,...e){return this.is(t)&&e.some(t=>this.hasAlign(t))}attr(t,e,i,n=!0){var s;let o=this["__"+t];return i?(void 0===o&&(this._namespaces.includes(t)||this._namespaces.push(t),o={},this["__"+t]=o),n&&this.lockedAttr(t,e)&&(n=!1),!n&&o[e]?i=o[e]:o[e]=i,i):(null===(s=o)||void 0===s?void 0:s[e])||""}unsafe(t,e){if(void 0===e)return this["_"+t];this["_"+t]=e}unset(t){delete this["_"+t]}namespace(t){return this["__"+t]||{}}delete(t,...e){const i=this["__"+t];if(i)for(const t of e)if(t.includes("*"))for(const[e]of Be(i,t))delete i[e];else delete i[t]}lockAttr(t,e){let i=this._locked[t];void 0===i&&(i={},this._locked[t]=i),i[e]=!0}unlockAttr(t,e){const i=this._locked[t];i&&(i[e]=!1)}lockedAttr(t,e){var i;return(null===(i=this._locked[t])||void 0===i?void 0:i[e])||!1}render(t){this.renderParent=t,this.rendered=!0}parseUnit(t,e="width",i=!0,n){return super.parseUnit(t,e,i,n||this.localSettings.screenDimension)}renderEach(t){const e=this.renderChildren,i=e.length;for(let n=0;n<i;n++){const i=e[n];i.visible&&t(i,n,e)}return this}renderFilter(t){return Ae(this.renderChildren,t)}hide(t){var e;const i=this.renderParent;if(i){const t=i.renderTemplates;if(t){const n=i.renderChildren.findIndex(t=>t===this);if(-1!==n){(null===(e=t[n])||void 0===e?void 0:e.node)===this&&(t[n]=null)}}}this.rendered=!0,this.visible=!1}inherit(t,...e){for(const i of e)switch(i){case"base":{this._documentParent=t.documentParent,this._bounds=Object.assign({},t.bounds),this._linear=Object.assign({},t.linear),this._box=Object.assign({},t.box),this._boxReset=ye(),this._boxAdjustment=ye(),-1===this.depth&&(this.depth=t.depth);const e=t.actualParent;e&&(this.actualParent=e,this.dir=e.dir);break}case"initial":Te(t.unsafe("initial"),this.initial);break;case"alignment":{const e=this._styleMap;for(const i of Le)e[i]=t.css(i);if(!this.positionStatic)for(const i of be)t.hasPX(i)&&(e[i]=t.css(i));if(t.autoMargin.horizontal||t.autoMargin.vertical)for(const i of pe)"auto"===t.cssInitial(i)&&(e[i]="auto");this.positionAuto=t.positionAuto;break}case"styleMap":we(this._styleMap,t.unsafe("styleMap"));break;case"textStyle":this.cssApply(t.textStyle),this.fontSize=t.fontSize;break;case"boxStyle":{const{backgroundColor:e,backgroundImage:i}=t;this.cssApply({backgroundColor:e,backgroundImage:i,backgroundRepeat:t.css("backgroundRepeat"),backgroundSize:t.css("backgroundSize"),backgroundPositionX:t.css("backgroundPositionX"),backgroundPositionY:t.css("backgroundPositionY"),backgroundClip:t.css("backgroundClip"),boxSizing:t.css("boxSizing"),border:"initial",borderRadius:"initial",borderTopWidth:t.css("borderTopWidth"),borderBottomWidth:t.css("borderBottomWidth"),borderRightWidth:t.css("borderRightWidth"),borderLeftWidth:t.css("borderLeftWidth"),borderTopColor:t.css("borderTopColor"),borderBottomColor:t.css("borderBottomColor"),borderRightColor:t.css("borderRightColor"),borderLeftColor:t.css("borderLeftColor"),borderTopStyle:t.css("borderTopStyle"),borderBottomStyle:t.css("borderBottomStyle"),borderRightStyle:t.css("borderRightStyle"),borderLeftStyle:t.css("borderLeftStyle"),borderTopLeftRadius:t.css("borderTopLeftRadius"),borderTopRightRadius:t.css("borderTopRightRadius"),borderBottomRightRadius:t.css("borderBottomRightRadius"),borderBottomLeftRadius:t.css("borderBottomLeftRadius")},!0),this.setCacheValue("backgroundColor",e),this.setCacheValue("backgroundImage",i),t.setCacheValue("backgroundColor",""),t.setCacheValue("backgroundImage",""),t.resetBox(510,this);const n=t.visibleStyle;n.background=!1,n.backgroundImage=!1,n.backgroundColor=!1,n.borderWidth=!1;break}}}addAlign(t){this.hasAlign(t)||(this.alignmentType|=t)}removeAlign(t){this.hasAlign(t)&&(this.alignmentType^=t)}hasAlign(t){return Ie(this.alignmentType,t)}hasResource(t){return!Ie(this.excludeResource,t)}hasProcedure(t){return!Ie(this.excludeProcedure,t)}hasSection(t){return!Ie(this.excludeSection,t)}exclude(t){const{resource:e,procedure:i,section:n}=t;e&&!Ie(this._excludeResource,e)&&(this._excludeResource|=e),i&&!Ie(this._excludeProcedure,i)&&(this._excludeProcedure|=i),n&&!Ie(this._excludeSection,n)&&(this._excludeSection|=n)}setExclusions(){var t;if(this.styleElement){const e=this._element.dataset,i=(null===(t=this.actualParent)||void 0===t?void 0:t.dataset)||{};if(Object.keys(e).length||Object.keys(i).length){const t=(t,n)=>{let s=e[t]||"",o=0;const r=i[t+"Child"];if(r&&(s+=(""!==s?"|":"")+r),""!==s)for(const t of s.split(/\s*\|\s*/)){const e=n[t.toUpperCase()]||0;e>0&&!Ie(o,e)&&(o|=e)}return o};this.exclude({resource:t("excludeResource",de),procedure:t("excludeProcedure",ue),section:t("excludeSection",he)})}}}appendTry(t,e,i=!0){let n=!1;const s=this.children,o=s.length;for(let i=0;i<o;i++)if(s[i]===t){s[i]=e,e.parent=this,e.containerIndex=t.containerIndex,n=!0;break}return!n&&i&&(e.parent=this,n=!0),n}sort(t){return t?super.sort(t):this.children.sort((t,e)=>t.containerIndex<e.containerIndex?-1:1),this}alignedVertically(t,e,i){var n,s,o,r,a;if(this.lineBreak)return 2;if(this.pageFlow||this.positionAuto){if(Re(t)){if(null===(n=e)||void 0===n?void 0:n.has(this))return 5;{const n=t[t.length-1],r=this.floating;if(r&&n.floating){const o=this.float;if(i&&(o===n.float||(null===(s=e)||void 0===s?void 0:s.size)&&!t.some((t,i)=>i>0&&e.get(t)===o)))return 0;if(ke(this.linear.top,n.linear.bottom))return 4}else{if(r&&t.some(t=>t.multiline))return 4;if(!r&&t.every(t=>{var e;return"right"===t.float&&ke((null===(e=this.textBounds)||void 0===e?void 0:e.top)||-1/0,t.bounds.bottom)}))return 6;if(void 0!==i){if(r&&n.blockStatic&&!i)return 0;if(!/^inline-/.test(this.display)){let{top:n,bottom:s}=this.linear;if(this.textElement&&(null===(o=e)||void 0===o?void 0:o.size)&&t.some(t=>e.has(t))&&t.some(t=>n<t.linear.top&&s>t.linear.bottom))return 7;if("right"===t[0].float){if(t.length>1){let e=-1/0;for(const i of t)"right"===i.float&&(e=Math.max(i.actualRect("bottom","bounds"),e));if(this.multiline){if(this.styleText){const t=this.textBounds;t&&(s=t.bottom)}const t=s-e;n=t<=0||t/(s-n)<.5?-1/0:1/0}return ke(e,n)?i?0:6:i?6:0}if(!i)return 6}}}}if(De(this,n))return 3}}for(const i of this.siblingsLeading){if(i.blockStatic||i.autoMargin.leftRight)return 1;if(i.lineBreak)return 2;{const t=this.blockStatic||"table"===this.display;if(t&&(!i.floating||!i.rightAligned&&Ne(i.linear.right,(this.actualParent||this.documentParent).box.right)||(null===(r=e)||void 0===r?void 0:r.has(i))))return 1;if(i.floating){if(this.blockDimension&&"100%"===this.css("width")&&!this.hasPX("maxWidth")||"left"===i.float&&this.autoMargin.right||"right"===i.float&&this.autoMargin.left)return 1;if(t&&this.some(t=>t.floating&&ke(t.linear.top,i.linear.bottom)))return 6}}if(!("both"!==(null===(a=e)||void 0===a?void 0:a.get(i))||Re(t)&&t[0]===i))return 5;if(De(this,i))return 3}}return 0}previousSiblings(t={}){var e,i,n;return We(t,!this.nodeGroup&&(null===(e=this.innerMostWrapped.element)||void 0===e?void 0:e.previousSibling)||(null===(n=null===(i=this.firstChild)||void 0===i?void 0:i.element)||void 0===n?void 0:n.previousSibling),"previousSibling",this.sessionId)}nextSiblings(t={}){var e,i,n;return We(t,!this.nodeGroup&&(null===(e=this.innerMostWrapped.element)||void 0===e?void 0:e.nextSibling)||(null===(n=null===(i=this.firstChild)||void 0===i?void 0:i.element)||void 0===n?void 0:n.nextSibling),"nextSibling",this.sessionId)}modifyBox(t,e,i=!0){if(0!==e){const n=tt.get(t);if(n){const s=()=>{let t=this._boxReset;void 0===t&&(t=ye(),this._boxReset=t),t[n]=1},o=this._boxRegister[t];if(void 0===e)if(o){const e=this[n]||o.getBox(t)[1];e>0&&o.modifyBox(t,-e,!1)}else s();else if(o)o.modifyBox(t,e,i);else{let t=this._boxAdjustment;if(void 0===t&&(t=ye(),this._boxAdjustment=t),!i&&this[n]+t[n]+e<=0)return this.naturalChild&&s(),void(t[n]=0);t[n]+=e}}}}getBox(t){var e,i;const n=tt.get(t);return n?[(null===(e=this._boxReset)||void 0===e?void 0:e[n])||0,(null===(i=this._boxAdjustment)||void 0===i?void 0:i[n])||0]:[0,0]}resetBox(t,e){let i=this._boxReset;void 0===i&&(i=ye(),this._boxReset=i);const n=(n,s)=>{for(let o=0;o<4;o++){const r=Me[o+s];if(Ie(t,r)&&(i[n[o]]=1,e)){const t=this.registerBox(r);if(t)t.resetBox(r,e);else{if(this.naturalChild){const t=this[tt.get(r)];t>=0&&e.modifyBox(r,t)}this.transferBox(r,e)}}}};Ie(30,t)&&n(pe,0),Ie(480,t)&&n(me,4)}transferBox(t,e){let i=this._boxAdjustment;void 0===i&&(i=ye(),this._boxAdjustment=i);const n=(n,s)=>{for(let o=0;o<4;o++){const r=Me[o+s];if(Ie(t,r)){const t=this.registerBox(r);if(t)t.transferBox(r,e);else{const t=n[o],s=i[t];0!==s&&(e.modifyBox(r,s,!1),i[t]=0),this.registerBox(r,e)}}}};Ie(30,t)&&n(pe,0),Ie(480,t)&&n(me,4)}registerBox(t,e){const i=this._boxRegister;return e&&(i[t]=e),i[t]}actualPadding(t,e){if(e>0){if(this.layoutElement){if(this.gridElement)switch(this.css("alignContent")){case"space-around":case"space-evenly":return 0}}else{const i=this.innerMostWrapped;if(i!==this){if(!i.naturalChild)return e;if(0===i.getBox("paddingTop"===t?32:128)[0])return 0}if(i.naturalChild){let n=!1;return Fe(i)&&(n=function t(e,i,n){let s=!1;for(const o of e){if(o.blockStatic)return!1;if(o.inlineStatic){if(o.has("lineHeight")&&o.lineHeight>o.bounds.height)return!1;if(o[i]>=n)s=!0;else if(Fe(o)){if(!t(o.naturalElements,i,n))return!1;s=!0}}}return s}(i.naturalElements,t,e)),n?0:e}}return e}return 0}cloneBase(t){t.localSettings=this.localSettings,t.alignmentType=this.alignmentType,t.containerName=this.containerName,t.depth=this.depth,t.visible=this.visible,t.excluded=this.excluded,t.rendered=this.rendered,t.childIndex=this.childIndex,t.containerIndex=this.containerIndex,t.inlineText=this.inlineText,t.lineBreakLeading=this.lineBreakLeading,t.lineBreakTrailing=this.lineBreakTrailing,t.actualParent=this.actualParent,t.documentParent=this.documentParent,t.documentRoot=this.documentRoot,t.renderParent=this.renderParent,this.length&&t.retain(this.duplicate()),t.inherit(this,"initial","base","alignment","styleMap","textStyle"),Object.assign(t.unsafe("cached"),this._cached)}unsetCache(...t){if(t.length){const e=this._cached;for(const i of t)switch(i){case"top":case"right":case"bottom":case"left":e.positionAuto=void 0;break;case"lineHeight":e.baselineHeight=void 0}}super.unsetCache(...t)}css(t,e,i=!1){return arguments.length>=2&&(e?this._styleMap[t]=e:delete this._styleMap[t],i&&this.unsetCache(t)),this._styleMap[t]||this.styleElement&&this.style[t]||""}cssApply(t,e=!1){return Object.assign(this._styleMap,t),e&&this.unsetCache(...Object.keys(t)),this}cssSet(t,e,i=!0){return super.css(t,e,i)}setCacheValue(t,e){this._cached[t]=e}get element(){return this._element||this.innerMostWrapped.unsafe("element")||null}set naturalChild(t){this._cached.naturalChild=t}get naturalChild(){var t;let e=this._cached.naturalChild;return void 0===e&&(e=!!(null===(t=this._element)||void 0===t?void 0:t.parentElement),this._cached.naturalChild=e),e}get pseudoElement(){var t;return"__squared.pseudo"===(null===(t=this._element)||void 0===t?void 0:t.className)}set documentParent(t){this._documentParent=t}get documentParent(){return this._documentParent||this.absoluteParent||this.actualParent||this.parent||this}set containerName(t){this._cached.containerName=t.toUpperCase()}get containerName(){let t=this._cached.containerName;if(void 0===t){const e=this.element;t=e?xe(e)?"PLAINTEXT":"INPUT"===e.tagName?"INPUT_"+Ce(e.type,!0).toUpperCase():e.tagName.toUpperCase():"",this._cached.containerName=t}return t}get excludeSection(){return this._excludeSection}get excludeProcedure(){return this._excludeProcedure}get excludeResource(){return this._excludeResource}get layoutHorizontal(){return this.hasAlign(8)}get layoutVertical(){return this.hasAlign(16)}get nodeGroup(){return!1}set renderAs(t){var e;this.rendered||!1!==(null===(e=t)||void 0===e?void 0:e.rendered)||(this._renderAs=t)}get renderAs(){return this._renderAs}get blockStatic(){return super.blockStatic||this.hasAlign(64)&&!this.floating}get rightAligned(){return super.rightAligned||this.hasAlign(2048)}set positionAuto(t){this._cached.positionAuto=t}get positionAuto(){var t;let e=this._cached.positionAuto;if(void 0===e){if(this.pageFlow)e=!1;else{const{top:i,right:n,bottom:s,left:o}=(null===(t=this._initial)||void 0===t?void 0:t.styleMap)||this._styleMap;e=!(i&&"auto"!==i||n&&"auto"!==n||s&&"auto"!==s||o&&"auto"!==o||!(this.toFloat("opacity",1)>0))}this._cached.positionAuto=e}return e}set flexbox(t){this._cached.flexbox=t}get flexbox(){return super.flexbox}set contentBoxWidth(t){this._cached.contentBoxWidth=t}get contentBoxWidth(){return super.contentBoxWidth}set contentBoxHeight(t){this._cached.contentBoxHeight=t}get contentBoxHeight(){return super.contentBoxHeight}set textContent(t){this._cached.textContent=t}get textContent(){let t=this._cached.textContent;return void 0===t&&(t=this.naturalChild&&this._element.textContent||"",this._cached.textContent=t),t}get positiveAxis(){let t=this._cached.positiveAxis;return void 0===t&&(t=(!this.positionRelative||this.positionRelative&&this.top>=0&&this.left>=0&&(this.right<=0||this.hasPX("left"))&&(this.bottom<=0||this.hasPX("top")))&&this.marginTop>=0&&this.marginLeft>=0&&this.marginRight>=0,this._cached.positiveAxis=t),t}set overflow(t){0!==t&&16!==t&&8!==t&&24!==t||(Ie(this.overflow,64)&&(t|=64),this._cached.overflow=t)}get overflow(){return super.overflow}get baseline(){return super.baseline}get baselineElement(){let t=this._cached.baselineElement;if(void 0===t){if(this.baseline){const e=this.naturalElements;t=e.length?e.every(t=>t.baselineElement&&0===t.length):this.inlineText&&this.textElement||this.plainText&&!this.multiline||this.inputElement||this.imageElement||this.svgElement}else t=!1;this._cached.baselineElement=t}return t}set multiline(t){this._cached.multiline=t}get multiline(){return super.multiline}set visible(t){this._visible=t}get visible(){return this._visible}set controlName(t){this.rendered&&void 0!==this._controlName||(this._controlName=t)}get controlName(){return this._controlName||""}set actualParent(t){this._cached.actualParent=t}get actualParent(){let t=this._cached.actualParent;return void 0===t&&(t=super.actualParent,null===t&&(t=this.innerMostWrapped.actualParent),this._cached.actualParent=t),t}set siblingsLeading(t){this._siblingsLeading=t}get siblingsLeading(){return this._siblingsLeading||this.previousSiblings()}set siblingsTrailing(t){this._siblingsTrailing=t}get siblingsTrailing(){return this._siblingsTrailing||this.nextSiblings()}get previousSibling(){const t=this.actualParent;if(t){const e=t.naturalChildren,i=e.indexOf(this);if(-1!==i)for(let t=i-1;t>=0;t--){const i=e[t];if(i&&(!i.excluded||i.lineBreak))return i}}return null}get nextSibling(){const t=this.actualParent;if(t){const e=t.naturalChildren,i=e.indexOf(this);if(-1!==i){const t=e.length;for(let n=i+1;n<t;n++){const t=e[n];if(t&&(!t.excluded||t.lineBreak))return t}}}return null}get firstChild(){return this.naturalChildren[0]||null}get lastChild(){const t=this.naturalChildren;return t[t.length-1]||null}get onlyChild(){var t,e,i;return 1===(null!=(e=null===(t=this.renderParent)||void 0===t?void 0:t.renderChildren.length)?e:null===(i=this.parent)||void 0===i?void 0:i.length)&&!this.documentRoot}set childIndex(t){this._childIndex=t}get childIndex(){let t=this._childIndex;if(t===1/0){let e=this.innerWrapped;if(e)do{const i=e.childIndex;if(i!==1/0){t=i,this._childIndex=t;break}e=e.innerWrapped}while(e);else{const e=this._element;if(e){const i=e.parentElement;if(i){const n=i.childNodes,s=n.length;for(let i=0;i<s;i++)n[i]===e&&(t=i,this._childIndex=i)}}}}return t}set containerIndex(t){this._containerIndex=t}get containerIndex(){let t=this._containerIndex;if(t===1/0){let e=this.innerWrapped;for(;e;){const i=e.containerIndex;if(i!==1/0){t=i,this._containerIndex=t;break}e=e.innerWrapped}}return t}get textEmpty(){let t=this._cached.textEmpty;if(void 0===t){if(!this.styleElement||this.imageElement||this.svgElement||"HR"===this.tagName)t=!1;else{const e=this.textContent;t=""===e||!this.preserveWhiteSpace&&!this.pseudoElement&&""===e.trim()}this._cached.textEmpty=t}return t}get percentWidth(){let t=this._cached.percentWidth;return void 0===t&&(t=ve(this.cssInitial("width")),this._cached.percentWidth=t),t}get percentHeight(){let t=this._cached.percentHeight;return void 0===t&&(t=ve(this.cssInitial("height")),this._cached.percentHeight=t),t}get innerMostWrapped(){if(this.naturalChild)return this;let t=this.innerWrapped;for(;t;){const e=t.innerWrapped;if(!e)break;t=e}return t||this}get outerMostWrapper(){let t=this.outerWrapper;for(;t;){const e=t.outerWrapper;if(!e)break;t=e}return t||this}get preserveWhiteSpace(){let t=this._cached.whiteSpace;if(void 0===t){const e=this.css("whiteSpace");t="pre"===e||"pre-wrap"===e,this._cached.whiteSpace=t}return t}get outerExtensionElement(){if(this.naturalChild){let t=this._element.parentElement;for(;t;){if(t.dataset.use)return t;t=t.parentElement}}return null}set fontSize(t){this._fontSize=t}get fontSize(){return super.fontSize}get extensions(){let t=this._cached.extensions;if(void 0===t){const e=this.dataset.use;t=e?Pe(e.split(Ee.SEPARATOR),t=>""===t):[],this._cached.extensions=t}return t}}const{aboveRange:Xe,hasBit:ze}=squared.lib.util;class Ue extends squared.lib.base.Container{constructor(t,e,i=0,n=0,s){var o;super(s),this.parent=t,this.node=e,this.containerType=i,this.alignmentType=n,this.rowCount=0,this.columnCount=0,this.renderType=0,this.renderIndex=-1,this.itemCount=0,(null===(o=s)||void 0===o?void 0:o.length)&&this.init()}static create(t){const{parent:e,node:i,containerType:n,alignmentType:s,children:o,itemCount:r,rowCount:a,columnCount:l}=t,c=new Ue(e,i,n,s,o);return r&&(c.itemCount=r),a&&(c.rowCount=a),l&&(c.columnCount=l),c}init(){const t=this.children,e=t.length;if(e){let i;if(e>1){const e=He.linearData(t),n=e.floated;this._floated=n,this._cleared=e.cleared,this._linearX=e.linearX,this._linearY=e.linearY,i=n.size}else this._linearY=t[0].blockStatic,this._linearX=!this._linearY,i=0;let n=!0,s=!0;for(let i=0;i<e;i++){const e=t[i];if(e.floating||(n=!1),e.rightAligned||(s=!1),!n&&!s)break}(n||2===i)&&(this.add(512),this.some(t=>t.blockStatic)&&this.add(64)),s&&this.add(2048),this.itemCount=e}}setContainerType(t,e){this.containerType=t,e&&this.add(e)}hasAlign(t){return ze(this.alignmentType,t)}add(t){return ze(this.alignmentType,t)||(this.alignmentType|=t),this.alignmentType}addRender(t){return ze(this.renderType,t)||(this.renderType|=t),this.renderType}delete(t){return ze(this.alignmentType,t)&&(this.alignmentType^=t),this.alignmentType}retain(t){return super.retain(t),this.init(),this}get linearX(){var t;return null==(t=this._linearX)||t}get linearY(){var t;return null!=(t=this._linearY)&&t}get floated(){return this._floated||new Set}get cleared(){return this._cleared||new Map}set type(t){this.setContainerType(t.containerType,t.alignmentType)}get singleRowAligned(){let t=this._singleRow;if(void 0===t){const e=this.length;if(e){if(t=!0,e>1){let e=1/0;for(const i of this.children){if(i.blockStatic||i.multiline||Xe(i.linear.top,e)){t=!1;break}e=i.linear.bottom}}this._singleRow=t}else t=!1}return t}get unknownAligned(){return this.length>1&&!this.linearX&&!this.linearY}get visible(){return this.filter(t=>t.visible)}}const Ve=squared.lib,{BOX_POSITION:qe,convertListStyle:Ge,formatPX:je,getStyle:Ye,insertStyleSheetRule:$e,isLength:Qe,resolveURL:Ke}=Ve.css,{getNamedItem:Je,getRangeClientRect:Ze,isTextNode:ti,removeElementsByClassName:ei}=Ve.dom,{aboveRange:ii,convertFloat:ni,convertWord:si,filterArray:oi,flatArray:ri,fromLastIndexOf:ai,hasBit:li,isString:ci,partitionArray:hi,trimString:di}=Ve.util,{XML:ui}=Ve.regex,{getElementCache:fi,getPseudoElt:gi,setElementCache:pi}=Ve.session,{isPlainText:mi}=Ve.xml,bi=/\s*(?:attr\(([^)]+)\)|(counter)\(([^,)]+)(?:, ([a-z-]+))?\)|(counters)\(([^,]+), "([^"]*)"(?:, ([a-z-]+))?\)|"([^"]+)")\s*/g;function vi(t,e,i,n,s,o){let r=t[i];void 0===r&&(r={},t[i]=r),r[n]=o,e.style.setProperty(n,s)}function xi(t,e){if("none"!==t){const i=/\s*([^\-\d][^\-\d]?[^ ]*) (-?\d+)\s*/g;let n;for(;null!==(n=i.exec(t));)if(n[1]===e)return parseInt(n[2])}}function yi(t,e,i,n){var s;const o=fi(t,"styleMap"+i,n);if(null===(s=o)||void 0===s?void 0:s.counterIncrement)return xi(o.counterIncrement,e)}function Si(t,e,i,n){return!i.length&&!n&&(e.push(t),!0)}function Ei(t,e,i){return!e.length&&(i.push(t),!0)}function _i(t,e){if(t){const i=t.split(ui.SEPARATOR),n=[],s=[];for(const t of e){const e=i.indexOf(t.name);-1!==e?n[e]=t:s.push(t)}if(n.length)return ri(n).concat(s)}return e}const ki=t=>t.textElement&&(t.blockStatic||t.multiline);const wi=squared.lib,{isUserAgent:Ti}=wi.client,{BOX_BORDER:Ci,BOX_PADDING:Ai,formatPX:Ii,getStyle:Ri,isLength:Bi,isPercent:Pi}=wi.css,{isTextNode:Ni}=wi.dom,{capitalize:Mi,convertFloat:Li,flatArray:Wi}=wi.util,{actualClientRect:Fi,getElementCache:Oi,setElementCache:Di}=wi.session,{pushIndent:Hi,pushIndentArray:Xi}=wi.xml;function zi(t){const e=t.getPropertyValue("position");return"absolute"===e||"fixed"===e}const Ui=(t,e)=>"none"!==t.getPropertyValue(e+"-style")?Vi(t,e+"-width"):0,Vi=(t,e)=>parseInt(t.getPropertyValue(e));const qi=squared.lib,{hasComputedStyle:Gi}=qi.css,{includes:ji}=qi.util;class Yi extends j{constructor(t,e,i,n=[]){super(t,e,i),this.eventOnly=!1,this.documentBase=!1,this.cascadeAll=!1,this.removeIs=!1,this._isAll=!1,this.tagNames=n,this._isAll=0===n.length}static findNestedElement(t,e){if(t&&Gi(t)){const i=t.children,n=i.length;for(let t=0;t<n;t++){const n=i[t];if(ji(n.dataset.use,e))return n}}return null}condition(t,e){return t.dataset.use?this.included(t.element):!this._isAll}is(t){return this._isAll||this.tagNames.includes(t.tagName)}included(t){return ji(t.dataset.use,this.name)}processNode(t,e){}processChild(t,e){}addDescendant(t){const e=this.application.session.extensionMap,i=t.id,n=e.get(i)||[];n.includes(this)||n.push(this),e.set(i,n)}postBaseLayout(t){}postConstraints(t){}postOptimize(t){}afterBaseLayout(){}afterConstraints(){}afterResources(){}beforeBaseLayout(){}beforeCascade(){}afterFinalize(){}set application(t){this._application=t,this._controller=t.controllerHandler,this._resource=t.resourceHandler,this._cache=t.session.cache,this._cacheProcessing=t.processing.cache}get application(){return this._application}get controller(){return this._controller}get resource(){return this._resource}get cache(){return this._cache}get cacheProcessing(){return this._cacheProcessing}}const{isLength:$i}=squared.lib.css;const Qi=squared.lib,{isUserAgent:Ki}=Qi.client,{parseColor:Ji}=Qi.color,{BOX_BORDER:Zi,calculate:tn,convertAngle:en,formatPX:nn,getBackgroundPosition:sn,getInheritedStyle:on,isCalc:rn,isLength:an,isParentStyle:ln,isPercent:cn,parseAngle:hn}=Qi.css,{cos:dn,equal:un,hypotenuse:fn,offsetAngleX:gn,offsetAngleY:pn,relativeAngle:mn,sin:bn,triangulate:vn,truncateFraction:xn}=Qi.math,{CHAR:yn,ESCAPE:Sn,STRING:En,XML:_n}=Qi.regex,{getElementAsNode:kn}=Qi.session,{convertCamelCase:wn,convertFloat:Tn,hasValue:Cn,isEqual:An,isNumber:In,isString:Rn,trimEnd:Bn,trimStart:Pn}=Qi.util,{STRING_SPACE:Nn,STRING_TABSPACE:Mn}=Qi.xml,Ln=`(rgba?\\(\\d+, \\d+, \\d+(?:, [\\d.]+)?\\)|#[A-Za-z\\d]{3,8}|[a-z]+)\\s*(${En.LENGTH_PERCENTAGE}|${En.CSS_ANGLE}|(?:${En.CSS_CALC}(?=,)|${En.CSS_CALC}))?,?\\s*`,Wn=/^url/,Fn=/\u00A0/g,On=RegExp(`(?:initial|url\\([^)]+\\)|(repeating)?-?(linear|radial|conic)-gradient\\(((?:to [a-z ]+|(?:from )?-?[\\d.]+(?:deg|rad|turn|grad)|(?:circle|ellipse)?\\s*(?:closest-side|closest-corner|farthest-side|farthest-corner)?)?(?:\\s*(?:(?:-?[\\d.]+(?:[a-z%]+)?\\s*)+)?(?:at [\\w %]+)?)?),?\\s*((?:${Ln})+)\\))`,"g"),Dn=RegExp(Ln,"g");function Hn(t,e,i){const{width:n,height:s}=e.dimension;let o,r=!1,a=!0,l=1;switch(e.type){case"conic":o=Math.min(n,s);break;case"radial":{const{repeating:i,radiusExtent:n,radius:s}=e;a=t.actualWidth<=t.actualHeight,r=i,l=n/s,o=s;break}default:{const{repeating:t,angle:i}=e;switch(r=t,i){case 0:case 180:case 360:o=s,a=!1;break;case 90:case 270:o=n;break;default:o=Math.abs(n*bn(i))+Math.abs(s*dn(i)),a=n>=s}break}}const c=[];let h,d=0;for(;null!==(h=Dn.exec(i));){const i=Ji(h[1],1,!0);if(i){let n=-1;if("conic"===e.type){const t=h[3],e=h[4];t&&e&&(n=en(t,e)/360)}else{const e=h[2];cn(e)?n=parseFloat(e)/100:an(e)?n=t.parseUnit(e,a?"width":"height",!1)/o:rn(e)&&(n=tn(h[6],o,t.fontSize)/o),r&&-1!==n&&(n*=l)}0===c.length&&(-1===n?n=0:n>0&&c.push({color:i,offset:0})),-1!==n&&(n=Math.max(d,n),d=n),c.push({color:i,offset:n})}}const u=c.length,f=c[u-1];-1===f.offset&&(f.offset=1);let g=0;for(let t=0;t<u;t++){const e=c[t];if(-1===e.offset)if(0===t)e.offset=0;else{for(let i=t+1,n=2;i<u-1;i++,n++){const t=c[i];if(-1!==t.offset){e.offset=(g+t.offset)/n;break}}-1===e.offset&&(e.offset=g+f.offset/(u-1))}g=e.offset}if(r){if(g<100)t:{const t=c.slice(0);let e=g;for(;g<100;){for(const i of t)if(g=Math.min(e+i.offset,1),c.push(Object.assign(Object.assign({},i),{offset:g})),1===g)break t;e=g}}}else g<1&&c.push(Object.assign(Object.assign({},c[u-1]),{offset:1}));return Dn.lastIndex=0,c}function Xn(t,e=0){if(""!==(t=t.trim())){let e=hn(t);return e<0&&(e+=360),e}return e}function zn(t,e){var i;let n=!1;switch(e=e.replace(Fn,Nn),t.css("whiteSpace")){case"nowrap":e=e.replace(/\n/g," "),n=!0;break;case"pre":case"pre-wrap":return!1===(null===(i=t.renderParent)||void 0===i?void 0:i.layoutVertical)&&(e=e.replace(/^\s*?\n/,"")),[e=e.replace(/\n/g,"\\n").replace(/\t/g,Mn).replace(/\s/g,Nn),!0,!1];case"pre-line":return[e=e.replace(/\n/g,"\\n").replace(/[ ]+/g," "),!0,!1]}if(t.onlyChild&&t.htmlElement)e=e.replace(yn.LEADINGSPACE,"").replace(yn.TRAILINGSPACE,"");else{const{previousSibling:i,nextSibling:n}=t;i&&(i.lineBreak||i.blockStatic)&&(e=e.replace(yn.LEADINGSPACE,"")),n&&(n.lineBreak||n.blockStatic)&&(e=e.replace(yn.TRAILINGSPACE,""))}return[e,n,!0]}function Un(t,e,i,n){if(i){const s=i.split(_n.SEPARATOR);return jn.getBackgroundSize(t,s[e%s.length],n)}}function Vn(t,e,i,n){const s=t.css(n[0])||"none";if("none"!==s){let o=nn("outline"!==i?t[n[1]]:Tn(t.style[n[1]]));if("0px"!==o){let r=t.css(n[2])||"initial";switch(r){case"initial":r="rgb(0, 0, 0)";break;case"inherit":case"currentcolor":r=on(t.element,n[2])}"2px"!==o||"inset"!==s&&"outset"!==s||(o="1px"),r=Ji(r,1,!0),r&&(e[i]={width:o,style:s,color:r})}}}function qn(t,e,i){switch(t.css(i)){case"border-box":return!0;case"padding-box":e[i]={top:t.borderTopWidth,right:t.borderRightWidth,bottom:t.borderBottomWidth,left:t.borderLeftWidth};break;case"content-box":e[i]={top:t.borderTopWidth+t.paddingTop,right:t.borderRightWidth+t.paddingRight,bottom:t.borderBottomWidth+t.paddingBottom,left:t.borderLeftWidth+t.paddingLeft}}return!1}const Gn=t=>Rn(t)?t.includes("at ")?/(.+?)?\s*at (.+?)\s*$/.exec(t):[t,t]:null;class jn extends c{static generateId(t,e,i=1){const n=e;let s=i;1===i&&(e+="_"+s);const o=this.ASSETS.ids,r=o.get(t)||[];for(;;){if(!r.includes(e)){r.push(e);break}e=n+"_"+ ++s}return o.set(t,r),e}static insertStoredAsset(t,e,i){const n=jn.STORED[t];if(n&&Cn(i)){let s=this.getStoredName(t,i);if(""===s){In(e)&&(e="__"+e);let t=0;do{if(s=e+(t>0?"_"+t:""),!n.has(s)){n.set(s,i);break}}while(++t)}return s}return""}static getOptionArray(t,e=!1){let i=[],n=!0;const s=t.children,o=s.length;for(let t=0;t<o;t++){const o=s[t];if(!o.disabled||e)switch(o.tagName){case"OPTION":{const t=o.text.trim()||o.value.trim();""!==t&&(n&&!In(t)&&(n=!1),i.push(t));break}case"OPTGROUP":{const[t,s]=this.getOptionArray(o,e);t?(i=i.concat(t),n=!1):s&&(i=i.concat(s));break}}}return n?[void 0,i]:[i]}static isBackgroundVisible(t){return!!t&&("backgroundImage"in t||"borderTop"in t||"borderRight"in t||"borderBottom"in t||"borderLeft"in t)}static parseBackgroundImage(t,e){var i,n,s,o,r;const a=t.backgroundImage;if(""!==a){const l=[];let c,h=0;for(;null!==(c=On.exec(a));){const a=c[0];if(Wn.test(a)||"initial"===a)l.push(a);else{const a="repeating"===c[1],d=c[2],u=c[3],f=Un(t,h,t.css("backgroundSize"),e),g=f||t.actualDimension;let p;switch(d){case"conic":{const n=Gn(u),s={type:d,dimension:g,angle:Xn(u),center:sn((null===(i=n)||void 0===i?void 0:i[2])||"center",g,t.fontSize,f,"",e)};s.colorStops=Hn(t,s,c[4]),p=s;break}case"radial":{const i=Gn(u),l=sn((null===(n=i)||void 0===n?void 0:n[2])||"center",g,t.fontSize,f,"",e),{left:h,top:m}=l,{width:b,height:v}=g;let x="ellipse",y=m,S=m,E=1/0,_=-1/0,k=0,w=0;if(i){const e=null===(s=i[1])||void 0===s?void 0:s.trim();if(e)if(/^circle/.test(e))x="circle";else{let i=1/0;const n=e.split(" "),s=n.length;for(let e=0;e<s;e++)i=Math.min(t.parseUnit(n[e],0===e?"width":"height",!1),i);k=i,w=i,1!==s&&n[0]!==n[1]||(x="circle")}}for(const t of[[0,0],[b,0],[b,v],[0,v]]){const e=Math.round(fn(Math.abs(t[0]-h),Math.abs(t[1]-m)));E=Math.min(e,E),_=Math.max(e,_)}for(const t of[b-h,v-m,h])y=Math.min(t,y),S=Math.max(t,S);const T={type:d,repeating:a,dimension:g,shape:x,center:l,closestSide:y,farthestSide:S,closestCorner:E,farthestCorner:_};if(0===k&&0===w){k=_;const t=(null===(r=null===(o=i)||void 0===o?void 0:o[1])||void 0===r?void 0:r.split(" ").pop())||"";switch(t){case"closest-corner":case"closest-side":case"farthest-side":{const e=T[wn(t)];a?w=e:k=e;break}default:w=_}}T.radius=k,T.radiusExtent=w,T.colorStops=Hn(t,T,c[4]),p=T;break}case"linear":{const{width:e,height:i}=g;let n=180;switch(u){case"to top":n=360;break;case"to right top":n=45;break;case"to right":n=90;break;case"to right bottom":n=135;break;case"to bottom":break;case"to left bottom":n=225;break;case"to left":n=270;break;case"to left top":n=315;break;default:u&&(n=Xn(u,180)||360)}let s=xn(gn(n,e)),o=xn(pn(n,i));if(s!==e&&o!==i&&!un(Math.abs(s),Math.abs(o))){let t;t=n<=90?mn({x:0,y:i},{x:e,y:0}):n<=180?mn({x:0,y:0},{x:e,y:i}):n<=270?mn({x:0,y:0},{x:-e,y:i}):mn({x:0,y:i},{x:-e,y:0});const r=Math.abs(t-n);s=xn(gn(n,vn(r,90-r,fn(e,i))[1])),o=xn(pn(n,vn(90,90-n,s)[0]))}const r={type:d,repeating:a,dimension:g,angle:n,angleExtent:{x:s,y:o}};r.colorStops=Hn(t,r,c[4]),p=r;break}}l.push(p||"initial")}h++}if(On.lastIndex=0,l.length)return l}}static getBackgroundSize(t,e,i){let n=0,s=0;switch(e){case"":case"cover":case"contain":case"100% 100%":case"auto":case"auto auto":case"initial":return;default:{const o=e.split(" "),r=o.length;1===r&&(o[1]=o[0]);for(let e=0;e<r;e++){let r=o[e];"auto"===r&&(r="100%"),0===e?n=t.parseUnit(r,"width",!1,i):s=t.parseUnit(r,"height",!1,i)}break}}return n>0&&s>0?{width:Math.round(n),height:Math.round(s)}:void 0}static isInheritedStyle(t,e){var i;return t.styleElement&&t.style[e]===(null===(i=t.actualParent)||void 0===i?void 0:i.style[e])&&("inherit"===t.cssStyle[e]||""===t.cssInitial(e))}static hasLineBreak(t,e=!1,i=!1){if(t.naturalElements.length)return t.naturalElements.some(t=>t.lineBreak);if(!e&&t.naturalChild){const e=t.element;let n=e.textContent;return i&&(n=n.trim()),n.includes("\n")&&(t.plainText&&ln(e,"whiteSpace","pre","pre-wrap")||/^pre/.test(t.css("whiteSpace")))}return!1}static getStoredName(t,e){const i=jn.STORED[t];if(i)for(const[t,n]of i.entries())if(An(e,n))return t;return""}finalize(t){}reset(){super.reset();const t=jn.STORED;for(const e in t)t[e].clear()}writeRawImage(t,e){var i;null===(i=this.fileHandler)||void 0===i||i.addAsset({pathname:this.controllerSettings.directory.image,filename:t,base64:e})}setBoxStyle(t){var e;if(t.styleElement||t.visibleStyle.background){const i={backgroundSize:t.css("backgroundSize"),backgroundRepeat:t.css("backgroundRepeat"),backgroundPositionX:t.css("backgroundPositionX"),backgroundPositionY:t.css("backgroundPositionY")};if(qn(t,i,"backgroundClip")&&t.has("backgroundOrigin")&&qn(t,i,"backgroundOrigin"),"0px"!==t.css("borderRadius")){const[e,n]=t.css("borderTopLeftRadius").split(" "),[s,o]=t.css("borderTopRightRadius").split(" "),[r,a]=t.css("borderBottomRightRadius").split(" "),[l,c]=t.css("borderBottomLeftRadius").split(" "),h=n||o||a||c?[e,n||e,s,o||s,r,a||r,l,c||l]:[e,s,r,l],d=t.actualWidth>=t.actualHeight,u=h[0];h.every(t=>t===u)&&(h.length="0px"===u||""===u?0:1);const f=h.length;if(f){const e=d?"width":"height";for(let i=0;i<f;i++)h[i]=nn(t.parseUnit(h[i],e,!1));i.borderRadius=h}}t.visibleStyle.borderWidth&&(t.borderTopWidth>0&&Vn(t,i,"borderTop",Zi[0]),t.borderRightWidth>0&&Vn(t,i,"borderRight",Zi[1]),t.borderBottomWidth>0&&Vn(t,i,"borderBottom",Zi[2]),t.borderLeftWidth>0&&Vn(t,i,"borderLeft",Zi[3])),Vn(t,i,"outline",Zi[4]),t.hasResource(de.IMAGE_SOURCE)&&(i.backgroundImage=jn.parseBackgroundImage(t,t.localSettings.screenDimension));let n=t.backgroundColor;""===n&&!t.documentParent.visible&&t.has("backgroundColor")&&(n=t.css("backgroundColor")),""!==n&&(i.backgroundColor=(null===(e=Ji(n))||void 0===e?void 0:e.valueAsRGBA)||""),t.data(jn.KEY_NAME,"boxStyle",i)}}setFontStyle(t){var e;if((t.textElement||t.inlineText)&&(!t.textEmpty||t.visibleStyle.background)||t.inputElement){const i=Ji(t.css("color"));let n=t.css("fontWeight");if(!In(n))switch(n){case"lighter":n="200";break;case"bold":n="700";break;case"bolder":n="900";break;default:n="400"}t.data(jn.KEY_NAME,"fontStyle",{fontFamily:t.css("fontFamily").trim(),fontStyle:t.css("fontStyle"),fontSize:t.fontSize,fontWeight:n,color:(null===(e=i)||void 0===e?void 0:e.valueAsRGBA)||""})}}setValueString(t){var e,i,n,s;const o=t.element;if(o){let r="",a="",l="",c=!0,h=!1;switch(o.tagName){case"INPUT":switch(a=o.value,o.type){case"radio":case"checkbox":{const i=t.companion;!1===(null===(e=i)||void 0===e?void 0:e.visible)&&(a=i.textContent.trim());break}case"submit":""!==a||t.visibleStyle.backgroundImage||(a="Submit");break;case"reset":""!==a||t.visibleStyle.backgroundImage||(a="Reset");break;case"time":""===a&&(l="--:-- --");break;case"date":case"datetime-local":if(""===a){switch((new Intl.DateTimeFormat).resolvedOptions().locale){case"en-US":l="mm/dd/yyyy";break;default:l="dd/mm/yyyy"}"datetime-local"===o.type&&(l+=" --:-- --")}break;case"week":""===a&&(l="Week: --, ----");break;case"month":""===a&&(l="--------- ----");break;case"text":case"password":case"url":case"email":case"search":case"number":case"tel":""===a&&(l=o.placeholder);break;case"file":a=Ki(8)?"Browse...":"Choose File";break;case"range":l=a,a=""}break;case"TEXTAREA":a=o.value;break;case"IFRAME":a=o.src;break;default:{const e=t.textContent;t.plainText||t.pseudoElement?(r=e.trim(),[a,h,c]=zn(t,e.replace(/&/g,"&amp;")),h=!0):t.inlineText?(r=e.trim(),[a,h,c]=zn(t,this.removeExcludedFromText(o,t.sessionId))):0===t.naturalElements.length&&""===(null===(i=e)||void 0===i?void 0:i.trim())&&!t.hasPX("height")&&jn.isBackgroundVisible(t.data(jn.KEY_NAME,"boxStyle"))&&(a=e);break}}if(""!==a){if(c){const e=t.siblingsLeading[0];let i=!1;if(a.length>1)if(void 0===e||e.multiline||e.lineBreak||e.plainText&&yn.TRAILINGSPACE.test(e.textContent))a=a.replace(yn.LEADINGSPACE,"");else if(e.naturalElement){const t=e.textContent,n=t.length;n&&(i=32===t.charCodeAt(n-1))}if(h){const o=!t.lineBreakTrailing&&yn.TRAILINGSPACE.test(a);if(a=!yn.LEADINGSPACE.test(a)||!1!==(null===(n=e)||void 0===n?void 0:n.block)||e.lineBreak||i?a.trim():Nn+a.trim(),o){!1===(null===(s=t.siblingsTrailing.find(t=>!t.excluded||t.lineBreak))||void 0===s?void 0:s.blockStatic)&&(a+=Nn)}}else if(""!==a.trim())a=a.replace(yn.LEADINGSPACE,e&&(e.block||e.lineBreak||i&&e.htmlElement&&e.textContent.length>1||t.multiline&&jn.hasLineBreak(t))?"":Nn),a=a.replace(yn.TRAILINGSPACE,"table-cell"===t.display||t.lineBreakTrailing||t.blockStatic?"":Nn);else if(!t.inlineText)return}""!==a&&t.data(jn.KEY_NAME,"valueString",{key:r,value:a})}""!==l&&t.data(jn.KEY_NAME,"hintString",l)}else if(t.inlineText){const e=t.textContent;e&&t.data(jn.KEY_NAME,"valueString",{key:e,value:e})}}removeExcludedFromText(t,e){const i=t.children.length||"CODE"===t.tagName,n=i?"innerHTML":"textContent";let s=t[n]||"";const o=t.childNodes,r=o.length;for(let t=0;t<r;t++){const a=o[t],l=kn(a,e);if(null===l||!l.textElement||!l.pageFlow||l.positioned||l.pseudoElement||l.excluded||l.dataset.target){if(l){const t=l.actualParent.preserveWhiteSpace;if(i&&l.htmlElement){const e=l.toElementString("outerHTML");l.lineBreak?s=s.replace(t?e:RegExp(`\\s*${e}\\s*`),"\\n"):l.positioned?s=s.replace(e,""):t||(s=s.replace(e,l.pageFlow&&""!==l.textContent.trim()?Nn:""));continue}{const e=l[n];if(Rn(e)){t||(s=s.replace(e,""));continue}}}else if(a instanceof HTMLElement){const t=getComputedStyle(a).getPropertyValue("position");s=s.replace(a.outerHTML,"absolute"!==t&&"fixed"!==t&&""!==a.textContent.trim()?Nn:"")}0===t?s=Pn(s," "):t===r-1&&(s=Bn(s," "))}}return i?s.replace(Sn.ENTITY,(t,e)=>String.fromCharCode(parseInt(e))):s}}jn.KEY_NAME="squared.resource",jn.STORED={strings:new Map,arrays:new Map,fonts:new Map,colors:new Map,images:new Map};const Yn=squared.lib,{formatPercent:$n,formatPX:Qn,isLength:Kn,isPercent:Jn}=Yn.css,{CHAR:Zn,CSS:ts}=Yn.regex,{isNumber:es,trimString:is,withinRange:ns}=Yn.util,ss=et.CSS_GRID,os="[\\d.]+[a-z%]+|auto|max-content|min-content",rs=RegExp(`^(${os})$`),as=RegExp(`\\s*(repeat\\((auto-fit|auto-fill|\\d+), (.+)\\)|\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|${os})\\s*`,"g"),ls=RegExp(`\\s*(\\[([\\w\\-\\s]+)\\]|minmax\\(([^,]+), ([^)]+)\\)|fit-content\\(([\\d.]+[a-z%]+)\\)|${os})\\s*`,"g"),cs=/^([\w-]+)-(start|end)$/,hs=/[\d.]+[a-z%]+|auto|max-content|min-content/,ds=/minmax\(([^,]+), ([^)]+)\)/,us=/fit-content\(([\d.]+[a-z%]+)\)/,fs=/\[([\w\-\s]+)\]/,gs=/^span/;function ps(t,e){const i=t.repeat,n=[],s=[],o=e.length;for(let t=0;t<o;t++)i[t]?s.push(e[t]):n.push(e[t]);const r=t.length,a=r-n.length,l=s.length,c=Array(r);for(let t=0;t<r;t++)if(i[t]){for(let e=0,i=0;e<a;t++,e++,i++)i===l&&(i=0),c[t]=s[i];t--}else c[t]=n.shift();return c}function ms(t,e){const i=t.unit;if(1===i.length&&(t.autoFill||t.autoFit)){const n=t.unitMin;let s=0;if([i[0],n[0]].forEach(t=>{Jn(t)?s=Math.max(parseFloat(t)/100*e,s):Kn(t)&&(s=Math.max(parseFloat(t),s))}),s>0)return t.length=Math.floor(e/(s+t.gap)),t.unit=ps(t,i),t.unitMin=ps(t,n),!0}return!1}function bs(t){let e=0;for(const i of t)i&&e++;return e}function vs(t,e,i,n,s){let o=0,r=0,a=1;const l=n.length;for(let t=0;t<l;t++){const e=n[t];ts.PX.test(e)?o+=parseFloat(e):Es(e)?r+=parseFloat(e):Jn(e)&&(a-=parseFloat(e)/100)}if(a<1&&r>0){const c=(t*a-(i-1)*e-s.reduce((t,e)=>t+Math.max(0,e),0)-o)/r;if(c>0)for(let t=0;t<l;t++){const e=n[t];Es(e)&&(n[t]=Qn(parseFloat(e)*c))}}}function xs(t,e){if(0===t.length)for(let i=0;i<e;i++)t[i]="1fr"}function ys(t,e,i){if(i){for(let n=0,s=-1,o=0;n<t;n++)if(0===i[n]){if(-1===s&&(s=n),++o===e)return s}else s=-1;return-1}return 0}function Ss(t){const e=t.length;for(let i=0;i<e;i++){const e=t[i];for(let t=0;t<e.length;t++)if(0===e[t])return i}return Math.max(0,e-1)}const Es=t=>/fr$/.test(t),_s=(t,e,i)=>Kn(e)?Qn(t.parseUnit(e,0===i?"height":"width")):e;class ks extends Yi{static isAligned(t){return t.hasHeight&&/^space-|center|flex-end|end/.test(t.css("alignContent"))}static isJustified(t){return(t.blockStatic||t.hasWidth)&&/^space-|center|flex-end|end|right/.test(t.css("justifyContent"))}static createDataAttribute(t,e,i,n,s){return{children:[],rowData:[],rowSpanMultiple:[],rowDirection:!s.includes("column"),dense:s.includes("dense"),templateAreas:{},row:ks.createDataRowAttribute(),column:ks.createDataRowAttribute(),emptyRows:[],alignItems:t,alignContent:e,justifyItems:i,justifyContent:n}}static createDataRowAttribute(){return{length:0,gap:0,unit:[],unitMin:[],unitTotal:[],repeat:[],auto:[],autoFill:!1,autoFit:!1,name:{},fixedWidth:!1,flexible:!1,frTotal:0}}is(t){return t.gridElement}condition(t){return t.length>0}processNode(t){const e=ks.createDataAttribute(t.css("alignItems"),t.css("alignContent"),t.css("justifyItems"),t.css("justifyContent"),t.css("gridAutoFlow")),{column:i,dense:n,row:s,rowDirection:o}=e,[r,a,l,c]=o?[0,1,2,3]:[1,0,3,2],h=[],d=[],u=[];s.gap=t.parseUnit(t.css("rowGap"),"height",!1),i.gap=t.parseUnit(t.css("columnGap"),"width",!1),[t.cssInitial("gridTemplateRows",!0),t.cssInitial("gridTemplateColumns",!0),t.css("gridAutoRows"),t.css("gridAutoColumns")].forEach((e,n)=>{if(""!==e&&"none"!==e&&"auto"!==e){const o=0===n?s:i,{name:r,repeat:a,unit:l,unitMin:c}=o;let h,d=1;for(;null!==(h=as.exec(e));){const e=h[1].trim();switch(n){case 0:case 1:if("["===e.charAt(0))for(const t of h[4].split(Zn.SPACE)){let e=r[t];void 0===e&&(e=[],r[t]=e),e.push(d)}else if(/^repeat/.test(e)){let e=1;switch(h[2]){case"auto-fit":o.autoFit=!0;break;case"auto-fill":o.autoFill=!0;break;default:e=parseInt(h[2])||1}if(e>0){const i=[];let s;for(;null!==(s=ls.exec(h[3]));){const e=s[1];let o;if(null!==(o=fs.exec(e))){const t=o[1];void 0===r[t]&&(r[t]=[]),i.push({name:t})}else null!==(o=ds.exec(e))?i.push({unit:_s(t,o[2],n),unitMin:_s(t,o[1],n)}):null!==(o=us.exec(e))?i.push({unit:_s(t,o[1],n),unitMin:"0px"}):null!==(o=hs.exec(e))&&i.push({unit:_s(t,o[0],n)})}if(i.length)for(let t=0;t<e;t++)for(const t of i){const{name:e,unit:i}=t;e?r[e].push(d):i&&(l.push(i),c.push(t.unitMin||""),a.push(!0),d++)}ls.lastIndex=0}}else/^minmax/.test(e)?(l.push(_s(t,h[6],n)),c.push(_s(t,h[5],n)),a.push(!1),d++):/^fit-content/.test(e)?(l.push(_s(t,h[7],n)),c.push("0px"),a.push(!1),d++):rs.test(e)&&(l.push(_s(t,e,n)),c.push(""),a.push(!1),d++);break;case 2:case 3:(2===n?s:i).auto.push(Kn(e)?Qn(t.parseUnit(e,2===n?"height":"width")):e)}}as.lastIndex=0}}),t.sort(o?(t,e)=>{const{left:i,top:n}=t.linear,{left:s,top:o}=e.linear;return ns(n,o)?ns(i,s)?0:i<s?-1:1:n<o?-1:1}:(t,e)=>{const{left:i,top:n}=t.linear,{left:s,top:o}=e.linear;return ns(i,s)?ns(n,o)?0:n<o?-1:1:i<s?-1:1});let f,g=!1,p=!1;if(!t.has("gridTemplateAreas")&&t.every(t=>"auto"===t.css("gridRowStart")&&"auto"===t.css("gridColumnStart"))){const[n,r,a,l,c]=o?["top","bottom",2,1,3]:["left","right",3,0,2];let h,d=0,f=0,m=0;o?i.autoFill&&(g=ms(i,t.actualWidth)):s.autoFill&&(p=ms(s,t.actualHeight)),t.each((t,i)=>{(void 0===h||t.linear[n]>=h.linear[r]||f>0&&f===m)&&(m=Math.max(f,m),d++,f=1);const s=t.css("gridRowEnd"),g=t.css("gridColumnEnd");let p=1,b=1;if(gs.test(s)?p=parseInt(s.split(" ")[1]):es(s)&&(p=parseInt(s)-d),gs.test(g)?b=parseInt(g.split(" ")[1]):es(g)&&(b=parseInt(g)-f),1===f&&m>0){let t=!1;do{const i=Array(m-1).fill(1);for(const t of u){const e=t.placement;if(e[a]>d)for(let t=e[l];t<e[c];t++)i[t-1]=0}for(let e=0,n=0,s=0;e<i.length;e++)if(i[e]){if(0===n&&(s=e),++n===b){f=s+1,t=!0;break}}else n=0;t||(e.emptyRows[d-1]=i,d++)}while(!t)}u[i]=o?{outerCoord:t.linear.top,placement:[d,f,d+p,f+b],rowSpan:p,columnSpan:b}:{outerCoord:t.linear.left,placement:[f,d,f+b,d+p],rowSpan:p,columnSpan:b},f+=b,h=t})}else{const n=e.templateAreas;let r;g=ms(i,t.actualWidth),p=ms(s,t.actualHeight),t.css("gridTemplateAreas").split(/"[\s\n]+"/).forEach((t,e)=>{"none"!==t&&is(t.trim(),'"').split(Zn.SPACE).forEach((t,i)=>{if("."!==t.charAt(0)){const s=n[t];s?(s.rowSpan=e-s.rowStart+1,s.columnSpan=i-s.columnStart+1):n[t]={rowStart:e,rowSpan:1,columnStart:i,columnSpan:1}}})}),t.each((t,e)=>{const a=[t.css("gridRowStart"),t.css("gridColumnStart"),t.css("gridRowEnd"),t.css("gridColumnEnd")],l=[0,0,0,0];let c=-1,h=-1;if(Object.keys(n).length)for(let t=0;t<4;t++){const e=a[t];let i=n[e];if(i)switch(t){case 0:l[0]=i.rowStart+1;break;case 1:l[1]=i.columnStart+1;break;case 2:l[2]=i.rowStart+i.rowSpan+1;break;case 3:l[3]=i.columnStart+i.columnSpan+1}else{const s=cs.exec(e);if(s&&(i=n[s[1]],i))if("start"===s[2])switch(t){case 0:case 2:l[t]=i.rowStart+1;break;case 1:case 3:l[t]=i.columnStart+1}else switch(t){case 0:case 2:l[t]=i.rowStart+i.rowSpan+1;break;case 1:case 3:l[t]=i.columnStart+i.columnSpan+1}}}if(0===l[0]||0===l[1]||0===l[2]||0===l[3]){const t=(t,e,i,n)=>{if(es(t)){const i=parseInt(t);if(i>0)return l[e]=i,!0;if(i<0&&e>=2){const t=e-2;return l[l[t]>0?e:t]=i+n+2,!0}}else if(gs.test(t)){const s=parseInt(t.split(" ")[1]);if(s===n&&r)if(o){if(!i){const t=r[2];t>0&&0===l[0]&&(l[0]=t)}}else if(i){const t=r[3];t>0&&0===l[1]&&(l[1]=t)}const d=l[e-2];switch(e){case 0:{const t=a[2];if(es(t)){const e=parseInt(t);l[0]=e-s,l[2]=e}break}case 1:{const t=a[3];if(es(t)){const e=parseInt(t);l[1]=e-s,l[3]=e}break}case 2:case 3:d>0&&(l[e]=d+s)}return i?-1===c&&(c=s):-1===h&&(h=s),!0}return!1};let e,n;for(let o=0;o<4;o++){const r=a[o];if("auto"!==r&&0===l[o]){const d=o%2==0,u=d?s:i;if(!t(r,o,d,Math.max(1,u.unit.length))){const t=r.split(" ");1===t.length?(t[1]=t[0],t[0]="1"):es(t[0])&&(d?e?c=parseInt(t[0])-parseInt(e[0]):e=t:n?h=parseInt(t[0])-parseInt(n[0]):n=t);const i=u.name[t[1]];if(i){const e=parseInt(t[0]);e<=i.length&&(l[o]=i[e-1]+(t[1]===a[o-2]?1:0))}}}}}void 0===r&&(0===l[0]&&(l[0]=1),0===l[1]&&(l[1]=1));const[d,f,g,p]=l;-1===c?c=d>0&&g>0?g-d:1:d>0&&0===g&&(l[2]=d+c),-1===h?h=f>0&&p>0?p-f:1:f>0&&0===p&&(l[3]=d+h),0===l[2]&&l[0]>0&&(l[2]=l[0]+c),0===l[3]&&l[1]>0&&(l[3]=l[1]+h),u[e]={outerCoord:o?t.linear.top:t.linear.left,placement:l,rowSpan:c,columnSpan:h},r=l})}{const[e,n]=o?[i,t.box.top]:[s,t.box.left];let r=e.unit,a=1,l=0;for(const t of u)if(t){const[e,i,s]=o?[t.columnSpan,1,3]:[t.rowSpan,0,2],r=t.placement;r.some(t=>t>0)&&(a=Math.max(a,e,r[i],r[s]-1)),ns(t.outerCoord,n)&&(l+=e)}const c=r.length;if(f=Math.max(a,l,o&&!g||!o&&!p?c:0),e.length=f,c<f)if(e.autoFill||e.autoFit)0===c&&(r.push("auto"),e.unitMin.push(""),e.repeat.push(!0)),r=ps(e,r),e.unit=r,e.unitMin=ps(e,e.unitMin);else{const t=e.auto,i=t.length;if(i){let e=0;for(;r.length<f;)e===i&&(e=0),r.push(t[e])}}else(e.autoFit||e.autoFill&&t.blockStatic&&(o&&!t.hasWidth&&!t.hasPX("maxWidth",!1)||!o&&!t.hasHeight))&&(r.length=f);let h=1,d=0,m=0;for(const t of r)Jn(t)?h-=parseFloat(t)/100:Es(t)?d+=parseFloat(t):"auto"===t&&m++;if(e.flexible=h<1||d>0,h<1)if(d>0){const t=r.length;for(let e=0;e<t;e++){const t=r[e];Es(t)&&(r[e]=h*(parseFloat(t)/d)+"fr")}}else if(1===m){const t=r.findIndex(t=>"auto"===t);-1!==t&&(r[t]=$n(h))}}if(t.each((t,i)=>{const{placement:s,rowSpan:g,columnSpan:p}=u[i],[m,b]=o?[g,p]:[p,g];for(;0===s[0]||0===s[1];){const t=s.slice(0);if(0===t[r]){let e=h.length;for(let i=n?0:Ss(d),s=0,o=-1;i<e;i++){if(-1!==ys(f,b,d[i])){if(0===s&&(o=i,e=Math.max(e,i+m)),++s===m){t[r]=o+1;break}}else s=0,o=-1,e=h.length}}if(0===t[r])s[r]=h.length+1,0===s[a]&&(s[a]=1);else if(0===t[a]){0===t[l]&&(t[l]=t[r]+m);const e=[],i=t[r]-1,n=t[l]-1;for(let t=i;t<n;t++){const i=h[t];if(void 0===i)e.push([[0,-1]]);else{if(!(bs(i)+b<=f))break;{const t=[];let n=0;for(let e=0,s=-1;e<f;e++){const o=i[e];void 0===o&&(-1===s&&(s=e),n++),(o||e===f-1)&&(n>=b&&t.push([s,s+n]),s=-1,n=0)}if(!t.length)break;e.push(t)}}}const s=e.length;if(s){const o=e[0];if(-1===o[0][1])t[a]=1;else if(s===n-i)if(s>1)t:for(const i of o)for(let n=i[0];n<i[1];n++)for(let i=1;i<s;i++){const s=e[i],o=s.length;for(let e=0;e<o;e++){const i=s[e];if(n>=i[0]&&(-1===i[1]||n+b<=i[1])){t[a]=n+1;break t}}}else t[a]=o[0][0]+1}}const e=t[r];if(e>0){const i=t[a];i>0&&(s[r]=e,s[a]=i)}}if(0===s[l]&&(s[l]=s[r]+m),0===s[c]&&(s[c]=s[a]+b),((t,e,i)=>{if(e.every(t=>t>0)){for(let s=e[r]-1;s<e[l]-1;s++){let o=h[s];void 0===o&&(o=[],h[s]=o);let r=d[s],l=e[a]-1;if(void 0===r){if(r=Array(i).fill(0),!n)for(let t=0;t<l;t++)r[t]=1;d[s]=r}for(;l<e[c]-1;l++){let e=o[l];void 0===e&&(e=[],o[l]=e),r[l]=1,e.push(t)}}return!0}return!1})(t,s,f)){const[i,r,a,l]=s,c=i-1,h=a-i,u=r-1;if(!n){const t=o?c:u;if(t>0){const e=d[t-1];for(let t=0;t<f;t++)e[t]=1}}if(h>1){const t=e.rowSpanMultiple;for(let e=c;e<c+h;e++)t[e]=!0}t.data(ss,"cellData",{rowStart:c,rowSpan:h,columnStart:u,columnSpan:l-r})}}),h.length){let n;if(o)n=h,e.rowData=h;else{n=e.rowData;const t=h.length;for(let e=0;e<t;e++){const t=h[e],i=t.length;for(let s=0;s<i;s++){let i=n[s];void 0===i&&(i=[],n[s]=i),i[e]=t[s]}}}const r=o?s.unitTotal:i.unitTotal,a=e.children,l=i.unit.length;for(const t of n){const e=t.length;for(let i=0;i<e;i++){const e=t[i];let n=r[i]||0;if(e){let t=0;for(const i of e)a.includes(i)||(t=Math.max(t,o?i.bounds.height:i.bounds.width),a.push(i));n+=t}r[i]=n}}if(a.length===t.length){const{gap:r,unit:c}=s,{gap:h,unit:d}=i,u=Math.max(c.length,n.length),f=Array(u).fill(0),g=Array(l).fill(0),p=new Set;s.length=u,i.length=l;for(let t=0;t<u;t++){const i=n[t],s=c[t];if(i)for(let n=0;n<l;n++){const s=i[n];if(s){for(const e of s)if(!p.has(e)){const{columnSpan:i,rowSpan:s}=e.data(ss,"cellData"),o=t+s-1;if(n+i-1<l-1&&e.modifyBox(4,h),o<u-1&&e.modifyBox(8,r),1===s){const i=e.bounds.height,n=f[t];e.hasHeight?n<0?i>Math.abs(n)&&(f[t]=i):f[t]=Math.max(i,n):i>Math.abs(n)&&(f[t]=-i)}if(1===i){const t=e.bounds.width,i=g[n];e.hasWidth?i<0?t>Math.abs(i)&&(g[n]=t):g[n]=Math.max(t,i):t>Math.abs(i)&&(g[n]=-t)}p.add(e)}}else o||(e.emptyRows[n]=[1/0])}else f[t]=parseFloat(s)||0,o&&(e.emptyRows[t]=[1/0])}o?(t.hasPX("width",!1)&&(i.fixedWidth=!0,i.flexible=!1,vs(t.actualWidth,h,l,d,g)),t.hasHeight&&!ks.isAligned(t)&&xs(s.unit,u)):(t.hasPX("height",!1)&&(s.fixedWidth=!0,s.flexible=!1,vs(t.actualHeight,r,u,c,f)),t.hasWidth&&!ks.isJustified(t)&&xs(i.unit,l)),t.retain(a),t.cssSort("zIndex"),t.cssTry("display","block")&&(t.each(t=>{const{width:e,height:i}=t.boundingClientRect;t.data(ss,"boundsData",Object.assign(Object.assign({},t.bounds),{width:e,height:i}))}),t.cssFinally("display")),t.data(ss,"mainData",e)}}}}const{withinRange:ws}=squared.lib.util,Ts=et.FLEXBOX;class Cs extends Yi{static createDataAttribute(t,e){const i=t.css("flexWrap"),n=t.css("flexDirection"),s=/^row/.test(n);return{directionRow:s,directionColumn:!s,directionReverse:/reverse$/.test(n),wrap:/^wrap/.test(i),wrapReverse:"wrap-reverse"===i,alignContent:t.css("alignContent"),justifyContent:t.css("justifyContent"),rowCount:0,columnCount:0,children:e}}is(t){return t.flexElement}condition(t){return t.length>0}processNode(t){const e=this.controller,[i,n]=t.partition(t=>t.pageFlow&&!t.renderExclude),s=Cs.createDataAttribute(t,i);if(t.cssTry("align-items","start")){if(t.cssTry("justify-items","start")){for(const t of i)if(t.cssTry("align-self","start")){if(t.cssTry("justify-self","start")){const{width:e,height:i}=t.boundingClientRect;t.data(Ts,"boundsData",Object.assign(Object.assign({},t.bounds),{width:e,height:i})),t.cssFinally("justify-self")}t.cssFinally("align-self")}t.cssFinally("justify-items")}t.cssFinally("align-items")}if(s.wrap){const[o,r,a,l]=s.directionRow?["top","left","right","intersectY"]:["left","top","bottom","intersectX"];i.sort((t,e)=>{const i=t.linear,n=e.linear;return t[l](e.bounds,"bounds")?ws(i[r],n[r])?0:i[r]<n[r]?-1:1:i[o]<n[o]?-1:1});let c=i[0],h=[c];const d=[h];let u=i.length;for(let t=1;t<u;t++){const e=i[t];c[l](e.bounds,"bounds")?h.push(e):(c=e,h=[e],d.push(h))}t.clear();let f,g=0;if(u=d.length,u>1){const i=t.box[a];for(let n=0;n<u;n++){const s=d[n],o=e.createNodeGroup(s[0],s,t,!0);o.containerIndex=n;const r=o.unsafe("box");r&&(r[a]=i),o.addAlign(128),g=Math.max(s.length,g)}f=u}else{const e=d[0];t.retain(e);for(let t=0;t<e.length;t++)e[t].containerIndex=t;g=e.length,f=g}for(let t=0;t<n.length;t++)n[t].containerIndex=f+t;t.concat(n),t.sort(),s.directionRow?(s.rowCount=u,s.columnCount=g):(s.rowCount=g,s.columnCount=u)}else{if(i.some(t=>0!==t.flexbox.order)){const[t,e]=s.directionReverse?[-1,1]:[1,-1];i.sort((i,n)=>{const s=i.flexbox.order,o=n.flexbox.order;return s===o?0:s>o?t:e})}s.directionRow?(s.rowCount=1,s.columnCount=t.length):(s.rowCount=t.length,s.columnCount=1)}t.data(Ts,"mainData",s)}}const As=squared.lib,{formatPX:Is,isLength:Rs,isPercent:Bs}=As.css,{aboveRange:Ps,belowRange:Ns,withinRange:Ms}=As.util,Ls=et.GRID;function Ws(t,e){const i=e.linear.top;for(const e of t){const t=e.findIndex(t=>{const e=t.linear.top;return Ms(i,e)||i>e&&i<t.linear.bottom});if(-1!==t)return t}return-1}class Fs extends Yi{static createDataCellAttribute(){return{rowSpan:0,columnSpan:0,index:-1,cellStart:!1,cellEnd:!1,rowEnd:!1,rowStart:!1,block:!1}}condition(t){if(t.length>1&&!t.layoutElement&&!t.has("listStyle")){if("table"===t.display)return t.every(t=>"table-row"===t.display&&t.every(t=>"table-cell"===t.display))||t.every(t=>"table-cell"===t.display);{let e=0,i=0;for(const n of t){if(!n.pageFlow||n.visibleStyle.background||!n.blockStatic||n.autoMargin.leftRight||n.autoMargin.left)return!1;n.length>1&&e++,"list-item"!==n.display||n.has("listStyleType")||i++}if(i===t.length)return!0;if(e)return t.every(t=>t.length>0&&He.linearData(t.children).linearX)}}return!1}processNode(t){var e,i,n,s;const o=[],r=[],a={};for(const e of t)for(const t of e)if(t.visible){const e=Math.floor(t.linear.left);let i=a[e];void 0===i&&(i=[],a[e]=i),i.push(t)}const l=Object.keys(a),c=l.length;if(c){let i=-1;for(let t=0;t<c;t++){const e=a[l[t]];if(0===t)i=c;else if(i!==e.length){i=-1;break}}if(-1!==i)for(let t=0;t<c;t++)r.push(a[l[t]]);else{const i=[];for(let t=0;t<c;t++){const e=a[l[t]],n=e.length;if(0===t&&0===n)return;i[t]=0===t?0:i[t-1];for(let s=0;s<n;s++){const o=e[s],{left:a,right:l}=o.linear;if(0===t||Ps(a,i[t-1])){let e=r[t];if(void 0===e&&(e=[],r[t]=e),0===t||r[0].length===n)e[s]=o;else{const t=Ws(r,o);if(-1===t)return;e[t]=o}}else{const t=r.length-1;if(r[t]){let e=1/0,i=-1/0;if(r[t].forEach(t=>{const{left:n,right:s}=t.linear;n<e&&(e=n),s>i&&(i=s)}),Math.floor(a)>Math.ceil(e)&&Math.floor(l)>Math.ceil(i)){const e=Ws(r,o);if(-1!==e)for(let i=r.length-1;i>=0;i--){const n=r[i];if(n){void 0===n[e]&&(r[t].length=0);break}}}}}i[t]=Math.max(l,i[t])}}const n=i.length;for(let t=0,e=-1;t<n;t++)void 0===r[t]?-1===e?e=t-1:t===n-1&&(i[e]=i[t]):-1!==e&&(i[e]=i[t-1],e=-1);for(let t=0;t<r.length;t++)(null===(e=r[t])||void 0===e?void 0:e.length)?o.push(i[t]):r.splice(t--,1);const s=r.reduce((t,e)=>Math.max(t,e.length),0);for(let t=0;t<s;t++){const e=r.length;for(let i=0;i<e;i++){const e=r[i];void 0===e[t]&&(e[t]={spacer:1})}}o.push(t.box.right)}}const h=r.length;if(h>1&&r[0].length===t.length){const e=[],a=new Set;for(let t=0,i=0;t<h;t++){const n=r[t];let s=0;for(let l=0,c=0;l<n.length;l++){const d=n[l],u=n.length;let f=e[l];if(void 0===f&&(f=[],e[l]=f),d.spacer)1===d.spacer&&s++;else{const e=Object.assign(Fs.createDataCellAttribute(),d.data(Ls,"cellData"));let g=1,p=1+s;for(let e=t+1;e<h;e++){const t=r[e][l];if(1!==t.spacer)break;p++,t.spacer=2}if(1===p)for(let t=l+1;t<u;t++){const e=n[t];if(1!==e.spacer)break;g++,e.spacer=2}if(o.length){const i=Math.min(t+(p-1),o.length-1);for(const t of d.actualParent.naturalChildren)if(!a.has(t)&&t.visible&&!t.rendered){const n=t.linear;if(Ps(n.left,d.linear.right)&&Ns(n.right,o[i])){let i=e.siblings;void 0===i&&(i=[],e.siblings=i),i.push(t)}}}e.rowSpan=g,e.columnSpan=p,e.rowStart=0==c++,e.rowEnd=p+t===h,e.cellStart=0===i,e.cellEnd=e.rowEnd&&l===u-1,e.index=t,s=0,d.data(Ls,"cellData",e),f.push(d),a.add(d)}}}t.each(t=>t.hide()),t.clear();for(const o of e){let e=!0,r=!1;for(const t of o){const i=t.css("width");if(Bs(i))r=!0;else if(!Rs(i)){e=!1;break}}const a=o.length;if(a>1&&e&&r){const t=o[0].data(Ls,"cellData");if(1===(null===(i=t)||void 0===i?void 0:i.rowSpan)){let e=(null===(n=t.siblings)||void 0===n?void 0:n.slice(0))||[];for(let t=1;t<a;t++){const i=o[t],n=i.data(Ls,"cellData");if(1!==(null===(s=n)||void 0===s?void 0:s.rowSpan)){e.length=0;break}e.push(i),n.siblings&&(e=e.concat(n.siblings))}e.length&&(t.block=!0,t.columnSpan=h,t.siblings=e,o.length=1)}}for(const i of o)i.parent=t,i.percentWidth&&!e&&i.css("width",Is(i.bounds.width),!0)}t.tableElement&&"collapse"===t.css("borderCollapse")&&(t.modifyBox(32),t.modifyBox(64),t.modifyBox(128),t.modifyBox(256)),t.data(Ls,"columnCount",h)}}}const{convertListStyle:Os}=squared.lib.css,Ds=t=>t.backgroundImage&&!t.backgroundRepeat;class Hs extends Yi{static createDataAttribute(){return{ordinal:"",imageSrc:"",imagePosition:""}}condition(t){const e=t.length;if(e){const i=new Set;let n=!0,s=!0,o=!0,r=!0,a=!1;const l=t.children;for(let t=0;t<e;t++){const c=l[t];if(("list-item"===c.display&&("none"!==c.css("listStyleType")||c.innerBefore)||c.marginLeft<0&&"none"===c.css("listStyleType")&&Ds(c.visibleStyle))&&(a=!0),(o||r)&&(c.floating?(i.add(c.float),r=!1):0===t||t===e-1||c.blockStatic||l[t-1].blockStatic&&l[t+1].blockStatic?o=!1:(o=!1,r=!1)),c.blockStatic||(n=!1),c.inlineVertical||(s=!1),!(n||s||r||o))return!1}return a&&(n||s||o&&1===i.size||r)}return!1}processNode(t){const e="OL"===t.tagName;let i=e&&t.toElementInt("start")||1;t.each(t=>{const n=Hs.createDataAttribute(),s=t.css("listStyleType"),o="list-item"===t.display;if(o||""!==s&&"none"!==s||Ds(t.visibleStyle)){if(t.has("listStyleImage"))n.imageSrc=t.css("listStyleImage");else{e&&o&&"LI"===t.tagName&&(i=t.toElementInt("value")||i);let r=Os(s,i);if(""===r)switch(s){case"disc":r="";break;case"square":r="";break;case"none":{let e="",i="";t.visibleStyle.backgroundRepeat||(e=t.backgroundImage,i=t.css("backgroundPosition")),""!==e&&"none"!==e&&(n.imageSrc=e,n.imagePosition=i,t.exclude({resource:de.IMAGE_SOURCE}));break}default:r=""}else r+=".";n.ordinal=r}o&&i++}t.data(et.LIST,"mainData",n)})}}const Xs=squared.lib,{assignRect:zs}=Xs.dom,{convertFloat:Us,filterArray:Vs,withinRange:qs}=Xs.util;const{getBackgroundPosition:Gs,resolveURL:js}=squared.lib.css,Ys=/^0[a-z%]+|left|start|top/;const $s=squared.lib,{formatPercent:Qs,formatPX:Ks,getInheritedStyle:Js,getStyle:Zs,isLength:to,isPercent:eo}=$s.css,{getNamedItem:io}=$s.dom,{maxArray:no}=$s.math,{isNumber:so,replaceMap:oo,withinRange:ro}=$s.util,ao=et.TABLE,lo=/rgba\(0, 0, 0, 0\)|transparent/;function co(t,e,i){i.percent=Math.round(e.bounds.width/t.box.width*100)+"%",i.expand=!0}const ho=t=>t.css("width",Ks(t.bounds.width),!0);class uo extends Yi{static createDataAttribute(t){return{layoutType:0,rowCount:0,columnCount:0,layoutFixed:"fixed"===t.css("tableLayout"),borderCollapse:"collapse"===t.css("borderCollapse"),expand:!1}}processNode(t){var e,i,n;const s=uo.createDataAttribute(t),o=[];let r,a,l=[];function c(t){if(t){for(const e of t.cascade())switch(e.tagName){case"TH":case"TD":e.inherit(t,"styleMap"),e.unsetCache("visibleStyle")}l=l.concat(t.children),t.hide()}}t.each(t=>{switch(t.tagName){case"THEAD":void 0===a?a=t:t.hide();break;case"TBODY":o.push(t);break;case"TFOOT":void 0===r?r=t:t.hide()}}),c(a);for(const t of o)l=l.concat(t.children),t.hide();c(r);const[h,d]=s.borderCollapse?[0,0]:oo(t.css("borderSpacing").split(" "),(e,i)=>t.parseUnit(e,0===i?"width":"height")),u=h>1?Math.round(h/2):h,f=d>1?Math.round(d/2):d,g=t.element.querySelector("COLGROUP"),p=[],m=[],b=[],v=[],x=l.length;let y=0;for(let e=0;e<x;e++){const i=l[e];p[e]=h;const n=b[e]||[];b[e]=n,i.each((i,o)=>{const r=i.element,a=r.rowSpan;let l=r.colSpan,c=-1;for(let t=0;-1===c;t++)void 0===n[t]&&(c=t);for(let t=e;t<e+a;t++){void 0===b[t]&&(b[t]=[]);for(let e=c,n=0;e<c+l;e++){if(void 0!==b[t][e]){l=n;break}b[t][e]=i,n++}}if(!i.hasPX("width")){const t=io(r,"width");eo(t)?i.css("width",t,!0):so(t)&&i.css("width",Ks(parseFloat(t)),!0)}if(!i.hasPX("height")){const t=io(r,"height");eo(t)?i.css("height",t):so(t)&&i.css("height",Ks(parseFloat(t)))}if(""===i.cssInitial("verticalAlign")&&i.css("verticalAlign","middle",!0),!i.visibleStyle.backgroundImage&&!i.visibleStyle.backgroundColor)if(g){const{backgroundImage:t,backgroundColor:e}=Zs(g.children[o+1]);t&&"none"!==t&&i.css("backgroundImage",t,!0),e&&!lo.test(e)&&i.css("backgroundColor",e,!0)}else{let t=Js(r,"backgroundImage",/none/,"TABLE");""!==t&&i.css("backgroundImage",t,!0),t=Js(r,"backgroundColor",lo,"TABLE"),""!==t&&i.css("backgroundColor",t,!0)}function y(t,e){const n=t+"Style";i.ascend({including:e}).some(e=>{if(e.has(n)){const s=t+"Color",o=t+"Width";return i.css(n,e.css(n)),i.css(s,e.css(s)),i.css(o,e.css(o),!0),i.css("border","inherit"),!0}return!1})}switch(i.tagName){case"TD":{const t=i.parent;0===i.borderTopWidth&&y("borderTop",t),0===i.borderRightWidth&&y("borderRight",t),0===i.borderBottomWidth&&y("borderBottom",t),0===i.borderLeftWidth&&y("borderLeft",t);break}case"TH":""===i.cssInitial("textAlign")&&i.css("textAlign","center"),0===i.borderTopWidth&&y("borderTop",t),0===i.borderBottomWidth&&y("borderBottom",t)}const S=i.cssInitial("width"),E=void 0===v[c]||"auto"===v[c],_=i.bounds.width;if(0===e||E||!s.layoutFixed)if(""===S||"auto"===S)void 0===v[c]?(v[c]=S||"0px",m[c]=0):e===x-1&&E&&0===m[c]&&(m[c]=_);else{const t=eo(S),e=to(v[c]);(E||_<m[c]||_===m[c]&&(e&&t||t&&eo(v[c])&&i.parseUnit(S)>=i.parseUnit(v[c])||e&&to(S)&&i.parseUnit(S)>i.parseUnit(v[c])))&&(v[c]=S),(E||1===r.colSpan)&&(m[c]=_)}(i.length||i.inlineText)&&(p[e]+=_+h),u>0&&(i.modifyBox(16,0===c?h:u),i.modifyBox(4,0===o?u:h)),f>0&&(i.modifyBox(2,0===e?d:f),i.modifyBox(8,e+a<x?f:d)),i.data(ao,"cellData",{colSpan:l,rowSpan:a})}),i.hide(),y=Math.max(y,n.length)}t.hasPX("width",!1)&&v.some(t=>eo(t))&&oo(v,(t,e)=>{if("auto"===t){const t=m[e];if(t>0)return Ks(t)}return t});let S=!1;if(v.every(t=>eo(t))){if(v.reduce((t,e)=>t+parseFloat(e),0)>1){let t=100;oo(v,e=>{const i=parseFloat(e);return t<=0?e="0px":t-i<0&&(e=Qs(t/100)),t-=i,e})}t.hasWidth||(s.expand=!0),S=!0}else if(v.every(t=>to(t))){const e=v.reduce((t,e)=>t+parseFloat(e),0);if(t.hasWidth)if(e<t.width)oo(v,t=>"0px"!==t?parseFloat(t)/e*100+"%":t);else if(e>t.width&&(t.css("width","auto"),!s.layoutFixed))for(const e of t.cascade())e.css("width","auto");s.layoutFixed&&!t.hasPX("width")&&t.css("width",Ks(t.bounds.width))}let E=0;s.layoutType=(()=>{if(v.length>1){if(E=v.reduce((t,e)=>t+(eo(e)?parseFloat(e):0),0),s.layoutFixed&&v.reduce((t,e)=>t+(to(e)?parseFloat(e):0),0)>=t.actualWidth)return 4;if(v.length>1&&v.some(t=>eo(t))||v.every(t=>to(t)&&"0px"!==t))return 3;if(v.every(t=>t===v[0])){if(t.cascadeSome(t=>t.hasHeight))return s.expand=!0,3;if("auto"===v[0]){if(t.hasWidth)return 3;{const e=t.cascade(t=>"TD"===t.tagName);return e.length&&e.every(t=>ro(t.bounds.width,e[0].bounds.width))?0:3}}if(t.hasWidth)return 2}if(v.every(t=>"auto"===t||to(t)&&"0px"!==t))return t.hasWidth||(s.expand=!0),1}return 0})();const _=t.find(t=>"CAPTION"===t.tagName);t.clear(),_&&(_.hasWidth||(_.textElement?_.hasPX("maxWidth")||_.css("maxWidth",Ks(_.bounds.width)):_.bounds.width>no(p)&&ho(_)),_.cssInitial("textAlign")||_.css("textAlign","center"),_.data(ao,"cellData",{colSpan:y}),_.parent=t);const k=t.hasWidth;for(let e=0;e<x;e++){const i=b[e],n=i.length;for(let e=0;e<n;){const n=i[e],o=n.data(ao,"cellData");if(o.placed){e+=o.colSpan;continue}const r=v[e];if(r)switch(s.layoutType){case 0:break;case 3:"auto"===r?E>=1?(ho(n),o.exceed=!k,o.downsized=!0):co(t,n,o):eo(r)?S?(o.percent=r,o.expand=!0):ho(n):to(r)&&parseInt(r)>0?n.bounds.width>=parseInt(r)?(ho(n),o.expand=!1,o.downsized=!1):s.layoutFixed?(co(t,n,o),o.downsized=!0):(ho(n),o.expand=!1):(n.hasPX("width",!1)&&!n.percentWidth||ho(n),o.expand=!1);break;case 2:n.css("width","0px");break;case 1:"auto"===r?n.css("width","0px"):(s.layoutFixed?o.downsized=!0:ho(n),o.expand=!1);break;case 4:to(r)||n.hide()}o.placed=!0,n.parent=t,e+=o.colSpan}if(n<y){const t=i[n-1].data(ao,"cellData");t&&(t.spaceSpan=y-n)}}if(s.borderCollapse){const s=t.css("borderTopColor"),o=t.css("borderTopStyle"),r=t.css("borderTopWidth"),a=t.css("borderRightColor"),l=t.css("borderRightStyle"),c=t.css("borderRightWidth"),h=t.css("borderBottomColor"),d=t.css("borderBottomStyle"),u=t.css("borderBottomWidth"),f=t.css("borderLeftColor"),g=t.css("borderLeftStyle"),p=t.css("borderLeftWidth");let m=!1,v=!1,S=!1,E=!1;for(let t=0;t<x;t++)for(let _=0;_<y;_++){const k=b[t][_];if("visible"===(null===(e=k)||void 0===e?void 0:e.css("visibility"))){if(0===t&&(k.borderTopWidth<parseInt(r)?k.cssApply({borderTopColor:s,borderTopStyle:o,borderTopWidth:r},!0):m=!0),t>=0&&t<x-1){const e=b[t+1][_];"visible"===(null===(i=e)||void 0===i?void 0:i.css("visibility"))&&e!==k&&(k.borderBottomWidth>e.borderTopWidth?e.css("borderTopWidth","0px",!0):k.css("borderBottomWidth","0px",!0))}if(t===x-1&&(k.borderBottomWidth<parseInt(u)?k.cssApply({borderBottomColor:h,borderBottomStyle:d,borderBottomWidth:u},!0):S=!0),0===_&&(k.borderLeftWidth<parseInt(p)?k.cssApply({borderLeftColor:f,borderLeftStyle:g,borderLeftWidth:p},!0):E=!0),_>=0&&_<y-1){const e=b[t][_+1];"visible"===(null===(n=e)||void 0===n?void 0:n.css("visibility"))&&e!==k&&(k.borderRightWidth>=e.borderLeftWidth?e.css("borderLeftWidth","0px",!0):k.css("borderRightWidth","0px",!0))}_===y-1&&(k.borderRightWidth<parseInt(c)?k.cssApply({borderRightColor:a,borderRightStyle:l,borderRightWidth:c},!0):v=!0)}}(m||v||S||E)&&t.cssApply({borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px",borderLeftWidth:"0px"},!0)}s.rowCount=x,s.columnCount=y,t.data(ao,"mainData",s)}}const fo=squared.lib,{isLength:go}=fo.css,{convertFloat:po}=fo.util;var mo;const bo=squared.lib,{formatPX:vo}=bo.css,{hasBit:xo}=bo.util,yo="html"===(null===(mo=document.doctype)||void 0===mo?void 0:mo.name);function So(t,e,i,n=0){let s;switch(e){case 2:s=t.actualRect("top")-i;break;case 16:s=t.actualRect("left")-i;break;case 8:s=i-t.actualRect("bottom");break;default:s=0}s-=n,s>0&&(t.renderAs||t.outerMostWrapper).modifyBox(e,s)}function Eo(t,e,i){if(ko(e,i)){const[n,s,o,r]=i?["marginTop","borderTopWidth","paddingTop",2]:["marginBottom","borderBottomWidth","paddingBottom",8];if(0===t[s])if(0===t[o]){for(;yo&&0===e[n]&&0===e[s]&&0===e[o]&&Co(e);){const t=i?e.firstStaticChild:e.lastStaticChild;if(!ko(t,i))break;e=t}const a=t[n],l=e[n];if(a>0||l>0){const s=e.bounds.height;let o=!1;if(!yo&&0===a&&l>0&&""===e.cssInitial(n))o=!0;else{const n=a>=l;if(0===s&&n&&e.textEmpty&&0===e.extensions.length)e.hide();else if(1!==e.getBox(r)[0])n?o=!0:t.documentBody?(_o(t,r),i&&(t.bounds.top=0,t.unset("box"),t.unset("linear"))):(1!==t.getBox(r)[0]&&(t.modifyBox(r),t.modifyBox(r,l)),o=!0);else{const i=e.registerBox(r);if(i){const e=i.getBox(r)[1];e>0&&(t.modifyBox(r),t.modifyBox(r,e),i.modifyBox(r,-e))}}}o&&(_o(e,r),0!==s||e.every(t=>t.floating)||_o(e,i?8:2))}}else if(0===e[n]&&0===e[s]&&Co(e)){let r=!0;for(;;){const a=i?e.firstStaticChild:e.lastStaticChild;if(!a||0!==a[n]||0!==a[s]||a.visibleStyle.background||!Co(a))break;{const n=a[o];if(n>0){n>=t[o]?t.modifyBox(i?32:128):r&&t.modifyBox(i?32:128,-n);break}ko(a,i)||(r=!1),e=a}}}}}function _o(t,e){if(0===t.getBox(e)[0])t.modifyBox(e);else{const i=t.registerBox(e);if(i){const n=t[tt.get(e)];i.modifyBox(e,-n,!1)}}}function ko(t,e,i=!1){if(t&&!t.lineBreak){let n=!1;if(t.blockStatic)n=!0;else if(!t.floating)switch(t.display){case"table":case"list-item":n=!0,i=!1;break;default:if(e){const e=t.firstStaticChild;n=ko(e)&&Ao(e)}else{const e=t.lastStaticChild;n=ko(e)&&Io(e)}}return n&&(!i||void 0===e||t.bounds.height>0)}return!1}function wo(t,e,i,n){const s=t.linear.top;if(n){const t=Math.max(n.linear.top,e.linear.bottom);if(t<s)return s-t-i}return s-e.linear.bottom-i}const To=(t,e)=>t.css("minHeight",vo(Math.max(e,t.hasPX("minHeight",!1)?t.parseUnit(t.css("minHeight")):0))),Co=t=>!t.layoutElement&&!t.tableElement&&"FIELDSET"!==t.tagName,Ao=t=>!t.hasPX("height")&&0===t.paddingBottom&&0===t.borderBottomWidth&&Co(t),Io=t=>!t.hasPX("height")&&0===t.borderTopWidth&&0===t.paddingTop&&Co(t);const Ro={Accessibility:class extends Yi{},CssGrid:ks,Flexbox:Cs,Grid:Fs,List:Hs,Relative:class extends Yi{is(t){return t.positionRelative||0!==t.toFloat("verticalAlign",0,!0)}condition(){return!0}processNode(){return{include:!0}}postOptimize(t){var e,i,n;const s=t.renderParent,o=Us(t.verticalAlign);let r=t,a=0,l=0,c=0,h=0;if(t.hasPX("top")?a=t.top:c=t.bottom,t.hasPX("left")?h=t.left:l=t.right,s.layoutHorizontal&&s.support.positionRelative&&0===t.renderChildren.length&&(0!==a||0!==c||0!==o)){const e=this.application;r=t.clone(e.nextId,!0,!0),r.baselineAltered=!0,t.hide(!0),this.cache.append(r,!1);const i=new Ue(s,r,r.containerType,r.alignmentType),n=s.renderChildren.findIndex(e=>e===t);if(-1!==n&&(i.renderIndex=n+1),e.addLayout(i),t.parseUnit(t.css("textIndent"))<0){const e=t.documentId;s.renderEach(t=>{t.alignSibling("topBottom")===e?t.alignSibling("topBottom",r.documentId):t.alignSibling("bottomTop")===e&&t.alignSibling("bottomTop",r.documentId)})}if(t.baselineActive&&!t.baselineAltered)for(const e of s.horizontalRows||[s.renderChildren])if(e.includes(t)){const i=Vs(e,e=>e.positionRelative&&e.length>0&&0!==Us(t.verticalAlign)),n=i.length;if(n){i.sort((t,e)=>{const i=t.linear.top,n=e.linear.top;return qs(i,n)?0:i<n?-1:1});for(let e=0;e<n;e++){const n=i[e];0===e?t.modifyBox(2,Us(n.verticalAlign)):n.modifyBox(2,n.linear.top-i[0].linear.top),n.css("verticalAlign","0px",!0)}}break}}else if(t.naturalElement&&t.positionRelative){const o=t.bounds,r=0!==a||0!==c,d=0!==h||0!==l;let u,f=!1;for(const g of t.actualParent.naturalElements){if(g===t){if(f){if(r&&s.layoutVertical){const i=zs(t.boundingClientRect);0!==a?a-=i.top-o.top:(null===(e=u)||void 0===e?void 0:e.positionRelative)&&u.has("top")?c+=o.bottom-i.bottom:c+=i.bottom-o.bottom}if(d&&s.layoutHorizontal&&""===t.alignSibling("leftRight")){const e=zs(t.boundingClientRect);0!==h?h-=e.left-o.left:(null===(i=u)||void 0===i?void 0:i.positionRelative)&&u.has("right")?l+=o.right-e.right:l+=e.right-o.right}}else if(s.layoutVertical)if(0!==a)(null===(n=u)||void 0===n?void 0:n.blockStatic)&&u.positionRelative&&g.blockStatic&&(a-=u.top);else if(0!==c){1===g.getBox(2)[0]&&(c-=g.marginTop)}break}g.positionRelative&&g.renderParent===s&&(f=!0),g.pageFlow&&(u=g)}}0!==o&&r.modifyBox(2,-1*o),0!==a?r.modifyBox(2,a):0!==c&&r.modifyBox(2,-1*c),0!==h?r.autoMargin.left?r.modifyBox(4,-1*h):r.modifyBox(16,h):0!==l&&r.modifyBox(16,-1*l),r!==t&&r.setBoxSpacing()}},Sprite:class extends Yi{is(t){return 0===t.length&&t.hasWidth&&t.hasHeight}condition(t){const e=t.backgroundImage;if(""!==e&&(this.included(t.element)||!t.dataset.use)){const i=this.resource.getRawData(e)||this.resource.getImage(js(e));if(i){const e=t.actualDimension,n=t.css("backgroundPositionX"),s=t.css("backgroundPositionY"),o=Gs(n+" "+s,e,t.fontSize,void 0,"",t.localSettings.screenDimension),r=(o.left<0||Ys.test(n))&&i.width>e.width,a=(o.top<0||Ys.test(s))&&i.height>e.height;if((r||a)&&(r||0===o.left)&&(a||0===o.top))return t.data(et.SPRITE,"mainData",{image:i,position:o}),!0}}return!1}},Table:uo,VerticalAlign:class extends Yi{is(){return!0}condition(t){let e=!1,i=0,n=0,s=0;for(const o of t){if(o.inlineVertical){const t=po(o.verticalAlign);0!==t&&(e=!0),isNaN(s)||(0===s?s=t:s!==t&&(s=NaN)),n++}else s=NaN;(o.positionStatic||o.positionRelative&&o.length)&&i++}return e&&isNaN(s)&&n>1&&i===t.length&&He.linearData(t.children).linearX}processNode(t){return t.each(t=>{(t.inlineVertical&&go(t.verticalAlign)||t.imageElement||t.svgElement)&&(t.baselineAltered=!0)}),{include:!0}}postConstraints(t){var e;if(t.layoutHorizontal)for(const i of t.horizontalRows||[t.renderChildren]){const t=[];let n,s=1/0;for(const e of i){const i=e.linear.top;e.inlineVertical&&i<=s&&(i<s&&(t.length=0),t.push(e),s=i),e.baselineActive&&(n=e)}if(t.length){const s=t[0],o=s.linear.top;for(const s of i)s!==n&&(s.inlineVertical&&(t.includes(s)?(s.imageElement||s.svgElement)&&(null===(e=n)||void 0===e?void 0:e.documentId)===s.alignSibling("baseline")&&s.modifyBox(2,n.linear.top-s.linear.top):(go(s.verticalAlign)||void 0===n)&&(s.modifyBox(2,s.linear.top-o),s.baselineAltered=!0)),s.baselineAltered&&s.css("verticalAlign","0px",!0));n&&(n.modifyBox(2,n.linear.top-o+Math.min(0,s.parseUnit(s.cssInitial("verticalAlign"),"height"))),n.baselineAltered=!0)}}else t.each(t=>t.baselineAltered=!1)}},WhiteSpace:class extends Yi{afterBaseLayout(){var t,e,i,n;const s=new Set;for(const n of this.cacheProcessing)if(n.naturalElement&&n.naturalElements.length&&!n.layoutElement&&!n.tableElement){const o=n.naturalChildren;if(o[0].documentBody)continue;const r=n.actualParent,a=ko(n)&&!r.layoutElement,l=n.pageFlow;let c,h;const d=o.length;for(let r=0;r<d;r++){const u=o[r];if(u.pageFlow&&(a&&(l&&!u.floating?u.bounds.height>0||1===d||ko(u,0===r||r!==d-1&&void 0,!0)?(void 0===c&&(c=u),h=u):0===u.bounds.height&&n.layoutVertical&&""===u.alignSibling("topBottom")&&""===u.alignSibling("bottomTop")&&(0===u.renderChildren.length||u.every(t=>!t.visible))&&(!u.pseudoElement||u.pseudoElement&&(1===d||r>0||o.every((t,e)=>0===e||t.floating||t.pseudoElement&&""===t.textContent.trim())))&&u.hide():h=void 0),r>0&&ko(u,!1))){const o=u.previousSiblings({floating:!1}),r=o.length;if(r){let l=!1;const h=o[r-1];if(ko(h,!0)){let i=h.marginBottom,n=u.marginTop;if(h.excluded&&!u.excluded){const t=Math.min(i,h.marginTop);if(t<0){u.modifyBox(2,Math.abs(t)<n?t:void 0),s.add(h.id);continue}}else if(!h.excluded&&u.excluded){const t=Math.min(n,u.marginBottom);if(t<0){h.modifyBox(8,Math.abs(t)<i?t:void 0),s.add(u.id);continue}}let o=!1;if(a){let t=h;for(;Ao(t);){const e=t.lastStaticChild;if(ko(e,!0)&&1!==e.getBox(8)[0]){const n=e.marginBottom;if(_o(e,8),n>i)i=n,h.setCacheValue("marginBottom",i),o=!0;else if(0===n&&0===i){t=e;continue}}break}for(t=u;Io(t);){const e=t.firstStaticChild;if(ko(e,!1)&&1!==e.getBox(2)[0]){const i=e.marginTop;if(_o(e,2),i>n)n=i,u.setCacheValue("marginTop",n),l=!0;else if(0===i&&0===n){t=e;continue}}break}}i>0&&(n>0?n<=i?l&&xo(u.overflow,64)||(l&&(u.setCacheValue("marginTop",0),l=!1),_o(u,2)):o&&xo(h.overflow,64)||(o&&(h.setCacheValue("marginBottom",0),o=!1),_o(h,8)):0===h.bounds.height&&_o(h,8)),l&&(null===(t=u.registerBox(2))||void 0===t||t.setCacheValue("marginTop",n)),o&&(null===(e=h.registerBox(8))||void 0===e||e.setCacheValue("marginBottom",i))}if(!l&&o.length>1&&o[0].floating&&(n.layoutVertical||(null===(i=u.renderParent)||void 0===i?void 0:i.layoutVertical))){const t=o[0].linear.top-u.linear.top;if(u===c){if(t>0){const e=u.marginTop;e>0&&(t<e?u.modifyBox(2,-t,!1):u.modifyBox(2))}}else t<0&&u.modifyBox(2,t,!1)}}}}if(l&&!xo(n.overflow,64)&&"FIELDSET"!==n.tagName&&(c&&Eo(n,c,!0),h&&(Eo(n,h,!1),h.marginTop<0))){const t=h.bounds.height+h.marginBottom+h.marginTop;t<0&&n.modifyBox(128,t,!1)}}for(const t of this.application.processing.excluded)if(t.lineBreak&&!t.lineBreakTrailing&&!s.has(t.id)){let e=!1;const i=t.previousSiblings({floating:!1});if(i.length){const o=t.actualParent,r=t.nextSiblings({floating:!1});if(r.length){let a,l=i.pop(),c=r.pop(),h=0;if(l.rendered&&c.rendered){const r=l.inlineStatic&&c.inlineStatic;if(r&&0===i.length){s.add(t.id);continue}if(!l.multiline&&l.has("lineHeight")){const t=Math.floor((l.lineHeight-l.bounds.height)/2);t>0&&(h+=t)}if(!c.multiline&&c.has("lineHeight")){const t=Math.round((c.lineHeight-c.bounds.height)/2);t>0&&(h+=t)}r&&(a=i[0],1===i.length&&(a=a.lineBreak?t:void 0),null===(n=a)||void 0===n||n.setBounds(!1));let d=l.renderParent,u=c.renderParent;for(;d&&d!==o;)l=d,d=l.renderParent;for(;u&&u!==o;)c=u,u=c.renderParent;const f=wo(c,l,h,a);f>=1&&(c.visible?(c.modifyBox(2,f),e=!0):l.visible&&(l.modifyBox(8,f),e=!0))}else{const t=wo(c,l,h);t>0&&((c.lineBreak||c.excluded)&&o.lastChild===c?(o.modifyBox(128,t),e=!0):(l.lineBreak||l.excluded)&&o.firstChild===l&&(o.modifyBox(32,t),e=!0))}}else if(o.visible&&!o.preserveWhiteSpace&&"CODE"!==o.tagName){if(o.documentRoot||0!==o.ascend({condition:t=>t.documentRoot,attr:"outerWrapper"}).length){if(r.length){const t=r[r.length-1],e=(t.lineBreak||t.excluded?t.linear.bottom:t.linear.top)-o.box.top;0!==e&&(t.rendered||o.visibleStyle.background?o.modifyBox(32,e):o.hasHeight||To(o,e))}}else{const t=i[i.length-1],e=0===t.bounds.height&&t.length?He.outerRegion(t):t.linear,n=o.box.bottom-(t.lineBreak||t.excluded?e.top:e.bottom);0!==n&&(t.rendered||o.visibleStyle.background?o.modifyBox(128,n):o.hasHeight||To(o,n))}e=!0}if(e){for(const t of i)s.add(t.id);for(const t of r)s.add(t.id)}}}}afterConstraints(){var t,e,i,n;for(const s of this.cacheProcessing)if(s.naturalChild&&s.pageFlow&&s.styleElement&&s.inlineVertical&&!s.positioned&&!s.actualParent.layoutElement){const o=s.outerMostWrapper.renderParent;if(!1===(null===(t=o)||void 0===t?void 0:t.hasAlign(4))){if(s.blockDimension&&!s.floating)if(o.layoutVertical){const t=o.renderChildren,n=t.findIndex(t=>t===s);if(-1!==n){if(!s.lineBreakLeading){const i=t[n-1];(null===(e=i)||void 0===e?void 0:e.pageFlow)&&So(s,2,i.actualRect("bottom"),i.getBox(8)[1])}if(!s.lineBreakTrailing){const e=t[n+1];(null===(i=e)||void 0===i?void 0:i.pageFlow)&&e.styleElement&&!e.inlineVertical&&So(s,8,e.actualRect("top"),e.getBox(2)[1])}}}else{const t=o.horizontalRows,e=t=>t.pageFlow&&t.blockDimension&&!t.floating;let i;if(t)t:{let n=-1/0;const o=t.length;for(let r=0;r<o;r++){const o=t[r],a=o.length;for(let t=0;t<a;t++)if(s===o[t]){r>0?So(s,2,n):i=o;break t}for(const t of o)e(t)&&(n=Math.max(t.actualRect("bottom"),n));if(n===-1/0)break}}else o.layoutHorizontal&&(i=o.renderChildren);if(i){const t=s.actualParent;if(t){const n=s.actualRect("top");let o=-1/0;for(const n of t.naturalChildren){if(i.includes(n))break;if(n.lineBreak)o=-1/0;else{if(n.excluded)continue;e(n)&&(o=Math.max(n.actualRect("bottom"),o))}}o!==-1/0&&n>o&&So(s,2,o)}}}if(!o.layoutVertical&&!s.alignParent("left")){const t=s.alignSibling("leftRight");if(""!==t){const e=o.renderChildren.find(e=>e.documentId===t);(null===(n=e)||void 0===n?void 0:n.inlineVertical)&&So(s,16,e.actualRect("right"))}else{let t=s;for(;;){const e=t.siblingsLeading;if(e.length&&!e.some(t=>t.lineBreak||t.excluded&&t.blockStatic)){const i=e[0];if(i.inlineVertical)So(s,16,i.actualRect("right"));else if(i.floating){t=i;continue}}break}}}}}}}},Bo={constant:it,enumeration:fe};t.Application=q,t.ApplicationUI=class extends q{constructor(t,i,n,s,o){super(t,i,n,s,o),this.session={cache:new e,excluded:new e,extensionMap:new Map,active:[],documentRoot:[],targetQueue:new Map},this.builtInExtensions={},this.extensions=[],this._layouts=[];const r=this.controllerHandler.localSettings;this._localSettings=r,this._excluded=r.unsupported.excluded}finalize(){var t,e;const{controllerHandler:i,session:n}=this,s=n.cache,o=this.extensions,r=this._layouts;for(const[t,e]of n.targetQueue.entries()){const i=this.resolveTarget(t.dataset.target);i?(t.render(i),this.addLayoutTemplate(i,t,e)):void 0===t.renderParent&&s.remove(t)}const a=s.children,l=a.length,c=Array(l);let h=0;for(let t=0;t<l;t++){const e=a[t];e.renderParent&&e.visible&&(e.hasProcedure(ue.LAYOUT)&&e.setLayout(),e.hasProcedure(ue.ALIGNMENT)&&e.setAlignment(),c[h++]=e)}c.length=h,i.optimize(c);for(const t of o)for(const e of t.subscribers)t.postOptimize(e);for(const t of c)t.hasResource(de.BOX_SPACING)&&t.setBoxSpacing();for(const t of o)t.beforeCascade();const d=this._localSettings.layout.baseTemplate;for(const s of n.documentRoot){const n=s.node;if(n.documentRoot&&0===n.renderChildren.length&&!n.inlineText&&n.naturalElements.every(t=>t.documentRoot))continue;const o=null===(t=n.renderParent)||void 0===t?void 0:t.renderTemplates;o&&this.saveDocument(s.layoutName,d+i.cascadeDocument(o,0),n.dataset.pathname,(null===(e=n.renderExtension)||void 0===e?void 0:e.some(t=>t.documentBase))?0:void 0)}this.resourceHandler.finalize(r),i.finalize(r);for(const t of o)t.afterFinalize();ei("__squared.pseudo"),this.closed=!0}copyToDisk(t,e){super.copyToDisk(t,e,this.layouts)}appendToArchive(t){super.appendToArchive(t,this.layouts)}saveToArchive(t){super.saveToArchive(t,this.layouts)}reset(){super.reset();for(const t of this.rootElements)t.dataset.iteration="";const t=this.session;t.cache.reset(),t.excluded.reset(),t.extensionMap.clear(),t.documentRoot.length=0,t.targetQueue.clear(),this._layouts.length=0}conditionElement(t,e){if(!this._excluded.has(t.tagName)){if(this.controllerHandler.visibleElement(t,e)||this._cascadeAll)return!0;if(!e){switch(Ye(t).position){case"absolute":case"fixed":return this.isUseElement(t)}let e=t.parentElement;for(;e;){if("none"===Ye(e).display)return this.isUseElement(t);e=e.parentElement}const i=this.controllerHandler,n=t.children,s=n.length;for(let t=0;t<s;t++)if(i.visibleElement(n[t]))return!0;return this.isUseElement(t)}}return!1}insertNode(t,e,i){var n;if(!ti(t)){if(this.conditionElement(t,i))return this.controllerHandler.applyDefaultStyles(t),this.createNode({parent:e,element:t,append:!1});{const i=this.createNode({parent:e,element:t,append:!1});return i.visible=!1,i.excluded=!0,i}}if(mi(t.textContent)||(null===(n=e)||void 0===n?void 0:n.preserveWhiteSpace)&&("PRE"!==e.tagName||0===e.element.childElementCount)){this.controllerHandler.applyDefaultStyles(t);const i=this.createNode({parent:e,element:t,append:!1});return e&&(i.cssApply(e.textStyle),i.fontSize=e.fontSize),i}}saveDocument(t,e,i,n){if(ci(e)){const s={pathname:i?di(i,"/"):this._localSettings.layout.pathName,filename:t,content:e,index:n},o=this._layouts;void 0!==n&&n>=0&&n<o.length?o.splice(n,0,s):o.push(s)}}renderNode(t){return 0===t.itemCount?this.controllerHandler.renderNode(t):this.controllerHandler.renderNodeGroup(t)}addLayout(t){const e=t.renderType;if(li(e,512)&&(li(e,8)?t=this.processFloatHorizontal(t):li(e,16)&&(t=this.processFloatVertical(t))),0!==t.containerType){const e=this.renderNode(t);if(e)return this.addLayoutTemplate(e.parent||t.parent,t.node,e,t.renderIndex)}return!1}addLayoutTemplate(t,e,i,n=-1){if(i){if(e.renderExclude)e.hide(),e.excluded=!0;else if(e.renderParent){let s=t.renderTemplates;void 0===s&&(s=[],t.renderTemplates=s),n>=0&&n<t.renderChildren.length?(t.renderChildren.splice(n,0,e),s.splice(n,0,i)):(t.renderChildren.push(e),s.push(i))}else this.session.targetQueue.set(e,i);return!0}return!1}createNode(t){const e=this.processing,{element:i,parent:n,children:s,replace:o}=t,r=new this.Node(this.nextId,e.sessionId,i,this.controllerHandler.afterInsertNode);if(n&&(r.depth=n.depth+1,!n.naturalElement||i&&null!==i.parentElement||(r.actualParent=n),o&&n.appendTry(o,r,!1)&&(o.parent=r,r.innerWrapped=o)),s)for(const t of s)t.parent=r;return!1!==t.append&&e.cache.append(r,void 0!==s),r}createCache(t){const e=this.createRootNode(t);if(e){const t=this.controllerHandler,i=this._cache,n=e.parent,s={},o=new Set,r=[];let a=!1;e.documentBody&&(n.visible=!1,n.exclude({resource:de.FONT_STYLE|de.VALUE_STRING,procedure:ue.ALL,section:he.EXTENSION}),i.append(n)),e.documentParent=n;for(const t of i)if(t.styleElement){const e=t.element;if(t.length){const i=t.cssInitial("textAlign");switch(i){case"center":case"right":case"end":vi(s,e,t.id,"text-align","left",i)}}if(t.positionRelative)for(const i of qe)t.hasPX(i)&&(vi(s,e,t.id,i,"auto",t.css(i)),a=!0);"rtl"===t.dir&&(e.dir="ltr",o.add(e))}!a&&o.size&&(a=!0);for(const t of this.processing.excluded)t.pageFlow||t.cssTry("display","none");n.setBounds();for(const t of i)t.pseudoElement?r.push(t):(t.setBounds(void 0===s[t.id]&&!a),e.styleText&&(t.textBounds=Ze(e.element)));if(r.length){const t=[];for(const e of r){const i=e.actualParent.element;let n,s=i.id;e.pageFlow&&(""===s&&(s="__squared_"+Math.round(Math.random()*(new Date).getTime()),i.id=s),n=$e(`#${s+gi(e.element,e.sessionId)} { display: none !important; }`)),e.cssTry("display",e.display)&&t.push({item:e,id:s,parentElement:i,styleElement:n})}for(const e of t)e.item.setBounds(!1);for(const e of t){const{item:t,parentElement:i,styleElement:n}=e;if(/^__squared_/.test(e.id)&&(i.id=""),n)try{document.head.removeChild(n)}catch(t){}t.cssFinally("display")}}for(const t of this.processing.excluded)t.lineBreak||(t.setBounds(),t.saveAsInitial()),t.pageFlow||t.cssFinally("display");for(const t of i){if(t.styleElement){const e=t.element,i=s[t.id];if(i)for(const t in i)e.style.setProperty(t,i[t]);o.has(e)&&(e.dir="rtl")}t.saveAsInitial()}return t.evaluateNonStatic(e,i),t.sortInitialCache(),!0}return!1}afterCreateCache(t){const e=t.dataset,{filename:i,iteration:n}=e,s=ci(i)&&i.replace(RegExp(`\\.${this._localSettings.layout.fileExtension}$`),"")||t.id||"document_"+this.length,o=(n?parseInt(n):-1)+1,r=si(o>1?s+"_"+o:s,!0);e.iteration=""+o,e.layoutName=r,this.setBaseLayout(),this.setConstraints(),this.setResources(r)}resolveTarget(t){if(ci(t)){for(const e of this._cache)if(e.elementId===t||e.controlId===t)return e;for(const e of this.session.cache)if(e.elementId===t||e.controlId===t)return e}}toString(){var t;return(null===(t=this._layouts[0])||void 0===t?void 0:t.content)||""}cascadeParentNode(t,e,i){var n;const s=this.insertNode(t);if(s&&("none"!==s.display||0===e||s.outerExtensionElement)){if(s.depth=e,0===e){this._cache.append(s);const t=this.extensionManager;for(const e of s.extensions){if(null===(n=t.retrieve(e))||void 0===n?void 0:n.cascadeAll){this._cascadeAll=!0;break}}}const o=this.controllerHandler;if(o.preventNodeCascade(t))return s;const r=this.processing.sessionId,a=this.createPseduoElement(t,"::before",r),l=this.createPseduoElement(t,"::after",r),c=t.childNodes,h=c.length,d=Array(h),u=Array(t.childElementCount);let f=!0,g=0,p=0;for(let t=0;t<h;t++){const n=c[t];let r;n===a?(r=this.insertNode(a,void 0,"::before"),r&&(s.innerBefore=r,r.textEmpty||(r.inlineText=!0),f=!1)):n===l?(r=this.insertNode(l,void 0,"::after"),r&&(s.innerAfter=r,r.textEmpty||(r.inlineText=!0),f=!1)):"#"===n.nodeName.charAt(0)?ti(n)&&(r=this.insertNode(n,s)):o.includeElement(n)&&(i&&_i(n.dataset.use,i).some(t=>t.init(n)),this.rootElements.has(n)?(r=this.insertNode(n),r&&(r.documentRoot=!0,r.visible=!1,r.excluded=!0),f=!1):(r=this.cascadeParentNode(n,e+1,i),!r||r.excluded&&"WBR"!==r.tagName||(f=!1)),r&&(u[p++]=r)),r&&(r.childIndex=g,r.naturalChild=!0,d[g++]=r)}d.length=g,u.length=p,s.naturalChildren=d,s.naturalElements=u,this.cacheNodeChildren(s,d,f),this.userSettings.createQuerySelectorMap&&p>0&&(s.queryMap=this.createQueryMap(u))}return s}cacheNodeChildren(t,e,i){const n=e.length;if(n){const s=this._cache;let o=[],r=[];if(n>1){let a=e[0],l=!1;for(let c=0,h=0;c<n;c++){const d=e[c];d.excluded?this.processing.excluded.append(d):d.plainText&&i||(d.containerIndex=h++,d.parent=t,s.append(d)),d.pageFlow&&(d.floating&&(l=!0),c>0&&(r.push(d),d.lineBreak&&(e[c-1].lineBreakTrailing=!0)),d.excluded||(d.siblingsLeading=o,a.siblingsTrailing=r,o=[],r=[],a=d),c<n-1&&(o.push(d),d.lineBreak&&(e[c+1].lineBreakLeading=!0))),d.actualParent=t}a.siblingsTrailing=r,t.floatContainer=l}else{const i=e[0];i.excluded?this.processing.excluded.append(i):i.plainText||(i.siblingsLeading=o,i.siblingsTrailing=r,i.parent=t,i.containerIndex=0,s.append(i)),i.actualParent=t}}else i=!t.textEmpty;t.inlineText=i}createPseduoElement(t,e,i){var n;let s=fi(t,"styleMap"+e,i),o=0;if("Q"===t.tagName){void 0===s&&(s={},pi(t,"styleMap"+e,i,s));let r=s.content;if("string"==typeof r&&""!==r||(r=Ye(t,e).getPropertyValue("content")||("::before"===e?"open-quote":"close-quote"),s.content=r),/-quote$/.test(r)){let e=t.parentElement;for(;"Q"===(null===(n=e)||void 0===n?void 0:n.tagName);)o++,e=e.parentElement}}if(s){let n=s.content;if(n){if(""===di(n,'"').trim()&&0===ni(s.width)&&0===ni(s.height)&&("absolute"===s.position||"fixed"===s.position||s.clear&&"none"!==s.clear)){let t=!0;for(const e in s)if(/(Width|Height)$/.test(e)){const i=s[e];if(Qe(i,!0)&&0!==ni(i)){t=!1;break}}if(t)return}if("inherit"===n){let e=t;do{if(n=Ye(e).getPropertyValue("content"),"inherit"!==n)break;e=e.parentElement}while(e)}const r=Ye(t);void 0===s.fontFamily&&(s.fontFamily=r.getPropertyValue("font-family")),void 0===s.fontSize&&(s.fontSize=r.getPropertyValue("font-size")),void 0===s.fontWeight&&(s.fontWeight=r.getPropertyValue("font-weight")),void 0===s.color&&(s.color=r.getPropertyValue("color")),void 0===s.display&&(s.display="inline");let a=/^inline/.test(s.display)?"span":"div",l="";switch(n){case"normal":case"none":case"initial":case"inherit":case"no-open-quote":case"no-close-quote":case'""':break;case"open-quote":"::before"===e&&(l=o%2==0?"":"");break;case"close-quote":"::after"===e&&(l=o%2==0?"":"");break;default:if(/^url\(/.test(n)){l=Ke(n);const t=ai(l,".").toLowerCase(),e=this._localSettings.supported.imageFormat;"*"===e||e.includes(t)?a="img":l=""}else{let s,o=!1;for(;null!==(s=bi.exec(n));){const n=s[1];if(n)l+=Je(t,n.trim());else if(s[2]||s[5]){const n="counter"===s[2],[o,a]=n?[s[3],s[4]||"decimal"]:[s[6],s[8]||"decimal"],c=(yi(t,o,e,i)||0)+(xi(r.getPropertyValue("counter-reset"),o)||0),h=[];let d,u=t,f=c,g=!1;const p=(t,e)=>{0===h.length?f+=t:(g||e)&&(h[h.length-1]+=t)},m=t=>{if(void 0===xi(Ye(t).getPropertyValue("counter-reset"),o)){const n=t.children,s=n.length;for(let t=0;t<s;t++){const s=n[t];if("__squared.pseudo"!==s.className){let t=yi(s,o,e,i);t&&p(t,!0);const n=Ye(s);if(t=xi(n.getPropertyValue("counter-increment"),o),t&&p(t,!1),t=xi(n.getPropertyValue("counter-reset"),o),void 0!==t)return;m(s)}}}};for(;;){if(g=!1,u.previousElementSibling)u=u.previousElementSibling,m(u);else{if(!u.parentElement)break;u=u.parentElement,g=!0}if("__squared.pseudo"!==u.className){const t=yi(u,o,e,i);t&&p(t,!0);const s=Ye(u),r=xi(s.getPropertyValue("counter-increment"),o)||0;r&&p(r,!1);const a=xi(s.getPropertyValue("counter-reset"),o);if(void 0!==a){if(void 0===d&&(f+=a),d=u,n)break;g&&h.push((t||0)+a)}}}if(d){if(!n&&h.length>1){h.reverse(),h.splice(1,1);for(const t of h)l+=Ge(a,t,!0)+s[7]}}else f=c;l+=Ge(a,f,!0)}else s[9]&&(l+=s[9]);o=!0}o||(l=n),bi.lastIndex=0}}if(l||'""'===n){const o=function(t,e="span",i=-1){const n=document.createElement(e);return n.className="__squared.pseudo",n.style.setProperty("display","none"),i>=0&&i<t.childNodes.length?t.insertBefore(n,t.childNodes[i]):t.appendChild(n),n}(t,a,"::before"===e?0:-1);if("img"===a){o.src=l;const t=this.resourceHandler.getImage(l);t&&(void 0===s.width&&t.width>0&&(s.width=je(t.width)),void 0===s.height&&t.height>0&&(s.height=je(t.height)))}else'""'!==n&&(o.innerText=l);for(const t in s)"display"!==t&&(o.style[t]=s[t]);return pi(o,"pseudoElement",i,e),pi(o,"styleMap",i,s),o}}}}setBaseLayout(){const{processing:t,session:e}=this,i=t.cache,n=t.node,s=e.extensionMap,o=new Map;let r=oi(this.extensions,t=>!t.eventOnly),a=0;function l(t,e,i){const n=o.get(t)||new Map;o.set(t,n.set(e,i))}function c(t){const e=o.get(t.depth);e&&e.delete(t.id)}l(-1,0,n.parent);for(const t of i)if(t.length){const e=t.depth;l(e,t.id,t),a=Math.max(e,a)}for(let t=0;t<a;t++)o.set(-1*t-2,new Map);i.afterAppend=t=>{l(-1*t.depth-2,t.id,t);for(const e of t.cascade())e.length&&(c(e),l(-1*e.depth-2,e.id,e))};for(const t of this.extensions)t.beforeBaseLayout();for(const t of o.values())for(const e of t.values()){if(0===e.length)continue;const t=e.floatContainer,i=e.renderExtension,n=e.duplicate(),o=n.length;let a;t&&(a=He.linearData(e.naturalElements,!0).cleared);for(let e=0;e<o;e++){let l=n[e];if(l.rendered||!l.visible||l.naturalElement&&this.rootElements.has(l.element)&&!l.documentRoot)continue;let c=l.parent;if(o>1&&e<o-1&&l.pageFlow&&!l.nodeGroup&&(0===c.alignmentType||c.hasAlign(2)||l.hasAlign(8192))&&!c.hasAlign(4)&&l.hasSection(he.DOM_TRAVERSE)){const i=[],s=[];let r,h,d=!1,u=e,f=0;c.layoutVertical&&l.hasAlign(8192)&&(i.push(l),u++,f++);t:{let e,r;for(t&&(e=new Set,r=new Map);u<o;u++,f++){const o=n[u];if(o.pageFlow){if(o.labelFor&&!o.visible){f--;continue}if(t){if(e.size){const t=a.get(o);t&&("both"===t?e.clear():e.delete(t),r.set(o,t))}o.floating&&e.add(o.float)}if(0===f){const t=o.siblingsTrailing[0];if(t){!o.horizontalAligned||t.alignedVertically([o])>0?s.push(o):i.push(o);continue}}const n=o.siblingsLeading[0];if(!n)break t;if(t){const t=o.alignedVertically(i.length?i:s,a,i.length>0);if(t>0){if(i.length){if(t<6&&e.size&&"both"!==r.get(o)&&!o.siblingsLeading.some(t=>t.lineBreak&&!a.has(t))&&(!o.floating||n.floating&&!ii(o.linear.top,n.linear.bottom))){if(r.has(o)){if(!o.floating){o.addAlign(8192),i.push(o),d=!0;continue}break t}{let t=-1/0;if(!o.floating)for(const e of i)e.floating&&(t=Math.max(t,e.linear.bottom));if(!o.floating&&!ii(o.linear.top,t)||o.floating&&e.has(o.float)){if(i.push(o),!o.floating&&ii(o.linear.bottom,t))break t;continue}}}break t}if(!Ei(o,i,s))break t}else if(!Si(o,i,s,d))break t}else if(o.alignedVertically()>0){if(!Ei(o,i,s))break t}else if(!Si(o,i,s,d))break t}else if(o.positionAuto){const t=s.length;if(t){s[t-1].blockStatic&&s.push(o);break}i.push(o)}}}i.length>1?(r=this.controllerHandler.processTraverseHorizontal(new Ue(c,l,0,0,i),n),h=i[i.length-1]):s.length>1&&(r=this.controllerHandler.processTraverseVertical(new Ue(c,l,0,0,s),n),h=s[s.length-1],h.horizontalAligned&&h!==n[o-1]&&h.addAlign(8192)),r&&this.addLayout(r)&&(h===n[o-1]&&c.removeAlign(2),c=l.parent)}if(l.removeAlign(8192),e===o-1&&c.removeAlign(2),l.renderAs&&c.appendTry(l,l.renderAs,!1)&&(l.hide(),l=l.renderAs,l.positioned&&(c=l.parent)),!l.rendered&&l.hasSection(he.EXTENSION)){const t=s.get(l.id),e=t?i?i.concat(t):t:i;if(e){let t=!1;for(const i of e){const e=i.processChild(l,c);if(e){const{output:i,renderAs:n,outputAs:s}=e;if(i&&this.addLayoutTemplate(e.outerParent||c,l,i),n&&s&&this.addLayoutTemplate(e.parentAs||c,n,s),c=e.parent||c,t=!0===e.next,e.complete||t)break}}if(t)continue}if(l.styleElement){let e=!1;for(const i of _i(l.dataset.use,r))if(i.is(l)&&i.condition(l,c)&&(void 0===t||!t.includes(i))){const t=i.processNode(l,c);if(t){const{output:n,renderAs:s,outputAs:o,include:a}=t;if(n&&this.addLayoutTemplate(t.outerParent||c,l,n),s&&o&&this.addLayoutTemplate(t.parentAs||c,s,o),c=t.parent||c,n&&!1!==a||a){let t=l.renderExtension;void 0===t&&(t=[],l.renderExtension=t),t.push(i),i.subscribers.add(l)}if(t.remove){const t=r.indexOf(i);-1!==t&&(r=r.slice(0),r.splice(t,1))}if(e=!0===t.next,t.complete||e)break}}if(e)continue}}if(!l.rendered&&l.hasSection(he.RENDER)){let t=this.createLayoutControl(c,l);if(0===t.containerType){const e=l.length?this.controllerHandler.processUnknownParent(t):this.controllerHandler.processUnknownChild(t);if(e.next)continue;t=e.layout}this.addLayout(t)}}}i.sort((t,e)=>{if(t.depth===e.depth){const i=t.nodeGroup,n=e.nodeGroup;if(i||n)return i&&n?t.id<e.id?-1:1:i?-1:1}return t.depth<e.depth?-1:1}),e.cache.join(i),e.excluded.join(t.excluded);for(const t of this.extensions){for(const e of t.subscribers)i.contains(e)&&t.postBaseLayout(e);t.afterBaseLayout()}}setConstraints(){const t=this._cache;this.controllerHandler.setConstraints();for(const e of this.extensions){for(const i of e.subscribers)t.contains(i)&&e.postConstraints(i);e.afterConstraints()}}setResources(t){const e=this.resourceHandler;for(const i of this._cache)i.documentRoot&&i.renderParent&&this.session.documentRoot.push({node:i,layoutName:i===this.processing.node?t:""}),e.setBoxStyle(i),i.imageElement||i.svgElement||!i.visible||(e.setFontStyle(i),e.setValueString(i));for(const t of this.extensions)t.afterResources()}processFloatHorizontal(t){const e=this.controllerHandler,{containerType:i,alignmentType:n}=e.containerTypeVertical,s=t.cleared,o=[],r=[],a=[],l=[],c=[];let h,d,u,f,g=0;if(t.each((t,e)=>{if(e>0){const e=s.get(t);if(e)switch(e){case"left":li(g,2)||(g|=2);break;case"right":li(g,4)||(g|=4);break;default:g=6}}const i=t.float;if(0===g)if("left"===i)l.push(t);else if("right"===i)c.push(t);else if(l.length||c.length){let e=t.linear.top;if(t.styleText){const i=t.textBounds;i&&(e=Math.max(i.top,e))}l.some(t=>e>=t.linear.bottom)||c.some(t=>e>=t.linear.bottom)?a.push(t):r.push(t)}else r.push(t);else"left"===i?2===g||6===g?(void 0===h&&(h=[]),h.push(t)):l.push(t):"right"===i?4===g||6===g?(void 0===d&&(d=[]),d.push(t)):c.push(t):6===g?a.push(t):r.push(t)}),l.length&&(u=h?[l,h]:l),c.length&&(f=d?[c,d]:c),c.length+(d?d.length:0)===t.length&&t.add(2048),a.length){const{node:e,parent:s}=t;a.length>1&&a[0].addAlign(8192),a.unshift(e);const o=this.createNode({parent:s,children:a});o.childIndex=e.childIndex,o.containerName=e.containerName,o.inherit(e,"boxStyle"),o.innerWrapped=e,this.addLayout(new Ue(s,o,i,n|(s.blockStatic?64:0),a)),t.parent=o}r.length&&o.push(r),u&&o.push(u),f&&o.push(f),t.type=e.containerTypeVerticalMargin,t.add(64),t.itemCount=o.length;for(const s of o){let o,a;if(Array.isArray(s[0])){o=s;const r=t.node;let l=o[0];for(let t=1;t<o.length;t++)l=l.concat(o[t]);l.sort((t,e)=>t.childIndex<e.childIndex?-1:1),r.layoutVertical?a=r:(a=e.createNodeGroup(l[0],l,r),this.addLayout(Ue.create({parent:r,node:a,containerType:i,alignmentType:n|(o.some(t=>t===f||t===c)?2048:0),itemCount:o.length})))}else o=[s];for(const s of o){const o=a||t.node,h=s[0],d=e.createNodeGroup(h,s,o,!0),u=new Ue(o,d,0,128|(s===r?256:0),s);1===s.length?(h.percentWidth?u.type=e.containerTypePercent:u.setContainerType(i,n),u.node.innerWrapped=h):u.linearY||u.unknownAligned?u.setContainerType(i,n|(u.unknownAligned?2:0)):e.processLayoutHorizontal(u),this.addLayout(u),s===r&&this.setFloatPadding(o,d,r,l,c)}}return t}processFloatVertical(t){const e=this.controllerHandler,{containerType:i,alignmentType:n}=e.containerTypeVertical,s=t.cleared;if(0!==t.containerType){const s=t.node,o=e.createNodeGroup(s,[s],t.parent);this.addLayout(new Ue(o,s,i,n,o.children)),t.node=o}else t.setContainerType(i,n);const o=[],r=[],a=[],l=[];let c=!1,h=!1,d=!0;for(const e of t)e.blockStatic&&0===l.length?(a.push(e),h=!0):(s.has(e)&&(e.floating?c=!0:(e.modifyBox(2),o.push(a.slice(0)),r.push(l.slice(0)),a.length=0,l.length=0)),e.floating?(h&&(o.push(a.slice(0)),r.push(null),a.length=0,l.length=0,h=!1),l.push(e)):(c&&!s.has(e)&&(d=!1),a.push(e)));if(l.length&&r.push(l),a.length&&o.push(a),!d){const s=t.node,a=Math.max(r.length,o.length);for(let t=0;t<a;t++){const a=o[t]||[];if(null===r[t]&&a.length){const t=e.containerTypeVertical;this.addLayout(new Ue(s,e.createNodeGroup(a[0],a,s),t.containerType,192|t.alignmentType,a))}else{const o=r[t]||[];if(a.length||o.length){const t=e.createNodeGroup(o[0]||a[0],[],s),r=new Ue(s,t);r.type=e.containerTypeVerticalMargin;const l=[];let c;if(o.length){const i=e.createNodeGroup(o[0],o,t);r.add(512),0===a.length&&o.every(t=>"right"===t.float)&&r.add(2048),l.push(i)}a.length&&(c=e.createNodeGroup(a[0],a,t),l.push(c)),t.init(),r.itemCount=l.length,this.addLayout(r);for(let s of l)s.nodeGroup||(s=e.createNodeGroup(s,[s],t,!0)),this.addLayout(new Ue(t,s,i,192|n,s.children));if(a.length&&o.length){const[t,e]=hi(o,t=>"right"!==t.float);this.setFloatPadding(s,c,a,t,e)}}}}}return t}setFloatPadding(t,e,i,n,s){if(i.some(t=>ki(t)||t.blockStatic&&t.cascadeSome(t=>ki(t)))){const o=e.bounds.bottom;if(n.length){let s=-1/0,r=0,a=!1,l=!1;for(const t of n)t.bounds.top<o&&(s=Math.max(t.linear.right+Math.min(t.marginLeft,0),s),l=t.marginRight>0);if(s!==-1/0){for(const t of i)t.bounds.left<=s&&(r=Math.max(r,t.marginLeft),a=!0);if(a){const i=s-t.box.left-r;i>0&&e.modifyBox(256,i+(!l&&e.cascadeSome(t=>t.multiline)?Math.max(r,this._localSettings.deviations.textMarginBoundarySize):0))}}}if(s.length){let n=1/0,r=0,a=!1;for(const t of s)t.bounds.top<o&&(n=Math.min(t.linear.left+Math.min(t.marginRight,0),n));if(n!==1/0){for(const t of i)(t.multiline||t.bounds.right>=n)&&(r=Math.max(r,t.marginRight),a=!0);if(a){const i=t.box.right-n-r;i>0&&e.modifyBox(64,i+(e.cascadeSome(t=>t.multiline)?Math.max(r,this._localSettings.deviations.textMarginBoundarySize):0))}}}}}createLayoutControl(t,e){return new Ue(t,e,e.containerType,e.alignmentType,e.children)}isUseElement(t){const e=t.dataset.use;return ci(e)&&e.split(ui.SEPARATOR).some(t=>!!this.extensionManager.retrieve(t))}get layouts(){return this._layouts.sort((t,e)=>{const i=t.index,n=e.index;if(i!==n){if(0===i||n===1/0||void 0===n&&i!==1/0)return-1;if(0===n||i===1/0||void 0===i&&n!==1/0)return 1;if(void 0!==i&&void 0!==n)return i<n?-1:1}return 0})}get extensionsCascade(){return this.extensions.filter(t=>!!t.init)}get length(){return this.session.documentRoot.length}},t.Controller=G,t.ControllerUI=class extends G{constructor(){super(...arguments),this._requireFormat=!1,this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}init(){const t=this.localSettings.unsupported;this._unsupportedCascade=t.cascade,this._unsupportedTagName=t.tagName}reset(){this._requireFormat=!1,this._beforeOutside={},this._beforeInside={},this._afterInside={},this._afterOutside={}}preventNodeCascade(t){return this._unsupportedCascade.has(t.tagName)}applyDefaultStyles(t){const e=this.sessionId;let i;if(Ni(t))i={position:"static",display:"inline",verticalAlign:"baseline",float:"none",clear:"none"};else{i=Oi(t,"styleMap",e)||{};const n=()=>{if(void 0===i.border&&o()){const t=this.localSettings.style.inputBorderColor;i.border="outset 1px "+t;for(let e=0;e<4;e++){const n=Ci[e];i[n[0]]="outset",i[n[1]]="1px",i[n[2]]=t}return!0}return!1},s=t=>{if(t){const t=i.backgroundColor;void 0!==t&&"initial"!==t||(i.backgroundColor=this.localSettings.style.inputBackgroundColor)}void 0===i.textAlign&&(i.textAlign="center"),void 0!==i.padding||Ai.some(t=>!!i[t])||(i.paddingTop="2px",i.paddingRight="6px",i.paddingBottom="3px",i.paddingLeft="6px")},o=()=>!(Ci[0][0]in i||Ci[1][0]in i||Ci[2][0]in i||Ci[3][0]in i),r=t.tagName;if(Ti(8))switch(r){case"INPUT":case"SELECT":case"BUTTON":case"TEXTAREA":void 0===i.display&&(i.display="inline-block");break;case"FIELDSET":void 0===i.display&&(i.display="block")}switch(r){case"INPUT":{const e=t.type;switch(e){case"radio":case"checkbox":case"image":break;case"week":case"month":case"time":case"date":case"datetime-local":i.paddingTop=Ii(Li(i.paddingTop)+1),i.paddingRight=Ii(Li(i.paddingRight)+1),i.paddingBottom=Ii(Li(i.paddingBottom)+1),i.paddingLeft=Ii(Li(i.paddingLeft)+1);break;default:{const t=n();switch(e){case"file":case"reset":case"submit":case"button":s(t)}break}}break}case"BUTTON":s(n());break;case"TEXTAREA":case"SELECT":n();break;case"BODY":{const t=i.backgroundColor;void 0!==t&&"initial"!==t||(i.backgroundColor="rgb(255, 255, 255)");break}case"FORM":void 0===i.marginTop&&(i.marginTop="0px");break;case"LI":if(void 0===i.listStyleImage){const e=Ri(t);i.listStyleImage=e.getPropertyValue("list-style-image")}break;case"IFRAME":void 0===i.display&&(i.display="block");case"IMG":{const e=(e,n)=>{const s=i[e];if(void 0===s||"auto"===s){const s=RegExp(`\\s+${e}="([^"]+)"`).exec(t.outerHTML);if(s){const t=s[1];Bi(t)?i[e]=t+"px":Pi(t)&&(i[e]=t)}else if("IFRAME"===r)"width"===e?i.width="300px":i.height="150px";else{const s=i[n];if(s&&Bi(s)){const o="max"+Mi(e);if(void 0===i[o]||!Pi(o)){const o=this.application.resourceHandler.getImage(t.src);o&&o.width>0&&o.height>0&&(i[e]=Ii(o[e]*parseFloat(s)/o[n]))}}}}};e("width","height"),e("height","width");break}}}Di(t,"styleMap",e,i)}addBeforeOutsideTemplate(t,e,i=!0,n=-1){let s=this._beforeOutside[t];void 0===s&&(s=[],this._beforeOutside[t]=s),-1!==n&&n<s.length?s.splice(n,0,e):s.push(e),i&&(this._requireFormat=!0)}addBeforeInsideTemplate(t,e,i=!0,n=-1){let s=this._beforeInside[t];void 0===s&&(s=[],this._beforeInside[t]=s),-1!==n&&n<s.length?s.splice(n,0,e):s.push(e),i&&(this._requireFormat=!0)}addAfterInsideTemplate(t,e,i=!0,n=-1){let s=this._afterInside[t];void 0===s&&(s=[],this._afterInside[t]=s),-1!==n&&n<s.length?s.splice(n,0,e):s.push(e),i&&(this._requireFormat=!0)}addAfterOutsideTemplate(t,e,i=!0,n=-1){let s=this._afterOutside[t];void 0===s&&(s=[],this._afterOutside[t]=s),-1!==n&&n<s.length?s.splice(n,0,e):s.push(e),i&&(this._requireFormat=!0)}getBeforeOutsideTemplate(t,e){const i=this._beforeOutside[t];return i?Xi(i,e):""}getBeforeInsideTemplate(t,e){const i=this._beforeInside[t];return i?Xi(i,e):""}getAfterInsideTemplate(t,e){const i=this._afterInside[t];return i?Xi(i,e):""}getAfterOutsideTemplate(t,e){const i=this._afterOutside[t];return i?Xi(i,e):""}hasAppendProcessing(t){return void 0===t?this._requireFormat:t in this._beforeOutside||t in this._beforeInside||t in this._afterInside||t in this._afterOutside}includeElement(t){return!(this._unsupportedTagName.has(t.tagName)||"INPUT"===t.tagName&&this._unsupportedTagName.has(t.tagName+":"+t.type))||"true"===t.contentEditable}visibleElement(t,e){let i,n,s,o;if(e){const r=t.parentElement;i=r?Ri(r,e):Ri(t),n=0===Vi(i,"width")?Ui(i,"border-left")>0||Vi(i,"padding-left")>0||Vi(i,"padding-right")>0||Ui(i,"border-right")>0?1:0:1,s=0===Vi(i,"height")?Ui(i,"border-top")>0||Vi(i,"padding-top")>0||Vi(i,"padding-bottom")>0||Ui(i,"border-bottom")>0?1:0:1,o=!0}else{i=Ri(t);const e=Fi(t,this.sessionId);({width:n,height:s}=e),o=(t=>!(t.top+window.scrollY+t.height<0||t.left+window.scrollX+t.width<0))(e)}if(o){if(n>0&&s>0)return"visible"===i.getPropertyValue("visibility")||!zi(i);if("IMG"===t.tagName&&"none"!==i.getPropertyValue("display"))return!0;if(!zi(i))return n>0&&"none"!==i.getPropertyValue("float")||"none"!==i.getPropertyValue("clear")||"block"===i.getPropertyValue("display")&&(0!==Vi(i,"margin-top")||0!==Vi(i,"margin-bottom"))}return!1}evaluateNonStatic(t,e){var i;const n=new Set;for(const s of e)if(!s.documentRoot){const e=s.parent,o=s.absoluteParent;let r;switch(s.css("position")){case"relative":if(!e.layoutElement&&s===e.lastChild){let i=!1;const n=e.box;if(s.outsideX(n)){if(!e.hasPX("width")||"hidden"===e.css("overflowX"))continue;i=!0}if(s.outsideY(n)){if(!e.hasHeight&&!e.hasPX("height")||"hidden"===e.css("overflowY"))continue;i=!0}if(i){for(r=e.actualParent;r&&r!==t&&!(s.withinX(r.box)&&s.withinY(r.box)||"hidden"===r.css("overflow"));)r=r.actualParent;r&&(s.css("position","absolute",!0),s.setBounds(!1))}}break;case"fixed":if(!s.positionAuto){r=t;break}case"absolute":if(o)if(r=o,s.positionAuto)s.siblingsLeading.some(t=>t.multiline||t.excluded&&!t.blockStatic)?s.positionAuto=!1:s.cssApply({display:"inline-block",verticalAlign:"top"},!0),r=e;else if(this.userSettings.supportNegativeLeftTop){const e=r.box;let i=!1;for(;r&&r!==t;){if(i){if(r.layoutElement){r=o;break}if(s.withinX(e)&&s.withinY(e))break}else{const t="hidden"===r.css("overflowX"),n="hidden"===r.css("overflowY");if(t&&n||0===parseFloat(s.cssInitial("top"))||0===parseFloat(s.cssInitial("right"))||0===parseFloat(s.cssInitial("bottom"))||0===parseFloat(s.cssInitial("left")))break;{const o=!t&&s.outsideX(e),a=!n&&s.outsideY(e);if(!n&&s.linear.top<Math.floor(e.top)&&(s.top<0||s.marginTop<0))i=!0;else if(o&&!s.hasPX("left")&&s.right>0||a&&!s.hasPX("top")&&0!==s.bottom)i=!0;else if(o&&a&&(!r.pageFlow||r.actualParent.documentBody)&&(s.top>0||s.left>0))i=!0;else if(!t&&s.outsideX(r.linear)&&!s.pseudoElement&&(s.left<0||s.marginLeft<0||!s.hasPX("left")&&s.right<0&&s.linear.left>=r.linear.right))i=!0;else{if(t||n||s.intersectX(e)||s.intersectY(e))break;i=!0}}}r=r.actualParent}}}if(void 0===r&&(r=s.pageFlow?e:t),r!==e){if((null===(i=o)||void 0===i?void 0:i.positionRelative)&&r!==o){const{left:t,right:e,top:i,bottom:n}=o,r=s.bounds;0!==t?(r.left+=t,r.right+=t):o.hasPX("left")||0===e||(r.left-=e,r.right-=e),0!==i?(r.top+=i,r.bottom+=i):o.hasPX("top")||0===n||(r.top-=n,r.bottom-=n),s.unset("box"),s.unset("linear")}let t=s.toFloat("opacity",1),a=e;do{t*=a.toFloat("opacity",1),a=a.actualParent}while(a&&a!==r);s.css("opacity",""+t),s.parent=r,s.containerIndex=1/0,n.add(r)}s.documentParent=r}for(const t of n){const e=[];let i=-1;t.each(n=>{if(n.containerIndex===1/0)for(const i of t.children){let t=i.naturalElements.includes(n);if(!t){const e=i.cascade();t=n.ascend({condition:t=>e.includes(t)}).length>0}if(t){const t=i.containerIndex+(n.zIndex>=0||i!==n.actualParent?1:0);let s=e[t];void 0===s&&(s=[],e[t]=s),s.push(n);break}}else n.containerIndex>i&&(i=n.containerIndex)});const n=e.length;if(n){const s=t.children;for(let t=0,o=0,r=1;t<n;t++,o++){const n=e[t];if(n){n.sort((t,e)=>t.parent===e.parent?t.zIndex===e.zIndex?t.id<e.id?-1:1:t.zIndex<e.zIndex?-1:1:0);for(const t of n)t.containerIndex=i+r++;for(let t=0;t<s.length;t++)n.includes(s[t])&&(s[t]=void 0);s.splice(o,0,...n),o+=n.length}}t.retain(Wi(s))}}}sortInitialCache(t){(t||this.cache).sort((t,e)=>{if(t.depth!==e.depth)return t.depth<e.depth?-1:1;{const i=t.documentParent,n=e.documentParent;if(i!==n){const t=i.depth,e=n.depth;return t!==e?t<e?-1:1:i.actualParent===n.actualParent?i.childIndex<n.childIndex?-1:1:i.id<n.id?-1:1}}return 0})}cascadeDocument(t,e){const i=this.userSettings.showAttributes,n=e>0?"\t".repeat(e):"";let s="";for(const o of t)if(o){const t=o.node;switch(o.type){case 1:{const{controlName:r,attributes:a}=o,{id:l,renderTemplates:c}=t,h=e+1,d=this.getBeforeInsideTemplate(l,h),u=this.getAfterInsideTemplate(l,h);let f=n+`<${r+(0===e?"{#0}":"")+(i?a?Hi(a,h):t.extractAttributes(h):"")}`;f+=c||""!==d||""!==u?">\n"+d+(c?this.cascadeDocument(this.sortRenderPosition(t,c),h):"")+u+n+`</${r}>\n`:" />\n",s+=this.getBeforeOutsideTemplate(l,e)+f+this.getAfterOutsideTemplate(l,e);break}case 2:{const t=o.content;t&&(s+=Hi(t,e));break}}}return s}getEnclosingXmlTag(t,e,i){return"<"+t+(e||"")+(i?">\n"+i+"</"+t+">\n":" />\n")}get generateSessionId(){return""+(new Date).getTime()}},t.Extension=j,t.ExtensionManager=class{constructor(t){this.application=t}include(t){const e=this.application,i=e.extensions;let n=t.name;const s=i.findIndex(t=>t.name===n);if(-1!==s)return i[s]=t,!0;{const s=t.framework;if(s>0)for(const i of t.dependencies)if(i.preload&&(n=i.name,null===this.retrieve(n))){const t=e.builtInExtensions[n];t&&this.include(t)}if((0===s||Y(s,e.framework))&&t.dependencies.every(t=>!!this.retrieve(t.name)))return t.application=e,i.push(t),!0}return!1}exclude(t){const e=this.application.extensions,i=e.length;for(let n=0;n<i;n++)if(e[n]===t)return e.splice(n,1),!0;return!1}retrieve(t){for(const e of this.application.extensions)if(e.name===t)return e;return null}optionValue(t,e){var i;const n=null===(i=this.retrieve(t))||void 0===i?void 0:i.options;return $(n)?n[e]:void 0}optionValueAsObject(t,e){const i=this.optionValue(t,e);return $(i)?i:null}optionValueAsString(t,e){const i=this.optionValue(t,e);return"string"==typeof i?i:""}optionValueAsNumber(t,e){const i=this.optionValue(t,e);return"number"==typeof i?i:NaN}optionValueAsBoolean(t,e){const i=this.optionValue(t,e);return"boolean"==typeof i&&i}},t.ExtensionUI=Yi,t.File=Z,t.FileUI=class extends Z{get directory(){return this.resource.controllerSettings.directory}},t.LayoutUI=Ue,t.Node=ce,t.NodeGroupUI=class extends He{init(){var t;if(this.length){for(const t of this.children)t.parent=this;this.setBounds(),this.saveAsInitial(),this.dir=(null===(t=this.actualParent)||void 0===t?void 0:t.dir)||""}}setBounds(){this.length&&(this._bounds=He.outerRegion(this))}previousSiblings(t){var e,i;return(null===(i=((null===(e=this._initial)||void 0===e?void 0:e.children)||this.children)[0])||void 0===i?void 0:i.previousSiblings(t))||[]}nextSiblings(t){var e,i;const n=(null===(e=this._initial)||void 0===e?void 0:e.children)||this.children;return(null===(i=n[n.length-1])||void 0===i?void 0:i.nextSiblings(t))||[]}get block(){let t=this._cached.block;return void 0===t&&(t=this.some(t=>t.block),this._cached.block=t),t}get blockStatic(){let t=this._cached.blockStatic;if(void 0===t){const e=this.actualParent||this.documentParent;t=this.naturalChildren.length>0&&this.naturalChildren[0].blockStatic||this.actualWidth===e.actualWidth&&!this.some(t=>t.plainText||t.naturalElement&&t.rightAligned)||this.layoutVertical&&this.some(t=>t.blockStatic||t.rightAligned)||e.blockStatic&&(e.layoutVertical||this.hasAlign(256)),(t||0!==this.containerType)&&(this._cached.blockStatic=t)}return t||this.hasAlign(64)}get blockDimension(){let t=this._cached.blockDimension;return void 0===t&&(t=this.some(t=>t.blockDimension),this._cached.blockDimension=t),t}get inline(){let t=this._cached.inline;return void 0===t&&(t=this.every(t=>t.inline),this._cached.inline=t),t}get inlineStatic(){let t=this._cached.inlineStatic;return void 0===t&&(t=this.every(t=>t.inlineStatic),this._cached.inlineStatic=t),t}get inlineVertical(){let t=this._cached.inlineVertical;return void 0===t&&(t=this.every(t=>t.inlineVertical),this._cached.inlineVertical=t),t}get inlineFlow(){let t=this._cached.inlineStatic;return void 0===t&&(t=this.inlineStatic||this.hasAlign(128),this._cached.inlineStatic=t),t}get pageFlow(){let t=this._cached.pageFlow;if(void 0===t){const e=this.css("position");t="absolute"!==e&&"fixed"!==e,this._cached.pageFlow=t}return t}set baseline(t){this._cached.baseline=t}get baseline(){let t=this._cached.baseline;if(void 0===t){const e=this.cssInitial("verticalAlign",!0);t=""===e?this.every(t=>t.baseline):"baseline"===e||$i(e,!0),this._cached.baseline=t}return t}get float(){let t=this._cached.float;return void 0===t&&(t=this.floating?this.hasAlign(2048)?"right":"left":"none",this._cached.float=t),t}get floating(){let t=this._cached.floating;return void 0===t&&(t=this.every(t=>t.floating),this._cached.floating=t),t}get display(){return super.display||(this.some(t=>t.blockStatic)?"block":this.blockDimension?"inline-block":"inline")}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}set childIndex(t){super.childIndex=t}get childIndex(){let t=super.childIndex;if(t===1/0){for(const e of this)t=Math.min(e.childIndex,t);super.childIndex=t}return t}set containerIndex(t){super.containerIndex=t}get containerIndex(){let t=super.containerIndex;if(t===1/0){for(const e of this)t=Math.min(e.containerIndex,t);super.containerIndex=t}return t}get tagName(){return""}get plainText(){return!1}get styleText(){return!1}get multiline(){return!1}get nodeGroup(){return!0}get naturalChild(){return!1}get naturalElement(){return!1}get pseudoElement(){return!1}get previousSibling(){return null}get nextSibling(){return null}get previousElementSibling(){return null}get nextElementSibling(){return null}},t.NodeList=e,t.NodeUI=He,t.Resource=c,t.ResourceUI=jn,t.extensions=Ro,t.lib=Bo,Object.defineProperty(t,"__esModule",{value:!0})}));
