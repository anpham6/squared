!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t=t||self).squared=t.squared||{},t.squared.svg={}))}(this,(function(t){"use strict";const{css:e,dom:s,math:i,regex:n,session:a,util:r}=squared.lib,o={path:1,line:2,rect:3,ellipse:4,circle:5,polyline:6,polygon:7},l=`(${n.STRING.DECIMAL})`,c={MATRIX:RegExp(`(matrix(?:3d)?)\\(${l}, ${l}, ${l}, ${l}, ${l}, ${l}(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?(?:, ${l})?\\)`,"g"),ROTATE:RegExp(`(rotate[XY]?)\\(${n.STRING.CSS_ANGLE}\\)`,"g"),SKEW:RegExp(`(skew[XY]?)\\(${n.STRING.CSS_ANGLE}(?:, ${n.STRING.CSS_ANGLE})?\\)`,"g"),SCALE:RegExp(`(scale[XY]?)\\(${l}(?:, ${l})?\\)`,"g"),TRANSLATE:RegExp(`(translate[XY]?)\\(${n.STRING.LENGTH_PERCENTAGE}(?:, ${n.STRING.LENGTH_PERCENTAGE})?\\)`,"g")};let h;const u={applyX:(t,e,s)=>t.a*e+t.c*s+t.e,applyY:(t,e,s)=>t.b*e+t.d*s+t.f,clone:t=>({a:t.a,b:t.b,c:t.c,d:t.d,e:t.e,f:t.f}),rotate(t){const e=i.convertRadian(t),s=Math.cos(e),n=Math.sin(e);return{a:s,b:n,c:-1*n,d:s,e:0,f:0}},skew:(t=0,e=0)=>({a:1,b:Math.tan(i.convertRadian(e)),c:Math.tan(i.convertRadian(t)),d:1,e:0,f:0}),scale:(t=1,e=1)=>({a:t,b:0,c:0,d:e,e:0,f:0}),translate:(t=0,e=0)=>({a:1,b:0,c:0,d:1,e:t,f:e})},f={create:(t,e,s=0,i=!0,n=!0)=>({type:t,matrix:e,angle:s,method:{x:i,y:n}}),parse(t,s){const i=s||t.style.getPropertyValue("transform");if(""!==i){const n=[];for(const a in c){let r;for(c[a].lastIndex=0;null!==(r=c[a].exec(i));){const i=r[1].endsWith("X"),a=r[1].endsWith("Y");if(r[1].startsWith("rotate")){const t=e.convertAngle(r[2],r[3]),s=u.rotate(t);i?(s.a=1,s.b=0,s.c=0):a&&(s.b=0,s.c=0,s.d=1),n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_ROTATE,s,t,!i,!a)}else if(r[1].startsWith("skew")){const t=a?0:e.convertAngle(r[2],r[3]),s=a?e.convertAngle(r[2],r[3]):r[4]&&r[5]?e.convertAngle(r[4],r[5]):0,o=u.skew(t,s);i?n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_SKEWX,o,t,!0,!1):a?n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_SKEWY,o,s,!1,!0):(n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_SKEWX,Object.assign(Object.assign({},o),{b:0}),t,!0,!1),0!==s&&(n[r.index+1]=f.create(SVGTransform.SVG_TRANSFORM_SKEWY,Object.assign(Object.assign({},o),{c:0}),s,!1,!0)))}else if(r[1].startsWith("scale")){const t=a?void 0:parseFloat(r[2]),e=a?parseFloat(r[2]):!i&&r[3]?parseFloat(r[3]):t,s=u.scale(t,i?void 0:e);n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_SCALE,s,0,!a,!i)}else if(r[1].startsWith("translate")){const s=e.getFontSize(t),o=e.parseUnit(r[2],s),l=!i&&r[3]?e.parseUnit(r[3],s):0,c=u.translate(a?0:o,a?o:l);n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_TRANSLATE,c,0)}else if(r[1].startsWith("matrix")){const e=f.matrix(t,s);e&&(n[r.index]=f.create(SVGTransform.SVG_TRANSFORM_MATRIX,e))}}}const a=[];return n.forEach(t=>{t.fromCSS=!0,a.push(t)}),a}},matrix(t,s){c.MATRIX.lastIndex=0;const i=c.MATRIX.exec(s||e.getStyle(t).transform||"");if(i)switch(i[1]){case"matrix":return{a:parseFloat(i[2]),b:parseFloat(i[3]),c:parseFloat(i[4]),d:parseFloat(i[5]),e:parseFloat(i[6]),f:parseFloat(i[7])};case"matrix3d":return{a:parseFloat(i[2]),b:parseFloat(i[3]),c:parseFloat(i[6]),d:parseFloat(i[7]),e:parseFloat(i[14]),f:parseFloat(i[15])}}},origin(t,s){void 0===s&&(s=g(t,"transform-origin"));const i={x:0,y:0};if(""!==s){const a=S(t);function n(s,n,a){e.isLength(n)?i[s]=e.parseUnit(n,e.getFontSize(t)):e.isPercent(n)&&(i[s]=parseFloat(n)/100*a)}let r=0,o=0;if(a)r=a.width,o=a.height;else{const e=t.parentElement;e instanceof SVGGraphicsElement&&e.viewportElement&&(p.svg(e.viewportElement)||p.symbol(e.viewportElement))&&(r=e.viewportElement.viewBox.baseVal.width,o=e.viewportElement.viewBox.baseVal.height)}if(!r||!o){const e=t.getBoundingClientRect();r=e.width,o=e.height}const l=s.split(" ");switch(1===l.length&&l.push("center"),l[0]){case"0%":case"left":break;case"100%":case"right":i.x=r;break;case"center":l[0]="50%";default:n("x",l[0],r)}switch(l[1]){case"0%":case"top":break;case"100%":case"bottom":i.y=o;break;case"center":l[1]="50%";default:n("y",l[1],o)}}return i},rotateOrigin(t,e="transform"){const i=s.getNamedItem(t,e),n=[];if(""!==i){let t;for(h?h.lastIndex=0:h=/rotate\((-?[\d.]+)(?:,? (-?[\d.]+))?(?:,? (-?[\d.]+))?\)/g;null!==(t=h.exec(i));){const e=parseFloat(t[1]);0!==e&&n.push({angle:e,x:t[2]?parseFloat(t[2]):0,y:t[3]?parseFloat(t[3]):0})}}return n},typeAsName(t){switch(t){case SVGTransform.SVG_TRANSFORM_ROTATE:return"rotate";case SVGTransform.SVG_TRANSFORM_SCALE:return"scale";case SVGTransform.SVG_TRANSFORM_SKEWX:return"skewX";case SVGTransform.SVG_TRANSFORM_SKEWY:return"skewY";case SVGTransform.SVG_TRANSFORM_TRANSLATE:return"translate";default:return""}},typeAsValue(t){switch(t){case"rotate":case SVGTransform.SVG_TRANSFORM_ROTATE:return"0 0 0";case"scale":case SVGTransform.SVG_TRANSFORM_SCALE:return"1 1 0 0";case"skewX":case"skewY":case SVGTransform.SVG_TRANSFORM_SKEWX:case SVGTransform.SVG_TRANSFORM_SKEWY:return"0";case"translate":case SVGTransform.SVG_TRANSFORM_TRANSLATE:return"0 0";default:return""}}},p={svg:t=>"svg"===t.tagName,g:t=>"g"===t.tagName,symbol:t=>"symbol"===t.tagName,path:t=>"path"===t.tagName,shape:t=>void 0!==o[t.tagName],image:t=>"image"===t.tagName,use:t=>"use"===t.tagName,line:t=>"line"===t.tagName,rect:t=>"rect"===t.tagName,circle:t=>"circle"===t.tagName,ellipse:t=>"ellipse"===t.tagName,polygon:t=>"polygon"===t.tagName,polyline:t=>"polyline"===t.tagName,clipPath:t=>"clipPath"===t.tagName,pattern:t=>"pattern"===t.tagName,linearGradient:t=>"linearGradient"===t.tagName,radialGradient:t=>"radialGradient"===t.tagName};function d(t){const e=t.getBoundingClientRect();return e.x=e.left,e.y=e.top,e}function g(t,i,n=!0){let o=s.getNamedItem(t,i);if(""===o){const s=a.getElementCache(t,"styleMap");s&&(o=s[r.convertCamelCase(i)]||""),""===o&&(n||Array.from(t.style).includes(i))&&(o=e.getStyle(t).getPropertyValue(i))}return o.trim()}function m(t,e,s=!0){let i=t,n="";for(;i&&!(i instanceof HTMLElement)&&(""===(n=g(i,e,s))||"inherit"===n);)i=i.parentElement;return n}function y(t){const e=n.CSS.URL.exec(t);return e?e[1]:""}function v(t,e){const i=s.getNamedItem(t,"href");if("#"===i.charAt(0)){const s=i.substring(1);let n;if(e)n=e;else for(n=t.parentElement;n&&n.parentElement instanceof SVGGraphicsElement;)n=n.parentElement;if(n){const t=n.querySelectorAll("*"),e=t.length;for(let i=0;i<e;i++){const e=t.item(i);if(e.id===s&&e instanceof SVGElement)return e}}else{const t=document.getElementById(s);if(t instanceof SVGElement)return t}}return null}function S(t){let e=t.parentElement;for(;e;){if((p.svg(e)||p.symbol(e))&&e.viewBox&&e.viewBox.baseVal.width>0&&e.viewBox.baseVal.height>0)return e.viewBox.baseVal;e=e.parentElement}}function b(t){const e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttribute("d",t),e}function k(t){return b(t).getTotalLength()}var T=Object.freeze({__proto__:null,MATRIX:u,TRANSFORM:f,SVG:p,getDOMRect:d,getAttribute:g,getParentAttribute:m,getAttributeURL:y,getTargetElement:v,getNearestViewBox:S,createPath:b,getPathLength:k});const{css:x,dom:A,math:_,regex:R,util:V}=squared.lib,w=RegExp(R.STRING.DECIMAL,"g"),M=/([A-Za-z])([^A-Za-z]+)?/g,P=new Map;class N{static isContainer(t){return V.hasBit(t.instanceType,2)}static isElement(t){return V.hasBit(t.instanceType,4)}static isShape(t){return V.hasBit(t.instanceType,2052)}static isAnimate(t){return V.hasBit(t.instanceType,16392)}static isAnimateTransform(t){return V.hasBit(t.instanceType,49160)}static asSvg(t){return 18===t.instanceType}static asG(t){return 34===t.instanceType}static asPattern(t){return 130===t.instanceType}static asShapePattern(t){return 258===t.instanceType}static asUsePattern(t){return 514===t.instanceType}static asImage(t){return 4100===t.instanceType}static asUse(t){return 10244===t.instanceType}static asUseSymbol(t){return 66===t.instanceType}static asSet(t){return 8===t.instanceType}static asAnimate(t){return 16392===t.instanceType}static asAnimateTransform(t){return 49160===t.instanceType}static asAnimateMotion(t){return 114696===t.instanceType}static setName(t){if(t){let e,s="";if(V.isString(t.id)){const i=V.convertWord(t.id,!0);P.has(i)||(s=i),e=i}else e=t.tagName;let i=P.get(e)||0;return""!==s?(P.set(s,i),s):(P.set(e,++i),e+"_"+i)}return P.clear(),""}static drawLine(t,e,s=0,i=0,n){return n&&(t=_.truncate(t,n),e=_.truncate(e,n),s=_.truncate(s,n),i=_.truncate(i,n)),`M${t},${e} L${s},${i}`}static drawRect(t,e,s=0,i=0,n){return n?(t=_.truncate(s+t,n),e=_.truncate(i+e,n),s=_.truncate(s,n),i=_.truncate(i,n)):(t+=s,e+=i),`M${s},${i} ${t},${i} ${t},${e} ${s},${e} Z`}static drawCircle(t,e,s,i){return N.drawEllipse(t,e,s,s,i)}static drawEllipse(t,e,s,i,n){void 0===i&&(i=s);let a=2*s;return n?(t=_.truncate(t-s,n),e=_.truncate(e,n),s=_.truncate(s,n),i=_.truncate(i,n),a=_.truncate(a,n)):t-=s,`M${t},${e} a${s},${i},0,0,1,${a},0 a${s},${i},0,0,1,-${a},0`}static drawPolygon(t,e){return t.length?N.drawPolyline(t,e)+"Z":""}static drawPolyline(t,e){let s="M";if(e)for(const i of t)s+=` ${_.truncate(i.x,e)},${_.truncate(i.y,e)}`;else for(const e of t)s+=` ${e.x},${e.y}`;return s}static drawPath(t,e){let s="";for(const e of t)switch(s+=(""!==s?" ":"")+e.key,e.key.toUpperCase()){case"M":case"L":case"C":case"S":case"Q":case"T":s+=e.coordinates.join(",");break;case"H":s+=e.coordinates[0];break;case"V":s+=e.coordinates[1];break;case"A":s+=`${e.radiusX},${e.radiusY},${e.xAxisRotation},${e.largeArcFlag},${e.sweepFlag},${e.coordinates.join(",")}`}return e?_.truncateString(s,e):s}static drawRefit(t,e,s){let i;if(p.path(t)){if(i=A.getNamedItem(t,"d"),e&&e.requireRefit){const t=N.getPathCommands(i);if(t.length){const n=N.getPathPoints(t);n.length&&(e.refitPoints(n),i=N.drawPath(N.syncPathPoints(t,n),s))}}}else if(p.line(t)){const n=[{x:t.x1.baseVal.value,y:t.y1.baseVal.value},{x:t.x2.baseVal.value,y:t.y2.baseVal.value}];e&&e.requireRefit&&e.refitPoints(n),i=N.drawPolyline(n,s)}else if(p.circle(t)||p.ellipse(t)){let n,a;p.ellipse(t)?(n=t.rx.baseVal.value,a=t.ry.baseVal.value):a=n=t.r.baseVal.value;const r=[{x:t.cx.baseVal.value,y:t.cy.baseVal.value,rx:n,ry:a}];e&&e.requireRefit&&e.refitPoints(r);const o=r[0];i=N.drawEllipse(o.x,o.y,o.rx,o.ry,s)}else if(p.rect(t)){let n=t.x.baseVal.value,a=t.y.baseVal.value,r=t.width.baseVal.value,o=t.height.baseVal.value;e&&e.requireRefit&&(n=e.refitX(n),a=e.refitY(a),r=e.refitSize(r),o=e.refitSize(o)),i=N.drawRect(r,o,n,a,s)}else if(p.polygon(t)||p.polyline(t)){const n=N.clonePoints(t.points);e&&e.requireRefit&&e.refitPoints(n),i=p.polygon(t)?N.drawPolygon(n,s):N.drawPolyline(n,s)}else i="";return i}static transformRefit(t,e,s,i,n){const a=N.getPathCommands(t);if(a.length){let r=N.getPathPoints(a);if(r.length){const o=e&&e.length>0;o&&(r=N.applyTransforms(e,r,s&&f.origin(s.element))),i&&i.requireRefit&&i.refitPoints(r),t=N.drawPath(N.syncPathPoints(a,r,o),n)}}return t}static getOffsetPath(t,e="auto 0deg"){const s=b(t),i=Math.ceil(s.getTotalLength()),n=[];if(i>0){const a=[],r=[];let o=0,l=0;if(x.isAngle(e))o=x.parseAngle(e);else{const s=N.getPathCommands(t);for(const t of s)switch(t.key.toUpperCase()){case"M":case"L":case"H":case"V":case"Z":for(const e of t.value)a.push(e),r.push(!1);break;case"C":case"S":case"Q":case"T":case"A":a.push(t.end),r.push(!0)}"auto 0deg"!==e&&(l=x.parseAngle(e.split(" ").pop()))}let c,h=!1,u=0,f=0;for(let t=0;t<=i;t++){const e=s.getPointAtLength(t);if(a.length){const t=a.findIndex(t=>{const s=""+t.x,i=""+t.y;return s===e.x.toPrecision(s.length-(-1!==s.indexOf(".")?1:0))&&i===e.y.toPrecision(i.length-(-1!==i.indexOf(".")?1:0))});if(-1!==t){const s=a[t+1];s?(h=r[t+1])?(c=N.centerPoints(a[t],s),o=0):(c=void 0,o=_.truncateFraction(_.absoluteAngle(e,s))):c=void 0,f=0,a.splice(0,t+1),r.splice(0,t+1)}}let i;h?(i=c?_.truncateFraction(_.relativeAngle(c,e)):0,u>0&&u%360==0&&0===Math.floor(i)&&(f=u),i+=f):i=o,n.push({key:t,value:e,rotate:i+=l}),u=Math.ceil(i)}}return n}static getPathCommands(t){M.lastIndex=0;const e=[];let s;for(t=t.trim();null!==(s=M.exec(t))&&(0!==e.length||"M"===s[1].toUpperCase());){const t=N.parseCoordinates((s[2]||"").trim());let i,n,a,r,o,l,c;if(e.length){const t=e[e.length-1];i=t.key.toUpperCase(),n=t.end}switch(s[1].toUpperCase()){case"M":0===e.length&&(s[1]="M");case"L":if(t.length>=2){t.length%2!=0&&t.length--;break}continue;case"H":if(n&&t.length){t[1]="h"===s[1]?0:n.y,t.length=2;break}continue;case"V":if(n&&t.length){const e=t[0];t[0]="v"===s[1]?0:n.x,t[1]=e,t.length=2;break}continue;case"Z":if(e.length){const i=e[0].coordinates;t[0]=i[0],t[1]=i[1],t.length=2,s[1]="Z";break}continue;case"C":if(t.length>=6){t.length=6;break}continue;case"S":if(t.length>=4&&("C"===i||"S"===i)){t.length=4;break}continue;case"Q":if(t.length>=4){t.length=4;break}continue;case"T":if(t.length>=2&&("Q"===i||"T"===i)){t.length=2;break}continue;case"A":if(t.length>=7){a=t[0],r=t[1],o=t[2],l=t[3],c=t[4],t[0]=t[5],t[1]=t[6],t.length=2;break}continue;default:continue}const h=t.length;if(h>=2){const i=s[1]===s[1].toLowerCase(),u=[];for(let e=0;e<h;e+=2){let s=t[e],a=t[e+1];i&&n&&(s+=n.x,a+=n.y),u.push({x:s,y:a})}e.push({key:s[1],value:u,start:u[0],end:u[u.length-1],relative:i,coordinates:t,radiusX:a,radiusY:r,xAxisRotation:o,largeArcFlag:l,sweepFlag:c})}}return e}static getPathPoints(t,e=!1){const s=[];let i=0,n=0;for(const a of t){const t=a.coordinates,r=t.length;for(let o=0;o<r;o+=2){a.relative?(i+=t[o],n+=t[o+1]):(i=t[o],n=t[o+1]);const r={x:i,y:n};"A"===a.key.toUpperCase()&&(r.rx=a.radiusX,r.ry=a.radiusY,e&&(t[o]>=0?r.y-=a.radiusY:r.y+=a.radiusY)),s.push(r)}a.relative&&(a.key=a.key.toUpperCase())}return s}static syncPathPoints(t,e,s=!1){t:{let i;for(const n of t){const a=n.coordinates;if(n.relative){if(!i)break;if(!s||"H"!==n.key&&"V"!==n.key){const t=a.length;for(let s=0,r=0;s<t;s+=2,r++){const t=e.shift();if(!t)break t;a[s]=t.x-i.x,a[s+1]=t.y-i.y,"a"===n.key&&void 0!==t.rx&&void 0!==t.ry&&(n.radiusX=t.rx,n.radiusY=t.ry),n.value[r]=t}n.key=n.key.toLowerCase()}else{const t=e.shift();if(!t)break t;a[0]=t.x,a[1]=t.y,n.value[0]=t,n.start=t,n.end=t,n.key="L",n.relative=!1}i=n.end}else{switch(n.key.toUpperCase()){case"M":case"L":case"H":case"V":case"C":case"S":case"Q":case"T":case"Z":{const s=a.length;for(let i=0,r=0;i<s;i+=2,r++){const s=e.shift();if(!s){t=[];break t}a[i]=s.x,a[i+1]=s.y,n.value[r]=s}break}case"A":{const s=e.shift();if(!s||void 0===s.rx||void 0===s.ry){t=[];break t}a[0]=s.x,a[1]=s.y,n.radiusX=s.rx,n.radiusY=s.ry,n.value[0]=s;break}}n.relative||(i=n.end)}}}return t}static filterTransforms(t,e){const s=[];for(const i of t)if(void 0===e||!e.includes(i.type)){switch(i.type){case SVGTransform.SVG_TRANSFORM_ROTATE:case SVGTransform.SVG_TRANSFORM_SKEWX:case SVGTransform.SVG_TRANSFORM_SKEWY:if(0===i.angle)continue;break;case SVGTransform.SVG_TRANSFORM_SCALE:if(1===i.matrix.a&&1===i.matrix.d)continue;break;case SVGTransform.SVG_TRANSFORM_TRANSLATE:if(0===i.matrix.e&&0===i.matrix.f)continue}s.push(i)}return s}static applyTransforms(t,e,s){t=t.slice(0).reverse();const i=N.clonePoints(e);for(const e of t){const t=e.matrix;let n=0,a=0,r=0,o=0;if(s)switch(e.type){case SVGTransform.SVG_TRANSFORM_SCALE:e.method.x&&(r=s.x*(1-t.a)),e.method.y&&(o=s.y*(1-t.d));break;case SVGTransform.SVG_TRANSFORM_SKEWX:e.method.y&&(a-=s.y);break;case SVGTransform.SVG_TRANSFORM_SKEWY:e.method.x&&(n-=s.x);break;case SVGTransform.SVG_TRANSFORM_ROTATE:e.method.x&&(n-=s.x,r=s.x+_.offsetAngleY(e.angle,s.x)),e.method.y&&(a-=s.y,o=s.y+_.offsetAngleY(e.angle,s.y))}for(const s of i){const i=s.x;if(s.x=u.applyX(t,i,s.y+a)+r,s.y=u.applyY(t,i+n,s.y)+o,e.type===SVGTransform.SVG_TRANSFORM_SCALE&&void 0!==s.rx&&void 0!==s.ry){const e=s.rx;s.rx=u.applyX(t,e,s.ry+a),s.ry=u.applyY(t,e+n,s.ry)}}}return i}static convertTransforms(t){const e=[];for(let s=0;s<t.numberOfItems;s++){const i=t.getItem(s);e.push(f.create(i.type,i.matrix,i.angle))}return e}static clonePoints(t){const e=[];if(Array.isArray(t))for(const s of t){const t={x:s.x,y:s.y};void 0!==s.rx&&void 0!==s.ry&&(t.rx=s.rx,t.ry=s.ry),e.push(t)}else{const s=t.numberOfItems;for(let i=0;i<s;i++){const s=t.getItem(i);e.push({x:s.x,y:s.y})}}return e}static minMaxPoints(t){let e=t[0].x,s=e,i=t[0].y,n=i;const a=t.length;for(let r=1;r<a;r++){const a=t[r];a.x<e?e=a.x:a.x>s&&(s=a.x),a.y<i?i=a.y:a.y>n&&(n=a.y)}return[e,i,s,n]}static centerPoints(...t){const e=this.minMaxPoints(t);return{x:(e[0]+e[2])/2,y:(e[1]+e[3])/2}}static convertPoints(t){const e=[],s=t.length;if(s%2==0)for(let i=0;i<s;i+=2)e.push({x:t[i],y:t[i+1]});return e}static parsePoints(t){const e=[];for(const s of t.trim().split(R.CHAR.SPACE)){const[t,i]=V.replaceMap(s.split(R.XML.SEPARATOR),t=>parseFloat(t));e.push({x:t,y:i})}return e}static parseCoordinates(t){w.lastIndex=0;const e=[];let s;for(;null!==(s=w.exec(t));){const t=parseFloat(s[0]);isNaN(t)||e.push(t)}return e}static getBoxRect(t){let e=[];for(const s of t)e=e.concat(N.getPathPoints(N.getPathCommands(s),!0));const s=this.minMaxPoints(e);return{top:s[1],right:s[2],bottom:s[3],left:s[0]}}}const E=squared.lib.dom;function F(t,e,s,i,n){for(const a of t)a.x+=e,a.y+=s,void 0!==a.rx&&void 0!==a.ry&&(a.rx*=i,a.ry*=n)}var C=t=>(class extends t{constructor(){super(...arguments),this._baseVal={}}setBaseValue(t,e){if(void 0!==e){if(this.verifyBaseValue(t,e))return this._baseVal[t]=e,!0}else switch(t){case"d":return this._baseVal[t]=E.getNamedItem(this.element,"d"),!0;case"points":const e=this.element[t];if(Array.isArray(e))return this._baseVal[t]=N.clonePoints(e),!0;break;default:const s=this.element[t];if(s&&s.baseVal)return this._baseVal[t]=s.baseVal.value,!0}return!1}getBaseValue(t,e){const s=this._baseVal[t];return void 0!==s||this.setBaseValue(t)?s:e}refitBaseValue(t,e,s,i=1,n=1){const a=this._baseVal;for(const r in a){const o=a[r];if("string"==typeof o){if("d"===r){const l=N.getPathCommands(o),c=N.getPathPoints(l);F(c,t,e,i,n),a[r]=N.drawPath(N.syncPathPoints(l,c),s)}}else if("number"==typeof o)switch(r){case"cx":case"x1":case"x2":case"x":a[r]+=t;break;case"cy":case"y1":case"y2":case"y":a[r]+=e;break;case"r":a[r]*=Math.min(i,n);break;case"rx":case"width":a[r]*=i;break;case"ry":case"height":a[r]*=n}else Array.isArray(o)&&"points"===r&&F(o,t,e,i,n)}}verifyBaseValue(t,e){switch(t){case"d":return"string"==typeof e;case"cx":case"cy":case"r":case"rx":case"ry":case"x1":case"x2":case"y1":case"y2":case"x":case"y":case"width":case"height":return"number"==typeof e;case"points":return Array.isArray(e)}}});const{css:G,dom:O,util:B}=squared.lib,L={MS:/-?\d+ms$/,S:/-?\d+s$/,MIN:/-?\d+min$/,H:/-?\d+(.\d+)?h$/,CLOCK:/^(?:(-?)(\d?\d):)?(?:(\d?\d):)?(\d?\d)\.?(\d?\d?\d)?$/};class I{constructor(t,e){if(this.element=null,this.animationElement=null,this.paused=!1,this.fillMode=0,this.synchronizeState=0,this._attributeName="",this._duration=-1,this._delay=0,this._to="",t&&(this.element=t),e){this.animationElement=e,this.setAttribute("attributeName"),this.setAttribute("to"),this.setAttribute("fill","freeze");const t=O.getNamedItem(e,"dur");""!==t&&"indefinite"!==t&&(this.duration=I.convertClockTime(t))}}static convertClockTime(t){let e=0,s=0;if(B.isNumber(t))e=parseInt(t);else if(L.MS.test(t))s=parseFloat(t);else if(L.S.test(t))e=parseFloat(t);else if(L.MIN.test(t))e=60*parseFloat(t);else if(L.H.test(t))e=60*parseFloat(t)*60;else{const i=L.CLOCK.exec(t);i&&(i[2]&&(e+=60*parseInt(i[2])*60),i[3]&&(e+=60*parseInt(i[3])),i[4]&&(e+=parseInt(i[4])),i[5]&&(s=parseInt(i[5])*(i[5].length<3?Math.pow(10,3-i[5].length):1)),i[1]&&(e*=-1,s*=-1))}return 1e3*e+s}setAttribute(t,e){const s=this.animationElement;if(s){const i=O.getNamedItem(s,t);""!==i&&(void 0!==e?this[t+B.capitalize(e)]=i===e:this[t]=i)}}addState(...t){for(const e of t)B.hasBit(this.synchronizeState,e)||(this.synchronizeState|=e)}removeState(...t){for(const e of t)B.hasBit(this.synchronizeState,e)&&(this.synchronizeState^=e)}hasState(...t){return t.some(t=>B.hasBit(this.synchronizeState,t))}setFillMode(t,e){const s=B.hasBit(this.fillMode,e);t?s||(this.fillMode|=e):s&&(this.fillMode^=e)}set attributeName(t){if("transform"!==t&&!B.isString(this.baseValue)){let e;const s=this.element;if(s)switch(t){case"opacity":case"stroke-opacity":case"fill-opacity":e=g(s,t,!1)||"1";break;default:e=g(s,t)}if(!B.isString(e)){const s=this.animationElement;if(s){const i=s.parentElement;e=B.optionalAsString(i,t+".baseVal.valueAsString"),G.isLength(e)&&(e=""+G.parseUnit(e,G.getFontSize(i)))}}void 0!==e&&(this.baseValue=e)}this._attributeName=t}get attributeName(){return this._attributeName}set delay(t){this._delay=t}get delay(){return this._delay}set duration(t){this._duration=Math.round(t)}get duration(){return this._duration}set to(t){this._to=t}get to(){return this._to}set fillBackwards(t){this.setFillMode(t,8)}get fillBackwards(){return B.hasBit(this.fillMode,8)}set fillForwards(t){this.setFillMode(t,4)}get fillForwards(){return B.hasBit(this.fillMode,4)}set fillFreeze(t){this.setFillMode(t,2)}get fillFreeze(){return B.hasBit(this.fillMode,2)}get fillReplace(){const t=this.fillMode;return 0===t||8===t}get parentContainer(){let t=this._parent;for(;t&&!N.isContainer(t);)t=t.parent;return t}set parent(t){this._parent=t}get parent(){return this._parent}set group(t){this._group=t}get group(){return this._group||{id:-1/0,name:""}}set setterType(t){}get setterType(){return!0}get instanceType(){return 8}}const $={ease:"0.25 0.1 0.25 1","ease-in":"0.42 0 1 1","ease-in-out":"0.42 0 0.58 1","ease-out":"0 0 0.58 1",linear:"0 0 1 1","step-start":"0 1 0 1","step-end":"1 0 1 0"};var z=Object.freeze({__proto__:null,KEYSPLINE_NAME:$});const{color:X,css:q,dom:j,regex:W,util:Y}=squared.lib,D=t=>parseFloat((1-t).toPrecision(5));class U extends I{constructor(t,e){if(super(t,e),this.type=0,this.from="",this.additiveSum=!1,this.accumulateSum=!1,this.evaluateStart=!1,this._iterationCount=1,this._reverse=!1,this._alternate=!1,this._setterType=!1,this._repeatDuration=-1,e){const t=j.getNamedItem(e,"values"),s=-1!==this.duration?U.toFractionList(j.getNamedItem(e,"keyTimes")):[];if(""!==t){const e=Y.trimEnd(t,";").split(/\s*;\s*/);this.values=e;const i=e.length;i>1&&i===s.length?(this.from=e[0],this.to=e[i-1],this.keyTimes=s):1===i&&(this.to=this.values[0],this.convertToValues())}else{if(this.from=j.getNamedItem(e,"from"),""===this.to){const t=j.getNamedItem(e,"by"),s=N.parseCoordinates(t);if(s.length){if(""===this.from){const t=this.baseValue;t&&(this.from=t),this.evaluateStart=!0}const t=N.parseCoordinates(this.from),e=t.length;if(s.length===e){const i=[];for(let n=0;n<e;n++)i.push(t[n]+s[n]);this.to=i.join(",")}}}N.parseCoordinates(this.to).length&&this.setAttribute("additive","sum"),this.convertToValues(s)}const i=j.getNamedItem(e,"repeatDur");""!==i&&"indefinite"!==i&&(this._repeatDuration=I.convertClockTime(i));const n=j.getNamedItem(e,"repeatCount");this.iterationCount="indefinite"===n?-1:parseFloat(n),"animate"===e.tagName&&this.setCalcMode()}}static getSplitValue(t,e,s){return t+(e-t)*s}static convertStepTimingFunction(t,e,s,i,n,a){let r,o;switch(t){case"fill":case"stroke":const t=X.parseColor(i[n]),e=X.parseColor(i[n+1]);t&&e&&(r=[t],o=[e]);break;case"points":r=N.convertPoints(N.parseCoordinates(i[n])),o=N.convertPoints(N.parseCoordinates(i[n+1]));break;case"rotate":case"scale":case"translate":r=Y.replaceMap(i[n].trim().split(W.CHAR.SPACE),t=>parseFloat(t)),o=Y.replaceMap(i[n+1].trim().split(W.CHAR.SPACE),t=>parseFloat(t));break;default:const s=i[n],l=i[n+1];Y.isNumber(s)?r=[parseFloat(s)]:q.isLength(s)&&(r=[q.parseUnit(s,a)]),Y.isNumber(l)?o=[parseFloat(l)]:q.isLength(l)&&(o=[q.parseUnit(l,a)])}if(r&&o){const i=r.length;if(i===o.length){switch(e){case"step-start":e="steps(1, start)";break;case"step-end":e="steps(1, end)"}const a=/steps\((\d+)(?:, (start|end))?\)/.exec(e);if(a){const e=s[n+1]-s[n],l=parseInt(a[1]),c=100/l,h=[],u=[];for(let f=0;f<=l;f++){const p=s[n]+e*(f/l),d=c*(f+(0===f&&"start"===a[2]?1:0))/100,g=[];switch(t){case"fill":case"stroke":{const t=r[0].rgba,e=o[0].rgba,s=X.getHexCode(U.getSplitValue(t.r,e.r,d),U.getSplitValue(t.g,e.g,d),U.getSplitValue(t.b,e.b,d)),i=X.getHexCode(U.getSplitValue(t.a,e.a,d));g.push("#"+(s+("FF"!==i?i:"")));break}case"points":for(let t=0;t<i;t++){const e=r[t],s=o[t];g.push(U.getSplitValue(e.x,s.x,d)+","+U.getSplitValue(e.y,s.y,d))}break;default:for(let t=0;t<i;t++)g.push(""+U.getSplitValue(r[t],o[t],d))}if(!g.length)return;h.push(p),u.push(g.join(" "))}return[h,u]}}}}static toFractionList(t,e=";",s=!0){let i=0;const n=Y.replaceMap(t.split(e),t=>{const e=parseFloat(t);return isNaN(e)||s&&!(e>=i&&e<=1)?-1:(i=e,e)});return n.length>1&&(!s||0===n[0]&&n.some(t=>-1!==t))?n:[]}setCalcMode(t,e){const s=this.animationElement;if(s){void 0===e&&(e=j.getNamedItem(s,"calcMode")||"linear");const i=this.keyTimes;switch(e){case"discrete":if(2===i.length&&0===i[0]){const e=this.values;let n=[],a=[];const r=i.length;for(let o=0;o<r-1;o++){const r=U.convertStepTimingFunction(t||this.attributeName,"step-end",i,e,o,q.getFontSize(s));r&&(n=n.concat(r[0]),a=a.concat(r[1]))}n.push(i.pop()),a.push(e.pop()),this._values=a,this._keyTimes=n,this._keySplines=[$["step-end"]]}break;case"paced":this._keySplines=void 0;break;case"spline":this.keySplines=Y.flatMap(j.getNamedItem(s,"keySplines").split(";"),t=>t.trim());case"linear":if(0!==i[0]&&1!==i[i.length-1]){const t=[],e=this.values.length;for(let s=0;s<e;s++)t.push(s/(e-1));this._keyTimes=t,this._keySplines=void 0}}}}convertToValues(t){if(this.to){if(this.values=[this.from,this.to],""===this.from&&(this.evaluateStart=!0),t&&2===t.length){const e=this.keyTimes;if(2!==e.length||0===e[0]&&e[1]<=1)return void(this.keyTimes=t)}this.keyTimes=[0,1]}}setGroupOrdering(t){if(this.group.ordering=t,this.fillBackwards){const e=this.group.name;for(let s=t.length-1,i=!1;s>=0;s--){const n=t[s];if(i){if("forwards"!==n.fillMode){this.fillBackwards=!1;break}}else n.name===e&&(i=!0)}}}getIntervalEndTime(t){const e=this.getTotalDuration();if(t<e){const{duration:s,keyTimes:i}=this;let n=this.delay;for(;n+s<=t;)n+=s;return Math.min(n+i[i.length-1]*s,e)}return e}getTotalDuration(t=!1){let e=this.iterationCount;return t&&-1===e&&(e=1),-1!==e?Math.min(this.delay+this.duration*e,this.end||1/0):1/0}set delay(t){super.delay=t;const e=this.animationElement,s=e&&j.getNamedItem(e,"end");if(s){const t=Y.sortNumber(Y.replaceMap(s.split(";"),t=>I.convertClockTime(t)))[0];if(!isNaN(t)){const{duration:e,iterationCount:s}=this;(-1===s||e>0&&t<e*s)&&(this.delay>t?(this.end=t,-1===s&&(this.iterationCount=Math.ceil((this.end-this.delay)/e))):this.duration=-1)}}}get delay(){return super.delay}set duration(t){super.duration=t}get duration(){const t=super.duration;return-1===t&&-1!==this._repeatDuration?this._repeatDuration:t}set iterationCount(t){const e=this.animationElement;this._iterationCount=isNaN(t)?1:t,this.fillFreeze=-1!==this.iterationCount&&!!e&&"freeze"===j.getNamedItem(e,"fill"),1!==this.iterationCount?this.setAttribute("accumulate","sum"):this.accumulateSum=!1}get iterationCount(){const t=this.duration;if(t>0){const e=this._iterationCount,s=this._repeatDuration;return-1!==s&&(-1===e||s<e*t)?s/t:e}return 1}set to(t){super.to=t}get to(){return this._setterType?this.valueTo||super.to:this.setterType?this.values[0]:super.to}set values(t){this._values=t,t&&t.length!==this.keyTimes.length&&(this._keyTimes=void 0,this._keySplines=void 0)}get values(){return void 0===this._values&&(this._values=[]),this._values}get valueTo(){const t=this._values;return t?t[t.length-1]:""}get valueFrom(){return this.values[0]||""}set keyTimes(t){const e=this._values;void 0!==e&&e.length!==t.length||!t.every(t=>t>=0&&t<=1)||(this._keyTimes=t)}get keyTimes(){return void 0===this._keyTimes&&(this._keyTimes=[]),this._keyTimes}set keySplines(t){if(t&&t.length){const e=this.keyTimes.length-1;if(t.length>=e&&!t.every(t=>""===t||t===$.linear)){const s=[];for(let i=0;i<e;i++){const e=Y.replaceMap(t[i].split(" "),t=>parseFloat(t));4===e.length&&!e.some(t=>isNaN(t))&&e[0]>=0&&e[0]<=1&&e[2]>=0&&e[2]<=1?s.push(e.join(" ")):s.push($.linear)}this._keySplines=s}}else this._keySplines=void 0}get keySplines(){return this._keySplines}set timingFunction(t){this._timingFunction=t}get timingFunction(){return this._timingFunction||this.keySplines&&this.keySplines[0]}set reverse(t){if(this.length&&t!==this._reverse){const t=this.keyTimes,e=this._keySplines,s=t.length,i=Array(s);for(let e=s-1,n=0;e>=0;)i[n++]=1-t[e--];if(this.keyTimes=i,this.values.reverse(),e){const t=[];for(let s=e.length-1;s>=0;s--){const i=Y.replaceMap(e[s].split(" "),t=>parseFloat(t));t.push(4===i.length?D(i[2])+" "+D(i[3])+" "+D(i[0])+" "+D(i[1]):$.linear)}this._keySplines=t}}this._reverse=t}get reverse(){return this._reverse}set alternate(t){this._alternate=t}get alternate(){return this._alternate}get playable(){return!this.paused&&this.duration>0&&this.keyTimes.length>1}get fillReplace(){return super.fillReplace||-1===this.iterationCount}get fromToType(){const t=this.keyTimes;return 2===t.length&&0===t[0]&&1===t[1]}get partialType(){const t=this.keyTimes;return t.length>1&&t[t.length-1]<1}set setterType(t){this._setterType=t}get setterType(){if(this._setterType)return!0;if(null!==this.animationElement&&0===this.duration){const t=this.keyTimes;return t.length>=2&&0===t[0]&&""!==this.values[0]}return!1}set length(t){0===t&&(this._values=void 0)}get length(){const t=this._values;return t?t.length:0}get instanceType(){return 16392}}const{dom:K,util:H}=squared.lib;class Z extends U{constructor(t,e){if(super(t,e),this.attributeName="transform",e){const t=K.getNamedItem(e,"type");this.setType(t),this.setCalcMode(t)}}static toRotateList(t){const e=[];for(const s of t)if(""===s)e.push([0,0,0]);else{const t=N.parseCoordinates(s);if(1===t.length&&(t[1]=0),2===t.length&&(t[2]=0),3!==t.length)return;e.push(t)}return e}static toScaleList(t){const e=[];for(const s of t)if(""===s)e.push([1,1,0,0]);else{const t=N.parseCoordinates(s);if(1===t.length&&(t[1]=t[0]),2===t.length&&(t[2]=0,t[3]=0),4!==t.length)return;e.push(t)}return e}static toTranslateList(t){const e=[];for(const s of t)if(""===s)e.push([0,0]);else{const t=N.parseCoordinates(s);if(1===t.length&&(t[1]=0),2!==t.length)return;e.push(t)}return e}static toSkewList(t){const e=[];for(const s of t)if(""===s)e.push([0]);else{const t=N.parseCoordinates(s);if(1!==t.length)return;e.push(t)}return e}expandToValues(){if(this.additiveSum){const t=this.iterationCount;if(-1!==t&&this.keyTimes.length){const e=this.duration;if(e>0){const s=e*t;t:{const i=this.keyTimes,n=this.keySplines,a=this.values,r=this.type,o=[],l=[],c=[];let h;const u=i.length;for(let f=0;f<t;f++){f>0&&n&&c.push("");for(let p=0;p<u;p++){const d=N.parseCoordinates(a[p]),g=d.length;if(!g)break t;{let a;switch(r){case SVGTransform.SVG_TRANSFORM_TRANSLATE:1===g?a=[d[0],0]:2===g&&(a=d);break;case SVGTransform.SVG_TRANSFORM_SCALE:1===g?a=[d[0],d[0]]:2===g&&(a=d);break;case SVGTransform.SVG_TRANSFORM_ROTATE:1===g?a=[d[0],0,0]:3===g&&(a=d);break;case SVGTransform.SVG_TRANSFORM_SKEWX:case SVGTransform.SVG_TRANSFORM_SKEWY:1===g&&(a=d)}if(!a)break t;{let r=(i[p]+f)*e;if(h){const t=a.length;for(let e=0;e<t;e++)a[e]+=h[e]}f<t-1&&p===u-1&&(this.accumulateSum&&(h=a),r--),o.push(r/s),l.push(a.join(" ")),n&&p<u-1&&c.push(n[p])}}}}this.values=l,this.keyTimes=o,this.keySplines=c.length?c:void 0,this.duration=s,this.iterationCount=1,this.accumulateSum=!1}}}}}setType(t){let e;switch(t){case"translate":this.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,this.animationElement&&(e=Z.toTranslateList(this.values));break;case"scale":this.type=SVGTransform.SVG_TRANSFORM_SCALE,this.animationElement&&(e=Z.toScaleList(this.values));break;case"rotate":this.type=SVGTransform.SVG_TRANSFORM_ROTATE,this.animationElement&&(e=Z.toRotateList(this.values));break;case"skewX":this.type=SVGTransform.SVG_TRANSFORM_SKEWX,this.animationElement&&(e=Z.toSkewList(this.values));break;case"skewY":this.type=SVGTransform.SVG_TRANSFORM_SKEWY,this.animationElement&&(e=Z.toSkewList(this.values));break;default:return}e&&(this.values=H.replaceMap(e,t=>t.join(" "))),this.baseValue=f.typeAsValue(this.type)}get instanceType(){return 49160}}const Q=squared.lib.util;class J{constructor(t,...e){t=(e.length?Q.filterArray(t,t=>e.includes(t.attributeName)):t.slice(0)).sort((t,e)=>t.delay===e.delay?t.group.id<e.group.id?1:-1:t.delay<e.delay?-1:1),e.length=0;for(const s of t){const t=J.getKeyName(s);e.includes(t)||e.push(t)}this.map={};const s={},i={};function n(t,e,n,a=0,r,o=!1,l=!1,c=0,h=!1,u){if(n){const f=s[t];void 0===f[e]&&(f[e]=[]),f[e].push({time:e,value:n,animation:r,start:o,end:l,endTime:a,fillMode:c,infinite:h,valueFrom:u}),i[t].add(e)}}for(const r of e){this.map[r]=new Map,s[r]={},i[r]=new Set;const e=-1!==(a=r).indexOf(":")?a.split(":")[0]:a,o=t.filter(t=>t.fillBackwards&&t.attributeName===e).sort((t,e)=>t.group.id<e.group.id?1:-1)[0];o&&n(r,0,o.values[0],o.delay,o,0===o.delay,!1,8)}var a;for(const e of t){const t=J.getKeyName(e);if(e.baseValue&&void 0===s[t][-1]&&n(t,-1,e.baseValue),e.setterType){const s=e.fillReplace&&e.duration>0;n(t,e.delay,e.to,s?e.delay+e.duration:0,e,s,!s,2),s&&n(t,e.delay+e.duration,"",0,e,!1,!0,2)}else if(N.isAnimate(e)&&e.duration>0){const s=-1===e.iterationCount,i=e.getTotalDuration();n(t,e.delay,e.valueTo,i,e,!0,!1,0,s,e.valueFrom),s||e.fillReplace||n(t,i,e.valueTo,0,e,!1,!0,e.fillForwards?4:2)}}for(const t in s)for(const e of Q.sortNumber(Array.from(i[t]))){const i=s[t][e];for(let e=0;e<i.length;e++){const s=i[e];if(""===s.value||s.start&&s.animation&&N.isAnimate(s.animation)&&s.animation.evaluateStart){let n;for(const e of this.map[t].values())for(const t of e)if(s.animation!==t.animation&&""!==t.value&&(-1===t.time||4===t.fillMode||2===t.fillMode)){n=t.value;break}n?s.value=n:""===s.value&&i.splice(e--,1)}}i.length&&(i.sort((t,e)=>t.animation&&e.animation?t.fillMode===e.fillMode?t.animation.group.id<e.animation.group.id?1:-1:t.fillMode<e.fillMode?1:-1:0),this.map[t].set(e,i))}for(const t in this.map)for(const[e,s]of this.map[t].entries())for(const i of s)if(i.animation)if(2===i.fillMode){const s=[];for(const[n,a]of this.map[t].entries())if(n<e)for(const t of a)t.start&&t.animation&&t.animation.animationElement&&s.push(t.animation);else if(n>e)for(let t=0;t<a.length;t++){const e=a[t];e.end&&s.includes(e.animation)&&a.splice(t--,1)}else for(let t=0;t<a.length;t++){const e=a[t];e.end&&e.animation&&e.animation.animationElement&&e.animation.group.id<i.animation.group.id&&a.splice(t--,1)}}else if(4===i.fillMode||i.infinite){const s=i.animation.group;let n=!1;if(s.ordering){const t=i.animation.getTotalDuration(),e=s.name;for(const i of s.ordering)if(i.name===e)n=!0;else if(J.getGroupEndTime(i)>=t)break}const a=[];for(const[s,r]of this.map[t].entries())if(!n&&s<e)for(const t of r)t.start&&t.animation&&a.push(t.animation);else if(s>e)for(let t=0;t<r.length;t++){const e=r[t];(n||e.animation&&(e.end&&a.includes(e.animation)||null===i.animation.animationElement&&e.animation.group.id<i.animation.group.id))&&r.splice(t--,1)}else for(let t=0;t<r.length;t++){const e=r[t];e.end&&e.animation&&e.animation.group.id<i.animation.group.id&&r.splice(t--,1)}}for(const t in this.map){const e=this.map[t];for(const[t,s]of Array.from(e.entries()))0===s.length&&e.delete(t)}}static getGroupEndTime(t){return"infinite"===t.iterationCount?1/0:t.delay+t.duration*parseInt(t.iterationCount)}static getKeyName(t){return t.attributeName+(N.isAnimateTransform(t)?":"+f.typeAsName(t.type):"")}has(t,e,s){const i=this.map[t];return void 0!==e?!(!i||!i.has(e))&&(void 0===s||-1!==i.get(e).findIndex(t=>t.animation===s)):void 0!==i}get(t,e,s=!1){const i=this.map[t];let n;if(i)for(const[t,a]of i.entries()){if(!(t<=e))break;for(const i of a)if(""!==i.value&&(-1===i.time||i.end&&(4===i.fillMode||2===i.fillMode))||s&&i.start&&e!==t){n=i.value;break}}return n}paused(t,e){const s=this.map[t];let i=0;if(s)for(const[t,n]of s.entries()){if(!(t<=e))break;for(const t of n)if(t.start&&(t.infinite||0===t.fillMode&&t.endTime>e)){if(!t.animation){i=1;break}i=2}else if(t.end&&(4===t.fillMode||1===i&&2===t.fillMode)){i=0;break}}return 0===i}evaluateStart(t,e){if(t.evaluateStart){const s=this.get(t.attributeName,t.delay)||e&&""+e||t.baseValue;if(s){const e=t.values;t.reverse?e[e.length-1]=s:e[0]=s}t.evaluateStart=!1}return t.values}}const{math:tt,regex:et,util:st}=squared.lib,it=["x1","y1","x2","y2"],nt=["width","height","x","y"],at=["points"],rt=["cx","cy","r"],ot=["cx","cy","rx","ry"];function lt(t,e,s,i,n){let a,r,o,l=0;for(const[e,i]of t.entries()){if(s===e){r={key:e,value:i};break}if(s>l&&s<e&&void 0!==a){r={key:l,value:a},o={key:e,value:i};break}l=e,a=i}if(r&&o)kt(t,s,vt(s,r.key,r.value,o.key,o.value),!0);else if(r)kt(t,s,r.value,!0);else if(!n){let n=i.get(e,s,!0);n&&""!==(n=ht(n,!0))&&kt(t,s,n)}}function ct(t){const e=new Set,s=t.length,i=t[s-1][0];for(let n=0;n<s;n++){let s=t[n][0]/i;if(s>0)for(let t=7;;t++){const i=parseFloat((""+s).substring(0,t));if(!e.has(i)){s=i;break}}t[n][0]=s,e.add(s)}return t}function ht(t,e=!1){return"string"==typeof t&&(st.isNumber(t)?t=parseFloat(t):0===(t=N.parsePoints(t)).length&&(t="")),e&&"string"==typeof t?"":t}function ut(t,e){let s;if(t)for(const i of t){if(!(i.time<=e))break;s=i.value}return s}function ft(t,e,s,i,n){const a=[],r=e.element.tagName;let o;switch(r){case"line":o=it;break;case"rect":o=nt;break;case"polyline":case"polygon":o=at;break;case"circle":o=rt;break;case"ellipse":o=ot;break;default:return}const l=f.origin(e.element),c=t.length;for(let h=0;h<c;h++){const c=t[h][0],u=t[h][1],f=[];for(const t of o){let s=u.get(t);if(void 0===s&&(void 0===s&&(s=ut(i[t],c)),void 0===s&&(s=e.getBaseValue(t))),void 0===s)return;f.push(s)}let p;switch(r){case"line":p=pt(f);break;case"rect":p=dt(f);break;case"polygon":case"polyline":p=f[0];break;case"circle":case"ellipse":p=Rt(f)}if(p){let t;switch(e.transformed&&(p=N.applyTransforms(e.transformed,p,l)),s&&s.refitPoints(p),r){case"line":case"polyline":t=N.drawPolyline(p,n);break;case"rect":case"polygon":t=N.drawPolygon(p,n);break;case"circle":case"ellipse":const e=p[0];t=N.drawEllipse(e.x,e.y,e.rx,e.ry,n)}void 0!==t&&a.push({key:c,value:t})}}return a}function pt(t){return[{x:t[0],y:t[1]},{x:t[2],y:t[4]}]}function dt(t){const e=t[0],s=t[1],i=t[2],n=t[3];return[{x:i,y:n},{x:i+e,y:n},{x:i+e,y:n+s},{x:i,y:n+s}]}function gt(t,e,s){const i=new Map;for(const n of e){const e=new Map;for(const i in t){let a;void 0!==(a=t[i].has(n)?t[i].get(n):ut(s[i],n))&&e.set(i,a)}i.set(n,e)}return i}function mt(t,e,s,i){e&&(t.set(s,e),void 0!==i&&t.set(i,e))}function yt(t,e,s,i,n){switch(t.alternate&&s%2!=0&&(e=e.slice(0).reverse()),t.attributeName){case"transform":if(t.additiveSum&&"string"==typeof n){const a=st.replaceMap(n.split(et.CHAR.SPACE),t=>parseFloat(t)),r=st.objectMap(e,t=>st.replaceMap(t.trim().split(et.CHAR.SPACE),t=>parseFloat(t))),o=a.length;if(r.every(t=>t.length===o)){const e=r[i];t.accumulateSum||(s=0);for(let t=0;t<o;t++)e[t]+=a[t];const n=r.length;for(let t=0;t<s;t++)for(let t=0;t<n;t++){const s=r[t],i=s.length;for(let t=0;t<i;t++)e[t]+=s[t]}return e.join(" ")}}return e[i];case"points":return N.parsePoints(e[i]);default:{let a=parseFloat(e[i]);if(isNaN(a))return n||0;if(t.additiveSum&&"number"==typeof n){a+=n,t.accumulateSum||(s=0);const i=e.length;for(let t=0;t<s;t++)for(let t=0;t<i;t++)a+=parseFloat(e[t])}return a}}}function vt(t,e,s,i,n){if(t>e){if("number"==typeof s&&"number"==typeof n)return U.getSplitValue(s,n,(t-e)/(i-e));if("string"==typeof s&&"string"==typeof n){const a=st.replaceMap(s.split(" "),t=>parseFloat(t)),r=st.replaceMap(n.split(" "),t=>parseFloat(t)),o=a.length;if(o===r.length){const s=[];for(let n=0;n<o;n++)s.push(vt(t,e,a[n],i,r[n]));return s.join(" ")}}else if(Array.isArray(s)&&Array.isArray(n)){const a=[];for(let r=0;r<Math.min(s.length,n.length);r++)a.push({x:vt(t,e,s[r].x,i,n[r].x),y:vt(t,e,s[r].y,i,n[r].y)});return a}}return s}function St(t,e,s,i,n,a,r,o,l,c,h,u,f,p){r<0&&(e-=r,r=0);const d=t.duration,g=e-(r+d*o);let m;m=0===g?0===l?0:1:tt.clampRange(g/d);let y=-1,v=-1;const S=i.length;for(let t=0;t<S;t++){if(-1!==y&&m<=i[t]){v=t;break}m>=i[t]&&(y=t)}let b;return Tt(t,c=kt(u,c,b=-1!==y&&-1!==v?vt(m,i[y],yt(t,n,o,y,s),i[v],yt(t,n,o,v,s)):yt(t,n,o,v=-1!==y?y+1:i.length-1,s)),a,v,h,f,p),[c,b]}function bt(t,e,s,i,n,a,r){const o=e.keyTimes.slice(0),l=e.keySplines?e.keySplines.slice(0):Array(n.length-1).fill(""),c=s+e.duration;let h=e.getIntervalEndTime(s);for(let s=0;s<r.length;s++){const f=r[s];if(f!==e){const p=f.getTotalDuration();if(p>h){const d=Math.min(c,p),g=xt(t,e,a);t:for(let t=Et(h,f.delay,f.duration),s=!1;;t++){const i=f.keyTimes,r=i.length;for(let c=0;c<r;c++){const p=_t(f.delay,f.duration,i,t,c);if(p>=h){function u(u){let m;if(p===u)m=Vt(yt(f,g,t,c,a));else{const e=(p-u)/f.duration;for(let s=1;s<r;s++)if(e>=i[s-1]&&e<=i[s]){m=Vt(vt(e,i[s-1],yt(f,g,t,s-1,a),i[s],yt(f,g,t,s,a)));break}}let y=u===d?1:u%e.duration/e.duration;0===y&&c>0&&(y=1),void 0===m||y===o[o.length-1]&&m===n[n.length-1]||(u===h?y+=.001:h=u,o.push(y),n.push(m),l&&l.push(s&&f.keySplines&&f.keySplines[c]?f.keySplines[c]:""))}if(!s&&p>=h&&(u(h),s=!0,p===h))continue;if(s){if(u(Math.min(p,d)),p>=d||1===o[o.length-1])break t;h=p}}}}if(p===d&&p<=i&&(f.addState(16),r.splice(s--,1)),d===c)break}else i!==1/0&&p<i&&r.splice(s--,1)}}return[o,n,l]}function kt(t,e,s,i=!1){if(""!==s){let n=t.get(e),a=!1;if(void 0===n&&(n=t.get(e-1),a=!0),n!==s||i){if(!i){if("number"==typeof n&&tt.isEqual(s,n))return e;for(;e>0&&t.has(e);)e++}t.set(e,s)}else a&&!t.has(e)&&(t.delete(e-1),t.set(e,s))}return e}function Tt(t,e,s,i,n,a,r){if(!wt(N.isAnimateTransform(t),n)){if(0===i)return;i--}const o=s&&s[i];o&&a.set(e,o),r&&function(t,e,s,i){N.asAnimateTransform(e)&&e.transformOrigin&&e.transformOrigin[i]&&t.set(s,e.transformOrigin[i])}(r,t,e,i)}function xt(t,e,s){if(e.evaluateStart){const i=e.reverse?e.length-1:0;t.get(J.getKeyName(e),e.delay)||e.values[i]||!e.additiveSum&&e.baseValue||(e.values[i]=Vt(s)),e.by&&st.isNumber(e.values[i])&&(e.values[i]=""+(parseFloat(e.values[i])+e.by)),e.evaluateStart=!1}return e.values}function At(t,e,s,i){t[t.length-1]<1&&(t.push(1),e.push(void 0!==i?Vt(i):e[0]),s&&s.push(""))}const _t=(t,e,s,i,n)=>Math.round(t+(s[n]+i)*e),Rt=t=>[{x:t[0],y:t[1],rx:t[2],ry:t[t.length-1]}],Vt=t=>Array.isArray(t)?st.objectMap(t,t=>t.x+","+t.y).join(" "):""+t,wt=(t,e)=>st.hasBit(e,t?32:4),Mt=(t,e)=>st.hasBit(e,t?16:2),Pt=t=>t.playable||t.animationElement&&-1!==t.duration,Nt=t=>[t.keyTimes.slice(0),t.values.slice(0),t.keySplines?t.keySplines.slice(0):void 0],Et=(t,e,s)=>Math.floor(Math.max(0,t-e)/s);var Ft=t=>(class extends t{getAnimateShape(t){const e=[];for(const s of this.animations)if(Pt(s))switch(s.attributeName){case"r":case"cx":case"cy":if(p.circle(t)){e.push(s);break}case"rx":case"ry":p.ellipse(t)&&e.push(s);break;case"x1":case"x2":case"y1":case"y2":p.line(t)&&e.push(s);break;case"points":(p.polyline(t)||p.polygon(t))&&e.push(s);break;case"x":case"y":case"width":case"height":p.rect(t)&&e.push(s)}return e}getAnimateTransform(t){const e=[];for(const s of this.animations)N.isAnimateTransform(s)&&s.duration>0&&(e.push(s),t&&N.asAnimateMotion(s)&&(s.framesPerSecond=t.framesPerSecond));return e}getAnimateViewRect(t){void 0===t&&(t=this.animations);const e=[];for(const s of t)if(Pt(s))switch(s.attributeName){case"x":case"y":e.push(s)}return e}animateSequentially(t,e,s,i){let n,a=18;i&&(i.keyTimeMode&&(a=i.keyTimeMode),n=i.precision),[t,e].forEach(t=>{const i=t===e;if(!t||0===t.length||!i&&st.hasBit(a,8)||i&&st.hasBit(a,64))return;const r=[],o={},l=new Set;let c=0;function h(t){void 0===o[t.attributeName]&&(o[t.attributeName]=[]),o[t.attributeName].push(t),c++}{const e=[],s=t.length;for(let i=0;i<s;i++){const n=t[i];if(n.setterType)h(n);else{const a=n.getTotalDuration();for(let r=0;r<s;r++){const s=t[r];if(i!==r&&n.attributeName===s.attributeName&&n.group.id<s.group.id&&n.fillReplace&&!s.partialType)if(s.setterType){if(n.delay===s.delay){e[i]=n;break}}else{const t=s.getTotalDuration();if(n.delay===s.delay&&(!s.fillReplace||a<=t||-1===s.iterationCount)||s.fillBackwards&&n.delay<=s.delay&&(s.fillForwards||n.fillReplace&&a<=s.delay)||n.animationElement&&null===s.animationElement&&(n.delay>=s.delay&&a<=t||s.fillForwards)){e[i]=n;break}}}}}const i=[];for(let n=0;n<s;n++){const s=t[n];e[n]?s.fillReplace?i.push(s):(s.setterType=!0,h(s)):s.setterType||(r.push(s),l.add(s.group.name))}this._removeAnimations(i)}if(r.length+c>1||1===r.length&&(r[0].alternate||void 0!==r[0].end)){for(const t of r)t.group.ordering&&st.spliceArray(t.group.ordering,t=>!l.has(t.name));const e={},c={};let h=0;for(const t of r){const s=t.attributeName;void 0===e[s]&&(e[s]=new Map,c[s]=[]);const i=e[s].get(t.delay)||[];i.push(t),c[s].push(t),e[s].set(t.delay,i)}for(const t in e){const s=new Map;for(const i of st.sortNumber(Array.from(e[t].keys()))){const n=e[t].get(i);for(const t of n)h=Math.max(h,t.getTotalDuration(!0));n.reverse(),s.set(i,n)}e[t]=s,c[t].reverse()}const _=new J(t),R={},V=new Map,w=i?new Map:void 0,M={},P=new Set,E={},F=new Map,C=i?new Map:void 0,G={},O={},B=new Map;let L,I,$=-1;const z=t=>O[t]&&O[t][O[t].length-1];for(const t in e){const n=new Map;if(R[t]=n,!i){let e;if(s)e=s.getBaseValue(t);else if(void 0===(e=this[t]))try{this.getBaseValue(t)}catch(t){}st.hasValue(e)&&(G[t]=e)}const r=o[t]||[],l=[],F=[];for(const[s,i]of e[t].entries())l.push(s),F.push(i);const C=[];let L,I,$,X=-1,q=0,j=1/0;function u(t,e){if(P.add(t),t.addState(16),$=t,t.fillForwards){b(q,L,t.type,t);const e=t.group;if(e.ordering){const s=t.getTotalDuration(),i=e.name;for(const t of e.ordering){if(t.name===i)return!0;if(J.getGroupEndTime(t)>=s)return!1}}}else{if(t.fillFreeze&&b(q,L,t.type,t),void 0!==e){let s=X;const a=g(q,q+1);void 0!==a&&t.fillReplace&&e>q&&0===C.length&&(s=kt(n,s,a),i&&mt(B,t.type,s),L=a,X=s)}m()}return!1}function p(t,e,s){return void 0===e&&(e=t.delay),void 0===s&&(s=t.to),kt(n,e,i?s:ht(s))}function d(t){t&&r.push(t),r.sort((t,e)=>t.delay===e.delay?t.group.id<e.group.id?-1:1:t.delay<e.delay?-1:1);for(let t=0;t<r.length-1;t++)r[t].delay===r[t+1].delay&&r.splice(t--,1)}function g(e,s){const n=z(t);let a=n&&n.value;return st.spliceArray(r,t=>t.delay>=e&&t.delay<s,t=>{t.animationElement&&S(),0===C.length&&(L=t.to),b(t.delay,t.to,t.type,t),t.delay===e?a=i?t.to:ht(t.to):(X=p(t),q=t.delay)}),a}function m(t,e){C.length&&st.spliceArray(C,t=>t.getTotalDuration()<=q,s=>{if(s.addState(16),s.fillForwards&&(b(s.getTotalDuration(),s.valueTo,s.type,s),void 0!==t&&void 0!==e)){const i=l.length;for(let n=t;n<i;n++){n!==t&&(e=-1);const i=F[n],a=i.length;for(let t=e+1;t<a;t++){const e=i[t];s.group.id>e.group.id&&e.addState(16)}}}})}function y(t){if(!t.hasState(16,64)){t.addState(4);const e=C.indexOf(t);-1!==e&&C.splice(e,1),C.push(t)}}function v(){C.sort((t,e)=>t.animationElement&&e.animationElement&&t.delay!==e.delay?t.delay<e.delay?1:-1:t.group.id<e.group.id?1:-1)}function S(t){t?-1!==t.iterationCount&&st.spliceArray(C,e=>e===t):st.spliceArray(C,t=>null!==t.animationElement)}function b(e,s,n=0,a){i||(s=ht(s));const o=z(t);if(""!==s&&(void 0===o||e>=o.time)&&(void 0===O[t]&&(O[t]=[]),O[t].push({key:n,value:s,time:e})),a&&N.isAnimate(a)&&!a.fillReplace)if(a.fillForwards){st.spliceArray(r,t=>t.group.id<a.group.id||t.delay<e),C.length=0;for(const t of F)for(const e of t)e.group.id<a.group.id&&e.addState(16)}else a.fillFreeze&&S()}function k(t,e,s){I&&!t&&(void 0===s&&(s=f.typeAsValue(I.type)),e!==(X=kt(n,e,s))&&mt(B,I.type,X)),I=void 0}function T(t){for(let e=0;e<l.length;e++){if(t.length)for(let s=0;s<F[e].length;s++)t.includes(F[e][s])&&F[e].splice(s--,1);0===F[e].length&&(F.splice(e,1),l.splice(e--,1))}}const W=c[t].find(t=>t.fillBackwards);if(W){L=yt(W,W.values,0,0),X=kt(n,0,L),i&&(mt(B,W.type,0),I=W);let e=!0;for(const s of c[t])if(s.group.id>W.group.id&&s.delay<=W.delay){e=!1;break}const s=W.getTotalDuration(),a=[];for(let t=0;t<l.length;t++)for(let i=0;i<F[t].length;i++){const n=F[t][i];if(e){if(n===W&&(0!==t||0!==i)){F[t].splice(i--,1),l.unshift(W.delay),F.unshift([W]);continue}if(n.group.id<W.group.id&&(W.fillForwards||n.getTotalDuration()<=s)){n.fillForwards&&(n.setterType=!0,r.push(n)),a.push(n);continue}}n.animationElement&&n.delay<=W.delay&&(F[t].splice(i--,1),y(n))}T(a),W.addState(2)}if(!i&&(void 0===O[t]&&void 0!==G[t]&&b(0,G[t],0),void 0===L)){const e=z(t);L=e&&e.value||G[t]}d();{let e;st.spliceArray(r,t=>t.delay<=l[0],s=>{const a=N.isAnimate(s)&&s.fillForwards;if(s.delay<l[0]&&(void 0===W||a))if(W&&a)b(s.delay,s.to,s.type);else{const a=s.delay-1;if(void 0===e)if(n.has(0))i||p(s,a,L);else{let e;void 0!==(e=i&&N.isAnimateTransform(s)?f.typeAsValue(s.type):G[t])&&(p(s,0,e),p(s,a,e))}else p(e,a);X=p(s),q=s.delay,e=s}}),e&&p(e,l[0]-1)}t:{const e=l.length;for(let s=0;s<e;s++){const o=F[s];let c=l[s];for(let T=0;T<o.length;T++){const A=o[T];if(A.hasState(16,64))continue;const R=-1===A.iterationCount,M=A.duration,P=A.iterationCount;let N,O,$;if(R)N=c+M;else if((N=A.getTotalDuration())<=X){A.fillReplace?A.addState(64):y(A);continue}R?(O=Math.ceil((h-c)/M),$=0):(O=Math.ceil(P),$=P-Math.floor(P)),r.length&&q>0&&q<c&&g(q,c),-1!==X&&X<c&&(X=kt(n,c-1,L),q=c),j=1/0;const W=A.group.ordering;if(W&&W.length>1){let i=!0;for(const e of W){if(e.name===A.group.name){i=!1;break}if(!e.paused&&q<=e.delay&&e.attributes.includes(t))break}if(i)e:for(let t=s+1;t<e;t++){const e=F[t],s=e.length;for(let t=0;t<s;t++){const s=e[t];if(s.group.ordering){j=s.delay;break e}s.getTotalDuration()<=N?(s.fillFreeze&&d(s),s.addState(16)):s.delay<N&&y(s)}}}else for(let t=s+1;t<e;t++)if(l[t]!==1/0&&F[t].length&&!F[t].every(t=>t.hasState(16,64))){j=l[t];break}const Y=q;let D,U=X+1,K=Math.min(j,A.end||1/0);if(r.length&&A.animationElement){const t=Math.min(j,N,K);if(D=r.find(e=>e.delay>=q&&e.delay<=t)){switch(D.delay){case q:b(q,L=D.to,D.type,D),D.group.id>A.group.id&&(i&&I&&k(A.additiveSum,Math.max(c-1,X)),X=p(D,Math.max(D.delay,X),L),K=-1);break;case j:D.addState(32);break;default:K=D.delay,D.addState(32)}st.spliceArray(r,t=>t!==D),A.addState(4)}}let H,Z=!1;if(K>X){i&&(I&&(k(A.additiveSum,Math.max(c-1,X)),U=X+1),L=f.typeAsValue(A.type),b(q,L,A.type));let e=c===1/0||(-1!==X||A.hasState(2))&&!(0===s&&0===T);Z=!0;e:{const i=z(t);for(let r=Et(q,c,M);r<O;r++){let l,h,u=xt(_,A,L);if(A.partialType){if(A.getIntervalEndTime(q)<K&&(C.length||T<F[s].length-1)){for(let t=T+1;t<o.length;t++)y(o[t]);o.length=0,v(),[l,u,h]=bt(_,A,q,K,u,L,C)}else[l,u,h]=Nt(A);At(l,u,h,G[t])}else l=A.keyTimes,h=A.keySplines;const f=l.length;for(let t=0;t<f;t++){const s=l[t];let o=-1,p=yt(A,u,r,t,L);if(r===O-1&&$>0)if($===s)$=-1;else if(t===f-1)q=o=N,p=vt($,l[t-1],yt(A,u,r,t-1,L),s,p),$=-1;else if($>s)for(let e=t+1;e<f;e++)if($<=l[e]){q=o=N,p=vt($,s,p,l[e],yt(A,u,r,e,L)),$=-1;break}if(-1===o){if((o=_t(c,M,l,r,t))<0||o<X)continue;if(o===K)Z=r===O-1&&t===f-1,q=o;else{function x(e){[X,H]=St(A,q,L,l,u,h,c,r,t,e,a,n,V,w)}if(c<0&&-1===X)o>0&&(q=0,x(0));else{if(o>K){e&&X+1<K&&x(X),q=K,x(K+(K!==j||n.has(K-1)?0:-1)),Z=!1;break e}if(e)A.hasState(2)&&(q=Y),c>=X?(o=Math.max(c,X+1),q=c):o===X?(q=o,o=X+1):(x(X),q=Math.max(o,X)),e=!1;else{if(q=o,r>0&&0===t&&A.accumulateSum){Tt(A,o,h,t,a,V,w),X=o;continue}o=Math.max(o,X+1)}}}}if(o>X&&(t===length-1&&!A.accumulateSum&&(r<O-1||A.fillReplace&&(void 0===i||p!==i.value))&&o--,X=kt(n,o,p),Tt(A,X,h,t,a,V,w),H=p),!Z||-1===$)break e}}}m(s,T)}if(void 0!==H&&(L=H,i&&(mt(B,A.type,U,X),I=A)),D&&(D.hasState(32)?(X=p(D,D.delay,H=D.to),b(q=D.delay,H,D.type,D)):A.hasState(64)&&mt(B,X,D.type),S(),Z=!0),st.spliceArray(r,t=>t.delay>=Y&&t.delay<=q,t=>{b(t.delay,t.to,t.type,t),t.animationElement&&S()}),R){if(!Z){C.length=0,C.push(A);continue}if(void 0===D){E[t]=A;break t}}if(Z){if(!R&&u(A,j))break t;for(let t=s;t<e;t++)if(l[t]<q){const e=F[t];for(let t=0;t<e.length;t++){const s=e[t],i=s.getTotalDuration();i>q&&!s.hasState(4,16,64)?y(s):s.fillReplace||b(i,s.valueTo,s.type,s)}l[t]=1/0,e.length=0}if(C.length&&q<j){v();const t=C.find(t=>t.delay<=q);t&&(t.removeState(4,2),t.addState(8),S(t),c=t.delay,F[s]=[t],T=-1)}}else y(A)}}if(C.length)for(v();C.length;){const e=C.shift(),s=e.delay,r=e.duration,o=X-s;let l=1/0;function A(){let c,h,u=xt(_,e,L);e.partialType?(e.getIntervalEndTime(q)<l&&C.length?[c,u,h]=bt(_,e,q,l,u,L,C):[c,u,h]=Nt(e),At(c,u,h,G[t])):(c=e.keyTimes,h=e.keySplines);const f=X+1;let p=Math.floor(o/r),d=!1;const g=(i,n)=>St(e,q,L,c,u,h,s,p,n,i,a,R[t],V,w);do{const t=c.length;for(let i=0;i<t;i++){let t=_t(s,r,c,p,i);if(!d&&t>=X&&([X,L]=g(X,i),d=!0),d)if(t>=l){if(l>X){const t=e.fillReplace||-1===e.iterationCount;[X,L]=g(l-(t?1:0),i),t&&(L=yt(e,u,p,0,L),X=kt(n,l,L)),q=l}}else t>X&&(q=t,i===c.length-1&&t<l&&t--,L=yt(e,u,p,i,L),X=kt(n,t,L),Tt(e,X,h,i,a,V,w))}}while(X<l&&++p);i&&mt(B,e.type,f,X)}if(-1===e.iterationCount){o>0&&o%e.duration!=0&&(l=s+e.duration*Math.ceil(o/r),A()),E[t]=e;break t}if((l=Math.min(s+e.duration*e.iterationCount,e.end||1/0))>X&&(A(),u(e)))break t}if($&&$.fillReplace&&void 0===E[t]){let e,s=0;if(O[t]){const i=z(t);i&&(s=i.key,e=i.value)}else i?(s=Array.from(B.values()).pop(),e=f.typeAsValue(s)):e=G[t];void 0===e||st.isEqual(n.get(X),e)||(X=kt(n,X,e),i&&mt(B,s,X))}}M[t]=X}{const t=new Set;let e=0;for(const s in R){let i=0;for(const e of R[s].keys())t.add(e),i=e;e=Math.max(e,i),O[s]&&O[s].sort((t,e)=>t.time===e.time?0:t.time<e.time?-1:1)}if(Object.keys(E).length){const s=[],i=[];for(const t in E){const e=E[t];s.push(e.delay),i.push(e.duration)}0===P.size&&1===new Set(s).size&&1===new Set(i).size&&s[0]===t.values().next().value?$=s[0]<=0?0:s[0]:i.length>1&&i.every(t=>t%250==0)?e=tt.nextMultiple(i,e,s):(e-s[0])%i[0]!=0&&(e=i[0]*Math.ceil(e/i[0]))}if(-1===$)for(const s in R){const n=E[s];if(n){let r=M[s];if(r<e){const o=R[s],l=n.delay,c=r+1;let h=Array.from(o.values()).pop(),u=Math.floor((r-l)/n.duration);const f=xt(_,n,h),p=n.keyTimes,d=p.length;do{let s=!1;for(let i=0;i<d;i++){let c=_t(l,n.duration,p,u,i);!s&&c>=r&&(o.has(r)||([r,h]=St(n,r,h,p,f,n.keySplines,l,u,i,r,a,o,V,w),t.add(r)),s=!0),s&&c>r&&(i===d-1&&c<e&&c--,r=kt(o,c,h=yt(n,f,u,i,h)),Tt(n,c,n.keySplines,i,a,V,w),t.add(r))}}while(r<e&&++u);M[s]=r,i&&mt(B,n.type,c,r)}}}const n=st.sortNumber(Array.from(t));if(s||i){let t=!1;for(const e in R){const s=R[e];if(!s.has(0)){const i=G[e];if(void 0!==i){const e=s.keys().next().value-1;s.set(0,i),s.set(e,i),n.includes(0)||(n.push(0),t=!0),n.includes(e)||(n.push(e),t=!0)}}}t&&st.sortNumber(n)}if(!i)for(const t in R)for(const e of n){if(!(e<=M[t]))break;{const s=R[t];if(!s.has(e)){if(_.paused(t,e)){let i=_.get(t,e);if(i&&""!==(i=ht(i,!0))){s.set(e,i);continue}}lt(s,t,e,_,i)}}}L=gt(R,n,O)}if(-1===$&&Object.keys(E).length){const t={},e=[],s=[],n=[];for(const t in E)n.push(E[t].duration),e.push(E[t]);const r=tt.nextMultiple(n);for(const i of e){const e=i.attributeName;t[e]=new Map;let n=R[e].has(M[e])?R[e].get(M[e]):G[e];const o=xt(_,i,n);let l=0,c=0;const h=i.keyTimes,u=h.length;do{for(let f=0;f<u;f++){let u=_t(0,i.duration,h,c,f);f===h.length-1&&u<r&&u--,n=yt(i,o,c,f,n),Tt(i,l=kt(t[e],u,n),i.keySplines,f,a,F,C),s.includes(l)||s.push(l)}}while(l<r&&++c)}if(e.every(t=>t.alternate)){let e=-1;for(const i in E){const n=t[i],a=Array.from(n.keys()),o=Array.from(n.values()).reverse(),l=a.length;for(let t=0;t<l;t++){const i=a[t];if(0!==i){e=r+i;const a=F.get(i);a&&F.set(e,a),e=kt(n,e,o[t]),s.includes(e)||s.push(e)}}}}st.sortNumber(s);for(const e in t){const n=t[e];for(const t of s)n.has(t)||lt(n,e,t,_,i)}I=gt(t,s,O)}if(L||I){this._removeAnimations(r);const t=Array.from(B.entries()),e=st.joinMap(r,t=>N.isAnimateTransform(t)?f.typeAsName(t.type):t.attributeName,"-",!1),o=this.parent;for(const r of[L,I])if(r){const l=r===L,c=l?V:F,h=l?w:C;if(wt(i,a)){const e=[];if(i){const s=[];if(l){const e=Array.from(r.entries());let i=t[0][1];const n=t.length,a=e.length;for(let r=0,o=0,l=0;r<n;r++){const c=r<n-1?t[r+1][1]:-1;if(i!==c){const n=new Map;for(let s=l;s<a;s++){const a=e[s][0];if(a>=t[o][0]&&a<=t[r][0])n.set(a,new Map([[i,e[s][1].values().next().value]])),l=s;else if(a>t[r][0])break}s.push(n),i=c,o=r+1}}}else{if(!E.transform)return;{const t=Array.from(r.entries()),e=new Map;for(const s of t)e.set(s[0],new Map([[E.transform.type,s[1].values().next().value]]));s.push(e)}}let i=0;const n=s.length;for(let t=0;t<n;t++){const a=Array.from(s[t].entries());let r=a[0][0];1===a.length&&a.push(t<n-1?[s[t+1].keys().next().value,a[0][1]]:[r+1,a[0][1]]);const o=a[a.length-1][0];let u=o-r;const f=new Z;f.type=a[0][1].keys().next().value;const p=a.length;for(let t=0;t<p;t++){const s=a[t];if(e.push(c.get(s[0])||""),f.type!==SVGTransform.SVG_TRANSFORM_ROTATE){const e=h.get(s[0]);e&&(void 0===f.transformOrigin&&(f.transformOrigin=[]),f.transformOrigin[t]=e)}s[0]-=r}for(const[t,e]of ct(a))f.keyTimes.push(t),f.values.push(e.values().next().value);(r-=i)>1?f.delay=r:1===r&&(u+1)%10==0&&u++,f.duration=u,f.keySplines=e,f.synchronized={key:t,value:""},i=o,this._insertAnimate(f,l)}}else{const t=Array.from(r.entries()),i=-1!==$?$:0;let a;for(const s of t)e.push(c.get(s[0])||""),s[0]-=i;if(s){const e=ft(ct(t),s,o,O,n);if(!e)return;(a=new U).attributeName="d";for(const t of e)a.keyTimes.push(t.key),a.values.push(""+t.value)}else{const t=new Z;t.type=SVGTransform.SVG_TRANSFORM_TRANSLATE;for(const[e,s]of r.entries()){const i=s.get("x")||0,n=s.get("y")||0;t.keyTimes.push(e),t.values.push(o?o.refitX(i)+" "+o.refitX(n):i+" "+n)}a=t}a.delay=i,a.keySplines=e,a.duration=t[t.length-1][0],this._insertAnimate(a,l)}}else if(Mt(i,a)){const a=Array.from(r.entries());for(let r=0;r<a.length-1;r++){const[u,f]=a[r],[p,d]=a[r+1];let g,m=e;if(i){const e=new Z;if(l)for(let s=0;s<t.length-1;s++){const i=t[s],n=t[s+1];if(i[1]===n[1]&&u>=i[0]&&p<=n[0]){e.type=i[1];break}if(p-u==1&&p===n[0]){e.type=n[1];break}}else E.transform&&(e.type=E.transform.type);if(0===e.type)continue;e.values=[f.values().next().value,d.values().next().value];const s=h.get(p);s&&(e.transformOrigin=[s]),g=e}else if(s){const t=ft([[u,f],[p,d]],s,o,O,n);if(!t)continue;(g=new U).attributeName="d",g.values=st.replaceMap(t,t=>""+t.value)}else{const t=new Z;t.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,t.values=st.objectMap([f,d],t=>{const e=t.get("x")||0,s=t.get("y")||0;return o?o.refitX(e)+" "+o.refitX(s):e+" "+s}),m+=r,g=t}l&&(g.delay=0===r?u:0),g.duration=p-u,g.keyTimes=[0,1],g.synchronized={key:r,value:m};const y=c.get(p);y&&(g.keySplines=[y]),this._insertAnimate(g,l)}}}}}})}_removeAnimations(t){t.length&&st.spliceArray(this.animations,e=>t.includes(e))}_insertAnimate(t,e){e||(t.iterationCount=-1),t.from=t.valueFrom,t.to=t.valueTo,this.animations.push(t)}});const{css:Ct,dom:Gt,math:Ot,util:Bt}=squared.lib;class Lt extends Z{constructor(t,e){if(super(t,e),this.path="",this.distance="0%",this.rotate="auto 0deg",this.motionPathElement=null,this.type=SVGTransform.SVG_TRANSFORM_TRANSLATE,this._offsetLength=0,e){this.setAttribute("path");const t=Gt.getNamedItem(e,"rotate");switch(t){case"auto":break;case"auto-reverse":this.rotate="auto 180deg";break;default:Bt.isNumber(t)&&(this.rotate=Bt.convertFloat(t)+"deg")}const s=e.children,i=s.length;for(let t=0;t<i;t++){const e=s[t];if("mpath"===e.tagName){let t=v(e);if(t&&(p.use(t)&&(t=v(t)),t&&p.shape(t))){this.motionPathElement=t;break}}}this.setCalcMode()}else if(t){const e=/path\("([^"]+)"\)/.exec(g(t,"offset-path"));e&&(this.path=e[1]);const s=g(t,"offset-distance",!1);""!==s&&(this.distance=s);const i=g(t,"offset-rotate",!1);""!==i&&"auto"!==i&&(this.rotate=i)}}setCalcMode(){const t=this.animationElement;if(t){const e=Gt.getNamedItem(t,"calcMode")||"paced";switch(e){case"paced":case"discrete":case"spline":super.setCalcMode("translate",e);break;case"linear":const s=Z.toFractionList(Gt.getNamedItem(t,"keyPoints"),";",!1);let i=super.keyTimes;0===i.length&&-1!==this.duration&&(i=Z.toFractionList(Gt.getNamedItem(t,"keyTimes")),this.length=0,super.keyTimes=i),s.length===i.length&&(this._keyPoints=s)}}}addKeyPoint(t){if(void 0===this._offsetPath){const e=t.key;if(e>=0&&e<=1){const s=super.keyTimes,i=this.keyPoints;if(s.length===i.length){const n=t.value;let a=NaN;if(Ct.isPercent(n)?a=parseFloat(n)/100:Bt.isNumber(n)&&(a=parseFloat(n)/this.offsetLength),!isNaN(a)){a>1&&(a=1);const n=s.findIndex(t=>t===e);-1!==n?(s[n]=t.key,i[n]=a):(s.push(t.key),i.push(a))}}}}}setOffsetPath(){if(void 0===this._offsetPath&&this.path){const t=this.rotateData;let e=N.getOffsetPath(this.path,t&&this.rotate),s=e.length;if(s>0){const i=this.duration;let n=NaN;if(i>=s){n=i/s;for(let t=1;t<s-1;t++)e[t].key*=n;e[s-1].key=i}else if(i>0){const t=Array(i),n=s/i;for(let s=0;s<i;s++){const i=Math.floor(s*n);e[i].key=s,t[s]=e[i]}const a=e.pop();t[t.length-1].value!==a.value&&(a.key=i,t.push(a)),e=t,s=t.length}const a=this.keyPoints,r=this.framesPerSecond,o=r?1e3/r:0;if(a.length){const t=s-1,r=super.keyTimes,l=[];if(a.length>1){let s;const c=(t,e,i)=>!!s&&s.key===t&&i===s.rotate&&Bt.isEqual(s.value,e),h=r.length;for(let u=0;u<h-1;u++){const h=Ot.truncateFraction(r[u]*i),f=Ot.truncateFraction((r[u+1]-r[u])*i),p=a[u],d=a[u+1];if(0===f){const i=h,{value:n,rotate:a}=e[Math.floor(d*t)];if(c(i,n,a))continue;l.push(s={key:i,value:n,rotate:a})}else{let s=0,i=h;if(p===d){const{value:a,rotate:r}=e[Math.floor(p*t)],u=isNaN(n)?1:n;for(c(h,a,r)&&(s+=u,i+=o);s<f;s+=u){const t=h+s;t>=i&&(l.push({key:t,value:a,rotate:r}),s<f-1?i+=o:i=0)}}else{const n=Math.floor(Math.min(p,d)*t),a=Math.floor(Math.max(p,d)*t),r=[];for(let t=n;t<=a;t++)r.push(Object.assign({},e[t]));p>d&&r.reverse();const u=r.length,g=f/u;for(c(h,r[0].value,r[0].rotate)&&(s++,i+=o);s<u;s++){const t=h+s*g;t>=i&&(r[s].key=t,l.push(r[s]),s<u-1?i+=o:i=0)}}l[l.length-1].key=h+f}}}else l.push(Object.assign({},e[Math.floor(a[0]*t)])),0===r[0]&&(l[0].rotate=0);this._offsetPath=l}else if(o>0){const t=[];for(let i=0;i<s;i+=o)t.push(e[Math.floor(i)]);const i=e.pop();i!==t[t.length-1]&&t.push(i),this._offsetPath=t}else this._offsetPath=e;if(t){e=this._offsetPath;for(let s=0,n=0;s<t.length-1;s++){const a=t[s],r=t[s+1],o=[];if(a.key===r.key)o.push(e[n++]);else{const t=Math.floor(Ot.truncateFraction(r.key*i));for(;;n++){const s=e[n];if(!(s&&s.key<=t))break;o.push(s)}}const l=Ct.parseAngle(a.value.split(" ").pop()),c=Ct.parseAngle(r.value.split(" ").pop());if(a.value===r.value||l===c)if(a.value.startsWith("auto")){if(0!==l)for(const t of o)t.rotate+=l}else for(const t of o)t.rotate=l;else{const t=c-l,e=o.length,s=t/e;if(a.value.startsWith("auto")){for(let t=0;t<e-1;t++)o[t].rotate+=l+t*s;o[e-1].rotate+=l+t}else{for(let t=0;t<e-1;t++)o[t].rotate=l+t*s;o[e-1].rotate=l+t}}}}this.keySplines=void 0,this.timingFunction=$.linear}}}reverseKeyPoints(){let t,e;if(this.validKeyPoints()){(e=this._keyPoints.slice(0)).reverse(),t=[];for(const e of super.keyTimes)t.push(1-e);t.reverse()}return{keyTimes:t,keyPoints:e}}validKeyPoints(){const t=this.keyPoints;return t.length>0&&t.length===super.keyTimes.length}get offsetPath(){return this._offsetPath}get playable(){return!this.paused&&-1!==this.duration&&Bt.isString(this.path)}set keyTimes(t){this.path||(super.keyTimes=t)}get keyTimes(){if(this.setOffsetPath(),this._offsetPath){const t=this.duration;return Bt.objectMap(this._offsetPath,e=>e.key/t)}return super.keyTimes}set values(t){this.path||(super.values=t)}get values(){return this.setOffsetPath(),this._offsetPath?Bt.objectMap(this._offsetPath,t=>t.value.x+" "+t.value.y):super.values}get rotateValues(){if(this.setOffsetPath(),this._offsetPath)return Bt.objectMap(this._offsetPath,t=>t.rotate)}get keyPoints(){return void 0===this._keyPoints&&(this._keyPoints=[]),this._keyPoints}set reverse(t){if(t!==super.reverse){const{keyTimes:e,keyPoints:s}=this.reverseKeyPoints();e&&s&&(this.length=0,this._keyPoints=s,super.keyTimes=e,super.reverse=t)}}get reverse(){return super.reverse}set alternate(t){const e=this.iterationCount;if(t!==super.alternate&&(-1===e||e>1)){const{keyTimes:s,keyPoints:i}=this.reverseKeyPoints();if(s&&i){const n=this.duration;let a=super.keyTimes,r=this.keyPoints;const o=a.length;if(-1===e){for(let t=0;t<o;t++)a[t]/=2,s[t]=.5+s[t]/2;a=a.concat(s),r=r.concat(i),this.duration=2*n}else{const t=a.slice(0),l=r.slice(0);for(let n=0;n<e;n++)if(0===n)for(let t=0;t<o;t++)a[t]/=e;else{const c=n*(1/e),h=n%2==0?t.slice(0):s.slice(0);for(let t=0;t<o;t++)h[t]=Ot.truncateFraction(c+h[t]/e);a=a.concat(h),r=r.concat(n%2==0?l:i)}this.duration=n*e,this.iterationCount=1}this._keyTimes=a,this._keyPoints=r,super.alternate=t}}}get alternate(){return super.alternate}set parent(t){super.parent=t;const e=this.parentContainer;if(e&&e.requireRefit){const t=this.path;t&&(this.path=N.transformRefit(t,void 0,void 0,e))}}get parent(){return super.parent}get offsetLength(){if(0===this._offsetLength){const t=this.path;t&&(this._offsetLength=k(t))}return this._offsetLength}get instanceType(){return 114696}}const{css:It,dom:$t,regex:zt,util:Xt}=squared.lib,qt="cubic-bezier\\(([\\d.]+), ([\\d.]+), ([\\d.]+), ([\\d.]+)\\)",jt=RegExp(`(ease|ease-in|ease-out|ease-in-out|linear|step-(?:start|end)|steps\\(\\d+, (?:start|end)\\)|${qt}),?\\s*`,"g"),Wt=It.getKeyframeRules(),Yt={"animation-delay":"0s","animation-duration":"0s","animation-iteration-count":"1","animation-play-state":"running","animation-direction":"normal","animation-fill-mode":"none","animation-timing-function":"ease"};function Dt(t,e){const s=g(t,e);if("animation-timing-function"===e){jt.lastIndex=0;const t=[];let e;for(;null!==(e=jt.exec(s));)t.push(e[1]);return t}return s.split(zt.XML.SEPARATOR)}function Ut(t){return t.sort((t,e)=>t.key!==e.key?t.key<e.key?-1:1:0)}function Kt(t){if("reverse"===t)return"auto 180deg";if(t.startsWith("reverse ")){const e=t.split(" ")[1];return It.isAngle(e)?"auto "+(180+It.parseAngle(e))+"deg":"auto 0deg"}return t}var Ht=t=>(class extends t{getTransforms(t){return void 0===t&&(t=this.element),N.filterTransforms(f.parse(t)||N.convertTransforms(t.transform.baseVal))}getAnimations(t){void 0===t&&(t=this.element);const e=[];let s=0;const i=(t,i,n="")=>{""===n&&s++,t.delay=i,t.group={id:s,name:n},t.parent=this,e.push(t)},n=t.children;let a=n.length;for(let e=0;e<a;e++){const s=n[e];if(s instanceof SVGAnimationElement){const e=$t.getNamedItem(s,"begin");if(""!==e&&/^[a-zA-Z]+$/.test(e))continue;const n=e?Xt.sortNumber(Xt.replaceMap(e.split(";"),t=>I.convertClockTime(t))):[0];if(n.length)switch(s.tagName){case"set":for(const e of n)i(new I(t,s),e);break;case"animate":for(const e of n)i(new U(t,s),e);break;case"animateTransform":for(const e of n){const n=new Z(t,s);if(N.isShape(this)&&this.path){const e=this.viewport;n.transformFrom=N.drawRefit(t,this.parent,e&&e.precision)}i(n,e)}break;case"animateMotion":for(const e of n){const n=new Lt(t,s);if(n.motionPathElement){const t=this.viewport;n.path=N.drawRefit(n.motionPathElement,this.parent,t&&t.precision)}i(n,e)}}}}const r=Dt(t,"animation-name");if(a=r.length){const e={},n=[],l=[];for(const s in Yt){let i=Dt(t,s);for(0===i.length&&i.push(Yt[s]);i.length<a;)i=i.concat(i.slice(0));i.length=a,e[s]=i}for(let c=0;c<a;c++){const a=Wt[r[c]],h=I.convertClockTime(e["animation-duration"][c]);if(a&&h>0){s++;const u={},p={},d="paused"===e["animation-play-state"][c],m=I.convertClockTime(e["animation-delay"][c]),y=e["animation-iteration-count"][c],v=e["animation-fill-mode"][c],S=r[c]+"_"+c,b=[];let k=!0;l.push({name:S,attributes:b,paused:d,delay:m,duration:h,iterationCount:y,fillMode:v});for(const e in a){const s=parseFloat(e)/100,i=a[e];for(const e in i){const n=Yt[e]?p:u;void 0===n[e]&&(n[e]=[]);let a=i[e];a&&(It.isCalc(a)?a=It.calculateVar(t,a,e):It.isCustomProperty(a)&&(a=It.parseVar(t,a)),void 0!==a&&n[e].push({key:s,value:""+a}))}}if(u.transform){function o(e){const s=u["transform-origin"],i=s&&s.find(t=>t.key===e);if(i)return f.origin(t,i.value)}for(const e of Ut(u.transform)){const s=f.parse(t,e.value);if(s){const t=o(e.key);for(const i of s){const s=i.matrix;let n,a,r;switch(i.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:n="translate",a=s.e+" "+s.f;break;case SVGTransform.SVG_TRANSFORM_SCALE:n="scale",a=s.a+" "+s.d+" "+(t?t.x+" "+t.y:"0 0"),!t||0===e.key&&0===t.x&&0===t.y||(r={x:t.x*(1-s.a),y:t.y*(1-s.d)});break;case SVGTransform.SVG_TRANSFORM_ROTATE:n="rotate",a=i.angle+" "+(t?t.x+" "+t.y:"0 0");break;case SVGTransform.SVG_TRANSFORM_SKEWX:n="skewX",a=""+i.angle,!t||0===e.key&&0===t.y||(r={x:t.y*s.c*-1,y:0});break;case SVGTransform.SVG_TRANSFORM_SKEWY:n="skewY",a=""+i.angle,!t||0===e.key&&0===t.x||(r={x:0,y:t.x*s.b*-1});break;default:continue}let o=u[n];void 0===o&&(u[n]=o=[]);const l=o.findIndex(t=>t.key===e.key);if(-1!==l){const t=o[l];t.value=a,t.transformOrigin=r}else o.push({key:e.key,value:a,transformOrigin:r})}}}delete u.transform,delete u["transform-origin"]}if("none"===g(t,"offset-path"))delete u["offset-distance"],delete u["offset-rotate"];else if(u["offset-rotate"]){const e=u["offset-rotate"];if(u["offset-distance"]||void 0===u.rotate){let s=g(t,"offset-rotate",!1);""!==s&&"auto"!==s||(s="auto 0deg"),Ut(e);const n=e[e.length-1];0!==e[0].key&&e.unshift({key:0,value:s}),1!==n.key&&e.push({key:1,value:s});for(let t=1;t<e.length;t++){const s=e[t-1],i=e[t];if(s.value=Kt(s.value),i.value=Kt(i.value),s.value.split(" ").pop()!==i.value.split(" ").pop()){const n=s.value.startsWith("auto"),a=i.value.startsWith("auto");if(n&&!a||!n&&a){const n=(s.key+i.key)/2;e.splice(t++,0,{key:n,value:s.value}),e.splice(t++,0,{key:n,value:i.value})}}}if(void 0===u["offset-distance"]){const s=new Lt(t);s.duration=0,s.iterationCount=1,s.fillForwards=!0,s.addKeyPoint({key:0,value:s.distance}),i(s,m,S);for(const t of e){const e=t.value;let s=It.parseAngle(e.split(" ").pop());e.startsWith("auto")&&(s+=90),t.value=s+"0 0"}u.rotate=e,delete u["offset-rotate"],k=!1}}else delete u["offset-rotate"]}for(const s in u){let a;switch(s){case"offset-rotate":continue;case"offset-distance":(a=new Lt(t)).rotateData=u["offset-rotate"];break;case"rotate":case"scale":case"skewX":case"skewY":case"translate":(a=new Z(t)).setType(s);break;default:(a=new U(t)).attributeName=s}i(a,m,S);const r=u[s],o=e["animation-direction"][c],l=e["animation-timing-function"][c];if(Ut(r),"offset-distance"===s){const t=a;0!==r[0].key&&t.addKeyPoint({key:0,value:t.distance});for(const e of r)t.addKeyPoint(e);1!==r.pop().key&&t.addKeyPoint({key:1,value:t.distance}),Xt.isString(l)&&(t.timingFunction=l)}else{b.push(s);const e=[],i=[],n=[],o=r.length;for(let t=0;t<o;t++){if(e.push(r[t].key),i.push(r[t].value),k&&t<o-1){const e=p["animation-timing-function"]&&p["animation-timing-function"].find(e=>e.key===r[t].key);n.push(e?e.value:l)}const s=r[t].transformOrigin;s&&N.asAnimateTransform(a)&&(void 0===a.transformOrigin&&(a.transformOrigin=[]),a.transformOrigin[t]=s)}if(0!==e[0]&&(e.unshift(0),i.unshift(a.baseValue||""),k&&n.unshift(l),a.evaluateStart=!0),k&&!n.every(t=>"linear"===t)){const r=[],o=[],l=[],c=e.length;for(let a=0;a<c;a++){if(a<c-1){const c=(e[a+1]-e[a])*h;if($[n[a]])n[a]=$[n[a]];else if(n[a].startsWith("step")){if(""!==i[a]){const u=U.convertStepTimingFunction(s,n[a],e,i,a,It.getFontSize(t));if(u){const t=1===e[a+1]?1:0;for(let s=0;s<u[0].length-t;s++){let t=(e[a]+u[0][s]*c)/h;r.includes(t)&&(t+=.001),r.push(t),o.push(u[1][s]),l.push($[-1!==n[a].indexOf("start")?"step-start":"step-end"])}continue}}n[a]=$.linear}else{const t=/cubic-bezier\(([\d.]+), ([\d.]+), ([\d.]+), ([\d.]+)\)/.exec(n[a]);n[a]=t?t[1]+" "+t[2]+" "+t[3]+" "+t[4]:$.ease}l.push(n[a])}r.push(e[a]),o.push(i[a])}a.values=o,a.keyTimes=r,a.keySplines=l}else a.values=i,a.keyTimes=e,k?a.keySplines=n:a.timingFunction=l}a.paused=d,a.duration=h,a.iterationCount="infinite"!==y?parseFloat(y):-1,a.fillForwards="forwards"===v||"both"===v,a.fillBackwards="backwards"===v||"both"===v,a.reverse=o.endsWith("reverse"),a.alternate=(-1===a.iterationCount||a.iterationCount>1)&&o.startsWith("alternate"),n.push(a)}}}l.reverse();for(const t of n)t.setGroupOrdering(l)}return e}set name(t){this._name=t}get name(){return void 0===this._name&&(this._name=N.setName(this.element)),this._name}get transforms(){return void 0===this._transforms&&(this._transforms=this.getTransforms()),this._transforms}get animations(){return void 0===this._animations&&(this._animations=this.getAnimations()),this._animations}get visible(){return function(t){const e=g(t,"visibility");return"hidden"!==e&&"collapse"!==e&&"none"!==g(t,"display")}(this.element)}get opacity(){return g(this.element,"opacity",!1)||"1"}});const Zt=squared.lib.client;function Qt(t){if("svg"===t.tagName){if(Zt.isUserAgent(8))return t.parentElement instanceof HTMLElement;if(Zt.isUserAgent(4))return!(t.parentElement instanceof HTMLElement)}return!1}var Jt=t=>(class extends t{setRect(){const t=this.parent;let{x:e,y:s,width:i,height:n}=this;t&&(e=t.refitX(e),s=t.refitY(s),i=t.refitSize(i),n=t.refitSize(n)),this.setBaseValue("x",e),this.setBaseValue("y",s),this.setBaseValue("width",i),this.setBaseValue("height",n)}_getElement(){const t=this.element;switch(t.tagName){case"svg":case"use":case"image":return t;default:return null}}set x(t){this._x=t}get x(){if(void 0!==this._x)return this._x;{const t=this._getElement();return t?t.x.baseVal.value:0}}set y(t){this._y=t}get y(){if(void 0!==this._y)return this._y;{const t=this._getElement();return t?t.y.baseVal.value:0}}set width(t){this._width=t}get width(){if(void 0!==this._width)return this._width;{const t=this._getElement();return t?Qt(t)?t.getBoundingClientRect().width:t.width.baseVal.value:0}}set height(t){this._height=t}get height(){if(void 0!==this._height)return this._height;{const t=this._getElement();return t?Qt(t)?t.getBoundingClientRect().height:t.height.baseVal.value:0}}});const te=squared.lib.util;function ee(t,e){const s=y(m(t,"fill"));if(""!==s){if(e){const t=e.definitions.pattern.get(s);if(t)return t}const t=document.getElementById(s.substring(1));if(t instanceof SVGPatternElement)return t}}class se extends squared.lib.base.Container{constructor(t){super(),this.element=t,this.aspectRatio={x:0,y:0,width:0,height:0,position:{x:0,y:0},parent:{x:0,y:0},unit:1},this._clipRegion=[]}append(t,e){return t.parent=this,t.viewport=e||this.getViewport(),super.append(t)}build(t){let e,s,i=!0;t?(e=t.symbolElement||t.patternElement||t.element||this.element,s=t.precision,!1===(t=Object.assign(Object.assign({},t),{symbolElement:void 0,patternElement:void 0,element:void 0})).initialize&&(i=!1)):e=this.element,this.clear();let n=!1;const a=this.getViewport(),r=e.children,o=r.length;for(let e=0;e<o;e++){const s=r[e];let o;if(p.svg(s))o=new squared.svg.Svg(s,!1),this.setAspectRatio(o,s.viewBox.baseVal),n=!0;else if(p.g(s))o=new squared.svg.SvgG(s),this.setAspectRatio(o);else if(p.use(s)){const t=v(s);if(t)if(p.symbol(t))o=new squared.svg.SvgUseSymbol(s,t),this.setAspectRatio(o,t.viewBox.baseVal),n=!0;else if(p.image(t))o=new squared.svg.SvgImage(s,t);else if(p.shape(t)){const e=ee(s,a);e?(o=new squared.svg.SvgUsePattern(s,t,e),this.setAspectRatio(o)):o=new squared.svg.SvgUse(s,t,i)}}else if(p.image(s))o=new squared.svg.SvgImage(s);else if(p.shape(s)){const t=ee(s,a);t?(o=new squared.svg.SvgShapePattern(s,t),this.setAspectRatio(o)):o=new squared.svg.SvgShape(s,i)}o&&(this.append(o,a),o.build(t))}const l=this.aspectRatio;if(N.asSvg(this)&&this.documentRoot)(l.x<0||l.y<0)&&this.clipViewBox(l.x,l.y,l.width,l.height,s,!0);else if(n&&this.hasViewBox()&&(0!==l.x||0!==l.y)){const t=N.getBoxRect(this.getPathAll(!1)),e=this.refitX(l.x),i=this.refitY(l.y);(t.left<e||t.top<i)&&this.clipViewBox(t.left,t.top,this.refitSize(l.width),this.refitSize(l.height),s)}}hasViewBox(){return N.asSvg(this)&&!!this.element.viewBox.baseVal||N.asUseSymbol(this)&&!!this.symbolElement.viewBox.baseVal}clipViewBox(t,e,s,i,n,a=!1){a&&(s-=t,i-=e,t=t<0?-1*t:0,e=e<0?-1*e:0),this.clipRegion=N.drawRect(s,i,t,e,n)}synchronize(t){this.each(e=>e.synchronize(t))}refitX(t){const e=this.aspectRatio;return(t-e.x)*e.unit-e.parent.x+e.position.x}refitY(t){const e=this.aspectRatio;return(t-e.y)*e.unit-e.parent.y+e.position.y}refitSize(t){return t*this.aspectRatio.unit}refitPoints(t){for(const e of t)if(e.x=this.refitX(e.x),e.y=this.refitY(e.y),void 0!==e.rx&&void 0!==e.ry){const t=this.aspectRatio.unit;e.rx*=t,e.ry*=t}return t}getPathAll(t=!0){const e=[];for(const s of t?this.cascade():this)if(N.isShape(s)){const t=s.path;t&&t.value&&e.push(t.value)}return e}getViewport(){return this.viewport||N.asSvg(this)&&this||void 0}setAspectRatio(t,e){const s=function(t){for(;t;){if(t.hasViewBox())return t;t=t.parent}}(this);if(s){const i=t.aspectRatio,n=s.aspectRatio;if(e){te.cloneObject(e,i);const{width:t,height:a}=i;if(t>0&&a>0){const e=t/a,r=n.width||s.viewBox.width,o=n.height||s.viewBox.height,l=r/o;l>e?i.position.x=(r-o*e)/2:l<e&&(i.position.y=(o-r*(1/e))/2),i.unit=Math.min(r/t,o/a)}}const{parent:a,position:r,unit:o,x:l,y:c}=n;i.parent.x=l+l*(o-1),i.position.x*=n.unit,i.position.x+=r.x-a.x,i.parent.y=c+c*(o-1),i.position.y*=o,i.position.y+=r.y-a.y,i.unit*=o}}set clipRegion(t){""!==t?this._clipRegion.push(t):this._clipRegion.length=0}get clipRegion(){const t=this._clipRegion;return t.length?t.join(";"):""}get requireRefit(){const t=this.aspectRatio;return 0!==t.x||0!==t.y||0!==t.position.x||0!==t.position.y||0!==t.parent.x||0!==t.parent.y||1!==t.unit}get instanceType(){return 2}}const{color:ie,dom:ne,util:ae}=squared.lib;function re(t){const e=[],s=t.getElementsByTagName("stop"),i=s.length;for(let t=0;t<i;t++){const i=s[t],n=ie.parseColor(ne.getNamedItem(i,"stop-color"),ae.convertFloat(ne.getNamedItem(i,"stop-opacity")||"1"));n&&e.push({color:n,offset:parseFloat(ne.getNamedItem(i,"offset"))/100})}return e}function oe(t,...e){const s={};for(const i of e){const e=t[i];if(e){const t=e.baseVal;s[i]=t.value,s[i+"AsString"]=t.valueAsString}}return s}class le extends(Ft(Jt(C(Ht(se))))){constructor(t,e=!0){super(t),this.element=t,this.documentRoot=e,this.definitions={clipPath:new Map,pattern:new Map,gradient:new Map},this.init()}build(t){this.precision=t&&t.precision,this.setRect(),super.build(t)}synchronize(t){!this.documentRoot&&this.animations.length&&this.animateSequentially(this.getAnimateViewRect(),this.getAnimateTransform(t),void 0,t),super.synchronize(t)}init(){const t=this.element;this.documentRoot&&(ae.cloneObject(t.viewBox.baseVal,this.aspectRatio),t.querySelectorAll("set, animate, animateTransform, animateMotion").forEach(e=>{const s=v(e,t);if(s){const t=e.parentElement;t&&t.removeChild(e),s.appendChild(e)}})),this.setDefinitions(t),t.querySelectorAll("defs").forEach(t=>this.setDefinitions(t))}setDefinitions(t){const e=this.definitions;t.querySelectorAll("clipPath, pattern, linearGradient, radialGradient").forEach(t=>{if(t.id){const s="#"+t.id;p.clipPath(t)?e.clipPath.set(s,t):p.pattern(t)?e.pattern.set(s,t):p.linearGradient(t)?e.gradient.set(s,Object.assign({type:"linear",element:t,spreadMethod:t.spreadMethod.baseVal,colorStops:re(t)},oe(t,"x1","x2","y1","y2"))):p.radialGradient(t)&&e.gradient.set(s,Object.assign({type:"radial",element:t,spreadMethod:t.spreadMethod.baseVal,colorStops:re(t)},oe(t,"cx","cy","r","fx","fy","fr")))}})}get viewBox(){return this.element.viewBox.baseVal||d(this.element)}get instanceType(){return 18}}class ce{constructor(t){this.element=t}build(t){}synchronize(t){}get instanceType(){return 4}}const{color:he,css:ue,regex:fe,util:pe}=squared.lib,de={url:fe.CSS.URL};var ge=t=>(class extends t{setPaint(t,e){this.resetPaint(),this.setAttribute("color"),this.setAttribute("fill"),this.setAttribute("fill-opacity",!1),this.setAttribute("fill-rule"),this.setAttribute("stroke"),this.setAttribute("stroke-opacity",!1),this.setAttribute("stroke-width"),this.setAttribute("stroke-linecap"),this.setAttribute("stroke-linejoin"),this.setAttribute("stroke-miterlimit"),this.setAttribute("stroke-dasharray"),this.setAttribute("stroke-dashoffset"),this.setAttribute("clip-rule");const s=this.getAttribute("clip-path",!0,!1);if(""!==s&&"none"!==s){if(void 0===de.polygon){const t=fe.STRING.LENGTH_PERCENTAGE;de.polygon=/polygon\(([^)]+)\)/,de.inset=RegExp(`inset\\(${t}\\s?${t}?\\s?${t}?\\s?${t}?\\)`),de.circle=RegExp(`circle\\(${t}(?: at ${t} ${t})?\\)`),de.ellipse=RegExp(`ellipse\\(${t} ${t}(?: at ${t} ${t})?\\)`)}for(const i in de){const n=de[i].exec(s);if(n){if("url"===i)return void(this.clipPath=n[1]);if(t&&t.length){const{top:s,right:a,bottom:r,left:o}=N.getBoxRect(t),l=a-o,c=r-s,h=this.parent;switch(i){case"inset":{let t=0,i=0,u=this.convertLength(n[1],c),f=0;n[4]?(t=o+this.convertLength(n[4],l),i=a-this.convertLength(n[2],l),f=r-this.convertLength(n[3],c)):n[2]?(i=a-(t=this.convertLength(n[2],l)),f=r-(n[3]?this.convertLength(n[3],c):u),t+=o):(t=o+u,i=a-u,f=r-u);const p=[{x:t,y:u+=s},{x:i,y:u},{x:i,y:f},{x:t,y:f}];return h&&h.refitPoints(p),void(this.clipPath=N.drawPolygon(p,e))}case"polygon":{const t=pe.objectMap(n[1].split(fe.XML.SEPARATOR),t=>{let[e,i]=pe.replaceMap(t.trim().split(" "),(t,e)=>this.convertLength(t,0===e?l:c));return{x:e+=o,y:i+=s}});return h&&h.refitPoints(t),void(this.clipPath=N.drawPolygon(t,e))}default:if("circle"===i||"ellipse"===i){const t=l<c?l:c;let a,r;"circle"===i?r=a=this.convertLength(n[1],t):(a=this.convertLength(n[1],l),r=this.convertLength(n[2],c));let u=o,f=s;const p=n.length;p>=4&&(u+=this.convertLength(n[p-2],t),f+=this.convertLength(n[p-1],t)),h&&(u=h.refitX(u),f=h.refitX(f),a=h.refitSize(a),r=h.refitSize(r)),this.clipPath=N.drawEllipse(u,f,a,r,e)}return}}}}}}setAttribute(t,e=!0,s=!0){let i=this.getAttribute(t,e,s);if(pe.isString(i)){if(ue.isCustomProperty(i)){const e=ue.calculateVar(this.element,i,t);void 0!==e&&(i=""+e)}switch(t){case"stroke-dasharray":i="none"!==i?pe.joinMap(i.split(/,\s*/),t=>""+this.convertLength(t),", ",!1):"";break;case"stroke-dashoffset":case"stroke-width":i=""+this.convertLength(i);break;case"fill":case"stroke":const e=y(i);if(""!==e)this[t+"Pattern"]=e;else{let e;switch(i.toLowerCase()){case"none":case"transparent":case"rgba(0, 0, 0, 0)":this[t]="none";break;case"currentcolor":e=he.parseColor(this.color||g(this.element,t));break;default:e=he.parseColor(i)}e&&(this[t]=e.value)}return}this[pe.convertCamelCase(t)]=i}}getAttribute(t,e=!0,s=!0){let i=g(this.element,t,e);if(s&&!pe.isString(i)){if(this.patternParent)switch(t){case"fill-opacity":case"stroke-opacity":break;default:return i}let s=this.useParent||this.parent;for(;s&&(i=g(s.element,t,e),!pe.isString(i));)s=s.parent}return i}convertLength(t,e){if(!pe.isNumber(t)){if(ue.isLength(t))return ue.parseUnit(t,ue.getFontSize(this.element));if(ue.isPercent(t))return Math.round(("number"==typeof e?e:this.element.getBoundingClientRect()[e||"width"])*pe.convertFloat(t)/100)}return pe.convertFloat(t)}resetPaint(){this.fill="black",this.fillPattern="",this.fillOpacity="1",this.fillRule="nonzero",this.stroke="",this.strokeWidth="1",this.strokePattern="",this.strokeOpacity="1",this.strokeLinecap="butt",this.strokeLinejoin="miter",this.strokeMiterlimit="4",this.strokeDasharray="",this.strokeDashoffset="0",this.color="",this.clipPath="",this.clipRule=""}});class me extends(ge(Ht(se))){constructor(t){super(t),this.element=t}build(t){super.build(t),this.setPaint(this.getPathAll(),t&&t.precision)}get instanceType(){return 34}}const ye=squared.lib.util;class ve extends(Jt(C(Ht(ce)))){constructor(t,e){super(t),this.element=t,this.imageElement=null,this.__get_transforms=!1,this.__get_animations=!1,e&&(this.imageElement=e)}build(){this.setRect()}extract(t){const e=t?N.filterTransforms(this.transforms,t):this.transforms;let{x:s,y:i,width:n,height:a}=this;if(e.length){e.reverse();for(const t of e){const e=t.matrix,r=s;switch(s=u.applyX(e,r,i),i=u.applyY(e,r,i),t.type){case SVGTransform.SVG_TRANSFORM_SCALE:n*=e.a,a*=e.d;break;case SVGTransform.SVG_TRANSFORM_ROTATE:0!==t.angle&&(e.a<0&&(s+=e.a*n),e.c<0&&(s+=e.c*n),e.b<0&&(i+=e.b*a),e.d<0&&(i+=e.d*a),this.rotateAngle?this.rotateAngle+=t.angle:this.rotateAngle=t.angle)}}this.transformed=e}const{parent:r,translationOffset:o}=this;r&&(s=r.refitX(s),i=r.refitY(i),n=r.refitSize(n),a=r.refitSize(a)),o&&(s+=o.x,i+=o.y),this.setBaseValue("x",s),this.setBaseValue("y",i),this.setBaseValue("width",n),this.setBaseValue("height",a)}set x(t){super.x=t}get x(){const t=super.x;if(0===t){const t=this.imageElement;if(t)return t.x.baseVal.value}return t}set y(t){super.y=t}get y(){const t=super.y;if(0===t){const t=this.imageElement;if(t)return t.y.baseVal.value}return t}set width(t){super.width=t}get width(){const t=super.width;if(0===t){const t=this.imageElement;if(t)return t.width.baseVal.value}return t}set height(t){super.height=t}get height(){const t=super.height;if(0===t){const t=this.imageElement;if(t)return t.height.baseVal.value}return t}get href(){const t=this.imageElement||this.element;return p.image(t)?ye.resolvePath(t.href.baseVal):""}get transforms(){let t=super.transforms;if(!this.__get_transforms){const e=this.imageElement;e&&(t=t.concat(this.getTransforms(e)),this._transforms=t),this.__get_transforms=!0}return t}get animations(){let t=super.animations;if(!this.__get_animations){const e=this.imageElement;e&&(t=t.concat(this.getAnimations(e)),this._animations=t),this.__get_animations=!0}return t}get instanceType(){return 4100}}const{dom:Se,math:be,util:ke}=squared.lib;function Te(t,e,s,i){const n=t[0],a=t[t.length-1];if(void 0!==s)switch(e){case"x":s-=n.start.x;break;case"x1":case"cx":return n.start.x=s,void(n.coordinates[0]=s);case"x2":return a.end.x=s,void(a.coordinates[0]=s)}if(void 0!==i)switch(e){case"y":i-=n.start.y;break;case"y1":case"cy":return n.start.y=i,void(n.coordinates[1]=i);case"y2":return a.end.y=i,void(a.coordinates[1]=i)}for(const e of t){const{coordinates:t,value:n}=e,a=t.length;for(let r=0,o=0;r<a;r+=2,o++)void 0!==s&&(e.relative||(t[r]+=s),n[o].x+=s),void 0!==i&&(e.relative||(t[r+1]+=i),n[o].y+=i)}}function xe(t,e,s){const i=t.length;for(let n=0;n<i;n++){const i=t[n];if("A"===i.key.toUpperCase()){if(void 0!==e){const s=e-i.radiusX;i.radiusX=e,i.coordinates[0]=2*e*(i.coordinates[0]<0?-1:1),1===n&&(t[0].coordinates[0]-=s,t[0].end.x-=s)}void 0!==s&&(i.radiusY=s)}}}class Ae extends(ge(C(ce))){constructor(t){super(t),this.element=t,this.name="",this.value="",this.baseValue="",this.init()}static extrapolate(t,e,s,i,n,a){const r=!!i||!!n&&!!n.parent&&n.parent.requireRefit,o=[];let l;const c=s.length;for(let h=0;h<c;h++){if("d"===t)o[h]=s[h];else if("points"===t){const t=N.convertPoints(N.parseCoordinates(s[h]));t.length&&(o[h]=n&&p.polygon(n.element)?N.drawPolygon(t,a):N.drawPolyline(t,a))}else if(e){void 0===l&&(l=N.getPathCommands(e));const i=parseFloat(s[h]);if(!isNaN(i)){const e=h<c-1?ke.cloneArray(l,[],!0):l;switch(t){case"x":case"x1":case"x2":case"cx":Te(e,t,i);break;case"y":case"y1":case"y2":case"cy":Te(e,t,void 0,i);break;case"r":xe(e,i,i);break;case"rx":xe(e,i);break;case"ry":xe(e,void 0,i);break;case"width":for(const t of[1,2]){const s=e[t];switch(s.key){case"m":case"l":case"h":s.coordinates[0]=i*(s.coordinates[0]<0?-1:1);break;case"M":case"L":case"H":s.coordinates[0]=e[0].end.x+i}}break;case"height":for(const t of[2,3]){const s=e[t];switch(s.key){case"m":case"l":case"v":s.coordinates[1]=i*(s.coordinates[1]<0?-1:1);break;case"M":case"L":case"V":s.coordinates[1]=e[0].end.y+i}}break;default:o[h]="";continue}o[h]=N.drawPath(e,a)}}o[h]?r&&(o[h]=N.transformRefit(o[h],i,n,n&&n.parent,a)):o[h]=""}return o}build(t){let e;t&&t.transforms&&(e=N.filterTransforms(t.transforms,t.exclude&&t.exclude[this.element.tagName])),this.draw(e,t)}draw(t,e){let s,i;e&&(s=e.residual,i=e.precision);const n=this.element,a=this.parent,r=this.patternParent,o=!!a&&a.requireRefit,l=!!r&&2===r.patternContentUnits;let c;if(this.transformed=void 0,p.path(n)){if(c=this.getBaseValue("d"),t&&t.length||o||l){const e=N.getPathCommands(c);if(e.length){let h=N.getPathPoints(e);h.length&&(l&&r.patternRefitPoints(h),t&&t.length&&("function"==typeof s&&([this.transformResidual,t]=s.call(this,n,t)),t.length&&(h=N.applyTransforms(t,h,f.origin(this.element)),this.transformed=t)),this.baseValue=N.drawPath(N.syncPathPoints(o?ke.cloneArray(e,[],!0):e,o?ke.cloneArray(h,[],!0):h,void 0!==this.transformed),i),o?(a.refitPoints(h),c=N.drawPath(N.syncPathPoints(e,h,void 0!==this.transformed),i)):c=this.baseValue)}}""===this.baseValue&&(this.baseValue=c)}else if(p.line(n)){let e=[{x:this.getBaseValue("x1"),y:this.getBaseValue("y1")},{x:this.getBaseValue("x2"),y:this.getBaseValue("y2")}];l&&r.patternRefitPoints(e),t&&t.length&&("function"==typeof s&&([this.transformResidual,t]=s.call(this,n,t)),t.length&&(e=N.applyTransforms(t,e,f.origin(this.element)),this.transformed=t));const h=()=>N.drawPolyline(e,i);this.baseValue=h(),o?(a.refitPoints(e),c=h()):c=this.baseValue}else if(p.circle(n)||p.ellipse(n)){const e=this.getBaseValue("cx"),h=this.getBaseValue("cy");let u,d;p.ellipse(n)?(u=this.getBaseValue("rx"),d=this.getBaseValue("ry")):d=u=this.getBaseValue("r");let g=[{x:e,y:h,rx:u,ry:d}];l&&r.patternRefitPoints(g),t&&t.length&&("function"==typeof s&&([this.transformResidual,t]=s.call(this,n,t,u,d)),t.length&&(g=N.applyTransforms(t,g,f.origin(this.element)),this.transformed=t));const m=g[0],y=()=>N.drawEllipse(m.x,m.y,m.rx,m.ry,i);this.baseValue=y(),o?(a.refitPoints(g),c=y()):c=this.baseValue}else if(p.rect(n)){let e=this.getBaseValue("x"),h=this.getBaseValue("y"),u=this.getBaseValue("width"),p=this.getBaseValue("height");if(t&&t.length){let d=[{x:e,y:h},{x:e+u,y:h},{x:e+u,y:h+p},{x:e,y:h+p}];l&&r.patternRefitPoints(d),"function"==typeof s&&([this.transformResidual,t]=s.call(this,n,t)),t.length&&(d=N.applyTransforms(t,d,f.origin(this.element)),this.transformed=t);const g=()=>N.drawPolygon(d,i);this.baseValue=g(),o?(a.refitPoints(d),c=g()):c=this.baseValue}else{l&&(e=r.patternRefitX(e),h=r.patternRefitY(h),u=r.patternRefitX(u),p=r.patternRefitY(p));const t=()=>N.drawRect(u,p,e,h,i);this.baseValue=t(),o?(e=a.refitX(e),h=a.refitY(h),u=a.refitSize(u),p=a.refitSize(p),c=t()):c=this.baseValue}}else if(p.polygon(n)||p.polyline(n)){let e=this.getBaseValue("points");l&&r.patternRefitPoints(e),t&&t.length&&("function"==typeof s&&([this.transformResidual,t]=s.call(this,n,t)),t.length&&(e=N.applyTransforms(t,e,f.origin(this.element)),this.transformed=t));const h=()=>p.polygon(n)?N.drawPolygon(e,i):N.drawPolyline(e,i);this.baseValue=h(),o?(null===this.transformed&&(e=N.clonePoints(e)),a.refitPoints(e),c=h()):c=this.baseValue}else c="";return this.value=c,this.setPaint([c],i),c}extendLength(t,e){if(""!==this.value)switch(this.element.tagName){case"path":case"line":case"polyline":const s=N.getPathCommands(this.value);if(s.length){const i=s[0],n=i.start,a=s[s.length-1],r=a.end,o=a.key.toUpperCase(),l=t.leading,c=t.trailing;let h=!1;if("Z"!==o&&(n.x!==r.x||n.y!==r.y)){if(l>0){let t;if(i.value.length>1?t=i.value[1]:s.length>1&&(t=s[1].start),t)if(t.x===n.x)i.coordinates[1]=i.coordinates[1]+(n.y>t.y?l:-l),h=!0;else if(t.y===n.y)i.coordinates[0]=i.coordinates[0]+(n.x>t.x?l:-l),h=!0;else{const e=be.relativeAngle(t,n);i.coordinates[0]=i.coordinates[0]-be.offsetAngleX(e,l),i.coordinates[1]=i.coordinates[1]-be.offsetAngleY(e,l),h=!0}}switch(o){case"M":case"L":if(c>0){let t;if(1===s.length?i.value.length>1&&(t=i.value[i.value.length-2]):t=a.value.length>1?a.value[a.value.length-2]:s[s.length-2].end,t)if(t.x===r.x)a.coordinates[1]=a.coordinates[1]+(r.y>t.y?c:-c),h=!0;else if(t.y===r.y)a.coordinates[0]=a.coordinates[0]+(r.x>t.x?c:-c),h=!0;else{const e=be.relativeAngle(t,r),s=a.coordinates[0]+be.offsetAngleX(e,c),i=a.coordinates[1]+be.offsetAngleY(e,c);a.coordinates[0]=s,a.coordinates[1]=i,h=!0}}break;case"H":case"V":{const t="H"===o?0:1;a.coordinates[t]=a.coordinates[t]+(l+c)*(a.coordinates[t]>=0?1:-1),h=!0;break}}}if(h)return t.leading=l,t.trailing=c,t.path=N.drawPath(s,e),t}}}flattenStrokeDash(t,e,s,i,n){let a,r,o,l;i||(i=s);let c=0;const h=t=>r[t%a];if(n)({dashArray:r,dashArrayTotal:o,extendedLength:l,startIndex:c}=n),a=r.length,n.items=[],n.leading=0;else{a=t.length,r=t.slice(0);const u=be.nextMultiple([2,a]);o=0;for(let e=0;e<u;e++){const s=t[e%a];o+=s,e>=a&&r.push(s)}if(a=u,e>0){let t=h(0);for(;e-t>=0;)e-=t,t=h(++c);c%=a}else if(e<0){for(r.reverse();e<0;)e+=h(c++);c=a-c%a,r.reverse()}n={dashArray:r,dashArrayTotal:o,items:[],leading:0,trailing:0,startIndex:c,extendedLength:l=i,lengthRatio:s/(i||s)}}let u,f=0;for(let t=0,s=0;;t+=s,c++){let i,a;s=h(c),t<e?(n.leading=e-t,i=0,a=s-n.leading):(i=t-e,a=s);const r=be.truncateFraction(i/l);if(u=be.truncateFraction(r+a/l),c%2==0?r<1&&(n.items.push({start:r,end:Math.min(u,1),length:s}),f+=s):f+=s,u>=1)break}for(n.trailing=be.truncateFraction((u-1)*l);f%o!=0;){const t=h(++c);n.trailing+=t,f+=t}return 0===n.items.length?n.items.push({start:1,end:1}):(n.leadingOffset=be.truncateFraction(n.items[0].start*l),n.leading*=n.lengthRatio,n.trailing*=n.lengthRatio),n}extractStrokeDash(t,e){const s=ke.convertInt(this.strokeWidth);let i,n="",a="";if(s>0){let f=N.parseCoordinates(this.strokeDasharray);if(f.length){const p=this.totalLength,d=this.pathLength||p,g=[];let m,y=ke.convertInt(this.strokeDashoffset),v=0;const S=(t,e,s,i=0)=>{const n=this.flattenStrokeDash(t,e,p,d);return 0===g.length&&(m=n),v=Math.max(v,n.items.length),g.push({items:n.items,delay:s,duration:i}),n.items};if(i=S(f,y,0),t){const b=t.slice(0).sort((t,e)=>{if(t.attributeName.startsWith("stroke-dash")&&e.attributeName.startsWith("stroke-dash")){if(t.delay!==e.delay)return t.delay<e.delay?-1:1;if(N.asSet(t)&&N.asAnimate(e)||void 0===t.animationElement&&e.animationElement)return-1;if(N.asAnimate(t)&&N.asSet(e)||t.animationElement&&void 0===e.animationElement)return 1}return 0}),T=new J(b,"stroke-dasharray","stroke-dashoffset");if(b.length>1)for(let t=0;t<b.length;t++)T.has(b[t].attributeName,b[t].delay,b[t])||b.splice(t--,1);function r(t,e=!1){const s=T.get("stroke-dashoffset",t,e);return s?parseFloat(s):y}function o(t,e=!1){const s=T.get("stroke-dasharray",t,e);return s?N.parseCoordinates(s):f}const x=t=>t?t.start+" "+t.end:"1 1";let A=t=>{let e=y;const s=b.length;for(let i=t;i<s;i++){const t=b[i];if("stroke-dasharray"===t.attributeName){const s=T.get("stroke-dashoffset",t.delay);s&&(e=parseFloat(s));for(const s of N.asAnimate(t)?T.evaluateStart(t):[t.to])v=Math.max(v,this.flattenStrokeDash(N.parseCoordinates(s),e,p,d).items.length)}}},_=[],R=!1;for(let t=0;t<b.length;t++){const V=b[t];if(V.setterType){function l(t,e){S(t,e,V.delay,V.fillReplace&&V.duration>0?V.duration:0),R=!0}switch(V.attributeName){case"stroke-dasharray":l(f=N.parseCoordinates(V.to),r(V.delay));continue;case"stroke-dashoffset":y=ke.convertInt(V.to),l(o(V.delay),y);continue}}else if(N.asAnimate(V)&&V.playable)switch(T.evaluateStart(V),V.attributeName){case"stroke-dasharray":{A&&(A(t),A=void 0);const e=r(V.delay),s=this.flattenStrokeDash(o(V.delay),e,p,d).items,i=[],n=[];for(let t=0;t<v;t++){const e=new U(this.element);e.id=t,e.baseValue=x(s[t]),e.attributeName="stroke-dasharray",e.delay=V.delay,e.duration=V.duration,e.iterationCount=V.iterationCount,e.fillMode=V.fillMode,n[t]=[],i.push(e)}for(const t of V.values){const s=this.flattenStrokeDash(N.parseCoordinates(t),e,p,d).items;for(let t=0;t<v;t++)n[t].push(x(s[t]))}const{keyTimes:a,keySplines:l}=V,c=V.timingFunction;for(let t=0;t<v;t++)i[t].values=n[t],i[t].keyTimes=a,l?i[t].keySplines=l:c&&(i[t].timingFunction=c);if(V.fillReplace){const t=V.getTotalDuration(),e=this.flattenStrokeDash(o(t),r(t),p,d).items;for(let t=0;t<v;t++)i[t].replaceValue=x(e[t])}_=_.concat(i),R=!0;continue}case"stroke-dashoffset":{const t=V.duration,r=parseFloat(V.values[0]),o=[],l=[];let f=0,S=0;y===r||0!==V.delay||V.fillReplace||(m=this.flattenStrokeDash(m.dashArray,r,p,d),g[0].items=i=m.items,v=Math.max(v,m.items.length),y=r);let b,x=p,A=1;if((m.leading>0||m.trailing>0)&&(this.extendLength(m,e),m.path)){const t=N.getBoxRect([this.value]);A=(x=be.truncateFraction(k(m.path)))/p,m.extendedLength=this.pathLength,m.extendedLength>0?m.extendedLength*=A:m.extendedLength=x;const e=this.flattenStrokeDash(m.dashArray,0,p,d,m);g[0].items=i=e.items,v=Math.max(v,i.length);const r=Math.ceil(s/2);n=m.path,a=N.drawRect(t.right-t.left,t.bottom-t.top+2*r,t.left,t.top-r)}if(V.fillReplace&&-1!==V.iterationCount){const t=ke.convertFloat(T.get(V.attributeName,V.getTotalDuration()));if(t!==y){let e=Math.abs(t-y)%x/x;t>y&&(e=1-e),b=""+e}}const _=V.keyTimes,w=V.values,M=_.length;for(let e=0;e<M;e++){const s=0===e?y:parseFloat(w[e-1]),i=parseFloat(w[e]),n=Math.abs(i-s),a=_[e];if(0===n){e>0&&(l.push(f=a),o.length?(o.push(o[o.length-1]),S=parseFloat(o[o.length-1])):(o.push("0"),S=0));continue}const r=i>s,p=e>0?(a-_[e-1])*t:0,d=n*m.lengthRatio,g=e=>e/d*p/t;function c(t,e=!1){if(k=(b-t)/x,e){const t=be.truncateFraction(k);r?t>0&&(k=1-k):0===t&&(k=1)}}function h(){e>0&&(r?"1"===o[o.length-1]:"0"===o[o.length-1])||(l.push(0===f?0:be.truncateFraction(f)),o.push(r?"1":"0"))}function u(){l.push(f=a);const t=be.truncateFraction(k);o.push(""+t),S=t>0&&t<1?k:0}let v=d/x,b=d,k=0;if(0===e)b%=x,c(0),r&&(k=1-k),u();else{if(S>0){const t=r?S:1-S,e=be.truncateFraction(t*x);if(be.lessEqual(b,e)){c(0),r?k=S-k:k+=S,u();continue}o.push(r?"0":"1"),f+=g(e),l.push(be.truncateFraction(f)),v=be.truncateFraction(v-t),b=be.truncateFraction(b-e)}if(be.isEqual(b,x)&&(b=x),b>x){const t=(v=Math.floor(v))*x;t===b&&v--,c(t,!0)}else v=0,c(0,!0);for(;v>0;)h(),o.push(r?"0":"1"),f+=g(x),l.push(be.truncateFraction(f)),v--;h(),u()}}V.baseValue="0",V.replaceValue=b,V.values=o,V.keyTimes=l;const P=V.timingFunction;P&&(V.keySplines=void 0,V.timingFunction=P),R=!0;break}}_.push(V)}if(R){const e=g.length;for(let t=0;t<e;t++){const s=g[t].items;if(s===i)for(let t=s.length;t<v;t++)s.push({start:1,end:1});else{const{delay:n,duration:a}=g[t],l=e>2?this.flattenStrokeDash(o(n-1),r(n-1),p,d).items:i;for(let t=0;t<v;t++){const e=new I(this.element);e.id=t,e.attributeName="stroke-dasharray",e.baseValue=x(l[t]),e.delay=n,e.to=x(s[t]),e.duration=a,e.fillFreeze=0===a,_.push(e)}}}t=_}}}}return[t,i,n,a]}init(){const t=this.element;p.path(t)?this.setBaseValue("d"):p.line(t)?(this.setBaseValue("x1"),this.setBaseValue("y1"),this.setBaseValue("x2"),this.setBaseValue("y2")):p.rect(t)?(this.setBaseValue("x"),this.setBaseValue("y"),this.setBaseValue("width"),this.setBaseValue("height")):p.circle(t)?(this.setBaseValue("cx"),this.setBaseValue("cy"),this.setBaseValue("r")):p.ellipse(t)?(this.setBaseValue("cx"),this.setBaseValue("cy"),this.setBaseValue("rx"),this.setBaseValue("ry")):(p.polygon(t)||p.polyline(t))&&this.setBaseValue("points",N.clonePoints(t.points))}get transforms(){return void 0===this._transforms&&(this._transforms=N.filterTransforms(f.parse(this.element)||N.convertTransforms(this.element.transform.baseVal))),this._transforms}get pathLength(){return ke.convertFloat(Se.getNamedItem(this.element,"pathLength"))}get totalLength(){return this.element.getTotalLength()}get instanceType(){return 1028}}class _e extends(Ht(se)){constructor(t,e){super(t),this.element=t,this.patternElement=e}build(t){t=Object.assign(Object.assign({},t),{patternElement:this.patternElement,initialize:!1}),super.build(t)}get animations(){return[]}get instanceType(){return 130}}class Re extends(Ft(Ht(ce))){constructor(t,e=!0){super(t),this.element=t,e&&this.setPath()}setPath(){this.path=new Ae(this.element)}build(t){const e=this.path;e&&(e.parent=this.parent,t=Object.assign(Object.assign({},t),{transforms:this.transforms}),e.build(t))}synchronize(t){if(this.animations.length){const e=this.path;if(e){const s=t&&t.element;this.animateSequentially(this.getAnimateShape(s||this.element),s?void 0:this.getAnimateTransform(t),e,t)}}}set path(t){this._path=t,t&&(t.name=this.name)}get path(){return this._path}get instanceType(){return 2052}}const{css:Ve,dom:we}=squared.lib,Me=t=>Ve.isPercent(t)?parseFloat(t)/100:parseFloat(t);class Pe extends(ge(C(Ht(se)))){constructor(t,e){super(t),this.element=t,this.patternElement=e,this.__get_transforms=!1,this.patternUnits="userSpaceOnUse"===we.getNamedItem(this.patternElement,"patternUnits")?1:2,this.patternContentUnits="objectBoundingBox"===we.getNamedItem(this.patternElement,"patternContentUnits")?2:1}build(t){const e=t&&t.element||this.element,s=new Ae(e);if(s.build(t),s.value){const i=t&&t.precision;t=Object.assign({},t),this.clipRegion=s.value,s.clipPath&&(this.clipRegion=s.clipPath);const n=[s.value];this.setPaint(n,i),this.drawRegion=N.getBoxRect(n);const{drawRegion:a,fillOpacity:r,patternWidth:o,patternHeight:l,tileWidth:c,tileHeight:h}=this;let u=this.offsetX%c,f=this.offsetY%h,p=0,d=0,g=a.right,m=a.bottom;2===this.patternUnits&&(g-=a.left,m-=a.top,p=a.left,d=a.top);let y=0;for(0!==u&&(u=c-u,g+=c),0!==f&&(f=h-f,m+=h);m>0;){const s=this.patternElement,n=2===this.patternContentUnits,a=d+y*h-f;let v=g,S=0;do{const f=p+S*c-u,d=new _e(e,s);d.build(t);for(const e of d.cascade())if(N.isShape(e)){e.setPath();const s=e.path;s&&(s.patternParent=this,n?s.refitBaseValue(f/o,a/l,i):s.refitBaseValue(f,a,i),t.transforms=e.transforms,s.build(t),s.fillOpacity=""+parseFloat(s.fillOpacity)*parseFloat(r),s.clipPath=N.drawRect(c,h,f,a,i)+(""!==s.clipPath?";"+s.clipPath:""))}this.append(d),v-=c,S++}while(v>0);y++,m-=h}if(""!==this.stroke&&parseFloat(this.strokeWidth)>0){s.fill="",s.fillOpacity="0",s.stroke=this.stroke,s.strokeWidth=this.strokeWidth;const t=new Re(e,!1);t.path=s,this.append(t)}}}patternRefitX(t){return this.drawRegion?t*this.patternWidth:t}patternRefitY(t){return this.drawRegion?t*this.patternHeight:t}patternRefitPoints(t){if(this.drawRegion){const e=this.patternWidth,s=this.patternHeight;for(const i of t)if(i.x*=e,i.y*=s,void 0!==i.rx&&void 0!==i.ry)if(i.rx===i.ry){const t=Math.min(e,s);i.rx*=t,i.ry*=t}else i.rx*=e,i.ry*=s}return t}get patternWidth(){const t=this.drawRegion;return t?t.right-t.left:0}get patternHeight(){const t=this.drawRegion;return t?t.bottom-t.top:0}get transforms(){if(!this.__get_transforms){const t=this.patternElement,e=N.convertTransforms(t.patternTransform.baseVal);if(e.length){const s=f.rotateOrigin(t,"patternTransform"),i=this.patternWidth/2,n=this.patternHeight/2;for(const t of e)switch(t.type){case SVGTransform.SVG_TRANSFORM_TRANSLATE:break;case SVGTransform.SVG_TRANSFORM_ROTATE:for(;s.length;){const e=s.shift();if(e.angle===t.angle){t.origin={x:i+e.x,y:n+e.y};break}}if(t.origin)break;default:t.origin={x:i,y:n}}this._transforms=super.transforms.concat(N.filterTransforms(e))}this.__get_transforms=!0}return super.transforms}get offsetX(){const t=this.patternElement.x.baseVal;let e=0;return 2===this.patternUnits&&(e=this.patternWidth*Me(t.valueAsString)),e||t.value}get offsetY(){const t=this.patternElement.y.baseVal;let e=0;return 2===this.patternUnits&&(e=this.patternHeight*Me(t.valueAsString)),e||t.value}get tileWidth(){const t=this.patternElement.width.baseVal;let e=0;return 2===this.patternUnits&&(e=this.patternWidth*Me(t.valueAsString)),e||t.value}get tileHeight(){const t=this.patternElement.height.baseVal;let e=0;return 2===this.patternUnits&&(e=this.patternHeight*Me(t.valueAsString)),e||t.value}get instanceType(){return 258}}class Ne extends(ge(Jt(C(Re)))){constructor(t,e,s=!0){super(t,!1),this.element=t,this.shapeElement=e,this.__get_transforms=!1,this.__get_animations=!1,s&&this.setPath()}setPath(){this.path=new Ae(this.shapeElement),this.path.useParent=this}build(t){super.build(t);const e=this.path;this.setPaint(e?[e.value]:void 0,t&&t.precision)}synchronize(t){t=Object.assign(Object.assign({},t),{element:this.shapeElement}),this.animations.length&&this.animateSequentially(this.getAnimateViewRect(),this.getAnimateTransform(t),void 0,t),super.synchronize(t)}get transforms(){let t=super.transforms;return this.__get_transforms||(t=t.concat(this.getTransforms(this.shapeElement)),this._transforms=t,this.__get_transforms=!0),t}get animations(){let t=super.animations;return this.__get_animations||(t=t.concat(this.getAnimations(this.shapeElement)),this._animations=t,this.__get_animations=!0),t}get instanceType(){return 10244}}const Ee=squared.lib.util;class Fe extends(Ft(Jt(Pe))){constructor(t,e,s){super(t,s),this.element=t,this.shapeElement=e}build(t){t=Object.assign(Object.assign({},t),{element:this.shapeElement}),super.build(t)}synchronize(t){const e=Ee.filterArray(this.animations,t=>void 0===this.verifyBaseValue(t.attributeName,0)||"x"===t.attributeName||"y"===t.attributeName),s=this.getAnimateTransform(t);(e.length||s.length)&&this.animateSequentially(this.getAnimateViewRect(e),s,void 0,t),super.synchronize(t)}get instanceType(){return 514}}class Ce extends(ge(Ft(Jt(C(Ht(se)))))){constructor(t,e){super(t),this.element=t,this.symbolElement=e}build(t){t=Object.assign(Object.assign({},t),{symbolElement:this.symbolElement}),this.setRect(),super.build(t);const e=this.getBaseValue("x",0),s=this.getBaseValue("y",0);if(0!==e||0!==s){const t={x:e,y:s};for(const e of this.cascade())e.translationOffset=t}this.setPaint(this.getPathAll(),t&&t.precision)}synchronize(t){this.animations.length&&this.animateSequentially(this.getAnimateViewRect(),this.getAnimateTransform(t),void 0,t),super.synchronize(t)}get viewBox(){return this.symbolElement.viewBox.baseVal||d(this.element)}get instanceType(){return 66}}const Ge={constant:z,util:T};t.Svg=le,t.SvgAnimate=U,t.SvgAnimateMotion=Lt,t.SvgAnimateTransform=Z,t.SvgAnimation=I,t.SvgAnimationIntervalMap=J,t.SvgBaseVal=C,t.SvgBuild=N,t.SvgContainer=se,t.SvgElement=ce,t.SvgG=me,t.SvgImage=ve,t.SvgPaint=ge,t.SvgPath=Ae,t.SvgPattern=_e,t.SvgShape=Re,t.SvgShapePattern=Pe,t.SvgSynchronize=Ft,t.SvgUse=Ne,t.SvgUsePattern=Fe,t.SvgUseSymbol=Ce,t.SvgView=Ht,t.SvgViewRect=Jt,t.lib=Ge,Object.defineProperty(t,"__esModule",{value:!0})}));
